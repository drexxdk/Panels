!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n():"function"==typeof define&&define.amd?define(n):n()}(0,function(){"use strict";function e(e){var n=this.constructor;return this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){return n.reject(t)})})}function n(){}function t(e){if(!(this instanceof t))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=undefined,this._deferreds=[],u(e,this)}function o(e,n){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,t._immediateFn(function(){var t=1===e._state?n.onFulfilled:n.onRejected;if(null!==t){var o;try{o=t(e._value)}catch(f){return void i(n.promise,f)}r(n.promise,o)}else(1===e._state?r:i)(n.promise,e._value)})):e._deferreds.push(n)}function r(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var o=n.then;if(n instanceof t)return e._state=3,e._value=n,void f(e);if("function"==typeof o)return void u(function(e,n){return function(){e.apply(n,arguments)}}(o,n),e)}e._state=1,e._value=n,f(e)}catch(r){i(e,r)}}function i(e,n){e._state=2,e._value=n,f(e)}function f(e){2===e._state&&0===e._deferreds.length&&t._immediateFn(function(){e._handled||t._unhandledRejectionFn(e._value)});for(var n=0,r=e._deferreds.length;r>n;n++)o(e,e._deferreds[n]);e._deferreds=null}function u(e,n){var t=!1;try{e(function(e){t||(t=!0,r(n,e))},function(e){t||(t=!0,i(n,e))})}catch(o){if(t)return;t=!0,i(n,o)}}var c=setTimeout;t.prototype["catch"]=function(e){return this.then(null,e)},t.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new function(e,n,t){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof n?n:null,this.promise=t}(e,t,r)),r},t.prototype["finally"]=e,t.all=function(e){return new t(function(n,t){function o(e,f){try{if(f&&("object"==typeof f||"function"==typeof f)){var u=f.then;if("function"==typeof u)return void u.call(f,function(n){o(e,n)},t)}r[e]=f,0==--i&&n(r)}catch(c){t(c)}}if(!e||"undefined"==typeof e.length)throw new TypeError("Promise.all accepts an array");var r=Array.prototype.slice.call(e);if(0===r.length)return n([]);for(var i=r.length,f=0;r.length>f;f++)o(f,r[f])})},t.resolve=function(e){return e&&"object"==typeof e&&e.constructor===t?e:new t(function(n){n(e)})},t.reject=function(e){return new t(function(n,t){t(e)})},t.race=function(e){return new t(function(n,t){for(var o=0,r=e.length;r>o;o++)e[o].then(n,t)})},t._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},t._unhandledRejectionFn=function(e){void 0!==console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var l=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw Error("unable to locate global object")}();"Promise"in l?l.Promise.prototype["finally"]||(l.Promise.prototype["finally"]=e):l.Promise=t});
self.fetch || (self.fetch = function (e, n) { return n = n || {}, new Promise(function (t, r) { var s = new XMLHttpRequest; for (var o in s.open(n.method || "get", e, !0), n.headers) s.setRequestHeader(o, n.headers[o]); function u() { var e, n = [], t = [], r = {}; return s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm, function (s, o, u) { n.push(o = o.toLowerCase()), t.push([o, u]), r[o] = (e = r[o]) ? e + "," + u : u }), { ok: 2 == (s.status / 100 | 0), status: s.status, statusText: s.statusText, url: s.responseURL, clone: u, text: function () { return Promise.resolve(s.responseText) }, json: function () { return Promise.resolve(s.responseText).then(JSON.parse) }, blob: function () { return Promise.resolve(new Blob([s.response])) }, headers: { keys: function () { return n }, entries: function () { return t }, get: function (e) { return r[e.toLowerCase()] }, has: function (e) { return e.toLowerCase() in r } } } } s.withCredentials = "include" == n.credentials, s.onload = function () { t(u()) }, s.onerror = r, s.send(n.body || null) }) });
/* Web Font Loader v1.6.28 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.o=b||a;this.c=this.o.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&("style"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}
function w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function y(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}
function ea(a){return a.o.location.hostname||a.a.location.hostname}function z(a,b,c){function d(){m&&e&&f&&(m(g),m=null)}b=t(a,"link",{rel:"stylesheet",href:b,media:"all"});var e=!1,f=!0,g=null,m=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error("Stylesheet failed to load");d()}):setTimeout(function(){e=!0;d()},0);u(a,"head",b)}
function A(a,b,c,d){var e=a.c.getElementsByTagName("head")[0];if(e){var f=t(a,"script",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error("Script load timeout")))},d||5E3);return f}return null};function B(){this.a=0;this.c=null}function C(a){a.a++;return function(){a.a--;D(a)}}function E(a,b){a.c=b;D(a)}function D(a){0==a.a&&a.c&&(a.c(),a.c=null)};function F(a){this.a=a||"-"}F.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.a)};function G(a,b){this.c=a;this.f=4;this.a="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return H(a)+" "+(a.f+"00")+" 300px "+I(a.c)}function I(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1!=d.indexOf(" ")||/^\d/.test(d)?b.push("'"+d+"'"):b.push(d)}return b.join(",")}function J(a){return a.a+a.f}function H(a){var b="normal";"o"===a.a?b="oblique":"i"===a.a&&(b="italic");return b}
function ga(a){var b=4,c="n",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.o.document.documentElement;this.h=b;this.a=new F("-");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c("wf","loading")]);K(a,"loading")}function L(a){if(a.g){var b=y(a.f,a.a.c("wf","active")),c=[],d=[a.a.c("wf","loading")];b||c.push(a.a.c("wf","inactive"));w(a.f,c,d)}K(a,"inactive")}function K(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,J(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function M(a,b){this.c=a;this.f=b;this.a=t(this.c,"span",{"aria-hidden":"true"},this.f)}function N(a){u(a.c,"body",a.a)}function O(a){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+I(a.c)+";"+("font-style:"+H(a)+";font-weight:"+(a.f+"00")+";")};function P(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}P.prototype.start=function(){var a=this.c.o.document,b=this,c=q(),d=new Promise(function(d,e){function f(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=null,f=new Promise(function(a,d){e=setTimeout(d,b.f)});Promise.race([f,d]).then(function(){e&&(clearTimeout(e),e=null);b.g(b.a)},function(){b.j(b.a)})};function Q(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||"BESbswy";this.f={};this.w=e||3E3;this.u=f||null;this.m=this.j=this.h=this.g=null;this.g=new M(this.c,this.s);this.h=new M(this.c,this.s);this.j=new M(this.c,this.s);this.m=new M(this.c,this.s);a=new G(this.a.c+",serif",J(this.a));a=O(a);this.g.a.style.cssText=a;a=new G(this.a.c+",sans-serif",J(this.a));a=O(a);this.h.a.style.cssText=a;a=new G("serif",J(this.a));a=O(a);this.j.a.style.cssText=a;a=new G("sans-serif",J(this.a));a=
O(a);this.m.a.style.cssText=a;N(this.g);N(this.h);N(this.j);N(this.m)}var R={D:"serif",C:"sans-serif"},S=null;function T(){if(null===S){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);S=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return S}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f["sans-serif"]=this.m.a.offsetWidth;this.A=q();U(this)};
function la(a,b,c){for(var d in R)if(R.hasOwnProperty(d)&&b===a.f[R[d]]&&c===a.f[R[d]])return!0;return!1}function U(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f["sans-serif"])||(d=T()&&la(a,b,c));d?q()-a.A>=a.w?T()&&la(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):ma(a):V(a,a.v)}function ma(a){setTimeout(p(function(){U(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.m.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.m=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c("wf",a.c,J(a).toString(),"active")],[b.a.c("wf",a.c,J(a).toString(),"loading"),b.a.c("wf",a.c,J(a).toString(),"inactive")]);K(b,"fontactive",a);this.m=!0;na(this)};
W.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c("wf",a.c,J(a).toString(),"active")),d=[],e=[b.a.c("wf",a.c,J(a).toString(),"loading")];c||d.push(b.a.c("wf",a.c,J(a).toString(),"inactive"));w(b.f,d,e)}K(b,"fontinactive",a);na(this)};function na(a){0==--a.f&&a.j&&(a.m?(a=a.a,a.g&&w(a.f,[a.a.c("wf","active")],[a.a.c("wf","loading"),a.a.c("wf","inactive")]),K(a,"active")):L(a.a))};function oa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}oa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;pa(this,new ha(this.c,a),a)};
function qa(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,m=d||null||{};if(0===c.length&&f)L(b.a);else{b.f+=c.length;f&&(b.j=f);var h,l=[];for(h=0;h<c.length;h++){var k=c[h],n=m[k.c],r=b.a,x=k;r.g&&w(r.f,[r.a.c("wf",x.c,J(x).toString(),"loading")]);K(r,"fontloading",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),xa=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);
X=x?42<parseInt(x[1],10):xa?!1:!0}else X=!1;X?r=new P(p(b.g,b),p(b.h,b),b.c,k,b.s,n):r=new Q(p(b.g,b),p(b.h,b),b.c,k,b.s,a,n);l.push(r)}for(h=0;h<l.length;h++)l[h].start()}},0)}function pa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){qa(a,f,b,d,c)})};function ra(a,b){this.c=a;this.a=b}
ra.prototype.load=function(a){function b(){if(f["__mti_fntLst"+d]){var c=f["__mti_fntLst"+d](),e=[],h;if(c)for(var l=0;l<c.length;l++){var k=c[l].fontfamily;void 0!=c[l].fontStyle&&void 0!=c[l].fontWeight?(h=c[l].fontStyle+c[l].fontWeight,e.push(new G(k,h))):e.push(new G(k))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.o;A(this.c,(c.a.api||"https://fast.fonts.net/jsapi")+"/"+d+".js"+(e?"?v="+e:""),function(e){e?a([]):(f["__MonotypeConfiguration__"+
d]=function(){return c.a},b())}).id="__MonotypeAPIScript__"+d}else a([])};function sa(a,b){this.c=a;this.a=b}sa.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new B;b=0;for(c=d.length;b<c;b++)z(this.c,d[b],C(g));var m=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(":"),d[1])for(var h=d[1].split(","),l=0;l<h.length;l+=1)m.push(new G(d[0],h[l]));else m.push(new G(d[0]));E(g,function(){a(m,f)})};function ta(a,b){a?this.c=a:this.c=ua;this.a=[];this.f=[];this.g=b||""}var ua="https://fonts.googleapis.com/css";function va(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(":");3==e.length&&a.f.push(e.pop());var f="";2==e.length&&""!=e[1]&&(f=":");a.a.push(e.join(f))}}
function wa(a){if(0==a.a.length)throw Error("No fonts to load!");if(-1!=a.c.indexOf("kit="))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,"+"));b=a.c+"?family="+c.join("%7C");0<a.f.length&&(b+="&subset="+a.f.join(","));0<a.g.length&&(b+="&text="+encodeURIComponent(a.g));return b};function ya(a){this.f=a;this.a=[];this.c={}}
var za={latin:"BESbswy","latin-ext":"\u00e7\u00f6\u00fc\u011f\u015f",cyrillic:"\u0439\u044f\u0416",greek:"\u03b1\u03b2\u03a3",khmer:"\u1780\u1781\u1782",Hanuman:"\u1780\u1781\u1782"},Aa={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},Ba={i:"i",italic:"i",n:"n",normal:"n"},
Ca=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;
function Da(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(":"),e=d[0].replace(/\+/g," "),f=["n4"];if(2<=d.length){var g;var m=d[1];g=[];if(m)for(var m=m.split(","),h=m.length,l=0;l<h;l++){var k;k=m[l];if(k.match(/^[\w-]+$/)){var n=Ca.exec(k.toLowerCase());if(null==n)k="";else{k=n[2];k=null==k||""==k?"n":Ba[k];n=n[1];if(null==n||""==n)n="4";else var r=Aa[n],n=r?r:isNaN(n)?"4":n.substr(0,1);k=[k,n].join("")}}else k="";k&&g.push(k)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(","):
g,0<d.length&&(d=za[d[0]])&&(a.c[e]=d))}a.c[e]||(d=za[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new G(e,f[d]))}};function Ea(a,b){this.c=a;this.a=b}var Fa={Arimo:!0,Cousine:!0,Tinos:!0};Ea.prototype.load=function(a){var b=new B,c=this.c,d=new ta(this.a.api,this.a.text),e=this.a.families;va(d,e);var f=new ya(e);Da(f);z(c,wa(d),C(b));E(b,function(){a(f.a,f.c,Fa)})};function Ga(a,b){this.c=a;this.a=b}Ga.prototype.load=function(a){var b=this.a.id,c=this.c.o;b?A(this.c,(this.a.api||"https://use.typekit.net")+"/"+b+".js",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],m=b[f+1],h=0;h<m.length;h++)e.push(new G(g,m[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}a(e)}},2E3):a([])};function Ha(a,b){this.c=a;this.f=b;this.a=[]}Ha.prototype.load=function(a){var b=this.f.id,c=this.c.o,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,m=c.fonts.length;g<m;++g){var h=c.fonts[g];d.a.push(new G(h.name,ga("font-weight:"+h.weight+";font-style:"+h.style)))}a(d.a)},A(this.c,(this.f.api||"https://f.fontdeck.com/s/css/js/")+ea(this.c)+"/"+b+".js",function(b){b&&a([])})):a([])};var Y=new oa(window);Y.a.c.custom=function(a,b){return new sa(b,a)};Y.a.c.fontdeck=function(a,b){return new Ha(b,a)};Y.a.c.monotype=function(a,b){return new ra(b,a)};Y.a.c.typekit=function(a,b){return new Ga(b,a)};Y.a.c.google=function(a,b){return new Ea(b,a)};var Z={load:p(Y.load,Y)};"function"===typeof define&&define.amd?define(function(){return Z}):"undefined"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());

/*! jQuery v3.3.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/parseXML,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-event/ajax,-effects,-effects/Tween,-effects/animatedSelector | (c) JS Foundation and other contributors | jquery.org/license */
!function (e, t) { "use strict"; "object" == typeof module && "object" == typeof module.exports ? module.exports = e.document ? t(e, !0) : function (e) { if (!e.document) throw new Error("jQuery requires a window with a document"); return t(e) } : t(e) }("undefined" != typeof window ? window : this, function (e, t) { "use strict"; var n = [], r = e.document, i = Object.getPrototypeOf, o = n.slice, a = n.concat, u = n.push, s = n.indexOf, l = {}, c = l.toString, f = l.hasOwnProperty, d = f.toString, p = d.call(Object), h = {}, g = function e(t) { return "function" == typeof t && "number" != typeof t.nodeType }, v = function e(t) { return null != t && t === t.window }, y = { type: !0, src: !0, noModule: !0 }; function m(e, t, n) { var i, o = (t = t || r).createElement("script"); if (o.text = e, n) for (i in y) n[i] && (o[i] = n[i]); t.head.appendChild(o).parentNode.removeChild(o) } function b(e) { return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? l[c.call(e)] || "object" : typeof e } var x = "3.3.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/parseXML,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-event/ajax,-effects,-effects/Tween,-effects/animatedSelector", w = function (e, t) { return new w.fn.init(e, t) }, C = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g; w.fn = w.prototype = { jquery: x, constructor: w, length: 0, toArray: function () { return o.call(this) }, get: function (e) { return null == e ? o.call(this) : e < 0 ? this[e + this.length] : this[e] }, pushStack: function (e) { var t = w.merge(this.constructor(), e); return t.prevObject = this, t }, each: function (e) { return w.each(this, e) }, map: function (e) { return this.pushStack(w.map(this, function (t, n) { return e.call(t, n, t) })) }, slice: function () { return this.pushStack(o.apply(this, arguments)) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, eq: function (e) { var t = this.length, n = +e + (e < 0 ? t : 0); return this.pushStack(n >= 0 && n < t ? [this[n]] : []) }, end: function () { return this.prevObject || this.constructor() }, push: u, sort: n.sort, splice: n.splice }, w.extend = w.fn.extend = function () { var e, t, n, r, i, o, a = arguments[0] || {}, u = 1, s = arguments.length, l = !1; for ("boolean" == typeof a && (l = a, a = arguments[u] || {}, u++), "object" == typeof a || g(a) || (a = {}), u === s && (a = this, u--); u < s; u++)if (null != (e = arguments[u])) for (t in e) n = a[t], a !== (r = e[t]) && (l && r && (w.isPlainObject(r) || (i = Array.isArray(r))) ? (i ? (i = !1, o = n && Array.isArray(n) ? n : []) : o = n && w.isPlainObject(n) ? n : {}, a[t] = w.extend(l, o, r)) : void 0 !== r && (a[t] = r)); return a }, w.extend({ expando: "jQuery" + (x + Math.random()).replace(/\D/g, ""), isReady: !0, error: function (e) { throw new Error(e) }, noop: function () { }, isPlainObject: function (e) { var t, n; return !(!e || "[object Object]" !== c.call(e)) && (!(t = i(e)) || "function" == typeof (n = f.call(t, "constructor") && t.constructor) && d.call(n) === p) }, isEmptyObject: function (e) { var t; for (t in e) return !1; return !0 }, globalEval: function (e) { m(e) }, each: function (e, t) { var n, r = 0; if (T(e)) { for (n = e.length; r < n; r++)if (!1 === t.call(e[r], r, e[r])) break } else for (r in e) if (!1 === t.call(e[r], r, e[r])) break; return e }, trim: function (e) { return null == e ? "" : (e + "").replace(C, "") }, makeArray: function (e, t) { var n = t || []; return null != e && (T(Object(e)) ? w.merge(n, "string" == typeof e ? [e] : e) : u.call(n, e)), n }, inArray: function (e, t, n) { return null == t ? -1 : s.call(t, e, n) }, merge: function (e, t) { for (var n = +t.length, r = 0, i = e.length; r < n; r++)e[i++] = t[r]; return e.length = i, e }, grep: function (e, t, n) { for (var r, i = [], o = 0, a = e.length, u = !n; o < a; o++)(r = !t(e[o], o)) !== u && i.push(e[o]); return i }, map: function (e, t, n) { var r, i, o = 0, u = []; if (T(e)) for (r = e.length; o < r; o++)null != (i = t(e[o], o, n)) && u.push(i); else for (o in e) null != (i = t(e[o], o, n)) && u.push(i); return a.apply([], u) }, guid: 1, support: h }), "function" == typeof Symbol && (w.fn[Symbol.iterator] = n[Symbol.iterator]), w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (e, t) { l["[object " + t + "]"] = t.toLowerCase() }); function T(e) { var t = !!e && "length" in e && e.length, n = b(e); return !g(e) && !v(e) && ("array" === n || 0 === t || "number" == typeof t && t > 0 && t - 1 in e) } var E = function (e) { var t, n, r, i, o, a, u, s, l, c, f, d, p, h, g, v, y, m, b, x = "sizzle" + 1 * new Date, w = e.document, C = 0, T = 0, E = ae(), N = ae(), k = ae(), A = function (e, t) { return e === t && (f = !0), 0 }, D = {}.hasOwnProperty, S = [], L = S.pop, j = S.push, q = S.push, O = S.slice, P = function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (e[n] === t) return n; return -1 }, H = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", I = "[\\x20\\t\\r\\n\\f]", R = "(?:\\\\.|[\\w-]|[^\0-\\xa0])+", B = "\\[" + I + "*(" + R + ")(?:" + I + "*([*^$|!~]?=)" + I + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + R + "))|)" + I + "*\\]", M = ":(" + R + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + B + ")*)|.*)\\)|)", W = new RegExp(I + "+", "g"), $ = new RegExp("^" + I + "+|((?:^|[^\\\\])(?:\\\\.)*)" + I + "+$", "g"), F = new RegExp("^" + I + "*," + I + "*"), z = new RegExp("^" + I + "*([>+~]|" + I + ")" + I + "*"), _ = new RegExp("=" + I + "*([^\\]'\"]*?)" + I + "*\\]", "g"), U = new RegExp(M), V = new RegExp("^" + R + "$"), X = { ID: new RegExp("^#(" + R + ")"), CLASS: new RegExp("^\\.(" + R + ")"), TAG: new RegExp("^(" + R + "|[*])"), ATTR: new RegExp("^" + B), PSEUDO: new RegExp("^" + M), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + I + "*(even|odd|(([+-]|)(\\d*)n|)" + I + "*(?:([+-]|)" + I + "*(\\d+)|))" + I + "*\\)|)", "i"), bool: new RegExp("^(?:" + H + ")$", "i"), needsContext: new RegExp("^" + I + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + I + "*((?:-\\d)?\\d*)" + I + "*\\)|)(?=[^-]|$)", "i") }, Q = /^(?:input|select|textarea|button)$/i, Y = /^h\d$/i, G = /^[^{]+\{\s*\[native \w/, K = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, J = /[+~]/, Z = new RegExp("\\\\([\\da-f]{1,6}" + I + "?|(" + I + ")|.)", "ig"), ee = function (e, t, n) { var r = "0x" + t - 65536; return r !== r || n ? t : r < 0 ? String.fromCharCode(r + 65536) : String.fromCharCode(r >> 10 | 55296, 1023 & r | 56320) }, te = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g, ne = function (e, t) { return t ? "\0" === e ? "\ufffd" : e.slice(0, -1) + "\\" + e.charCodeAt(e.length - 1).toString(16) + " " : "\\" + e }, re = function () { d() }, ie = me(function (e) { return !0 === e.disabled && ("form" in e || "label" in e) }, { dir: "parentNode", next: "legend" }); try { q.apply(S = O.call(w.childNodes), w.childNodes), S[w.childNodes.length].nodeType } catch (e) { q = { apply: S.length ? function (e, t) { j.apply(e, O.call(t)) } : function (e, t) { var n = e.length, r = 0; while (e[n++] = t[r++]); e.length = n - 1 } } } function oe(e, t, r, i) { var o, u, l, c, f, h, y, m = t && t.ownerDocument, C = t ? t.nodeType : 9; if (r = r || [], "string" != typeof e || !e || 1 !== C && 9 !== C && 11 !== C) return r; if (!i && ((t ? t.ownerDocument || t : w) !== p && d(t), t = t || p, g)) { if (11 !== C && (f = K.exec(e))) if (o = f[1]) { if (9 === C) { if (!(l = t.getElementById(o))) return r; if (l.id === o) return r.push(l), r } else if (m && (l = m.getElementById(o)) && b(t, l) && l.id === o) return r.push(l), r } else { if (f[2]) return q.apply(r, t.getElementsByTagName(e)), r; if ((o = f[3]) && n.getElementsByClassName && t.getElementsByClassName) return q.apply(r, t.getElementsByClassName(o)), r } if (n.qsa && !k[e + " "] && (!v || !v.test(e))) { if (1 !== C) m = t, y = e; else if ("object" !== t.nodeName.toLowerCase()) { (c = t.getAttribute("id")) ? c = c.replace(te, ne) : t.setAttribute("id", c = x), u = (h = a(e)).length; while (u--) h[u] = "#" + c + " " + ye(h[u]); y = h.join(","), m = J.test(e) && ge(t.parentNode) || t } if (y) try { return q.apply(r, m.querySelectorAll(y)), r } catch (e) { } finally { c === x && t.removeAttribute("id") } } } return s(e.replace($, "$1"), t, r, i) } function ae() { var e = []; function t(n, i) { return e.push(n + " ") > r.cacheLength && delete t[e.shift()], t[n + " "] = i } return t } function ue(e) { return e[x] = !0, e } function se(e) { var t = p.createElement("fieldset"); try { return !!e(t) } catch (e) { return !1 } finally { t.parentNode && t.parentNode.removeChild(t), t = null } } function le(e, t) { var n = e.split("|"), i = n.length; while (i--) r.attrHandle[n[i]] = t } function ce(e, t) { var n = t && e, r = n && 1 === e.nodeType && 1 === t.nodeType && e.sourceIndex - t.sourceIndex; if (r) return r; if (n) while (n = n.nextSibling) if (n === t) return -1; return e ? 1 : -1 } function fe(e) { return function (t) { return "input" === t.nodeName.toLowerCase() && t.type === e } } function de(e) { return function (t) { var n = t.nodeName.toLowerCase(); return ("input" === n || "button" === n) && t.type === e } } function pe(e) { return function (t) { return "form" in t ? t.parentNode && !1 === t.disabled ? "label" in t ? "label" in t.parentNode ? t.parentNode.disabled === e : t.disabled === e : t.isDisabled === e || t.isDisabled !== !e && ie(t) === e : t.disabled === e : "label" in t && t.disabled === e } } function he(e) { return ue(function (t) { return t = +t, ue(function (n, r) { var i, o = e([], n.length, t), a = o.length; while (a--) n[i = o[a]] && (n[i] = !(r[i] = n[i])) }) }) } function ge(e) { return e && "undefined" != typeof e.getElementsByTagName && e } n = oe.support = {}, o = oe.isXML = function (e) { var t = e && (e.ownerDocument || e).documentElement; return !!t && "HTML" !== t.nodeName }, d = oe.setDocument = function (e) { var t, i, a = e ? e.ownerDocument || e : w; return a !== p && 9 === a.nodeType && a.documentElement ? (p = a, h = p.documentElement, g = !o(p), w !== p && (i = p.defaultView) && i.top !== i && (i.addEventListener ? i.addEventListener("unload", re, !1) : i.attachEvent && i.attachEvent("onunload", re)), n.attributes = se(function (e) { return e.className = "i", !e.getAttribute("className") }), n.getElementsByTagName = se(function (e) { return e.appendChild(p.createComment("")), !e.getElementsByTagName("*").length }), n.getElementsByClassName = G.test(p.getElementsByClassName), n.getById = se(function (e) { return h.appendChild(e).id = x, !p.getElementsByName || !p.getElementsByName(x).length }), n.getById ? (r.filter.ID = function (e) { var t = e.replace(Z, ee); return function (e) { return e.getAttribute("id") === t } }, r.find.ID = function (e, t) { if ("undefined" != typeof t.getElementById && g) { var n = t.getElementById(e); return n ? [n] : [] } }) : (r.filter.ID = function (e) { var t = e.replace(Z, ee); return function (e) { var n = "undefined" != typeof e.getAttributeNode && e.getAttributeNode("id"); return n && n.value === t } }, r.find.ID = function (e, t) { if ("undefined" != typeof t.getElementById && g) { var n, r, i, o = t.getElementById(e); if (o) { if ((n = o.getAttributeNode("id")) && n.value === e) return [o]; i = t.getElementsByName(e), r = 0; while (o = i[r++]) if ((n = o.getAttributeNode("id")) && n.value === e) return [o] } return [] } }), r.find.TAG = n.getElementsByTagName ? function (e, t) { return "undefined" != typeof t.getElementsByTagName ? t.getElementsByTagName(e) : n.qsa ? t.querySelectorAll(e) : void 0 } : function (e, t) { var n, r = [], i = 0, o = t.getElementsByTagName(e); if ("*" === e) { while (n = o[i++]) 1 === n.nodeType && r.push(n); return r } return o }, r.find.CLASS = n.getElementsByClassName && function (e, t) { if ("undefined" != typeof t.getElementsByClassName && g) return t.getElementsByClassName(e) }, y = [], v = [], (n.qsa = G.test(p.querySelectorAll)) && (se(function (e) { h.appendChild(e).innerHTML = "<a id='" + x + "'></a><select id='" + x + "-\r\\' msallowcapture=''><option selected=''></option></select>", e.querySelectorAll("[msallowcapture^='']").length && v.push("[*^$]=" + I + "*(?:''|\"\")"), e.querySelectorAll("[selected]").length || v.push("\\[" + I + "*(?:value|" + H + ")"), e.querySelectorAll("[id~=" + x + "-]").length || v.push("~="), e.querySelectorAll(":checked").length || v.push(":checked"), e.querySelectorAll("a#" + x + "+*").length || v.push(".#.+[+~]") }), se(function (e) { e.innerHTML = "<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>"; var t = p.createElement("input"); t.setAttribute("type", "hidden"), e.appendChild(t).setAttribute("name", "D"), e.querySelectorAll("[name=d]").length && v.push("name" + I + "*[*^$|!~]?="), 2 !== e.querySelectorAll(":enabled").length && v.push(":enabled", ":disabled"), h.appendChild(e).disabled = !0, 2 !== e.querySelectorAll(":disabled").length && v.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), v.push(",.*:") })), (n.matchesSelector = G.test(m = h.matches || h.webkitMatchesSelector || h.mozMatchesSelector || h.oMatchesSelector || h.msMatchesSelector)) && se(function (e) { n.disconnectedMatch = m.call(e, "*"), m.call(e, "[s!='']:x"), y.push("!=", M) }), v = v.length && new RegExp(v.join("|")), y = y.length && new RegExp(y.join("|")), t = G.test(h.compareDocumentPosition), b = t || G.test(h.contains) ? function (e, t) { var n = 9 === e.nodeType ? e.documentElement : e, r = t && t.parentNode; return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))) } : function (e, t) { if (t) while (t = t.parentNode) if (t === e) return !0; return !1 }, A = t ? function (e, t) { if (e === t) return f = !0, 0; var r = !e.compareDocumentPosition - !t.compareDocumentPosition; return r || (1 & (r = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1) || !n.sortDetached && t.compareDocumentPosition(e) === r ? e === p || e.ownerDocument === w && b(w, e) ? -1 : t === p || t.ownerDocument === w && b(w, t) ? 1 : c ? P(c, e) - P(c, t) : 0 : 4 & r ? -1 : 1) } : function (e, t) { if (e === t) return f = !0, 0; var n, r = 0, i = e.parentNode, o = t.parentNode, a = [e], u = [t]; if (!i || !o) return e === p ? -1 : t === p ? 1 : i ? -1 : o ? 1 : c ? P(c, e) - P(c, t) : 0; if (i === o) return ce(e, t); n = e; while (n = n.parentNode) a.unshift(n); n = t; while (n = n.parentNode) u.unshift(n); while (a[r] === u[r]) r++; return r ? ce(a[r], u[r]) : a[r] === w ? -1 : u[r] === w ? 1 : 0 }, p) : p }, oe.matches = function (e, t) { return oe(e, null, null, t) }, oe.matchesSelector = function (e, t) { if ((e.ownerDocument || e) !== p && d(e), t = t.replace(_, "='$1']"), n.matchesSelector && g && !k[t + " "] && (!y || !y.test(t)) && (!v || !v.test(t))) try { var r = m.call(e, t); if (r || n.disconnectedMatch || e.document && 11 !== e.document.nodeType) return r } catch (e) { } return oe(t, p, null, [e]).length > 0 }, oe.contains = function (e, t) { return (e.ownerDocument || e) !== p && d(e), b(e, t) }, oe.attr = function (e, t) { (e.ownerDocument || e) !== p && d(e); var i = r.attrHandle[t.toLowerCase()], o = i && D.call(r.attrHandle, t.toLowerCase()) ? i(e, t, !g) : void 0; return void 0 !== o ? o : n.attributes || !g ? e.getAttribute(t) : (o = e.getAttributeNode(t)) && o.specified ? o.value : null }, oe.escape = function (e) { return (e + "").replace(te, ne) }, oe.error = function (e) { throw new Error("Syntax error, unrecognized expression: " + e) }, oe.uniqueSort = function (e) { var t, r = [], i = 0, o = 0; if (f = !n.detectDuplicates, c = !n.sortStable && e.slice(0), e.sort(A), f) { while (t = e[o++]) t === e[o] && (i = r.push(o)); while (i--) e.splice(r[i], 1) } return c = null, e }, i = oe.getText = function (e) { var t, n = "", r = 0, o = e.nodeType; if (o) { if (1 === o || 9 === o || 11 === o) { if ("string" == typeof e.textContent) return e.textContent; for (e = e.firstChild; e; e = e.nextSibling)n += i(e) } else if (3 === o || 4 === o) return e.nodeValue } else while (t = e[r++]) n += i(t); return n }, (r = oe.selectors = { cacheLength: 50, createPseudo: ue, match: X, attrHandle: {}, find: {}, relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } }, preFilter: { ATTR: function (e) { return e[1] = e[1].replace(Z, ee), e[3] = (e[3] || e[4] || e[5] || "").replace(Z, ee), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4) }, CHILD: function (e) { return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || oe.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && oe.error(e[0]), e }, PSEUDO: function (e) { var t, n = !e[6] && e[2]; return X.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : n && U.test(n) && (t = a(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3)) } }, filter: { TAG: function (e) { var t = e.replace(Z, ee).toLowerCase(); return "*" === e ? function () { return !0 } : function (e) { return e.nodeName && e.nodeName.toLowerCase() === t } }, CLASS: function (e) { var t = E[e + " "]; return t || (t = new RegExp("(^|" + I + ")" + e + "(" + I + "|$)")) && E(e, function (e) { return t.test("string" == typeof e.className && e.className || "undefined" != typeof e.getAttribute && e.getAttribute("class") || "") }) }, ATTR: function (e, t, n) { return function (r) { var i = oe.attr(r, e); return null == i ? "!=" === t : !t || (i += "", "=" === t ? i === n : "!=" === t ? i !== n : "^=" === t ? n && 0 === i.indexOf(n) : "*=" === t ? n && i.indexOf(n) > -1 : "$=" === t ? n && i.slice(-n.length) === n : "~=" === t ? (" " + i.replace(W, " ") + " ").indexOf(n) > -1 : "|=" === t && (i === n || i.slice(0, n.length + 1) === n + "-")) } }, CHILD: function (e, t, n, r, i) { var o = "nth" !== e.slice(0, 3), a = "last" !== e.slice(-4), u = "of-type" === t; return 1 === r && 0 === i ? function (e) { return !!e.parentNode } : function (t, n, s) { var l, c, f, d, p, h, g = o !== a ? "nextSibling" : "previousSibling", v = t.parentNode, y = u && t.nodeName.toLowerCase(), m = !s && !u, b = !1; if (v) { if (o) { while (g) { d = t; while (d = d[g]) if (u ? d.nodeName.toLowerCase() === y : 1 === d.nodeType) return !1; h = g = "only" === e && !h && "nextSibling" } return !0 } if (h = [a ? v.firstChild : v.lastChild], a && m) { b = (p = (l = (c = (f = (d = v)[x] || (d[x] = {}))[d.uniqueID] || (f[d.uniqueID] = {}))[e] || [])[0] === C && l[1]) && l[2], d = p && v.childNodes[p]; while (d = ++p && d && d[g] || (b = p = 0) || h.pop()) if (1 === d.nodeType && ++b && d === t) { c[e] = [C, p, b]; break } } else if (m && (b = p = (l = (c = (f = (d = t)[x] || (d[x] = {}))[d.uniqueID] || (f[d.uniqueID] = {}))[e] || [])[0] === C && l[1]), !1 === b) while (d = ++p && d && d[g] || (b = p = 0) || h.pop()) if ((u ? d.nodeName.toLowerCase() === y : 1 === d.nodeType) && ++b && (m && ((c = (f = d[x] || (d[x] = {}))[d.uniqueID] || (f[d.uniqueID] = {}))[e] = [C, b]), d === t)) break; return (b -= i) === r || b % r == 0 && b / r >= 0 } } }, PSEUDO: function (e, t) { var n, i = r.pseudos[e] || r.setFilters[e.toLowerCase()] || oe.error("unsupported pseudo: " + e); return i[x] ? i(t) : i.length > 1 ? (n = [e, e, "", t], r.setFilters.hasOwnProperty(e.toLowerCase()) ? ue(function (e, n) { var r, o = i(e, t), a = o.length; while (a--) e[r = P(e, o[a])] = !(n[r] = o[a]) }) : function (e) { return i(e, 0, n) }) : i } }, pseudos: { not: ue(function (e) { var t = [], n = [], r = u(e.replace($, "$1")); return r[x] ? ue(function (e, t, n, i) { var o, a = r(e, null, i, []), u = e.length; while (u--) (o = a[u]) && (e[u] = !(t[u] = o)) }) : function (e, i, o) { return t[0] = e, r(t, null, o, n), t[0] = null, !n.pop() } }), has: ue(function (e) { return function (t) { return oe(e, t).length > 0 } }), contains: ue(function (e) { return e = e.replace(Z, ee), function (t) { return (t.textContent || t.innerText || i(t)).indexOf(e) > -1 } }), lang: ue(function (e) { return V.test(e || "") || oe.error("unsupported lang: " + e), e = e.replace(Z, ee).toLowerCase(), function (t) { var n; do { if (n = g ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang")) return (n = n.toLowerCase()) === e || 0 === n.indexOf(e + "-") } while ((t = t.parentNode) && 1 === t.nodeType); return !1 } }), target: function (t) { var n = e.location && e.location.hash; return n && n.slice(1) === t.id }, root: function (e) { return e === h }, focus: function (e) { return e === p.activeElement && (!p.hasFocus || p.hasFocus()) && !!(e.type || e.href || ~e.tabIndex) }, enabled: pe(!1), disabled: pe(!0), checked: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && !!e.checked || "option" === t && !!e.selected }, selected: function (e) { return e.parentNode && e.parentNode.selectedIndex, !0 === e.selected }, empty: function (e) { for (e = e.firstChild; e; e = e.nextSibling)if (e.nodeType < 6) return !1; return !0 }, parent: function (e) { return !r.pseudos.empty(e) }, header: function (e) { return Y.test(e.nodeName) }, input: function (e) { return Q.test(e.nodeName) }, button: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && "button" === e.type || "button" === t }, text: function (e) { var t; return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase()) }, first: he(function () { return [0] }), last: he(function (e, t) { return [t - 1] }), eq: he(function (e, t, n) { return [n < 0 ? n + t : n] }), even: he(function (e, t) { for (var n = 0; n < t; n += 2)e.push(n); return e }), odd: he(function (e, t) { for (var n = 1; n < t; n += 2)e.push(n); return e }), lt: he(function (e, t, n) { for (var r = n < 0 ? n + t : n; --r >= 0;)e.push(r); return e }), gt: he(function (e, t, n) { for (var r = n < 0 ? n + t : n; ++r < t;)e.push(r); return e }) } }).pseudos.nth = r.pseudos.eq; for (t in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) r.pseudos[t] = fe(t); for (t in { submit: !0, reset: !0 }) r.pseudos[t] = de(t); function ve() { } ve.prototype = r.filters = r.pseudos, r.setFilters = new ve, a = oe.tokenize = function (e, t) { var n, i, o, a, u, s, l, c = N[e + " "]; if (c) return t ? 0 : c.slice(0); u = e, s = [], l = r.preFilter; while (u) { n && !(i = F.exec(u)) || (i && (u = u.slice(i[0].length) || u), s.push(o = [])), n = !1, (i = z.exec(u)) && (n = i.shift(), o.push({ value: n, type: i[0].replace($, " ") }), u = u.slice(n.length)); for (a in r.filter) !(i = X[a].exec(u)) || l[a] && !(i = l[a](i)) || (n = i.shift(), o.push({ value: n, type: a, matches: i }), u = u.slice(n.length)); if (!n) break } return t ? u.length : u ? oe.error(e) : N(e, s).slice(0) }; function ye(e) { for (var t = 0, n = e.length, r = ""; t < n; t++)r += e[t].value; return r } function me(e, t, n) { var r = t.dir, i = t.next, o = i || r, a = n && "parentNode" === o, u = T++; return t.first ? function (t, n, i) { while (t = t[r]) if (1 === t.nodeType || a) return e(t, n, i); return !1 } : function (t, n, s) { var l, c, f, d = [C, u]; if (s) { while (t = t[r]) if ((1 === t.nodeType || a) && e(t, n, s)) return !0 } else while (t = t[r]) if (1 === t.nodeType || a) if (f = t[x] || (t[x] = {}), c = f[t.uniqueID] || (f[t.uniqueID] = {}), i && i === t.nodeName.toLowerCase()) t = t[r] || t; else { if ((l = c[o]) && l[0] === C && l[1] === u) return d[2] = l[2]; if (c[o] = d, d[2] = e(t, n, s)) return !0 } return !1 } } function be(e) { return e.length > 1 ? function (t, n, r) { var i = e.length; while (i--) if (!e[i](t, n, r)) return !1; return !0 } : e[0] } function xe(e, t, n) { for (var r = 0, i = t.length; r < i; r++)oe(e, t[r], n); return n } function we(e, t, n, r, i) { for (var o, a = [], u = 0, s = e.length, l = null != t; u < s; u++)(o = e[u]) && (n && !n(o, r, i) || (a.push(o), l && t.push(u))); return a } function Ce(e, t, n, r, i, o) { return r && !r[x] && (r = Ce(r)), i && !i[x] && (i = Ce(i, o)), ue(function (o, a, u, s) { var l, c, f, d = [], p = [], h = a.length, g = o || xe(t || "*", u.nodeType ? [u] : u, []), v = !e || !o && t ? g : we(g, d, e, u, s), y = n ? i || (o ? e : h || r) ? [] : a : v; if (n && n(v, y, u, s), r) { l = we(y, p), r(l, [], u, s), c = l.length; while (c--) (f = l[c]) && (y[p[c]] = !(v[p[c]] = f)) } if (o) { if (i || e) { if (i) { l = [], c = y.length; while (c--) (f = y[c]) && l.push(v[c] = f); i(null, y = [], l, s) } c = y.length; while (c--) (f = y[c]) && (l = i ? P(o, f) : d[c]) > -1 && (o[l] = !(a[l] = f)) } } else y = we(y === a ? y.splice(h, y.length) : y), i ? i(null, a, y, s) : q.apply(a, y) }) } function Te(e) { for (var t, n, i, o = e.length, a = r.relative[e[0].type], u = a || r.relative[" "], s = a ? 1 : 0, c = me(function (e) { return e === t }, u, !0), f = me(function (e) { return P(t, e) > -1 }, u, !0), d = [function (e, n, r) { var i = !a && (r || n !== l) || ((t = n).nodeType ? c(e, n, r) : f(e, n, r)); return t = null, i }]; s < o; s++)if (n = r.relative[e[s].type]) d = [me(be(d), n)]; else { if ((n = r.filter[e[s].type].apply(null, e[s].matches))[x]) { for (i = ++s; i < o; i++)if (r.relative[e[i].type]) break; return Ce(s > 1 && be(d), s > 1 && ye(e.slice(0, s - 1).concat({ value: " " === e[s - 2].type ? "*" : "" })).replace($, "$1"), n, s < i && Te(e.slice(s, i)), i < o && Te(e = e.slice(i)), i < o && ye(e)) } d.push(n) } return be(d) } function Ee(e, t) { var n = t.length > 0, i = e.length > 0, o = function (o, a, u, s, c) { var f, h, v, y = 0, m = "0", b = o && [], x = [], w = l, T = o || i && r.find.TAG("*", c), E = C += null == w ? 1 : Math.random() || .1, N = T.length; for (c && (l = a === p || a || c); m !== N && null != (f = T[m]); m++) { if (i && f) { h = 0, a || f.ownerDocument === p || (d(f), u = !g); while (v = e[h++]) if (v(f, a || p, u)) { s.push(f); break } c && (C = E) } n && ((f = !v && f) && y-- , o && b.push(f)) } if (y += m, n && m !== y) { h = 0; while (v = t[h++]) v(b, x, a, u); if (o) { if (y > 0) while (m--) b[m] || x[m] || (x[m] = L.call(s)); x = we(x) } q.apply(s, x), c && !o && x.length > 0 && y + t.length > 1 && oe.uniqueSort(s) } return c && (C = E, l = w), b }; return n ? ue(o) : o } return u = oe.compile = function (e, t) { var n, r = [], i = [], o = k[e + " "]; if (!o) { t || (t = a(e)), n = t.length; while (n--) (o = Te(t[n]))[x] ? r.push(o) : i.push(o); (o = k(e, Ee(i, r))).selector = e } return o }, s = oe.select = function (e, t, n, i) { var o, s, l, c, f, d = "function" == typeof e && e, p = !i && a(e = d.selector || e); if (n = n || [], 1 === p.length) { if ((s = p[0] = p[0].slice(0)).length > 2 && "ID" === (l = s[0]).type && 9 === t.nodeType && g && r.relative[s[1].type]) { if (!(t = (r.find.ID(l.matches[0].replace(Z, ee), t) || [])[0])) return n; d && (t = t.parentNode), e = e.slice(s.shift().value.length) } o = X.needsContext.test(e) ? 0 : s.length; while (o--) { if (l = s[o], r.relative[c = l.type]) break; if ((f = r.find[c]) && (i = f(l.matches[0].replace(Z, ee), J.test(s[0].type) && ge(t.parentNode) || t))) { if (s.splice(o, 1), !(e = i.length && ye(s))) return q.apply(n, i), n; break } } } return (d || u(e, p))(i, t, !g, n, !t || J.test(e) && ge(t.parentNode) || t), n }, n.sortStable = x.split("").sort(A).join("") === x, n.detectDuplicates = !!f, d(), n.sortDetached = se(function (e) { return 1 & e.compareDocumentPosition(p.createElement("fieldset")) }), se(function (e) { return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href") }) || le("type|href|height|width", function (e, t, n) { if (!n) return e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2) }), n.attributes && se(function (e) { return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value") }) || le("value", function (e, t, n) { if (!n && "input" === e.nodeName.toLowerCase()) return e.defaultValue }), se(function (e) { return null == e.getAttribute("disabled") }) || le(H, function (e, t, n) { var r; if (!n) return !0 === e[t] ? t.toLowerCase() : (r = e.getAttributeNode(t)) && r.specified ? r.value : null }), oe }(e); w.find = E, w.expr = E.selectors, w.expr[":"] = w.expr.pseudos, w.uniqueSort = w.unique = E.uniqueSort, w.text = E.getText, w.isXMLDoc = E.isXML, w.contains = E.contains, w.escapeSelector = E.escape; var N = function (e, t, n) { var r = [], i = void 0 !== n; while ((e = e[t]) && 9 !== e.nodeType) if (1 === e.nodeType) { if (i && w(e).is(n)) break; r.push(e) } return r }, k = function (e, t) { for (var n = []; e; e = e.nextSibling)1 === e.nodeType && e !== t && n.push(e); return n }, A = w.expr.match.needsContext; function D(e, t) { return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase() } var S = /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i; function L(e, t, n) { return g(t) ? w.grep(e, function (e, r) { return !!t.call(e, r, e) !== n }) : t.nodeType ? w.grep(e, function (e) { return e === t !== n }) : "string" != typeof t ? w.grep(e, function (e) { return s.call(t, e) > -1 !== n }) : w.filter(t, e, n) } w.filter = function (e, t, n) { var r = t[0]; return n && (e = ":not(" + e + ")"), 1 === t.length && 1 === r.nodeType ? w.find.matchesSelector(r, e) ? [r] : [] : w.find.matches(e, w.grep(t, function (e) { return 1 === e.nodeType })) }, w.fn.extend({ find: function (e) { var t, n, r = this.length, i = this; if ("string" != typeof e) return this.pushStack(w(e).filter(function () { for (t = 0; t < r; t++)if (w.contains(i[t], this)) return !0 })); for (n = this.pushStack([]), t = 0; t < r; t++)w.find(e, i[t], n); return r > 1 ? w.uniqueSort(n) : n }, filter: function (e) { return this.pushStack(L(this, e || [], !1)) }, not: function (e) { return this.pushStack(L(this, e || [], !0)) }, is: function (e) { return !!L(this, "string" == typeof e && A.test(e) ? w(e) : e || [], !1).length } }); var j, q = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/; (w.fn.init = function (e, t, n) { var i, o; if (!e) return this; if (n = n || j, "string" == typeof e) { if (!(i = "<" === e[0] && ">" === e[e.length - 1] && e.length >= 3 ? [null, e, null] : q.exec(e)) || !i[1] && t) return !t || t.jquery ? (t || n).find(e) : this.constructor(t).find(e); if (i[1]) { if (t = t instanceof w ? t[0] : t, w.merge(this, w.parseHTML(i[1], t && t.nodeType ? t.ownerDocument || t : r, !0)), S.test(i[1]) && w.isPlainObject(t)) for (i in t) g(this[i]) ? this[i](t[i]) : this.attr(i, t[i]); return this } return (o = r.getElementById(i[2])) && (this[0] = o, this.length = 1), this } return e.nodeType ? (this[0] = e, this.length = 1, this) : g(e) ? void 0 !== n.ready ? n.ready(e) : e(w) : w.makeArray(e, this) }).prototype = w.fn, j = w(r); var O = /^(?:parents|prev(?:Until|All))/, P = { children: !0, contents: !0, next: !0, prev: !0 }; w.fn.extend({ has: function (e) { var t = w(e, this), n = t.length; return this.filter(function () { for (var e = 0; e < n; e++)if (w.contains(this, t[e])) return !0 }) }, closest: function (e, t) { var n, r = 0, i = this.length, o = [], a = "string" != typeof e && w(e); if (!A.test(e)) for (; r < i; r++)for (n = this[r]; n && n !== t; n = n.parentNode)if (n.nodeType < 11 && (a ? a.index(n) > -1 : 1 === n.nodeType && w.find.matchesSelector(n, e))) { o.push(n); break } return this.pushStack(o.length > 1 ? w.uniqueSort(o) : o) }, index: function (e) { return e ? "string" == typeof e ? s.call(w(e), this[0]) : s.call(this, e.jquery ? e[0] : e) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1 }, add: function (e, t) { return this.pushStack(w.uniqueSort(w.merge(this.get(), w(e, t)))) }, addBack: function (e) { return this.add(null == e ? this.prevObject : this.prevObject.filter(e)) } }); function H(e, t) { while ((e = e[t]) && 1 !== e.nodeType); return e } w.each({ parent: function (e) { var t = e.parentNode; return t && 11 !== t.nodeType ? t : null }, parents: function (e) { return N(e, "parentNode") }, parentsUntil: function (e, t, n) { return N(e, "parentNode", n) }, next: function (e) { return H(e, "nextSibling") }, prev: function (e) { return H(e, "previousSibling") }, nextAll: function (e) { return N(e, "nextSibling") }, prevAll: function (e) { return N(e, "previousSibling") }, nextUntil: function (e, t, n) { return N(e, "nextSibling", n) }, prevUntil: function (e, t, n) { return N(e, "previousSibling", n) }, siblings: function (e) { return k((e.parentNode || {}).firstChild, e) }, children: function (e) { return k(e.firstChild) }, contents: function (e) { return D(e, "iframe") ? e.contentDocument : (D(e, "template") && (e = e.content || e), w.merge([], e.childNodes)) } }, function (e, t) { w.fn[e] = function (n, r) { var i = w.map(this, t, n); return "Until" !== e.slice(-5) && (r = n), r && "string" == typeof r && (i = w.filter(r, i)), this.length > 1 && (P[e] || w.uniqueSort(i), O.test(e) && i.reverse()), this.pushStack(i) } }); var I = /[^\x20\t\r\n\f]+/g; function R(e) { var t = {}; return w.each(e.match(I) || [], function (e, n) { t[n] = !0 }), t } w.Callbacks = function (e) { e = "string" == typeof e ? R(e) : w.extend({}, e); var t, n, r, i, o = [], a = [], u = -1, s = function () { for (i = i || e.once, r = t = !0; a.length; u = -1) { n = a.shift(); while (++u < o.length) !1 === o[u].apply(n[0], n[1]) && e.stopOnFalse && (u = o.length, n = !1) } e.memory || (n = !1), t = !1, i && (o = n ? [] : "") }, l = { add: function () { return o && (n && !t && (u = o.length - 1, a.push(n)), function t(n) { w.each(n, function (n, r) { g(r) ? e.unique && l.has(r) || o.push(r) : r && r.length && "string" !== b(r) && t(r) }) }(arguments), n && !t && s()), this }, remove: function () { return w.each(arguments, function (e, t) { var n; while ((n = w.inArray(t, o, n)) > -1) o.splice(n, 1), n <= u && u-- }), this }, has: function (e) { return e ? w.inArray(e, o) > -1 : o.length > 0 }, empty: function () { return o && (o = []), this }, disable: function () { return i = a = [], o = n = "", this }, disabled: function () { return !o }, lock: function () { return i = a = [], n || t || (o = n = ""), this }, locked: function () { return !!i }, fireWith: function (e, n) { return i || (n = [e, (n = n || []).slice ? n.slice() : n], a.push(n), t || s()), this }, fire: function () { return l.fireWith(this, arguments), this }, fired: function () { return !!r } }; return l }; function B(e) { return e } function M(e) { throw e } function W(e, t, n, r) { var i; try { e && g(i = e.promise) ? i.call(e).done(t).fail(n) : e && g(i = e.then) ? i.call(e, t, n) : t.apply(void 0, [e].slice(r)) } catch (e) { n.apply(void 0, [e]) } } w.extend({ Deferred: function (t) { var n = [["notify", "progress", w.Callbacks("memory"), w.Callbacks("memory"), 2], ["resolve", "done", w.Callbacks("once memory"), w.Callbacks("once memory"), 0, "resolved"], ["reject", "fail", w.Callbacks("once memory"), w.Callbacks("once memory"), 1, "rejected"]], r = "pending", i = { state: function () { return r }, always: function () { return o.done(arguments).fail(arguments), this }, "catch": function (e) { return i.then(null, e) }, pipe: function () { var e = arguments; return w.Deferred(function (t) { w.each(n, function (n, r) { var i = g(e[r[4]]) && e[r[4]]; o[r[1]](function () { var e = i && i.apply(this, arguments); e && g(e.promise) ? e.promise().progress(t.notify).done(t.resolve).fail(t.reject) : t[r[0] + "With"](this, i ? [e] : arguments) }) }), e = null }).promise() }, then: function (t, r, i) { var o = 0; function a(t, n, r, i) { return function () { var u = this, s = arguments, l = function () { var e, l; if (!(t < o)) { if ((e = r.apply(u, s)) === n.promise()) throw new TypeError("Thenable self-resolution"); l = e && ("object" == typeof e || "function" == typeof e) && e.then, g(l) ? i ? l.call(e, a(o, n, B, i), a(o, n, M, i)) : (o++ , l.call(e, a(o, n, B, i), a(o, n, M, i), a(o, n, B, n.notifyWith))) : (r !== B && (u = void 0, s = [e]), (i || n.resolveWith)(u, s)) } }, c = i ? l : function () { try { l() } catch (e) { w.Deferred.exceptionHook && w.Deferred.exceptionHook(e, c.stackTrace), t + 1 >= o && (r !== M && (u = void 0, s = [e]), n.rejectWith(u, s)) } }; t ? c() : (w.Deferred.getStackHook && (c.stackTrace = w.Deferred.getStackHook()), e.setTimeout(c)) } } return w.Deferred(function (e) { n[0][3].add(a(0, e, g(i) ? i : B, e.notifyWith)), n[1][3].add(a(0, e, g(t) ? t : B)), n[2][3].add(a(0, e, g(r) ? r : M)) }).promise() }, promise: function (e) { return null != e ? w.extend(e, i) : i } }, o = {}; return w.each(n, function (e, t) { var a = t[2], u = t[5]; i[t[1]] = a.add, u && a.add(function () { r = u }, n[3 - e][2].disable, n[3 - e][3].disable, n[0][2].lock, n[0][3].lock), a.add(t[3].fire), o[t[0]] = function () { return o[t[0] + "With"](this === o ? void 0 : this, arguments), this }, o[t[0] + "With"] = a.fireWith }), i.promise(o), t && t.call(o, o), o }, when: function (e) { var t = arguments.length, n = t, r = Array(n), i = o.call(arguments), a = w.Deferred(), u = function (e) { return function (n) { r[e] = this, i[e] = arguments.length > 1 ? o.call(arguments) : n, --t || a.resolveWith(r, i) } }; if (t <= 1 && (W(e, a.done(u(n)).resolve, a.reject, !t), "pending" === a.state() || g(i[n] && i[n].then))) return a.then(); while (n--) W(i[n], u(n), a.reject); return a.promise() } }); var $ = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/; w.Deferred.exceptionHook = function (t, n) { e.console && e.console.warn && t && $.test(t.name) && e.console.warn("jQuery.Deferred exception: " + t.message, t.stack, n) }, w.readyException = function (t) { e.setTimeout(function () { throw t }) }; var F = w.Deferred(); w.fn.ready = function (e) { return F.then(e)["catch"](function (e) { w.readyException(e) }), this }, w.extend({ isReady: !1, readyWait: 1, ready: function (e) { (!0 === e ? --w.readyWait : w.isReady) || (w.isReady = !0, !0 !== e && --w.readyWait > 0 || F.resolveWith(r, [w])) } }), w.ready.then = F.then; function z() { r.removeEventListener("DOMContentLoaded", z), e.removeEventListener("load", z), w.ready() } "complete" === r.readyState || "loading" !== r.readyState && !r.documentElement.doScroll ? e.setTimeout(w.ready) : (r.addEventListener("DOMContentLoaded", z), e.addEventListener("load", z)); var _ = function (e, t, n, r, i, o, a) { var u = 0, s = e.length, l = null == n; if ("object" === b(n)) { i = !0; for (u in n) _(e, t, u, n[u], !0, o, a) } else if (void 0 !== r && (i = !0, g(r) || (a = !0), l && (a ? (t.call(e, r), t = null) : (l = t, t = function (e, t, n) { return l.call(w(e), n) })), t)) for (; u < s; u++)t(e[u], n, a ? r : r.call(e[u], u, t(e[u], n))); return i ? e : l ? t.call(e) : s ? t(e[0], n) : o }, U = /^-ms-/, V = /-([a-z])/g; function X(e, t) { return t.toUpperCase() } function Q(e) { return e.replace(U, "ms-").replace(V, X) } var Y = function (e) { return 1 === e.nodeType || 9 === e.nodeType || !+e.nodeType }; function G() { this.expando = w.expando + G.uid++ } G.uid = 1, G.prototype = { cache: function (e) { var t = e[this.expando]; return t || (t = {}, Y(e) && (e.nodeType ? e[this.expando] = t : Object.defineProperty(e, this.expando, { value: t, configurable: !0 }))), t }, set: function (e, t, n) { var r, i = this.cache(e); if ("string" == typeof t) i[Q(t)] = n; else for (r in t) i[Q(r)] = t[r]; return i }, get: function (e, t) { return void 0 === t ? this.cache(e) : e[this.expando] && e[this.expando][Q(t)] }, access: function (e, t, n) { return void 0 === t || t && "string" == typeof t && void 0 === n ? this.get(e, t) : (this.set(e, t, n), void 0 !== n ? n : t) }, remove: function (e, t) { var n, r = e[this.expando]; if (void 0 !== r) { if (void 0 !== t) { n = (t = Array.isArray(t) ? t.map(Q) : (t = Q(t)) in r ? [t] : t.match(I) || []).length; while (n--) delete r[t[n]] } (void 0 === t || w.isEmptyObject(r)) && (e.nodeType ? e[this.expando] = void 0 : delete e[this.expando]) } }, hasData: function (e) { var t = e[this.expando]; return void 0 !== t && !w.isEmptyObject(t) } }; var K = new G, J = new G, Z = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, ee = /[A-Z]/g; function te(e) { return "true" === e || "false" !== e && ("null" === e ? null : e === +e + "" ? +e : Z.test(e) ? JSON.parse(e) : e) } function ne(e, t, n) { var r; if (void 0 === n && 1 === e.nodeType) if (r = "data-" + t.replace(ee, "-$&").toLowerCase(), "string" == typeof (n = e.getAttribute(r))) { try { n = te(n) } catch (e) { } J.set(e, t, n) } else n = void 0; return n } w.extend({ hasData: function (e) { return J.hasData(e) || K.hasData(e) }, data: function (e, t, n) { return J.access(e, t, n) }, removeData: function (e, t) { J.remove(e, t) }, _data: function (e, t, n) { return K.access(e, t, n) }, _removeData: function (e, t) { K.remove(e, t) } }), w.fn.extend({ data: function (e, t) { var n, r, i, o = this[0], a = o && o.attributes; if (void 0 === e) { if (this.length && (i = J.get(o), 1 === o.nodeType && !K.get(o, "hasDataAttrs"))) { n = a.length; while (n--) a[n] && 0 === (r = a[n].name).indexOf("data-") && (r = Q(r.slice(5)), ne(o, r, i[r])); K.set(o, "hasDataAttrs", !0) } return i } return "object" == typeof e ? this.each(function () { J.set(this, e) }) : _(this, function (t) { var n; if (o && void 0 === t) { if (void 0 !== (n = J.get(o, e))) return n; if (void 0 !== (n = ne(o, e))) return n } else this.each(function () { J.set(this, e, t) }) }, null, t, arguments.length > 1, null, !0) }, removeData: function (e) { return this.each(function () { J.remove(this, e) }) } }), w.extend({ queue: function (e, t, n) { var r; if (e) return t = (t || "fx") + "queue", r = K.get(e, t), n && (!r || Array.isArray(n) ? r = K.access(e, t, w.makeArray(n)) : r.push(n)), r || [] }, dequeue: function (e, t) { t = t || "fx"; var n = w.queue(e, t), r = n.length, i = n.shift(), o = w._queueHooks(e, t), a = function () { w.dequeue(e, t) }; "inprogress" === i && (i = n.shift(), r--), i && ("fx" === t && n.unshift("inprogress"), delete o.stop, i.call(e, a, o)), !r && o && o.empty.fire() }, _queueHooks: function (e, t) { var n = t + "queueHooks"; return K.get(e, n) || K.access(e, n, { empty: w.Callbacks("once memory").add(function () { K.remove(e, [t + "queue", n]) }) }) } }), w.fn.extend({ queue: function (e, t) { var n = 2; return "string" != typeof e && (t = e, e = "fx", n--), arguments.length < n ? w.queue(this[0], e) : void 0 === t ? this : this.each(function () { var n = w.queue(this, e, t); w._queueHooks(this, e), "fx" === e && "inprogress" !== n[0] && w.dequeue(this, e) }) }, dequeue: function (e) { return this.each(function () { w.dequeue(this, e) }) }, clearQueue: function (e) { return this.queue(e || "fx", []) }, promise: function (e, t) { var n, r = 1, i = w.Deferred(), o = this, a = this.length, u = function () { --r || i.resolveWith(o, [o]) }; "string" != typeof e && (t = e, e = void 0), e = e || "fx"; while (a--) (n = K.get(o[a], e + "queueHooks")) && n.empty && (r++ , n.empty.add(u)); return u(), i.promise(t) } }); var re = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, ie = new RegExp("^(?:([+-])=|)(" + re + ")([a-z%]*)$", "i"), oe = ["Top", "Right", "Bottom", "Left"], ae = function (e, t) { return "none" === (e = t || e).style.display || "" === e.style.display && w.contains(e.ownerDocument, e) && "none" === w.css(e, "display") }, ue = function (e, t, n, r) { var i, o, a = {}; for (o in t) a[o] = e.style[o], e.style[o] = t[o]; i = n.apply(e, r || []); for (o in t) e.style[o] = a[o]; return i }; function se(e, t, n, r) { var i, o, a = 20, u = r ? function () { return r.cur() } : function () { return w.css(e, t, "") }, s = u(), l = n && n[3] || (w.cssNumber[t] ? "" : "px"), c = (w.cssNumber[t] || "px" !== l && +s) && ie.exec(w.css(e, t)); if (c && c[3] !== l) { s /= 2, l = l || c[3], c = +s || 1; while (a--) w.style(e, t, c + l), (1 - o) * (1 - (o = u() / s || .5)) <= 0 && (a = 0), c /= o; c *= 2, w.style(e, t, c + l), n = n || [] } return n && (c = +c || +s || 0, i = n[1] ? c + (n[1] + 1) * n[2] : +n[2], r && (r.unit = l, r.start = c, r.end = i)), i } var le = {}; function ce(e) { var t, n = e.ownerDocument, r = e.nodeName, i = le[r]; return i || (t = n.body.appendChild(n.createElement(r)), i = w.css(t, "display"), t.parentNode.removeChild(t), "none" === i && (i = "block"), le[r] = i, i) } function fe(e, t) { for (var n, r, i = [], o = 0, a = e.length; o < a; o++)(r = e[o]).style && (n = r.style.display, t ? ("none" === n && (i[o] = K.get(r, "display") || null, i[o] || (r.style.display = "")), "" === r.style.display && ae(r) && (i[o] = ce(r))) : "none" !== n && (i[o] = "none", K.set(r, "display", n))); for (o = 0; o < a; o++)null != i[o] && (e[o].style.display = i[o]); return e } w.fn.extend({ show: function () { return fe(this, !0) }, hide: function () { return fe(this) }, toggle: function (e) { return "boolean" == typeof e ? e ? this.show() : this.hide() : this.each(function () { ae(this) ? w(this).show() : w(this).hide() }) } }); var de = /^(?:checkbox|radio)$/i, pe = /<([a-z][^\/\0>\x20\t\r\n\f]+)/i, he = /^$|^module$|\/(?:java|ecma)script/i, ge = { option: [1, "<select multiple='multiple'>", "</select>"], thead: [1, "<table>", "</table>"], col: [2, "<table><colgroup>", "</colgroup></table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], _default: [0, "", ""] }; ge.optgroup = ge.option, ge.tbody = ge.tfoot = ge.colgroup = ge.caption = ge.thead, ge.th = ge.td; function ve(e, t) { var n; return n = "undefined" != typeof e.getElementsByTagName ? e.getElementsByTagName(t || "*") : "undefined" != typeof e.querySelectorAll ? e.querySelectorAll(t || "*") : [], void 0 === t || t && D(e, t) ? w.merge([e], n) : n } function ye(e, t) { for (var n = 0, r = e.length; n < r; n++)K.set(e[n], "globalEval", !t || K.get(t[n], "globalEval")) } var me = /<|&#?\w+;/; function be(e, t, n, r, i) { for (var o, a, u, s, l, c, f = t.createDocumentFragment(), d = [], p = 0, h = e.length; p < h; p++)if ((o = e[p]) || 0 === o) if ("object" === b(o)) w.merge(d, o.nodeType ? [o] : o); else if (me.test(o)) { a = a || f.appendChild(t.createElement("div")), u = (pe.exec(o) || ["", ""])[1].toLowerCase(), s = ge[u] || ge._default, a.innerHTML = s[1] + w.htmlPrefilter(o) + s[2], c = s[0]; while (c--) a = a.lastChild; w.merge(d, a.childNodes), (a = f.firstChild).textContent = "" } else d.push(t.createTextNode(o)); f.textContent = "", p = 0; while (o = d[p++]) if (r && w.inArray(o, r) > -1) i && i.push(o); else if (l = w.contains(o.ownerDocument, o), a = ve(f.appendChild(o), "script"), l && ye(a), n) { c = 0; while (o = a[c++]) he.test(o.type || "") && n.push(o) } return f } !function () { var e = r.createDocumentFragment().appendChild(r.createElement("div")), t = r.createElement("input"); t.setAttribute("type", "radio"), t.setAttribute("checked", "checked"), t.setAttribute("name", "t"), e.appendChild(t), h.checkClone = e.cloneNode(!0).cloneNode(!0).lastChild.checked, e.innerHTML = "<textarea>x</textarea>", h.noCloneChecked = !!e.cloneNode(!0).lastChild.defaultValue }(); var xe = r.documentElement, we = /^key/, Ce = /^(?:mouse|pointer|contextmenu|drag|drop)|click/, Te = /^([^.]*)(?:\.(.+)|)/; function Ee() { return !0 } function Ne() { return !1 } function ke() { try { return r.activeElement } catch (e) { } } function Ae(e, t, n, r, i, o) { var a, u; if ("object" == typeof t) { "string" != typeof n && (r = r || n, n = void 0); for (u in t) Ae(e, u, n, r, t[u], o); return e } if (null == r && null == i ? (i = n, r = n = void 0) : null == i && ("string" == typeof n ? (i = r, r = void 0) : (i = r, r = n, n = void 0)), !1 === i) i = Ne; else if (!i) return e; return 1 === o && (a = i, (i = function (e) { return w().off(e), a.apply(this, arguments) }).guid = a.guid || (a.guid = w.guid++)), e.each(function () { w.event.add(this, t, i, r, n) }) } w.event = { global: {}, add: function (e, t, n, r, i) { var o, a, u, s, l, c, f, d, p, h, g, v = K.get(e); if (v) { n.handler && (n = (o = n).handler, i = o.selector), i && w.find.matchesSelector(xe, i), n.guid || (n.guid = w.guid++), (s = v.events) || (s = v.events = {}), (a = v.handle) || (a = v.handle = function (t) { return "undefined" != typeof w && w.event.triggered !== t.type ? w.event.dispatch.apply(e, arguments) : void 0 }), l = (t = (t || "").match(I) || [""]).length; while (l--) p = g = (u = Te.exec(t[l]) || [])[1], h = (u[2] || "").split(".").sort(), p && (f = w.event.special[p] || {}, p = (i ? f.delegateType : f.bindType) || p, f = w.event.special[p] || {}, c = w.extend({ type: p, origType: g, data: r, handler: n, guid: n.guid, selector: i, needsContext: i && w.expr.match.needsContext.test(i), namespace: h.join(".") }, o), (d = s[p]) || ((d = s[p] = []).delegateCount = 0, f.setup && !1 !== f.setup.call(e, r, h, a) || e.addEventListener && e.addEventListener(p, a)), f.add && (f.add.call(e, c), c.handler.guid || (c.handler.guid = n.guid)), i ? d.splice(d.delegateCount++, 0, c) : d.push(c), w.event.global[p] = !0) } }, remove: function (e, t, n, r, i) { var o, a, u, s, l, c, f, d, p, h, g, v = K.hasData(e) && K.get(e); if (v && (s = v.events)) { l = (t = (t || "").match(I) || [""]).length; while (l--) if (u = Te.exec(t[l]) || [], p = g = u[1], h = (u[2] || "").split(".").sort(), p) { f = w.event.special[p] || {}, d = s[p = (r ? f.delegateType : f.bindType) || p] || [], u = u[2] && new RegExp("(^|\\.)" + h.join("\\.(?:.*\\.|)") + "(\\.|$)"), a = o = d.length; while (o--) c = d[o], !i && g !== c.origType || n && n.guid !== c.guid || u && !u.test(c.namespace) || r && r !== c.selector && ("**" !== r || !c.selector) || (d.splice(o, 1), c.selector && d.delegateCount-- , f.remove && f.remove.call(e, c)); a && !d.length && (f.teardown && !1 !== f.teardown.call(e, h, v.handle) || w.removeEvent(e, p, v.handle), delete s[p]) } else for (p in s) w.event.remove(e, p + t[l], n, r, !0); w.isEmptyObject(s) && K.remove(e, "handle events") } }, dispatch: function (e) { var t = w.event.fix(e), n, r, i, o, a, u, s = new Array(arguments.length), l = (K.get(this, "events") || {})[t.type] || [], c = w.event.special[t.type] || {}; for (s[0] = t, n = 1; n < arguments.length; n++)s[n] = arguments[n]; if (t.delegateTarget = this, !c.preDispatch || !1 !== c.preDispatch.call(this, t)) { u = w.event.handlers.call(this, t, l), n = 0; while ((o = u[n++]) && !t.isPropagationStopped()) { t.currentTarget = o.elem, r = 0; while ((a = o.handlers[r++]) && !t.isImmediatePropagationStopped()) t.rnamespace && !t.rnamespace.test(a.namespace) || (t.handleObj = a, t.data = a.data, void 0 !== (i = ((w.event.special[a.origType] || {}).handle || a.handler).apply(o.elem, s)) && !1 === (t.result = i) && (t.preventDefault(), t.stopPropagation())) } return c.postDispatch && c.postDispatch.call(this, t), t.result } }, handlers: function (e, t) { var n, r, i, o, a, u = [], s = t.delegateCount, l = e.target; if (s && l.nodeType && !("click" === e.type && e.button >= 1)) for (; l !== this; l = l.parentNode || this)if (1 === l.nodeType && ("click" !== e.type || !0 !== l.disabled)) { for (o = [], a = {}, n = 0; n < s; n++)void 0 === a[i = (r = t[n]).selector + " "] && (a[i] = r.needsContext ? w(i, this).index(l) > -1 : w.find(i, this, null, [l]).length), a[i] && o.push(r); o.length && u.push({ elem: l, handlers: o }) } return l = this, s < t.length && u.push({ elem: l, handlers: t.slice(s) }), u }, addProp: function (e, t) { Object.defineProperty(w.Event.prototype, e, { enumerable: !0, configurable: !0, get: g(t) ? function () { if (this.originalEvent) return t(this.originalEvent) } : function () { if (this.originalEvent) return this.originalEvent[e] }, set: function (t) { Object.defineProperty(this, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) } }) }, fix: function (e) { return e[w.expando] ? e : new w.Event(e) }, special: { load: { noBubble: !0 }, focus: { trigger: function () { if (this !== ke() && this.focus) return this.focus(), !1 }, delegateType: "focusin" }, blur: { trigger: function () { if (this === ke() && this.blur) return this.blur(), !1 }, delegateType: "focusout" }, click: { trigger: function () { if ("checkbox" === this.type && this.click && D(this, "input")) return this.click(), !1 }, _default: function (e) { return D(e.target, "a") } }, beforeunload: { postDispatch: function (e) { void 0 !== e.result && e.originalEvent && (e.originalEvent.returnValue = e.result) } } } }, w.removeEvent = function (e, t, n) { e.removeEventListener && e.removeEventListener(t, n) }, w.Event = function (e, t) { if (!(this instanceof w.Event)) return new w.Event(e, t); e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || void 0 === e.defaultPrevented && !1 === e.returnValue ? Ee : Ne, this.target = e.target && 3 === e.target.nodeType ? e.target.parentNode : e.target, this.currentTarget = e.currentTarget, this.relatedTarget = e.relatedTarget) : this.type = e, t && w.extend(this, t), this.timeStamp = e && e.timeStamp || Date.now(), this[w.expando] = !0 }, w.Event.prototype = { constructor: w.Event, isDefaultPrevented: Ne, isPropagationStopped: Ne, isImmediatePropagationStopped: Ne, isSimulated: !1, preventDefault: function () { var e = this.originalEvent; this.isDefaultPrevented = Ee, e && !this.isSimulated && e.preventDefault() }, stopPropagation: function () { var e = this.originalEvent; this.isPropagationStopped = Ee, e && !this.isSimulated && e.stopPropagation() }, stopImmediatePropagation: function () { var e = this.originalEvent; this.isImmediatePropagationStopped = Ee, e && !this.isSimulated && e.stopImmediatePropagation(), this.stopPropagation() } }, w.each({ altKey: !0, bubbles: !0, cancelable: !0, changedTouches: !0, ctrlKey: !0, detail: !0, eventPhase: !0, metaKey: !0, pageX: !0, pageY: !0, shiftKey: !0, view: !0, "char": !0, charCode: !0, key: !0, keyCode: !0, button: !0, buttons: !0, clientX: !0, clientY: !0, offsetX: !0, offsetY: !0, pointerId: !0, pointerType: !0, screenX: !0, screenY: !0, targetTouches: !0, toElement: !0, touches: !0, which: function (e) { var t = e.button; return null == e.which && we.test(e.type) ? null != e.charCode ? e.charCode : e.keyCode : !e.which && void 0 !== t && Ce.test(e.type) ? 1 & t ? 1 : 2 & t ? 3 : 4 & t ? 2 : 0 : e.which } }, w.event.addProp), w.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function (e, t) { w.event.special[e] = { delegateType: t, bindType: t, handle: function (e) { var n, r = this, i = e.relatedTarget, o = e.handleObj; return i && (i === r || w.contains(r, i)) || (e.type = o.origType, n = o.handler.apply(this, arguments), e.type = t), n } } }), w.fn.extend({ on: function (e, t, n, r) { return Ae(this, e, t, n, r) }, one: function (e, t, n, r) { return Ae(this, e, t, n, r, 1) }, off: function (e, t, n) { var r, i; if (e && e.preventDefault && e.handleObj) return r = e.handleObj, w(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this; if ("object" == typeof e) { for (i in e) this.off(i, t, e[i]); return this } return !1 !== t && "function" != typeof t || (n = t, t = void 0), !1 === n && (n = Ne), this.each(function () { w.event.remove(this, e, n, t) }) } }); var De = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi, Se = /<script|<style|<link/i, Le = /checked\s*(?:[^=]|=\s*.checked.)/i, je = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g; function qe(e, t) { return D(e, "table") && D(11 !== t.nodeType ? t : t.firstChild, "tr") ? w(e).children("tbody")[0] || e : e } function Oe(e) { return e.type = (null !== e.getAttribute("type")) + "/" + e.type, e } function Pe(e) { return "true/" === (e.type || "").slice(0, 5) ? e.type = e.type.slice(5) : e.removeAttribute("type"), e } function He(e, t) { var n, r, i, o, a, u, s, l; if (1 === t.nodeType) { if (K.hasData(e) && (o = K.access(e), a = K.set(t, o), l = o.events)) { delete a.handle, a.events = {}; for (i in l) for (n = 0, r = l[i].length; n < r; n++)w.event.add(t, i, l[i][n]) } J.hasData(e) && (u = J.access(e), s = w.extend({}, u), J.set(t, s)) } } function Ie(e, t) { var n = t.nodeName.toLowerCase(); "input" === n && de.test(e.type) ? t.checked = e.checked : "input" !== n && "textarea" !== n || (t.defaultValue = e.defaultValue) } function Re(e, t, n, r) { t = a.apply([], t); var i, o, u, s, l, c, f = 0, d = e.length, p = d - 1, v = t[0], y = g(v); if (y || d > 1 && "string" == typeof v && !h.checkClone && Le.test(v)) return e.each(function (i) { var o = e.eq(i); y && (t[0] = v.call(this, i, o.html())), Re(o, t, n, r) }); if (d && (i = be(t, e[0].ownerDocument, !1, e, r), o = i.firstChild, 1 === i.childNodes.length && (i = o), o || r)) { for (s = (u = w.map(ve(i, "script"), Oe)).length; f < d; f++)l = i, f !== p && (l = w.clone(l, !0, !0), s && w.merge(u, ve(l, "script"))), n.call(e[f], l, f); if (s) for (c = u[u.length - 1].ownerDocument, w.map(u, Pe), f = 0; f < s; f++)l = u[f], he.test(l.type || "") && !K.access(l, "globalEval") && w.contains(c, l) && (l.src && "module" !== (l.type || "").toLowerCase() ? w._evalUrl && w._evalUrl(l.src) : m(l.textContent.replace(je, ""), c, l)) } return e } function Be(e, t, n) { for (var r, i = t ? w.filter(t, e) : e, o = 0; null != (r = i[o]); o++)n || 1 !== r.nodeType || w.cleanData(ve(r)), r.parentNode && (n && w.contains(r.ownerDocument, r) && ye(ve(r, "script")), r.parentNode.removeChild(r)); return e } w.extend({ htmlPrefilter: function (e) { return e.replace(De, "<$1></$2>") }, clone: function (e, t, n) { var r, i, o, a, u = e.cloneNode(!0), s = w.contains(e.ownerDocument, e); if (!(h.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || w.isXMLDoc(e))) for (a = ve(u), r = 0, i = (o = ve(e)).length; r < i; r++)Ie(o[r], a[r]); if (t) if (n) for (o = o || ve(e), a = a || ve(u), r = 0, i = o.length; r < i; r++)He(o[r], a[r]); else He(e, u); return (a = ve(u, "script")).length > 0 && ye(a, !s && ve(e, "script")), u }, cleanData: function (e) { for (var t, n, r, i = w.event.special, o = 0; void 0 !== (n = e[o]); o++)if (Y(n)) { if (t = n[K.expando]) { if (t.events) for (r in t.events) i[r] ? w.event.remove(n, r) : w.removeEvent(n, r, t.handle); n[K.expando] = void 0 } n[J.expando] && (n[J.expando] = void 0) } } }), w.fn.extend({ detach: function (e) { return Be(this, e, !0) }, remove: function (e) { return Be(this, e) }, text: function (e) { return _(this, function (e) { return void 0 === e ? w.text(this) : this.empty().each(function () { 1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || (this.textContent = e) }) }, null, e, arguments.length) }, append: function () { return Re(this, arguments, function (e) { 1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || qe(this, e).appendChild(e) }) }, prepend: function () { return Re(this, arguments, function (e) { if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) { var t = qe(this, e); t.insertBefore(e, t.firstChild) } }) }, before: function () { return Re(this, arguments, function (e) { this.parentNode && this.parentNode.insertBefore(e, this) }) }, after: function () { return Re(this, arguments, function (e) { this.parentNode && this.parentNode.insertBefore(e, this.nextSibling) }) }, empty: function () { for (var e, t = 0; null != (e = this[t]); t++)1 === e.nodeType && (w.cleanData(ve(e, !1)), e.textContent = ""); return this }, clone: function (e, t) { return e = null != e && e, t = null == t ? e : t, this.map(function () { return w.clone(this, e, t) }) }, html: function (e) { return _(this, function (e) { var t = this[0] || {}, n = 0, r = this.length; if (void 0 === e && 1 === t.nodeType) return t.innerHTML; if ("string" == typeof e && !Se.test(e) && !ge[(pe.exec(e) || ["", ""])[1].toLowerCase()]) { e = w.htmlPrefilter(e); try { for (; n < r; n++)1 === (t = this[n] || {}).nodeType && (w.cleanData(ve(t, !1)), t.innerHTML = e); t = 0 } catch (e) { } } t && this.empty().append(e) }, null, e, arguments.length) }, replaceWith: function () { var e = []; return Re(this, arguments, function (t) { var n = this.parentNode; w.inArray(this, e) < 0 && (w.cleanData(ve(this)), n && n.replaceChild(t, this)) }, e) } }), w.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (e, t) { w.fn[e] = function (e) { for (var n, r = [], i = w(e), o = i.length - 1, a = 0; a <= o; a++)n = a === o ? this : this.clone(!0), w(i[a])[t](n), u.apply(r, n.get()); return this.pushStack(r) } }); var Me = new RegExp("^(" + re + ")(?!px)[a-z%]+$", "i"), We = function (t) { var n = t.ownerDocument.defaultView; return n && n.opener || (n = e), n.getComputedStyle(t) }, $e = new RegExp(oe.join("|"), "i"); !function () { function t() { if (c) { l.style.cssText = "position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0", c.style.cssText = "position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%", xe.appendChild(l).appendChild(c); var t = e.getComputedStyle(c); i = "1%" !== t.top, s = 12 === n(t.marginLeft), c.style.right = "60%", u = 36 === n(t.right), o = 36 === n(t.width), c.style.position = "absolute", a = 36 === c.offsetWidth || "absolute", xe.removeChild(l), c = null } } function n(e) { return Math.round(parseFloat(e)) } var i, o, a, u, s, l = r.createElement("div"), c = r.createElement("div"); c.style && (c.style.backgroundClip = "content-box", c.cloneNode(!0).style.backgroundClip = "", h.clearCloneStyle = "content-box" === c.style.backgroundClip, w.extend(h, { boxSizingReliable: function () { return t(), o }, pixelBoxStyles: function () { return t(), u }, pixelPosition: function () { return t(), i }, reliableMarginLeft: function () { return t(), s }, scrollboxSize: function () { return t(), a } })) }(); function Fe(e, t, n) { var r, i, o, a, u = e.style; return (n = n || We(e)) && ("" !== (a = n.getPropertyValue(t) || n[t]) || w.contains(e.ownerDocument, e) || (a = w.style(e, t)), !h.pixelBoxStyles() && Me.test(a) && $e.test(t) && (r = u.width, i = u.minWidth, o = u.maxWidth, u.minWidth = u.maxWidth = u.width = a, a = n.width, u.width = r, u.minWidth = i, u.maxWidth = o)), void 0 !== a ? a + "" : a } function ze(e, t) { return { get: function () { if (!e()) return (this.get = t).apply(this, arguments); delete this.get } } } var _e = /^(none|table(?!-c[ea]).+)/, Ue = /^--/, Ve = { position: "absolute", visibility: "hidden", display: "block" }, Xe = { letterSpacing: "0", fontWeight: "400" }, Qe = ["Webkit", "Moz", "ms"], Ye = r.createElement("div").style; function Ge(e) { if (e in Ye) return e; var t = e[0].toUpperCase() + e.slice(1), n = Qe.length; while (n--) if ((e = Qe[n] + t) in Ye) return e } function Ke(e) { var t = w.cssProps[e]; return t || (t = w.cssProps[e] = Ge(e) || e), t } function Je(e, t, n) { var r = ie.exec(t); return r ? Math.max(0, r[2] - (n || 0)) + (r[3] || "px") : t } function Ze(e, t, n, r, i, o) { var a = "width" === t ? 1 : 0, u = 0, s = 0; if (n === (r ? "border" : "content")) return 0; for (; a < 4; a += 2)"margin" === n && (s += w.css(e, n + oe[a], !0, i)), r ? ("content" === n && (s -= w.css(e, "padding" + oe[a], !0, i)), "margin" !== n && (s -= w.css(e, "border" + oe[a] + "Width", !0, i))) : (s += w.css(e, "padding" + oe[a], !0, i), "padding" !== n ? s += w.css(e, "border" + oe[a] + "Width", !0, i) : u += w.css(e, "border" + oe[a] + "Width", !0, i)); return !r && o >= 0 && (s += Math.max(0, Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - o - s - u - .5))), s } function et(e, t, n) { var r = We(e), i = Fe(e, t, r), o = "border-box" === w.css(e, "boxSizing", !1, r), a = o; if (Me.test(i)) { if (!n) return i; i = "auto" } return a = a && (h.boxSizingReliable() || i === e.style[t]), ("auto" === i || !parseFloat(i) && "inline" === w.css(e, "display", !1, r)) && (i = e["offset" + t[0].toUpperCase() + t.slice(1)], a = !0), (i = parseFloat(i) || 0) + Ze(e, t, n || (o ? "border" : "content"), a, r, i) + "px" } w.extend({ cssHooks: { opacity: { get: function (e, t) { if (t) { var n = Fe(e, "opacity"); return "" === n ? "1" : n } } } }, cssNumber: { animationIterationCount: !0, columnCount: !0, fillOpacity: !0, flexGrow: !0, flexShrink: !0, fontWeight: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0 }, cssProps: {}, style: function (e, t, n, r) { if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) { var i, o, a, u = Q(t), s = Ue.test(t), l = e.style; if (s || (t = Ke(u)), a = w.cssHooks[t] || w.cssHooks[u], void 0 === n) return a && "get" in a && void 0 !== (i = a.get(e, !1, r)) ? i : l[t]; "string" == (o = typeof n) && (i = ie.exec(n)) && i[1] && (n = se(e, t, i), o = "number"), null != n && n === n && ("number" === o && (n += i && i[3] || (w.cssNumber[u] ? "" : "px")), h.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (l[t] = "inherit"), a && "set" in a && void 0 === (n = a.set(e, n, r)) || (s ? l.setProperty(t, n) : l[t] = n)) } }, css: function (e, t, n, r) { var i, o, a, u = Q(t); return Ue.test(t) || (t = Ke(u)), (a = w.cssHooks[t] || w.cssHooks[u]) && "get" in a && (i = a.get(e, !0, n)), void 0 === i && (i = Fe(e, t, r)), "normal" === i && t in Xe && (i = Xe[t]), "" === n || n ? (o = parseFloat(i), !0 === n || isFinite(o) ? o || 0 : i) : i } }), w.each(["height", "width"], function (e, t) { w.cssHooks[t] = { get: function (e, n, r) { if (n) return !_e.test(w.css(e, "display")) || e.getClientRects().length && e.getBoundingClientRect().width ? et(e, t, r) : ue(e, Ve, function () { return et(e, t, r) }) }, set: function (e, n, r) { var i, o = We(e), a = "border-box" === w.css(e, "boxSizing", !1, o), u = r && Ze(e, t, r, a, o); return a && h.scrollboxSize() === o.position && (u -= Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - parseFloat(o[t]) - Ze(e, t, "border", !1, o) - .5)), u && (i = ie.exec(n)) && "px" !== (i[3] || "px") && (e.style[t] = n, n = w.css(e, t)), Je(e, n, u) } } }), w.cssHooks.marginLeft = ze(h.reliableMarginLeft, function (e, t) { if (t) return (parseFloat(Fe(e, "marginLeft")) || e.getBoundingClientRect().left - ue(e, { marginLeft: 0 }, function () { return e.getBoundingClientRect().left })) + "px" }), w.each({ margin: "", padding: "", border: "Width" }, function (e, t) { w.cssHooks[e + t] = { expand: function (n) { for (var r = 0, i = {}, o = "string" == typeof n ? n.split(" ") : [n]; r < 4; r++)i[e + oe[r] + t] = o[r] || o[r - 2] || o[0]; return i } }, "margin" !== e && (w.cssHooks[e + t].set = Je) }), w.fn.extend({ css: function (e, t) { return _(this, function (e, t, n) { var r, i, o = {}, a = 0; if (Array.isArray(t)) { for (r = We(e), i = t.length; a < i; a++)o[t[a]] = w.css(e, t[a], !1, r); return o } return void 0 !== n ? w.style(e, t, n) : w.css(e, t) }, e, t, arguments.length > 1) } }), w.fn.delay = function (t, n) { return t = w.fx ? w.fx.speeds[t] || t : t, n = n || "fx", this.queue(n, function (n, r) { var i = e.setTimeout(n, t); r.stop = function () { e.clearTimeout(i) } }) }, function () { var e = r.createElement("input"), t = r.createElement("select").appendChild(r.createElement("option")); e.type = "checkbox", h.checkOn = "" !== e.value, h.optSelected = t.selected, (e = r.createElement("input")).value = "t", e.type = "radio", h.radioValue = "t" === e.value }(); var tt, nt = w.expr.attrHandle; w.fn.extend({ attr: function (e, t) { return _(this, w.attr, e, t, arguments.length > 1) }, removeAttr: function (e) { return this.each(function () { w.removeAttr(this, e) }) } }), w.extend({ attr: function (e, t, n) { var r, i, o = e.nodeType; if (3 !== o && 8 !== o && 2 !== o) return "undefined" == typeof e.getAttribute ? w.prop(e, t, n) : (1 === o && w.isXMLDoc(e) || (i = w.attrHooks[t.toLowerCase()] || (w.expr.match.bool.test(t) ? tt : void 0)), void 0 !== n ? null === n ? void w.removeAttr(e, t) : i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : (e.setAttribute(t, n + ""), n) : i && "get" in i && null !== (r = i.get(e, t)) ? r : null == (r = w.find.attr(e, t)) ? void 0 : r) }, attrHooks: { type: { set: function (e, t) { if (!h.radioValue && "radio" === t && D(e, "input")) { var n = e.value; return e.setAttribute("type", t), n && (e.value = n), t } } } }, removeAttr: function (e, t) { var n, r = 0, i = t && t.match(I); if (i && 1 === e.nodeType) while (n = i[r++]) e.removeAttribute(n) } }), tt = { set: function (e, t, n) { return !1 === t ? w.removeAttr(e, n) : e.setAttribute(n, n), n } }, w.each(w.expr.match.bool.source.match(/\w+/g), function (e, t) { var n = nt[t] || w.find.attr; nt[t] = function (e, t, r) { var i, o, a = t.toLowerCase(); return r || (o = nt[a], nt[a] = i, i = null != n(e, t, r) ? a : null, nt[a] = o), i } }); var rt = /^(?:input|select|textarea|button)$/i, it = /^(?:a|area)$/i; w.fn.extend({ prop: function (e, t) { return _(this, w.prop, e, t, arguments.length > 1) }, removeProp: function (e) { return this.each(function () { delete this[w.propFix[e] || e] }) } }), w.extend({ prop: function (e, t, n) { var r, i, o = e.nodeType; if (3 !== o && 8 !== o && 2 !== o) return 1 === o && w.isXMLDoc(e) || (t = w.propFix[t] || t, i = w.propHooks[t]), void 0 !== n ? i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : e[t] = n : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t] }, propHooks: { tabIndex: { get: function (e) { var t = w.find.attr(e, "tabindex"); return t ? parseInt(t, 10) : rt.test(e.nodeName) || it.test(e.nodeName) && e.href ? 0 : -1 } } }, propFix: { "for": "htmlFor", "class": "className" } }), h.optSelected || (w.propHooks.selected = { get: function (e) { var t = e.parentNode; return t && t.parentNode && t.parentNode.selectedIndex, null }, set: function (e) { var t = e.parentNode; t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex) } }), w.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () { w.propFix[this.toLowerCase()] = this }); function ot(e) { return (e.match(I) || []).join(" ") } function at(e) { return e.getAttribute && e.getAttribute("class") || "" } function ut(e) { return Array.isArray(e) ? e : "string" == typeof e ? e.match(I) || [] : [] } w.fn.extend({ addClass: function (e) { var t, n, r, i, o, a, u, s = 0; if (g(e)) return this.each(function (t) { w(this).addClass(e.call(this, t, at(this))) }); if ((t = ut(e)).length) while (n = this[s++]) if (i = at(n), r = 1 === n.nodeType && " " + ot(i) + " ") { a = 0; while (o = t[a++]) r.indexOf(" " + o + " ") < 0 && (r += o + " "); i !== (u = ot(r)) && n.setAttribute("class", u) } return this }, removeClass: function (e) { var t, n, r, i, o, a, u, s = 0; if (g(e)) return this.each(function (t) { w(this).removeClass(e.call(this, t, at(this))) }); if (!arguments.length) return this.attr("class", ""); if ((t = ut(e)).length) while (n = this[s++]) if (i = at(n), r = 1 === n.nodeType && " " + ot(i) + " ") { a = 0; while (o = t[a++]) while (r.indexOf(" " + o + " ") > -1) r = r.replace(" " + o + " ", " "); i !== (u = ot(r)) && n.setAttribute("class", u) } return this }, toggleClass: function (e, t) { var n = typeof e, r = "string" === n || Array.isArray(e); return "boolean" == typeof t && r ? t ? this.addClass(e) : this.removeClass(e) : g(e) ? this.each(function (n) { w(this).toggleClass(e.call(this, n, at(this), t), t) }) : this.each(function () { var t, i, o, a; if (r) { i = 0, o = w(this), a = ut(e); while (t = a[i++]) o.hasClass(t) ? o.removeClass(t) : o.addClass(t) } else void 0 !== e && "boolean" !== n || ((t = at(this)) && K.set(this, "__className__", t), this.setAttribute && this.setAttribute("class", t || !1 === e ? "" : K.get(this, "__className__") || "")) }) }, hasClass: function (e) { var t, n, r = 0; t = " " + e + " "; while (n = this[r++]) if (1 === n.nodeType && (" " + ot(at(n)) + " ").indexOf(t) > -1) return !0; return !1 } }); var st = /\r/g; w.fn.extend({ val: function (e) { var t, n, r, i = this[0]; { if (arguments.length) return r = g(e), this.each(function (n) { var i; 1 === this.nodeType && (null == (i = r ? e.call(this, n, w(this).val()) : e) ? i = "" : "number" == typeof i ? i += "" : Array.isArray(i) && (i = w.map(i, function (e) { return null == e ? "" : e + "" })), (t = w.valHooks[this.type] || w.valHooks[this.nodeName.toLowerCase()]) && "set" in t && void 0 !== t.set(this, i, "value") || (this.value = i)) }); if (i) return (t = w.valHooks[i.type] || w.valHooks[i.nodeName.toLowerCase()]) && "get" in t && void 0 !== (n = t.get(i, "value")) ? n : "string" == typeof (n = i.value) ? n.replace(st, "") : null == n ? "" : n } } }), w.extend({ valHooks: { option: { get: function (e) { var t = w.find.attr(e, "value"); return null != t ? t : ot(w.text(e)) } }, select: { get: function (e) { var t, n, r, i = e.options, o = e.selectedIndex, a = "select-one" === e.type, u = a ? null : [], s = a ? o + 1 : i.length; for (r = o < 0 ? s : a ? o : 0; r < s; r++)if (((n = i[r]).selected || r === o) && !n.disabled && (!n.parentNode.disabled || !D(n.parentNode, "optgroup"))) { if (t = w(n).val(), a) return t; u.push(t) } return u }, set: function (e, t) { var n, r, i = e.options, o = w.makeArray(t), a = i.length; while (a--) ((r = i[a]).selected = w.inArray(w.valHooks.option.get(r), o) > -1) && (n = !0); return n || (e.selectedIndex = -1), o } } } }), w.each(["radio", "checkbox"], function () { w.valHooks[this] = { set: function (e, t) { if (Array.isArray(t)) return e.checked = w.inArray(w(e).val(), t) > -1 } }, h.checkOn || (w.valHooks[this].get = function (e) { return null === e.getAttribute("value") ? "on" : e.value }) }), h.focusin = "onfocusin" in e; var lt = /^(?:focusinfocus|focusoutblur)$/, ct = function (e) { e.stopPropagation() }; w.extend(w.event, { trigger: function (t, n, i, o) { var a, u, s, l, c, d, p, h, y = [i || r], m = f.call(t, "type") ? t.type : t, b = f.call(t, "namespace") ? t.namespace.split(".") : []; if (u = h = s = i = i || r, 3 !== i.nodeType && 8 !== i.nodeType && !lt.test(m + w.event.triggered) && (m.indexOf(".") > -1 && (m = (b = m.split(".")).shift(), b.sort()), c = m.indexOf(":") < 0 && "on" + m, t = t[w.expando] ? t : new w.Event(m, "object" == typeof t && t), t.isTrigger = o ? 2 : 3, t.namespace = b.join("."), t.rnamespace = t.namespace ? new RegExp("(^|\\.)" + b.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, t.result = void 0, t.target || (t.target = i), n = null == n ? [t] : w.makeArray(n, [t]), p = w.event.special[m] || {}, o || !p.trigger || !1 !== p.trigger.apply(i, n))) { if (!o && !p.noBubble && !v(i)) { for (l = p.delegateType || m, lt.test(l + m) || (u = u.parentNode); u; u = u.parentNode)y.push(u), s = u; s === (i.ownerDocument || r) && y.push(s.defaultView || s.parentWindow || e) } a = 0; while ((u = y[a++]) && !t.isPropagationStopped()) h = u, t.type = a > 1 ? l : p.bindType || m, (d = (K.get(u, "events") || {})[t.type] && K.get(u, "handle")) && d.apply(u, n), (d = c && u[c]) && d.apply && Y(u) && (t.result = d.apply(u, n), !1 === t.result && t.preventDefault()); return t.type = m, o || t.isDefaultPrevented() || p._default && !1 !== p._default.apply(y.pop(), n) || !Y(i) || c && g(i[m]) && !v(i) && ((s = i[c]) && (i[c] = null), w.event.triggered = m, t.isPropagationStopped() && h.addEventListener(m, ct), i[m](), t.isPropagationStopped() && h.removeEventListener(m, ct), w.event.triggered = void 0, s && (i[c] = s)), t.result } }, simulate: function (e, t, n) { var r = w.extend(new w.Event, n, { type: e, isSimulated: !0 }); w.event.trigger(r, null, t) } }), w.fn.extend({ trigger: function (e, t) { return this.each(function () { w.event.trigger(e, t, this) }) }, triggerHandler: function (e, t) { var n = this[0]; if (n) return w.event.trigger(e, t, n, !0) } }), h.focusin || w.each({ focus: "focusin", blur: "focusout" }, function (e, t) { var n = function (e) { w.event.simulate(t, e.target, w.event.fix(e)) }; w.event.special[t] = { setup: function () { var r = this.ownerDocument || this, i = K.access(r, t); i || r.addEventListener(e, n, !0), K.access(r, t, (i || 0) + 1) }, teardown: function () { var r = this.ownerDocument || this, i = K.access(r, t) - 1; i ? K.access(r, t, i) : (r.removeEventListener(e, n, !0), K.remove(r, t)) } } }); var ft = /\[\]$/, dt = /\r?\n/g, pt = /^(?:submit|button|image|reset|file)$/i, ht = /^(?:input|select|textarea|keygen)/i; function gt(e, t, n, r) { var i; if (Array.isArray(t)) w.each(t, function (t, i) { n || ft.test(e) ? r(e, i) : gt(e + "[" + ("object" == typeof i && null != i ? t : "") + "]", i, n, r) }); else if (n || "object" !== b(t)) r(e, t); else for (i in t) gt(e + "[" + i + "]", t[i], n, r) } w.param = function (e, t) { var n, r = [], i = function (e, t) { var n = g(t) ? t() : t; r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(null == n ? "" : n) }; if (Array.isArray(e) || e.jquery && !w.isPlainObject(e)) w.each(e, function () { i(this.name, this.value) }); else for (n in e) gt(n, e[n], t, i); return r.join("&") }, w.fn.extend({ serialize: function () { return w.param(this.serializeArray()) }, serializeArray: function () { return this.map(function () { var e = w.prop(this, "elements"); return e ? w.makeArray(e) : this }).filter(function () { var e = this.type; return this.name && !w(this).is(":disabled") && ht.test(this.nodeName) && !pt.test(e) && (this.checked || !de.test(e)) }).map(function (e, t) { var n = w(this).val(); return null == n ? null : Array.isArray(n) ? w.map(n, function (e) { return { name: t.name, value: e.replace(dt, "\r\n") } }) : { name: t.name, value: n.replace(dt, "\r\n") } }).get() } }), w.fn.extend({ wrapAll: function (e) { var t; return this[0] && (g(e) && (e = e.call(this[0])), t = w(e, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && t.insertBefore(this[0]), t.map(function () { var e = this; while (e.firstElementChild) e = e.firstElementChild; return e }).append(this)), this }, wrapInner: function (e) { return g(e) ? this.each(function (t) { w(this).wrapInner(e.call(this, t)) }) : this.each(function () { var t = w(this), n = t.contents(); n.length ? n.wrapAll(e) : t.append(e) }) }, wrap: function (e) { var t = g(e); return this.each(function (n) { w(this).wrapAll(t ? e.call(this, n) : e) }) }, unwrap: function (e) { return this.parent(e).not("body").each(function () { w(this).replaceWith(this.childNodes) }), this } }), w.expr.pseudos.hidden = function (e) { return !w.expr.pseudos.visible(e) }, w.expr.pseudos.visible = function (e) { return !!(e.offsetWidth || e.offsetHeight || e.getClientRects().length) }, h.createHTMLDocument = function () { var e = r.implementation.createHTMLDocument("").body; return e.innerHTML = "<form></form><form></form>", 2 === e.childNodes.length }(), w.parseHTML = function (e, t, n) { if ("string" != typeof e) return []; "boolean" == typeof t && (n = t, t = !1); var i, o, a; return t || (h.createHTMLDocument ? ((i = (t = r.implementation.createHTMLDocument("")).createElement("base")).href = r.location.href, t.head.appendChild(i)) : t = r), o = S.exec(e), a = !n && [], o ? [t.createElement(o[1])] : (o = be([e], t, a), a && a.length && w(a).remove(), w.merge([], o.childNodes)) }, w.offset = { setOffset: function (e, t, n) { var r, i, o, a, u, s, l, c = w.css(e, "position"), f = w(e), d = {}; "static" === c && (e.style.position = "relative"), u = f.offset(), o = w.css(e, "top"), s = w.css(e, "left"), (l = ("absolute" === c || "fixed" === c) && (o + s).indexOf("auto") > -1) ? (a = (r = f.position()).top, i = r.left) : (a = parseFloat(o) || 0, i = parseFloat(s) || 0), g(t) && (t = t.call(e, n, w.extend({}, u))), null != t.top && (d.top = t.top - u.top + a), null != t.left && (d.left = t.left - u.left + i), "using" in t ? t.using.call(e, d) : f.css(d) } }, w.fn.extend({ offset: function (e) { if (arguments.length) return void 0 === e ? this : this.each(function (t) { w.offset.setOffset(this, e, t) }); var t, n, r = this[0]; if (r) return r.getClientRects().length ? (t = r.getBoundingClientRect(), n = r.ownerDocument.defaultView, { top: t.top + n.pageYOffset, left: t.left + n.pageXOffset }) : { top: 0, left: 0 } }, position: function () { if (this[0]) { var e, t, n, r = this[0], i = { top: 0, left: 0 }; if ("fixed" === w.css(r, "position")) t = r.getBoundingClientRect(); else { t = this.offset(), n = r.ownerDocument, e = r.offsetParent || n.documentElement; while (e && (e === n.body || e === n.documentElement) && "static" === w.css(e, "position")) e = e.parentNode; e && e !== r && 1 === e.nodeType && ((i = w(e).offset()).top += w.css(e, "borderTopWidth", !0), i.left += w.css(e, "borderLeftWidth", !0)) } return { top: t.top - i.top - w.css(r, "marginTop", !0), left: t.left - i.left - w.css(r, "marginLeft", !0) } } }, offsetParent: function () { return this.map(function () { var e = this.offsetParent; while (e && "static" === w.css(e, "position")) e = e.offsetParent; return e || xe }) } }), w.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function (e, t) { var n = "pageYOffset" === t; w.fn[e] = function (r) { return _(this, function (e, r, i) { var o; if (v(e) ? o = e : 9 === e.nodeType && (o = e.defaultView), void 0 === i) return o ? o[t] : e[r]; o ? o.scrollTo(n ? o.pageXOffset : i, n ? i : o.pageYOffset) : e[r] = i }, e, r, arguments.length) } }), w.each(["top", "left"], function (e, t) { w.cssHooks[t] = ze(h.pixelPosition, function (e, n) { if (n) return n = Fe(e, t), Me.test(n) ? w(e).position()[t] + "px" : n }) }), w.each({ Height: "height", Width: "width" }, function (e, t) { w.each({ padding: "inner" + e, content: t, "": "outer" + e }, function (n, r) { w.fn[r] = function (i, o) { var a = arguments.length && (n || "boolean" != typeof i), u = n || (!0 === i || !0 === o ? "margin" : "border"); return _(this, function (t, n, i) { var o; return v(t) ? 0 === r.indexOf("outer") ? t["inner" + e] : t.document.documentElement["client" + e] : 9 === t.nodeType ? (o = t.documentElement, Math.max(t.body["scroll" + e], o["scroll" + e], t.body["offset" + e], o["offset" + e], o["client" + e])) : void 0 === i ? w.css(t, n, u) : w.style(t, n, i, u) }, t, a ? i : void 0, a) } }) }), w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "), function (e, t) { w.fn[t] = function (e, n) { return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t) } }), w.fn.extend({ hover: function (e, t) { return this.mouseenter(e).mouseleave(t || e) } }), w.fn.extend({ bind: function (e, t, n) { return this.on(e, null, t, n) }, unbind: function (e, t) { return this.off(e, null, t) }, delegate: function (e, t, n, r) { return this.on(t, e, n, r) }, undelegate: function (e, t, n) { return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n) } }), w.proxy = function (e, t) { var n, r, i; if ("string" == typeof t && (n = e[t], t = e, e = n), g(e)) return r = o.call(arguments, 2), i = function () { return e.apply(t || this, r.concat(o.call(arguments))) }, i.guid = e.guid = e.guid || w.guid++ , i }, w.holdReady = function (e) { e ? w.readyWait++ : w.ready(!0) }, w.isArray = Array.isArray, w.parseJSON = JSON.parse, w.nodeName = D, w.isFunction = g, w.isWindow = v, w.camelCase = Q, w.type = b, w.now = Date.now, w.isNumeric = function (e) { var t = w.type(e); return ("number" === t || "string" === t) && !isNaN(e - parseFloat(e)) }, "function" == typeof define && define.amd && define("jquery", [], function () { return w }); var vt = e.jQuery, yt = e.$; return w.noConflict = function (t) { return e.$ === w && (e.$ = yt), t && e.jQuery === w && (e.jQuery = vt), w }, t || (e.jQuery = e.$ = w), w });
jQuery.fn.extend({
    fadeIn: function(ms) {
        let elem = this;
        return new Promise(function (resolve, reject) {
            elem.css({
                'opacity': 0,
                'filter': 'alpha(opacity=0)',
                'display': 'block',
                'visibility': 'visible'
            });
            if (ms) {
                var opacity = 0;
                var timer = setInterval(function () {
                    opacity += 50 / ms;
                    if (opacity >= 1) {
                        clearInterval(timer);
                        opacity = 1;
                        resolve();
                    }
                    elem.css({
                        'opacity': opacity,
                        'filter': 'alpha(opacity=' + opacity * 100 + ')'
                    });
                }, 50);
            }
            else {
                elem.css({
                    'opacity': 1,
                    'filter': 'alpha(opacity=1)'
                });
                resolve();
            }
        })
    },
    fadeOut: function(ms) {
        let elem = this;
        return new Promise(function (resolve, reject) {
            if (ms) {
                var opacity = 1;
                var timer = setInterval(function () {
                    opacity -= 50 / ms;
                    if (opacity <= 0) {
                        clearInterval(timer);
                        opacity = 0;
                        elem.css({
                            'display': 'none',
                            'visibility': 'hidden'
                        });
                        resolve();
                    }
                    elem.css({
                        'opacity': opacity,
                        'filter': 'alpha(opacity=' + opacity * 100 + ')'
                    })
                }, 50);
            }
            else {
                elem.css({
                    'opacity': 0,
                    'filter': 'alpha(opacity=0)',
                    'display': 'none',
                    'visibility': 'hidden'
                });
                resolve();
            }
        })
    }
});

/*! jQuery Validation Plugin - v1.17.0 - 7/29/2017
 * https://jqueryvalidation.org/
 * Copyright (c) 2017 Jörn Zaefferer; Licensed MIT */
!function (a) { "function" == typeof define && define.amd ? define(["jquery"], a) : "object" == typeof module && module.exports ? module.exports = a(require("jquery")) : a(jQuery) }(function (a) { a.extend(a.fn, { validate: function (b) { if (!this.length) return void (b && b.debug && window.console && console.warn("Nothing selected, can't validate, returning nothing.")); var c = a.data(this[0], "validator"); return c ? c : (this.attr("novalidate", "novalidate"), c = new a.validator(b, this[0]), a.data(this[0], "validator", c), c.settings.onsubmit && (this.on("click.validate", ":submit", function (b) { c.submitButton = b.currentTarget, a(this).hasClass("cancel") && (c.cancelSubmit = !0), void 0 !== a(this).attr("formnovalidate") && (c.cancelSubmit = !0) }), this.on("submit.validate", function (b) { function d() { var d, e; return c.submitButton && (c.settings.submitHandler || c.formSubmitted) && (d = a("<input type='hidden'/>").attr("name", c.submitButton.name).val(a(c.submitButton).val()).appendTo(c.currentForm)), !c.settings.submitHandler || (e = c.settings.submitHandler.call(c, c.currentForm, b), d && d.remove(), void 0 !== e && e) } return c.settings.debug && b.preventDefault(), c.cancelSubmit ? (c.cancelSubmit = !1, d()) : c.form() ? c.pendingRequest ? (c.formSubmitted = !0, !1) : d() : (c.focusInvalid(), !1) })), c) }, valid: function () { var b, c, d; return a(this[0]).is("form") ? b = this.validate().form() : (d = [], b = !0, c = a(this[0].form).validate(), this.each(function () { b = c.element(this) && b, b || (d = d.concat(c.errorList)) }), c.errorList = d), b }, rules: function (b, c) { var d, e, f, g, h, i, j = this[0]; if (null != j && (!j.form && j.hasAttribute("contenteditable") && (j.form = this.closest("form")[0], j.name = this.attr("name")), null != j.form)) { if (b) switch (d = a.data(j.form, "validator").settings, e = d.rules, f = a.validator.staticRules(j), b) { case "add": a.extend(f, a.validator.normalizeRule(c)), delete f.messages, e[j.name] = f, c.messages && (d.messages[j.name] = a.extend(d.messages[j.name], c.messages)); break; case "remove": return c ? (i = {}, a.each(c.split(/\s/), function (a, b) { i[b] = f[b], delete f[b] }), i) : (delete e[j.name], f) }return g = a.validator.normalizeRules(a.extend({}, a.validator.classRules(j), a.validator.attributeRules(j), a.validator.dataRules(j), a.validator.staticRules(j)), j), g.required && (h = g.required, delete g.required, g = a.extend({ required: h }, g)), g.remote && (h = g.remote, delete g.remote, g = a.extend(g, { remote: h })), g } } }), a.extend(a.expr.pseudos || a.expr[":"], { blank: function (b) { return !a.trim("" + a(b).val()) }, filled: function (b) { var c = a(b).val(); return null !== c && !!a.trim("" + c) }, unchecked: function (b) { return !a(b).prop("checked") } }), a.validator = function (b, c) { this.settings = a.extend(!0, {}, a.validator.defaults, b), this.currentForm = c, this.init() }, a.validator.format = function (b, c) { return 1 === arguments.length ? function () { var c = a.makeArray(arguments); return c.unshift(b), a.validator.format.apply(this, c) } : void 0 === c ? b : (arguments.length > 2 && c.constructor !== Array && (c = a.makeArray(arguments).slice(1)), c.constructor !== Array && (c = [c]), a.each(c, function (a, c) { b = b.replace(new RegExp("\\{" + a + "\\}", "g"), function () { return c }) }), b) }, a.extend(a.validator, { defaults: { messages: {}, groups: {}, rules: {}, errorClass: "error", pendingClass: "pending", validClass: "valid", errorElement: "label", focusCleanup: !1, focusInvalid: !0, errorContainer: a([]), errorLabelContainer: a([]), onsubmit: !0, ignore: ":hidden", ignoreTitle: !1, onfocusin: function (a) { this.lastActive = a, this.settings.focusCleanup && (this.settings.unhighlight && this.settings.unhighlight.call(this, a, this.settings.errorClass, this.settings.validClass), this.hideThese(this.errorsFor(a))) }, onfocusout: function (a) { this.checkable(a) || !(a.name in this.submitted) && this.optional(a) || this.element(a) }, onkeyup: function (b, c) { var d = [16, 17, 18, 20, 35, 36, 37, 38, 39, 40, 45, 144, 225]; 9 === c.which && "" === this.elementValue(b) || a.inArray(c.keyCode, d) !== -1 || (b.name in this.submitted || b.name in this.invalid) && this.element(b) }, onclick: function (a) { a.name in this.submitted ? this.element(a) : a.parentNode.name in this.submitted && this.element(a.parentNode) }, highlight: function (b, c, d) { "radio" === b.type ? this.findByName(b.name).addClass(c).removeClass(d) : a(b).addClass(c).removeClass(d) }, unhighlight: function (b, c, d) { "radio" === b.type ? this.findByName(b.name).removeClass(c).addClass(d) : a(b).removeClass(c).addClass(d) } }, setDefaults: function (b) { a.extend(a.validator.defaults, b) }, messages: { required: "This field is required.", remote: "Please fix this field.", email: "Please enter a valid email address.", url: "Please enter a valid URL.", date: "Please enter a valid date.", dateISO: "Please enter a valid date (ISO).", number: "Please enter a valid number.", digits: "Please enter only digits.", equalTo: "Please enter the same value again.", maxlength: a.validator.format("Please enter no more than {0} characters."), minlength: a.validator.format("Please enter at least {0} characters."), rangelength: a.validator.format("Please enter a value between {0} and {1} characters long."), range: a.validator.format("Please enter a value between {0} and {1}."), max: a.validator.format("Please enter a value less than or equal to {0}."), min: a.validator.format("Please enter a value greater than or equal to {0}."), step: a.validator.format("Please enter a multiple of {0}.") }, autoCreateRanges: !1, prototype: { init: function () { function b(b) { !this.form && this.hasAttribute("contenteditable") && (this.form = a(this).closest("form")[0], this.name = a(this).attr("name")); var c = a.data(this.form, "validator"), d = "on" + b.type.replace(/^validate/, ""), e = c.settings; e[d] && !a(this).is(e.ignore) && e[d].call(c, this, b) } this.labelContainer = a(this.settings.errorLabelContainer), this.errorContext = this.labelContainer.length && this.labelContainer || a(this.currentForm), this.containers = a(this.settings.errorContainer).add(this.settings.errorLabelContainer), this.submitted = {}, this.valueCache = {}, this.pendingRequest = 0, this.pending = {}, this.invalid = {}, this.reset(); var c, d = this.groups = {}; a.each(this.settings.groups, function (b, c) { "string" == typeof c && (c = c.split(/\s/)), a.each(c, function (a, c) { d[c] = b }) }), c = this.settings.rules, a.each(c, function (b, d) { c[b] = a.validator.normalizeRule(d) }), a(this.currentForm).on("focusin.validate focusout.validate keyup.validate", ":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']", b).on("click.validate", "select, option, [type='radio'], [type='checkbox']", b), this.settings.invalidHandler && a(this.currentForm).on("invalid-form.validate", this.settings.invalidHandler) }, form: function () { return this.checkForm(), a.extend(this.submitted, this.errorMap), this.invalid = a.extend({}, this.errorMap), this.valid() || a(this.currentForm).triggerHandler("invalid-form", [this]), this.showErrors(), this.valid() }, checkForm: function () { this.prepareForm(); for (var a = 0, b = this.currentElements = this.elements(); b[a]; a++)this.check(b[a]); return this.valid() }, element: function (b) { var c, d, e = this.clean(b), f = this.validationTargetFor(e), g = this, h = !0; return void 0 === f ? delete this.invalid[e.name] : (this.prepareElement(f), this.currentElements = a(f), d = this.groups[f.name], d && a.each(this.groups, function (a, b) { b === d && a !== f.name && (e = g.validationTargetFor(g.clean(g.findByName(a))), e && e.name in g.invalid && (g.currentElements.push(e), h = g.check(e) && h)) }), c = this.check(f) !== !1, h = h && c, c ? this.invalid[f.name] = !1 : this.invalid[f.name] = !0, this.numberOfInvalids() || (this.toHide = this.toHide.add(this.containers)), this.showErrors(), a(b).attr("aria-invalid", !c)), h }, showErrors: function (b) { if (b) { var c = this; a.extend(this.errorMap, b), this.errorList = a.map(this.errorMap, function (a, b) { return { message: a, element: c.findByName(b)[0] } }), this.successList = a.grep(this.successList, function (a) { return !(a.name in b) }) } this.settings.showErrors ? this.settings.showErrors.call(this, this.errorMap, this.errorList) : this.defaultShowErrors() }, resetForm: function () { a.fn.resetForm && a(this.currentForm).resetForm(), this.invalid = {}, this.submitted = {}, this.prepareForm(), this.hideErrors(); var b = this.elements().removeData("previousValue").removeAttr("aria-invalid"); this.resetElements(b) }, resetElements: function (a) { var b; if (this.settings.unhighlight) for (b = 0; a[b]; b++)this.settings.unhighlight.call(this, a[b], this.settings.errorClass, ""), this.findByName(a[b].name).removeClass(this.settings.validClass); else a.removeClass(this.settings.errorClass).removeClass(this.settings.validClass) }, numberOfInvalids: function () { return this.objectLength(this.invalid) }, objectLength: function (a) { var b, c = 0; for (b in a) void 0 !== a[b] && null !== a[b] && a[b] !== !1 && c++; return c }, hideErrors: function () { this.hideThese(this.toHide) }, hideThese: function (a) { a.not(this.containers).text(""), this.addWrapper(a).hide() }, valid: function () { return 0 === this.size() }, size: function () { return this.errorList.length }, focusInvalid: function () { if (this.settings.focusInvalid) try { a(this.findLastActive() || this.errorList.length && this.errorList[0].element || []).filter(":visible").focus().trigger("focusin") } catch (b) { } }, findLastActive: function () { var b = this.lastActive; return b && 1 === a.grep(this.errorList, function (a) { return a.element.name === b.name }).length && b }, elements: function () { var b = this, c = {}; return a(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function () { var d = this.name || a(this).attr("name"); return !d && b.settings.debug && window.console && console.error("%o has no name assigned", this), this.hasAttribute("contenteditable") && (this.form = a(this).closest("form")[0], this.name = d), !(d in c || !b.objectLength(a(this).rules())) && (c[d] = !0, !0) }) }, clean: function (b) { return a(b)[0] }, errors: function () { var b = this.settings.errorClass.split(" ").join("."); return a(this.settings.errorElement + "." + b, this.errorContext) }, resetInternals: function () { this.successList = [], this.errorList = [], this.errorMap = {}, this.toShow = a([]), this.toHide = a([]) }, reset: function () { this.resetInternals(), this.currentElements = a([]) }, prepareForm: function () { this.reset(), this.toHide = this.errors().add(this.containers) }, prepareElement: function (a) { this.reset(), this.toHide = this.errorsFor(a) }, elementValue: function (b) { var c, d, e = a(b), f = b.type; return "radio" === f || "checkbox" === f ? this.findByName(b.name).filter(":checked").val() : "number" === f && "undefined" != typeof b.validity ? b.validity.badInput ? "NaN" : e.val() : (c = b.hasAttribute("contenteditable") ? e.text() : e.val(), "file" === f ? "C:\\fakepath\\" === c.substr(0, 12) ? c.substr(12) : (d = c.lastIndexOf("/"), d >= 0 ? c.substr(d + 1) : (d = c.lastIndexOf("\\"), d >= 0 ? c.substr(d + 1) : c)) : "string" == typeof c ? c.replace(/\r/g, "") : c) }, check: function (b) { b = this.validationTargetFor(this.clean(b)); var c, d, e, f, g = a(b).rules(), h = a.map(g, function (a, b) { return b }).length, i = !1, j = this.elementValue(b); if ("function" == typeof g.normalizer ? f = g.normalizer : "function" == typeof this.settings.normalizer && (f = this.settings.normalizer), f) { if (j = f.call(b, j), "string" != typeof j) throw new TypeError("The normalizer should return a string value."); delete g.normalizer } for (d in g) { e = { method: d, parameters: g[d] }; try { if (c = a.validator.methods[d].call(this, j, b, e.parameters), "dependency-mismatch" === c && 1 === h) { i = !0; continue } if (i = !1, "pending" === c) return void (this.toHide = this.toHide.not(this.errorsFor(b))); if (!c) return this.formatAndAdd(b, e), !1 } catch (k) { throw this.settings.debug && window.console && console.log("Exception occurred when checking element " + b.id + ", check the '" + e.method + "' method.", k), k instanceof TypeError && (k.message += ".  Exception occurred when checking element " + b.id + ", check the '" + e.method + "' method."), k } } if (!i) return this.objectLength(g) && this.successList.push(b), !0 }, customDataMessage: function (b, c) { return a(b).data("msg" + c.charAt(0).toUpperCase() + c.substring(1).toLowerCase()) || a(b).data("msg") }, customMessage: function (a, b) { var c = this.settings.messages[a]; return c && (c.constructor === String ? c : c[b]) }, findDefined: function () { for (var a = 0; a < arguments.length; a++)if (void 0 !== arguments[a]) return arguments[a] }, defaultMessage: function (b, c) { "string" == typeof c && (c = { method: c }); var d = this.findDefined(this.customMessage(b.name, c.method), this.customDataMessage(b, c.method), !this.settings.ignoreTitle && b.title || void 0, a.validator.messages[c.method], "<strong>Warning: No message defined for " + b.name + "</strong>"), e = /\$?\{(\d+)\}/g; return "function" == typeof d ? d = d.call(this, c.parameters, b) : e.test(d) && (d = a.validator.format(d.replace(e, "{$1}"), c.parameters)), d }, formatAndAdd: function (a, b) { var c = this.defaultMessage(a, b); this.errorList.push({ message: c, element: a, method: b.method }), this.errorMap[a.name] = c, this.submitted[a.name] = c }, addWrapper: function (a) { return this.settings.wrapper && (a = a.add(a.parent(this.settings.wrapper))), a }, defaultShowErrors: function () { var a, b, c; for (a = 0; this.errorList[a]; a++)c = this.errorList[a], this.settings.highlight && this.settings.highlight.call(this, c.element, this.settings.errorClass, this.settings.validClass), this.showLabel(c.element, c.message); if (this.errorList.length && (this.toShow = this.toShow.add(this.containers)), this.settings.success) for (a = 0; this.successList[a]; a++)this.showLabel(this.successList[a]); if (this.settings.unhighlight) for (a = 0, b = this.validElements(); b[a]; a++)this.settings.unhighlight.call(this, b[a], this.settings.errorClass, this.settings.validClass); this.toHide = this.toHide.not(this.toShow), this.hideErrors(), this.addWrapper(this.toShow).show() }, validElements: function () { return this.currentElements.not(this.invalidElements()) }, invalidElements: function () { return a(this.errorList).map(function () { return this.element }) }, showLabel: function (b, c) { var d, e, f, g, h = this.errorsFor(b), i = this.idOrName(b), j = a(b).attr("aria-describedby"); h.length ? (h.removeClass(this.settings.validClass).addClass(this.settings.errorClass), h.html(c)) : (h = a("<" + this.settings.errorElement + ">").attr("id", i + "-error").addClass(this.settings.errorClass).html(c || ""), d = h, this.settings.wrapper && (d = h.hide().show().wrap("<" + this.settings.wrapper + "/>").parent()), this.labelContainer.length ? this.labelContainer.append(d) : this.settings.errorPlacement ? this.settings.errorPlacement.call(this, d, a(b)) : d.insertAfter(b), h.is("label") ? h.attr("for", i) : 0 === h.parents("label[for='" + this.escapeCssMeta(i) + "']").length && (f = h.attr("id"), j ? j.match(new RegExp("\\b" + this.escapeCssMeta(f) + "\\b")) || (j += " " + f) : j = f, a(b).attr("aria-describedby", j), e = this.groups[b.name], e && (g = this, a.each(g.groups, function (b, c) { c === e && a("[name='" + g.escapeCssMeta(b) + "']", g.currentForm).attr("aria-describedby", h.attr("id")) })))), !c && this.settings.success && (h.text(""), "string" == typeof this.settings.success ? h.addClass(this.settings.success) : this.settings.success(h, b)), this.toShow = this.toShow.add(h) }, errorsFor: function (b) { var c = this.escapeCssMeta(this.idOrName(b)), d = a(b).attr("aria-describedby"), e = "label[for='" + c + "'], label[for='" + c + "'] *"; return d && (e = e + ", #" + this.escapeCssMeta(d).replace(/\s+/g, ", #")), this.errors().filter(e) }, escapeCssMeta: function (a) { return a.replace(/([\\!"#$%&'()*+,.\/:;<=>?@\[\]^`{|}~])/g, "\\$1") }, idOrName: function (a) { return this.groups[a.name] || (this.checkable(a) ? a.name : a.id || a.name) }, validationTargetFor: function (b) { return this.checkable(b) && (b = this.findByName(b.name)), a(b).not(this.settings.ignore)[0] }, checkable: function (a) { return /radio|checkbox/i.test(a.type) }, findByName: function (b) { return a(this.currentForm).find("[name='" + this.escapeCssMeta(b) + "']") }, getLength: function (b, c) { switch (c.nodeName.toLowerCase()) { case "select": return a("option:selected", c).length; case "input": if (this.checkable(c)) return this.findByName(c.name).filter(":checked").length }return b.length }, depend: function (a, b) { return !this.dependTypes[typeof a] || this.dependTypes[typeof a](a, b) }, dependTypes: { "boolean": function (a) { return a }, string: function (b, c) { return !!a(b, c.form).length }, "function": function (a, b) { return a(b) } }, optional: function (b) { var c = this.elementValue(b); return !a.validator.methods.required.call(this, c, b) && "dependency-mismatch" }, startRequest: function (b) { this.pending[b.name] || (this.pendingRequest++ , a(b).addClass(this.settings.pendingClass), this.pending[b.name] = !0) }, stopRequest: function (b, c) { this.pendingRequest-- , this.pendingRequest < 0 && (this.pendingRequest = 0), delete this.pending[b.name], a(b).removeClass(this.settings.pendingClass), c && 0 === this.pendingRequest && this.formSubmitted && this.form() ? (a(this.currentForm).submit(), this.submitButton && a("input:hidden[name='" + this.submitButton.name + "']", this.currentForm).remove(), this.formSubmitted = !1) : !c && 0 === this.pendingRequest && this.formSubmitted && (a(this.currentForm).triggerHandler("invalid-form", [this]), this.formSubmitted = !1) }, previousValue: function (b, c) { return c = "string" == typeof c && c || "remote", a.data(b, "previousValue") || a.data(b, "previousValue", { old: null, valid: !0, message: this.defaultMessage(b, { method: c }) }) }, destroy: function () { this.resetForm(), a(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur") } }, classRuleSettings: { required: { required: !0 }, email: { email: !0 }, url: { url: !0 }, date: { date: !0 }, dateISO: { dateISO: !0 }, number: { number: !0 }, digits: { digits: !0 }, creditcard: { creditcard: !0 } }, addClassRules: function (b, c) { b.constructor === String ? this.classRuleSettings[b] = c : a.extend(this.classRuleSettings, b) }, classRules: function (b) { var c = {}, d = a(b).attr("class"); return d && a.each(d.split(" "), function () { this in a.validator.classRuleSettings && a.extend(c, a.validator.classRuleSettings[this]) }), c }, normalizeAttributeRule: function (a, b, c, d) { /min|max|step/.test(c) && (null === b || /number|range|text/.test(b)) && (d = Number(d), isNaN(d) && (d = void 0)), d || 0 === d ? a[c] = d : b === c && "range" !== b && (a[c] = !0) }, attributeRules: function (b) { var c, d, e = {}, f = a(b), g = b.getAttribute("type"); for (c in a.validator.methods) "required" === c ? (d = b.getAttribute(c), "" === d && (d = !0), d = !!d) : d = f.attr(c), this.normalizeAttributeRule(e, g, c, d); return e.maxlength && /-1|2147483647|524288/.test(e.maxlength) && delete e.maxlength, e }, dataRules: function (b) { var c, d, e = {}, f = a(b), g = b.getAttribute("type"); for (c in a.validator.methods) d = f.data("rule" + c.charAt(0).toUpperCase() + c.substring(1).toLowerCase()), this.normalizeAttributeRule(e, g, c, d); return e }, staticRules: function (b) { var c = {}, d = a.data(b.form, "validator"); return d.settings.rules && (c = a.validator.normalizeRule(d.settings.rules[b.name]) || {}), c }, normalizeRules: function (b, c) { return a.each(b, function (d, e) { if (e === !1) return void delete b[d]; if (e.param || e.depends) { var f = !0; switch (typeof e.depends) { case "string": f = !!a(e.depends, c.form).length; break; case "function": f = e.depends.call(c, c) }f ? b[d] = void 0 === e.param || e.param : (a.data(c.form, "validator").resetElements(a(c)), delete b[d]) } }), a.each(b, function (d, e) { b[d] = a.isFunction(e) && "normalizer" !== d ? e(c) : e }), a.each(["minlength", "maxlength"], function () { b[this] && (b[this] = Number(b[this])) }), a.each(["rangelength", "range"], function () { var c; b[this] && (a.isArray(b[this]) ? b[this] = [Number(b[this][0]), Number(b[this][1])] : "string" == typeof b[this] && (c = b[this].replace(/[\[\]]/g, "").split(/[\s,]+/), b[this] = [Number(c[0]), Number(c[1])])) }), a.validator.autoCreateRanges && (null != b.min && null != b.max && (b.range = [b.min, b.max], delete b.min, delete b.max), null != b.minlength && null != b.maxlength && (b.rangelength = [b.minlength, b.maxlength], delete b.minlength, delete b.maxlength)), b }, normalizeRule: function (b) { if ("string" == typeof b) { var c = {}; a.each(b.split(/\s/), function () { c[this] = !0 }), b = c } return b }, addMethod: function (b, c, d) { a.validator.methods[b] = c, a.validator.messages[b] = void 0 !== d ? d : a.validator.messages[b], c.length < 3 && a.validator.addClassRules(b, a.validator.normalizeRule(b)) }, methods: { required: function (b, c, d) { if (!this.depend(d, c)) return "dependency-mismatch"; if ("select" === c.nodeName.toLowerCase()) { var e = a(c).val(); return e && e.length > 0 } return this.checkable(c) ? this.getLength(b, c) > 0 : b.length > 0 }, email: function (a, b) { return this.optional(b) || /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(a) }, url: function (a, b) { return this.optional(b) || /^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(a) }, date: function (a, b) { return this.optional(b) || !/Invalid|NaN/.test(new Date(a).toString()) }, dateISO: function (a, b) { return this.optional(b) || /^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(a) }, number: function (a, b) { return this.optional(b) || /^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(a) }, digits: function (a, b) { return this.optional(b) || /^\d+$/.test(a) }, minlength: function (b, c, d) { var e = a.isArray(b) ? b.length : this.getLength(b, c); return this.optional(c) || e >= d }, maxlength: function (b, c, d) { var e = a.isArray(b) ? b.length : this.getLength(b, c); return this.optional(c) || e <= d }, rangelength: function (b, c, d) { var e = a.isArray(b) ? b.length : this.getLength(b, c); return this.optional(c) || e >= d[0] && e <= d[1] }, min: function (a, b, c) { return this.optional(b) || a >= c }, max: function (a, b, c) { return this.optional(b) || a <= c }, range: function (a, b, c) { return this.optional(b) || a >= c[0] && a <= c[1] }, step: function (b, c, d) { var e, f = a(c).attr("type"), g = "Step attribute on input type " + f + " is not supported.", h = ["text", "number", "range"], i = new RegExp("\\b" + f + "\\b"), j = f && !i.test(h.join()), k = function (a) { var b = ("" + a).match(/(?:\.(\d+))?$/); return b && b[1] ? b[1].length : 0 }, l = function (a) { return Math.round(a * Math.pow(10, e)) }, m = !0; if (j) throw new Error(g); return e = k(d), (k(b) > e || l(b) % l(d) !== 0) && (m = !1), this.optional(c) || m }, equalTo: function (b, c, d) { var e = a(d); return this.settings.onfocusout && e.not(".validate-equalTo-blur").length && e.addClass("validate-equalTo-blur").on("blur.validate-equalTo", function () { a(c).valid() }), b === e.val() }, remote: function (b, c, d, e) { if (this.optional(c)) return "dependency-mismatch"; e = "string" == typeof e && e || "remote"; var f, g, h, i = this.previousValue(c, e); return this.settings.messages[c.name] || (this.settings.messages[c.name] = {}), i.originalMessage = i.originalMessage || this.settings.messages[c.name][e], this.settings.messages[c.name][e] = i.message, d = "string" == typeof d && { url: d } || d, h = a.param(a.extend({ data: b }, d.data)), i.old === h ? i.valid : (i.old = h, f = this, this.startRequest(c), g = {}, g[c.name] = b, a.ajax(a.extend(!0, { mode: "abort", port: "validate" + c.name, dataType: "json", data: g, context: f.currentForm, success: function (a) { var d, g, h, j = a === !0 || "true" === a; f.settings.messages[c.name][e] = i.originalMessage, j ? (h = f.formSubmitted, f.resetInternals(), f.toHide = f.errorsFor(c), f.formSubmitted = h, f.successList.push(c), f.invalid[c.name] = !1, f.showErrors()) : (d = {}, g = a || f.defaultMessage(c, { method: e, parameters: b }), d[c.name] = i.message = g, f.invalid[c.name] = !0, f.showErrors(d)), i.valid = j, f.stopRequest(c, j) } }, d)), "pending") } } }); var b, c = {}; return a.ajaxPrefilter ? a.ajaxPrefilter(function (a, b, d) { var e = a.port; "abort" === a.mode && (c[e] && c[e].abort(), c[e] = d) }) : (b = a.ajax, a.ajax = function (d) { var e = ("mode" in d ? d : a.ajaxSettings).mode, f = ("port" in d ? d : a.ajaxSettings).port; return "abort" === e ? (c[f] && c[f].abort(), c[f] = b.apply(this, arguments), c[f]) : b.apply(this, arguments) }), a });
/*! jQuery & Zepto Lazy v1.7.6 - http://jquery.eisbehr.de/lazy - MIT&GPL-2.0 license - Copyright 2012-2017 Daniel 'Eisbehr' Kern */
!function (t, e) { "use strict"; function r(r, a, i, u, l) { function f() { L = t.devicePixelRatio > 1, i = c(i), a.delay >= 0 && setTimeout(function () { s(!0) }, a.delay), (a.delay < 0 || a.combined) && (u.e = v(a.throttle, function (t) { "resize" === t.type && (w = B = -1), s(t.all) }), u.a = function (t) { t = c(t), i.push.apply(i, t) }, u.g = function () { return i = n(i).filter(function () { return !n(this).data(a.loadedName) }) }, u.f = function (t) { for (var e = 0; e < t.length; e++) { var r = i.filter(function () { return this === t[e] }); r.length && s(!1, r) } }, s(), n(a.appendScroll).on("scroll." + l + " resize." + l, u.e)) } function c(t) { var i = a.defaultImage, o = a.placeholder, u = a.imageBase, l = a.srcsetAttribute, f = a.loaderAttribute, c = a._f || {}; t = n(t).filter(function () { var t = n(this), r = m(this); return !t.data(a.handledName) && (t.attr(a.attribute) || t.attr(l) || t.attr(f) || c[r] !== e) }).data("plugin_" + a.name, r); for (var s = 0, d = t.length; s < d; s++) { var A = n(t[s]), g = m(t[s]), h = A.attr(a.imageBaseAttribute) || u; g === N && h && A.attr(l) && A.attr(l, b(A.attr(l), h)), c[g] === e || A.attr(f) || A.attr(f, c[g]), g === N && i && !A.attr(E) ? A.attr(E, i) : g === N || !o || A.css(O) && "none" !== A.css(O) || A.css(O, "url('" + o + "')") } return t } function s(t, e) { if (!i.length) return void (a.autoDestroy && r.destroy()); for (var o = e || i, u = !1, l = a.imageBase || "", f = a.srcsetAttribute, c = a.handledName, s = 0; s < o.length; s++)if (t || e || A(o[s])) { var g = n(o[s]), h = m(o[s]), b = g.attr(a.attribute), v = g.attr(a.imageBaseAttribute) || l, p = g.attr(a.loaderAttribute); g.data(c) || a.visibleOnly && !g.is(":visible") || !((b || g.attr(f)) && (h === N && (v + b !== g.attr(E) || g.attr(f) !== g.attr(F)) || h !== N && v + b !== g.css(O)) || p) || (u = !0, g.data(c, !0), d(g, h, v, p)) } u && (i = n(i).filter(function () { return !n(this).data(c) })) } function d(t, e, r, i) { ++z; var o = function () { y("onError", t), p(), o = n.noop }; y("beforeLoad", t); var u = a.attribute, l = a.srcsetAttribute, f = a.sizesAttribute, c = a.retinaAttribute, s = a.removeAttribute, d = a.loadedName, A = t.attr(c); if (i) { var g = function () { s && t.removeAttr(a.loaderAttribute), t.data(d, !0), y(T, t), setTimeout(p, 1), g = n.noop }; t.off(I).one(I, o).one(D, g), y(i, t, function (e) { e ? (t.off(D), g()) : (t.off(I), o()) }) || t.trigger(I) } else { var h = n(new Image); h.one(I, o).one(D, function () { t.hide(), e === N ? t.attr(C, h.attr(C)).attr(F, h.attr(F)).attr(E, h.attr(E)) : t.css(O, "url('" + h.attr(E) + "')"), t[a.effect](a.effectTime), s && (t.removeAttr(u + " " + l + " " + c + " " + a.imageBaseAttribute), f !== C && t.removeAttr(f)), t.data(d, !0), y(T, t), h.remove(), p() }); var m = (L && A ? A : t.attr(u)) || ""; h.attr(C, t.attr(f)).attr(F, t.attr(l)).attr(E, m ? r + m : null), h.complete && h.trigger(D) } } function A(t) { var e = t.getBoundingClientRect(), r = a.scrollDirection, n = a.threshold, i = h() + n > e.top && -n < e.bottom, o = g() + n > e.left && -n < e.right; return "vertical" === r ? i : "horizontal" === r ? o : i && o } function g() { return w >= 0 ? w : w = n(t).width() } function h() { return B >= 0 ? B : B = n(t).height() } function m(t) { return t.tagName.toLowerCase() } function b(t, e) { if (e) { var r = t.split(","); t = ""; for (var a = 0, n = r.length; a < n; a++)t += e + r[a].trim() + (a !== n - 1 ? "," : "") } return t } function v(t, e) { var n, i = 0; return function (o, u) { function l() { i = +new Date, e.call(r, o) } var f = +new Date - i; n && clearTimeout(n), f > t || !a.enableThrottle || u ? l() : n = setTimeout(l, t - f) } } function p() { --z, i.length || z || y("onFinishedAll") } function y(t, e, n) { return !!(t = a[t]) && (t.apply(r, [].slice.call(arguments, 1)), !0) } var z = 0, w = -1, B = -1, L = !1, T = "afterLoad", D = "load", I = "error", N = "img", E = "src", F = "srcset", C = "sizes", O = "background-image"; "event" === a.bind || o ? f() : n(t).on(D + "." + l, f) } function a(a, o) { var u = this, l = n.extend({}, u.config, o), f = {}, c = l.name + "-" + ++i; return u.config = function (t, r) { return r === e ? l[t] : (l[t] = r, u) }, u.addItems = function (t) { return f.a && f.a("string" === n.type(t) ? n(t) : t), u }, u.getItems = function () { return f.g ? f.g() : {} }, u.update = function (t) { return f.e && f.e({}, !t), u }, u.force = function (t) { return f.f && f.f("string" === n.type(t) ? n(t) : t), u }, u.loadAll = function () { return f.e && f.e({ all: !0 }, !0), u }, u.destroy = function () { return n(l.appendScroll).off("." + c, f.e), n(t).off("." + c), f = {}, e }, r(u, l, a, f, c), l.chainable ? a : u } var n = t.jQuery || t.Zepto, i = 0, o = !1; n.fn.Lazy = n.fn.lazy = function (t) { return new a(this, t) }, n.Lazy = n.lazy = function (t, r, i) { if (n.isFunction(r) && (i = r, r = []), n.isFunction(i)) { t = n.isArray(t) ? t : [t], r = n.isArray(r) ? r : [r]; for (var o = a.prototype.config, u = o._f || (o._f = {}), l = 0, f = t.length; l < f; l++)(o[t[l]] === e || n.isFunction(o[t[l]])) && (o[t[l]] = i); for (var c = 0, s = r.length; c < s; c++)u[r[c]] = t[0] } }, a.prototype.config = { name: "lazy", chainable: !0, autoDestroy: !0, bind: "load", threshold: 500, visibleOnly: !1, appendScroll: t, scrollDirection: "both", imageBase: null, defaultImage: "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==", placeholder: null, delay: -1, combined: !1, attribute: "data-src", srcsetAttribute: "data-srcset", sizesAttribute: "data-sizes", retinaAttribute: "data-retina", loaderAttribute: "data-loader", imageBaseAttribute: "data-imagebase", removeAttribute: !0, handledName: "handled", loadedName: "loaded", effect: "show", effectTime: 0, enableThrottle: !0, throttle: 250, beforeLoad: e, afterLoad: e, onError: e, onFinishedAll: e }, n(t).on("load", function () { o = !0 }) }(window);
/*! tooltipster v4.2.5 */!function (a, b) { "function" == typeof define && define.amd ? define(["jquery"], function (a) { return b(a) }) : "object" == typeof exports ? module.exports = b(require("jquery")) : b(jQuery) }(this, function (a) {
    function b(a) { this.$container, this.constraints = null, this.__$tooltip, this.__init(a) } function c(b, c) { var d = !0; return a.each(b, function (a, e) { return void 0 === c[a] || b[a] !== c[a] ? (d = !1, !1) : void 0 }), d } function d(b) { var c = b.attr("id"), d = c ? h.window.document.getElementById(c) : null; return d ? d === b[0] : a.contains(h.window.document.body, b[0]) } function e() { if (!g) return !1; var a = g.document.body || g.document.documentElement, b = a.style, c = "transition", d = ["Moz", "Webkit", "Khtml", "O", "ms"]; if ("string" == typeof b[c]) return !0; c = c.charAt(0).toUpperCase() + c.substr(1); for (var e = 0; e < d.length; e++)if ("string" == typeof b[d[e] + c]) return !0; return !1 } var f = { animation: "fade", animationDuration: 350, content: null, contentAsHTML: !1, contentCloning: !1, debug: !0, delay: 300, delayTouch: [300, 500], functionInit: null, functionBefore: null, functionReady: null, functionAfter: null, functionFormat: null, IEmin: 6, interactive: !1, multiple: !1, parent: null, plugins: ["sideTip"], repositionOnScroll: !1, restoration: "none", selfDestruction: !0, theme: [], timer: 0, trackerInterval: 500, trackOrigin: !1, trackTooltip: !1, trigger: "hover", triggerClose: { click: !1, mouseleave: !1, originClick: !1, scroll: !1, tap: !1, touchleave: !1 }, triggerOpen: { click: !1, mouseenter: !1, tap: !1, touchstart: !1 }, updateAnimation: "rotate", zIndex: 9999999 }, g = "undefined" != typeof window ? window : null, h = { hasTouchCapability: !(!g || !("ontouchstart" in g || g.DocumentTouch && g.document instanceof g.DocumentTouch || g.navigator.maxTouchPoints)), hasTransitions: e(), IE: !1, semVer: "4.2.5", window: g }, i = function () { this.__$emitterPrivate = a({}), this.__$emitterPublic = a({}), this.__instancesLatestArr = [], this.__plugins = {}, this._env = h }; i.prototype = { __bridge: function (b, c, d) { if (!c[d]) { var e = function () { }; e.prototype = b; var g = new e; g.__init && g.__init(c), a.each(b, function (a, b) { 0 != a.indexOf("__") && (c[a] ? f.debug && console.log("The " + a + " method of the " + d + " plugin conflicts with another plugin or native methods") : (c[a] = function () { return g[a].apply(g, Array.prototype.slice.apply(arguments)) }, c[a].bridged = g)) }), c[d] = g } return this }, __setWindow: function (a) { return h.window = a, this }, _getRuler: function (a) { return new b(a) }, _off: function () { return this.__$emitterPrivate.off.apply(this.__$emitterPrivate, Array.prototype.slice.apply(arguments)), this }, _on: function () { return this.__$emitterPrivate.on.apply(this.__$emitterPrivate, Array.prototype.slice.apply(arguments)), this }, _one: function () { return this.__$emitterPrivate.one.apply(this.__$emitterPrivate, Array.prototype.slice.apply(arguments)), this }, _plugin: function (b) { var c = this; if ("string" == typeof b) { var d = b, e = null; return d.indexOf(".") > 0 ? e = c.__plugins[d] : a.each(c.__plugins, function (a, b) { return b.name.substring(b.name.length - d.length - 1) == "." + d ? (e = b, !1) : void 0 }), e } if (b.name.indexOf(".") < 0) throw new Error("Plugins must be namespaced"); return c.__plugins[b.name] = b, b.core && c.__bridge(b.core, c, b.name), this }, _trigger: function () { var a = Array.prototype.slice.apply(arguments); return "string" == typeof a[0] && (a[0] = { type: a[0] }), this.__$emitterPrivate.trigger.apply(this.__$emitterPrivate, a), this.__$emitterPublic.trigger.apply(this.__$emitterPublic, a), this }, instances: function (b) { var c = [], d = b || ".tooltipstered"; return a(d).each(function () { var b = a(this), d = b.data("tooltipster-ns"); d && a.each(d, function (a, d) { c.push(b.data(d)) }) }), c }, instancesLatest: function () { return this.__instancesLatestArr }, off: function () { return this.__$emitterPublic.off.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this }, on: function () { return this.__$emitterPublic.on.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this }, one: function () { return this.__$emitterPublic.one.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this }, origins: function (b) { var c = b ? b + " " : ""; return a(c + ".tooltipstered").toArray() }, setDefaults: function (b) { return a.extend(f, b), this }, triggerHandler: function () { return this.__$emitterPublic.triggerHandler.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this } }, a.tooltipster = new i, a.Tooltipster = function (b, c) { this.__callbacks = { close: [], open: [] }, this.__closingTime, this.__Content, this.__contentBcr, this.__destroyed = !1, this.__$emitterPrivate = a({}), this.__$emitterPublic = a({}), this.__enabled = !0, this.__garbageCollector, this.__Geometry, this.__lastPosition, this.__namespace = "tooltipster-" + Math.round(1e6 * Math.random()), this.__options, this.__$originParents, this.__pointerIsOverOrigin = !1, this.__previousThemes = [], this.__state = "closed", this.__timeouts = { close: [], open: null }, this.__touchEvents = [], this.__tracker = null, this._$origin, this._$tooltip, this.__init(b, c) }, a.Tooltipster.prototype = { __init: function (b, c) { var d = this; if (d._$origin = a(b), d.__options = a.extend(!0, {}, f, c), d.__optionsFormat(), !h.IE || h.IE >= d.__options.IEmin) { var e = null; if (void 0 === d._$origin.data("tooltipster-initialTitle") && (e = d._$origin.attr("title"), void 0 === e && (e = null), d._$origin.data("tooltipster-initialTitle", e)), null !== d.__options.content) d.__contentSet(d.__options.content); else { var g, i = d._$origin.attr("data-tooltip-content"); i && (g = a(i)), g && g[0] ? d.__contentSet(g.first()) : d.__contentSet(e) } d._$origin.removeAttr("title").addClass("tooltipstered"), d.__prepareOrigin(), d.__prepareGC(), a.each(d.__options.plugins, function (a, b) { d._plug(b) }), h.hasTouchCapability && a(h.window.document.body).on("touchmove." + d.__namespace + "-triggerOpen", function (a) { d._touchRecordEvent(a) }), d._on("created", function () { d.__prepareTooltip() })._on("repositioned", function (a) { d.__lastPosition = a.position }) } else d.__options.disabled = !0 }, __contentInsert: function () { var a = this, b = a._$tooltip.find(".tooltipster-content"), c = a.__Content, d = function (a) { c = a }; return a._trigger({ type: "format", content: a.__Content, format: d }), a.__options.functionFormat && (c = a.__options.functionFormat.call(a, a, { origin: a._$origin[0] }, a.__Content)), "string" != typeof c || a.__options.contentAsHTML ? b.empty().append(c) : b.text(c), a }, __contentSet: function (b) { return b instanceof a && this.__options.contentCloning && (b = b.clone(!0)), this.__Content = b, this._trigger({ type: "updated", content: b }), this }, __destroyError: function () { throw new Error("This tooltip has been destroyed and cannot execute your method call.") }, __geometry: function () { var b = this, c = b._$origin, d = b._$origin.is("area"); if (d) { var e = b._$origin.parent().attr("name"); c = a('img[usemap="#' + e + '"]') } var f = c[0].getBoundingClientRect(), g = a(h.window.document), i = a(h.window), j = c, k = { available: { document: null, window: null }, document: { size: { height: g.height(), width: g.width() } }, window: { scroll: { left: h.window.scrollX || h.window.document.documentElement.scrollLeft, top: h.window.scrollY || h.window.document.documentElement.scrollTop }, size: { height: i.height(), width: i.width() } }, origin: { fixedLineage: !1, offset: {}, size: { height: f.bottom - f.top, width: f.right - f.left }, usemapImage: d ? c[0] : null, windowOffset: { bottom: f.bottom, left: f.left, right: f.right, top: f.top } } }; if (d) { var l = b._$origin.attr("shape"), m = b._$origin.attr("coords"); if (m && (m = m.split(","), a.map(m, function (a, b) { m[b] = parseInt(a) })), "default" != l) switch (l) { case "circle": var n = m[0], o = m[1], p = m[2], q = o - p, r = n - p; k.origin.size.height = 2 * p, k.origin.size.width = k.origin.size.height, k.origin.windowOffset.left += r, k.origin.windowOffset.top += q; break; case "rect": var s = m[0], t = m[1], u = m[2], v = m[3]; k.origin.size.height = v - t, k.origin.size.width = u - s, k.origin.windowOffset.left += s, k.origin.windowOffset.top += t; break; case "poly": for (var w = 0, x = 0, y = 0, z = 0, A = "even", B = 0; B < m.length; B++) { var C = m[B]; "even" == A ? (C > y && (y = C, 0 === B && (w = y)), w > C && (w = C), A = "odd") : (C > z && (z = C, 1 == B && (x = z)), x > C && (x = C), A = "even") } k.origin.size.height = z - x, k.origin.size.width = y - w, k.origin.windowOffset.left += w, k.origin.windowOffset.top += x } } var D = function (a) { k.origin.size.height = a.height, k.origin.windowOffset.left = a.left, k.origin.windowOffset.top = a.top, k.origin.size.width = a.width }; for (b._trigger({ type: "geometry", edit: D, geometry: { height: k.origin.size.height, left: k.origin.windowOffset.left, top: k.origin.windowOffset.top, width: k.origin.size.width } }), k.origin.windowOffset.right = k.origin.windowOffset.left + k.origin.size.width, k.origin.windowOffset.bottom = k.origin.windowOffset.top + k.origin.size.height, k.origin.offset.left = k.origin.windowOffset.left + k.window.scroll.left, k.origin.offset.top = k.origin.windowOffset.top + k.window.scroll.top, k.origin.offset.bottom = k.origin.offset.top + k.origin.size.height, k.origin.offset.right = k.origin.offset.left + k.origin.size.width, k.available.document = { bottom: { height: k.document.size.height - k.origin.offset.bottom, width: k.document.size.width }, left: { height: k.document.size.height, width: k.origin.offset.left }, right: { height: k.document.size.height, width: k.document.size.width - k.origin.offset.right }, top: { height: k.origin.offset.top, width: k.document.size.width } }, k.available.window = { bottom: { height: Math.max(k.window.size.height - Math.max(k.origin.windowOffset.bottom, 0), 0), width: k.window.size.width }, left: { height: k.window.size.height, width: Math.max(k.origin.windowOffset.left, 0) }, right: { height: k.window.size.height, width: Math.max(k.window.size.width - Math.max(k.origin.windowOffset.right, 0), 0) }, top: { height: Math.max(k.origin.windowOffset.top, 0), width: k.window.size.width } }; "html" != j[0].tagName.toLowerCase();) { if ("fixed" == j.css("position")) { k.origin.fixedLineage = !0; break } j = j.parent() } return k }, __optionsFormat: function () { return "number" == typeof this.__options.animationDuration && (this.__options.animationDuration = [this.__options.animationDuration, this.__options.animationDuration]), "number" == typeof this.__options.delay && (this.__options.delay = [this.__options.delay, this.__options.delay]), "number" == typeof this.__options.delayTouch && (this.__options.delayTouch = [this.__options.delayTouch, this.__options.delayTouch]), "string" == typeof this.__options.theme && (this.__options.theme = [this.__options.theme]), null === this.__options.parent ? this.__options.parent = a(h.window.document.body) : "string" == typeof this.__options.parent && (this.__options.parent = a(this.__options.parent)), "hover" == this.__options.trigger ? (this.__options.triggerOpen = { mouseenter: !0, touchstart: !0 }, this.__options.triggerClose = { mouseleave: !0, originClick: !0, touchleave: !0 }) : "click" == this.__options.trigger && (this.__options.triggerOpen = { click: !0, tap: !0 }, this.__options.triggerClose = { click: !0, tap: !0 }), this._trigger("options"), this }, __prepareGC: function () { var b = this; return b.__options.selfDestruction ? b.__garbageCollector = setInterval(function () { var c = (new Date).getTime(); b.__touchEvents = a.grep(b.__touchEvents, function (a, b) { return c - a.time > 6e4 }), d(b._$origin) || b.close(function () { b.destroy() }) }, 2e4) : clearInterval(b.__garbageCollector), b }, __prepareOrigin: function () { var a = this; if (a._$origin.off("." + a.__namespace + "-triggerOpen"), h.hasTouchCapability && a._$origin.on("touchstart." + a.__namespace + "-triggerOpen touchend." + a.__namespace + "-triggerOpen touchcancel." + a.__namespace + "-triggerOpen", function (b) { a._touchRecordEvent(b) }), a.__options.triggerOpen.click || a.__options.triggerOpen.tap && h.hasTouchCapability) { var b = ""; a.__options.triggerOpen.click && (b += "click." + a.__namespace + "-triggerOpen "), a.__options.triggerOpen.tap && h.hasTouchCapability && (b += "touchend." + a.__namespace + "-triggerOpen"), a._$origin.on(b, function (b) { a._touchIsMeaningfulEvent(b) && a._open(b) }) } if (a.__options.triggerOpen.mouseenter || a.__options.triggerOpen.touchstart && h.hasTouchCapability) { var b = ""; a.__options.triggerOpen.mouseenter && (b += "mouseenter." + a.__namespace + "-triggerOpen "), a.__options.triggerOpen.touchstart && h.hasTouchCapability && (b += "touchstart." + a.__namespace + "-triggerOpen"), a._$origin.on(b, function (b) { !a._touchIsTouchEvent(b) && a._touchIsEmulatedEvent(b) || (a.__pointerIsOverOrigin = !0, a._openShortly(b)) }) } if (a.__options.triggerClose.mouseleave || a.__options.triggerClose.touchleave && h.hasTouchCapability) { var b = ""; a.__options.triggerClose.mouseleave && (b += "mouseleave." + a.__namespace + "-triggerOpen "), a.__options.triggerClose.touchleave && h.hasTouchCapability && (b += "touchend." + a.__namespace + "-triggerOpen touchcancel." + a.__namespace + "-triggerOpen"), a._$origin.on(b, function (b) { a._touchIsMeaningfulEvent(b) && (a.__pointerIsOverOrigin = !1) }) } return a }, __prepareTooltip: function () { var b = this, c = b.__options.interactive ? "auto" : ""; return b._$tooltip.attr("id", b.__namespace).css({ "pointer-events": c, zIndex: b.__options.zIndex }), a.each(b.__previousThemes, function (a, c) { b._$tooltip.removeClass(c) }), a.each(b.__options.theme, function (a, c) { b._$tooltip.addClass(c) }), b.__previousThemes = a.merge([], b.__options.theme), b }, __scrollHandler: function (b) { var c = this; if (c.__options.triggerClose.scroll) c._close(b); else if (d(c._$origin) && d(c._$tooltip)) { var e = null; if (b.target === h.window.document) c.__Geometry.origin.fixedLineage || c.__options.repositionOnScroll && c.reposition(b); else { e = c.__geometry(); var f = !1; if ("fixed" != c._$origin.css("position") && c.__$originParents.each(function (b, c) { var d = a(c), g = d.css("overflow-x"), h = d.css("overflow-y"); if ("visible" != g || "visible" != h) { var i = c.getBoundingClientRect(); if ("visible" != g && (e.origin.windowOffset.left < i.left || e.origin.windowOffset.right > i.right)) return f = !0, !1; if ("visible" != h && (e.origin.windowOffset.top < i.top || e.origin.windowOffset.bottom > i.bottom)) return f = !0, !1 } return "fixed" == d.css("position") ? !1 : void 0 }), f) c._$tooltip.css("visibility", "hidden"); else if (c._$tooltip.css("visibility", "visible"), c.__options.repositionOnScroll) c.reposition(b); else { var g = e.origin.offset.left - c.__Geometry.origin.offset.left, i = e.origin.offset.top - c.__Geometry.origin.offset.top; c._$tooltip.css({ left: c.__lastPosition.coord.left + g, top: c.__lastPosition.coord.top + i }) } } c._trigger({ type: "scroll", event: b, geo: e }) } return c }, __stateSet: function (a) { return this.__state = a, this._trigger({ type: "state", state: a }), this }, __timeoutsClear: function () { return clearTimeout(this.__timeouts.open), this.__timeouts.open = null, a.each(this.__timeouts.close, function (a, b) { clearTimeout(b) }), this.__timeouts.close = [], this }, __trackerStart: function () { var a = this, b = a._$tooltip.find(".tooltipster-content"); return a.__options.trackTooltip && (a.__contentBcr = b[0].getBoundingClientRect()), a.__tracker = setInterval(function () { if (d(a._$origin) && d(a._$tooltip)) { if (a.__options.trackOrigin) { var e = a.__geometry(), f = !1; c(e.origin.size, a.__Geometry.origin.size) && (a.__Geometry.origin.fixedLineage ? c(e.origin.windowOffset, a.__Geometry.origin.windowOffset) && (f = !0) : c(e.origin.offset, a.__Geometry.origin.offset) && (f = !0)), f || (a.__options.triggerClose.mouseleave ? a._close() : a.reposition()) } if (a.__options.trackTooltip) { var g = b[0].getBoundingClientRect(); g.height === a.__contentBcr.height && g.width === a.__contentBcr.width || (a.reposition(), a.__contentBcr = g) } } else a._close() }, a.__options.trackerInterval), a }, _close: function (b, c, d) { var e = this, f = !0; if (e._trigger({ type: "close", event: b, stop: function () { f = !1 } }), f || d) { c && e.__callbacks.close.push(c), e.__callbacks.open = [], e.__timeoutsClear(); var g = function () { a.each(e.__callbacks.close, function (a, c) { c.call(e, e, { event: b, origin: e._$origin[0] }) }), e.__callbacks.close = [] }; if ("closed" != e.__state) { var i = !0, j = new Date, k = j.getTime(), l = k + e.__options.animationDuration[1]; if ("disappearing" == e.__state && l > e.__closingTime && e.__options.animationDuration[1] > 0 && (i = !1), i) { e.__closingTime = l, "disappearing" != e.__state && e.__stateSet("disappearing"); var m = function () { clearInterval(e.__tracker), e._trigger({ type: "closing", event: b }), e._$tooltip.off("." + e.__namespace + "-triggerClose").removeClass("tooltipster-dying"), a(h.window).off("." + e.__namespace + "-triggerClose"), e.__$originParents.each(function (b, c) { a(c).off("scroll." + e.__namespace + "-triggerClose") }), e.__$originParents = null, a(h.window.document.body).off("." + e.__namespace + "-triggerClose"), e._$origin.off("." + e.__namespace + "-triggerClose"), e._off("dismissable"), e.__stateSet("closed"), e._trigger({ type: "after", event: b }), e.__options.functionAfter && e.__options.functionAfter.call(e, e, { event: b, origin: e._$origin[0] }), g() }; h.hasTransitions ? (e._$tooltip.css({ "-moz-animation-duration": e.__options.animationDuration[1] + "ms", "-ms-animation-duration": e.__options.animationDuration[1] + "ms", "-o-animation-duration": e.__options.animationDuration[1] + "ms", "-webkit-animation-duration": e.__options.animationDuration[1] + "ms", "animation-duration": e.__options.animationDuration[1] + "ms", "transition-duration": e.__options.animationDuration[1] + "ms" }), e._$tooltip.clearQueue().removeClass("tooltipster-show").addClass("tooltipster-dying"), e.__options.animationDuration[1] > 0 && e._$tooltip.delay(e.__options.animationDuration[1]), e._$tooltip.queue(m)) : e._$tooltip.stop().fadeOut(e.__options.animationDuration[1], m) } } else g() } return e }, _off: function () { return this.__$emitterPrivate.off.apply(this.__$emitterPrivate, Array.prototype.slice.apply(arguments)), this }, _on: function () { return this.__$emitterPrivate.on.apply(this.__$emitterPrivate, Array.prototype.slice.apply(arguments)), this }, _one: function () { return this.__$emitterPrivate.one.apply(this.__$emitterPrivate, Array.prototype.slice.apply(arguments)), this }, _open: function (b, c) { var e = this; if (!e.__destroying && d(e._$origin) && e.__enabled) { var f = !0; if ("closed" == e.__state && (e._trigger({ type: "before", event: b, stop: function () { f = !1 } }), f && e.__options.functionBefore && (f = e.__options.functionBefore.call(e, e, { event: b, origin: e._$origin[0] }))), f !== !1 && null !== e.__Content) { c && e.__callbacks.open.push(c), e.__callbacks.close = [], e.__timeoutsClear(); var g, i = function () { "stable" != e.__state && e.__stateSet("stable"), a.each(e.__callbacks.open, function (a, b) { b.call(e, e, { origin: e._$origin[0], tooltip: e._$tooltip[0] }) }), e.__callbacks.open = [] }; if ("closed" !== e.__state) g = 0, "disappearing" === e.__state ? (e.__stateSet("appearing"), h.hasTransitions ? (e._$tooltip.clearQueue().removeClass("tooltipster-dying").addClass("tooltipster-show"), e.__options.animationDuration[0] > 0 && e._$tooltip.delay(e.__options.animationDuration[0]), e._$tooltip.queue(i)) : e._$tooltip.stop().fadeIn(i)) : "stable" == e.__state && i(); else { if (e.__stateSet("appearing"), g = e.__options.animationDuration[0], e.__contentInsert(), e.reposition(b, !0), h.hasTransitions ? (e._$tooltip.addClass("tooltipster-" + e.__options.animation).addClass("tooltipster-initial").css({ "-moz-animation-duration": e.__options.animationDuration[0] + "ms", "-ms-animation-duration": e.__options.animationDuration[0] + "ms", "-o-animation-duration": e.__options.animationDuration[0] + "ms", "-webkit-animation-duration": e.__options.animationDuration[0] + "ms", "animation-duration": e.__options.animationDuration[0] + "ms", "transition-duration": e.__options.animationDuration[0] + "ms" }), setTimeout(function () { "closed" != e.__state && (e._$tooltip.addClass("tooltipster-show").removeClass("tooltipster-initial"), e.__options.animationDuration[0] > 0 && e._$tooltip.delay(e.__options.animationDuration[0]), e._$tooltip.queue(i)) }, 0)) : e._$tooltip.css("display", "none").fadeIn(e.__options.animationDuration[0], i), e.__trackerStart(), a(h.window).on("resize." + e.__namespace + "-triggerClose", function (b) { var c = a(document.activeElement); (c.is("input") || c.is("textarea")) && a.contains(e._$tooltip[0], c[0]) || e.reposition(b) }).on("scroll." + e.__namespace + "-triggerClose", function (a) { e.__scrollHandler(a) }), e.__$originParents = e._$origin.parents(), e.__$originParents.each(function (b, c) { a(c).on("scroll." + e.__namespace + "-triggerClose", function (a) { e.__scrollHandler(a) }) }), e.__options.triggerClose.mouseleave || e.__options.triggerClose.touchleave && h.hasTouchCapability) { e._on("dismissable", function (a) { a.dismissable ? a.delay ? (m = setTimeout(function () { e._close(a.event) }, a.delay), e.__timeouts.close.push(m)) : e._close(a) : clearTimeout(m) }); var j = e._$origin, k = "", l = "", m = null; e.__options.interactive && (j = j.add(e._$tooltip)), e.__options.triggerClose.mouseleave && (k += "mouseenter." + e.__namespace + "-triggerClose ", l += "mouseleave." + e.__namespace + "-triggerClose "), e.__options.triggerClose.touchleave && h.hasTouchCapability && (k += "touchstart." + e.__namespace + "-triggerClose", l += "touchend." + e.__namespace + "-triggerClose touchcancel." + e.__namespace + "-triggerClose"), j.on(l, function (a) { if (e._touchIsTouchEvent(a) || !e._touchIsEmulatedEvent(a)) { var b = "mouseleave" == a.type ? e.__options.delay : e.__options.delayTouch; e._trigger({ delay: b[1], dismissable: !0, event: a, type: "dismissable" }) } }).on(k, function (a) { !e._touchIsTouchEvent(a) && e._touchIsEmulatedEvent(a) || e._trigger({ dismissable: !1, event: a, type: "dismissable" }) }) } e.__options.triggerClose.originClick && e._$origin.on("click." + e.__namespace + "-triggerClose", function (a) { e._touchIsTouchEvent(a) || e._touchIsEmulatedEvent(a) || e._close(a) }), (e.__options.triggerClose.click || e.__options.triggerClose.tap && h.hasTouchCapability) && setTimeout(function () { if ("closed" != e.__state) { var b = "", c = a(h.window.document.body); e.__options.triggerClose.click && (b += "click." + e.__namespace + "-triggerClose "), e.__options.triggerClose.tap && h.hasTouchCapability && (b += "touchend." + e.__namespace + "-triggerClose"), c.on(b, function (b) { e._touchIsMeaningfulEvent(b) && (e._touchRecordEvent(b), e.__options.interactive && a.contains(e._$tooltip[0], b.target) || e._close(b)) }), e.__options.triggerClose.tap && h.hasTouchCapability && c.on("touchstart." + e.__namespace + "-triggerClose", function (a) { e._touchRecordEvent(a) }) } }, 0), e._trigger("ready"), e.__options.functionReady && e.__options.functionReady.call(e, e, { origin: e._$origin[0], tooltip: e._$tooltip[0] }) } if (e.__options.timer > 0) { var m = setTimeout(function () { e._close() }, e.__options.timer + g); e.__timeouts.close.push(m) } } } return e }, _openShortly: function (a) { var b = this, c = !0; if ("stable" != b.__state && "appearing" != b.__state && !b.__timeouts.open && (b._trigger({ type: "start", event: a, stop: function () { c = !1 } }), c)) { var d = 0 == a.type.indexOf("touch") ? b.__options.delayTouch : b.__options.delay; d[0] ? b.__timeouts.open = setTimeout(function () { b.__timeouts.open = null, b.__pointerIsOverOrigin && b._touchIsMeaningfulEvent(a) ? (b._trigger("startend"), b._open(a)) : b._trigger("startcancel") }, d[0]) : (b._trigger("startend"), b._open(a)) } return b }, _optionsExtract: function (b, c) { var d = this, e = a.extend(!0, {}, c), f = d.__options[b]; return f || (f = {}, a.each(c, function (a, b) { var c = d.__options[a]; void 0 !== c && (f[a] = c) })), a.each(e, function (b, c) { void 0 !== f[b] && ("object" != typeof c || c instanceof Array || null == c || "object" != typeof f[b] || f[b] instanceof Array || null == f[b] ? e[b] = f[b] : a.extend(e[b], f[b])) }), e }, _plug: function (b) { var c = a.tooltipster._plugin(b); if (!c) throw new Error('The "' + b + '" plugin is not defined'); return c.instance && a.tooltipster.__bridge(c.instance, this, c.name), this }, _touchIsEmulatedEvent: function (a) { for (var b = !1, c = (new Date).getTime(), d = this.__touchEvents.length - 1; d >= 0; d--) { var e = this.__touchEvents[d]; if (!(c - e.time < 500)) break; e.target === a.target && (b = !0) } return b }, _touchIsMeaningfulEvent: function (a) { return this._touchIsTouchEvent(a) && !this._touchSwiped(a.target) || !this._touchIsTouchEvent(a) && !this._touchIsEmulatedEvent(a) }, _touchIsTouchEvent: function (a) { return 0 == a.type.indexOf("touch") }, _touchRecordEvent: function (a) { return this._touchIsTouchEvent(a) && (a.time = (new Date).getTime(), this.__touchEvents.push(a)), this }, _touchSwiped: function (a) { for (var b = !1, c = this.__touchEvents.length - 1; c >= 0; c--) { var d = this.__touchEvents[c]; if ("touchmove" == d.type) { b = !0; break } if ("touchstart" == d.type && a === d.target) break } return b }, _trigger: function () { var b = Array.prototype.slice.apply(arguments); return "string" == typeof b[0] && (b[0] = { type: b[0] }), b[0].instance = this, b[0].origin = this._$origin ? this._$origin[0] : null, b[0].tooltip = this._$tooltip ? this._$tooltip[0] : null, this.__$emitterPrivate.trigger.apply(this.__$emitterPrivate, b), a.tooltipster._trigger.apply(a.tooltipster, b), this.__$emitterPublic.trigger.apply(this.__$emitterPublic, b), this }, _unplug: function (b) { var c = this; if (c[b]) { var d = a.tooltipster._plugin(b); d.instance && a.each(d.instance, function (a, d) { c[a] && c[a].bridged === c[b] && delete c[a] }), c[b].__destroy && c[b].__destroy(), delete c[b] } return c }, close: function (a) { return this.__destroyed ? this.__destroyError() : this._close(null, a), this }, content: function (a) { var b = this; if (void 0 === a) return b.__Content; if (b.__destroyed) b.__destroyError(); else if (b.__contentSet(a), null !== b.__Content) { if ("closed" !== b.__state && (b.__contentInsert(), b.reposition(), b.__options.updateAnimation)) if (h.hasTransitions) { var c = b.__options.updateAnimation; b._$tooltip.addClass("tooltipster-update-" + c), setTimeout(function () { "closed" != b.__state && b._$tooltip.removeClass("tooltipster-update-" + c) }, 1e3) } else b._$tooltip.fadeTo(200, .5, function () { "closed" != b.__state && b._$tooltip.fadeTo(200, 1) }) } else b._close(); return b }, destroy: function () { var b = this; if (b.__destroyed) b.__destroyError(); else { "closed" != b.__state ? b.option("animationDuration", 0)._close(null, null, !0) : b.__timeoutsClear(), b._trigger("destroy"), b.__destroyed = !0, b._$origin.removeData(b.__namespace).off("." + b.__namespace + "-triggerOpen"), a(h.window.document.body).off("." + b.__namespace + "-triggerOpen"); var c = b._$origin.data("tooltipster-ns"); if (c) if (1 === c.length) { var d = null; "previous" == b.__options.restoration ? d = b._$origin.data("tooltipster-initialTitle") : "current" == b.__options.restoration && (d = "string" == typeof b.__Content ? b.__Content : a("<div></div>").append(b.__Content).html()), d && b._$origin.attr("title", d), b._$origin.removeClass("tooltipstered"), b._$origin.removeData("tooltipster-ns").removeData("tooltipster-initialTitle") } else c = a.grep(c, function (a, c) { return a !== b.__namespace }), b._$origin.data("tooltipster-ns", c); b._trigger("destroyed"), b._off(), b.off(), b.__Content = null, b.__$emitterPrivate = null, b.__$emitterPublic = null, b.__options.parent = null, b._$origin = null, b._$tooltip = null, a.tooltipster.__instancesLatestArr = a.grep(a.tooltipster.__instancesLatestArr, function (a, c) { return b !== a }), clearInterval(b.__garbageCollector) } return b }, disable: function () { return this.__destroyed ? (this.__destroyError(), this) : (this._close(), this.__enabled = !1, this) }, elementOrigin: function () { return this.__destroyed ? void this.__destroyError() : this._$origin[0] }, elementTooltip: function () { return this._$tooltip ? this._$tooltip[0] : null }, enable: function () { return this.__enabled = !0, this }, hide: function (a) { return this.close(a) }, instance: function () { return this }, off: function () { return this.__destroyed || this.__$emitterPublic.off.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this }, on: function () { return this.__destroyed ? this.__destroyError() : this.__$emitterPublic.on.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this }, one: function () { return this.__destroyed ? this.__destroyError() : this.__$emitterPublic.one.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this }, open: function (a) { return this.__destroyed ? this.__destroyError() : this._open(null, a), this }, option: function (b, c) { return void 0 === c ? this.__options[b] : (this.__destroyed ? this.__destroyError() : (this.__options[b] = c, this.__optionsFormat(), a.inArray(b, ["trigger", "triggerClose", "triggerOpen"]) >= 0 && this.__prepareOrigin(), "selfDestruction" === b && this.__prepareGC()), this) }, reposition: function (a, b) { var c = this; return c.__destroyed ? c.__destroyError() : "closed" != c.__state && d(c._$origin) && (b || d(c._$tooltip)) && (b || c._$tooltip.detach(), c.__Geometry = c.__geometry(), c._trigger({ type: "reposition", event: a, helper: { geo: c.__Geometry } })), c }, show: function (a) { return this.open(a) }, status: function () { return { destroyed: this.__destroyed, enabled: this.__enabled, open: "closed" !== this.__state, state: this.__state } }, triggerHandler: function () { return this.__destroyed ? this.__destroyError() : this.__$emitterPublic.triggerHandler.apply(this.__$emitterPublic, Array.prototype.slice.apply(arguments)), this } }, a.fn.tooltipster = function () { var b = Array.prototype.slice.apply(arguments), c = "You are using a single HTML element as content for several tooltips. You probably want to set the contentCloning option to TRUE."; if (0 === this.length) return this; if ("string" == typeof b[0]) { var d = "#*$~&"; return this.each(function () { var e = a(this).data("tooltipster-ns"), f = e ? a(this).data(e[0]) : null; if (!f) throw new Error("You called Tooltipster's \"" + b[0] + '" method on an uninitialized element'); if ("function" != typeof f[b[0]]) throw new Error('Unknown method "' + b[0] + '"'); this.length > 1 && "content" == b[0] && (b[1] instanceof a || "object" == typeof b[1] && null != b[1] && b[1].tagName) && !f.__options.contentCloning && f.__options.debug && console.log(c); var g = f[b[0]](b[1], b[2]); return g !== f || "instance" === b[0] ? (d = g, !1) : void 0 }), "#*$~&" !== d ? d : this } a.tooltipster.__instancesLatestArr = []; var e = b[0] && void 0 !== b[0].multiple, g = e && b[0].multiple || !e && f.multiple, h = b[0] && void 0 !== b[0].content, i = h && b[0].content || !h && f.content, j = b[0] && void 0 !== b[0].contentCloning, k = j && b[0].contentCloning || !j && f.contentCloning, l = b[0] && void 0 !== b[0].debug, m = l && b[0].debug || !l && f.debug; return this.length > 1 && (i instanceof a || "object" == typeof i && null != i && i.tagName) && !k && m && console.log(c), this.each(function () { var c = !1, d = a(this), e = d.data("tooltipster-ns"), f = null; e ? g ? c = !0 : m && (console.log("Tooltipster: one or more tooltips are already attached to the element below. Ignoring."), console.log(this)) : c = !0, c && (f = new a.Tooltipster(this, b[0]), e || (e = []), e.push(f.__namespace), d.data("tooltipster-ns", e), d.data(f.__namespace, f), f.__options.functionInit && f.__options.functionInit.call(f, f, { origin: this }), f._trigger("init")), a.tooltipster.__instancesLatestArr.push(f) }), this }, b.prototype = { __init: function (b) { this.__$tooltip = b, this.__$tooltip.css({ left: 0, overflow: "hidden", position: "absolute", top: 0 }).find(".tooltipster-content").css("overflow", "auto"), this.$container = a('<div class="tooltipster-ruler"></div>').append(this.__$tooltip).appendTo(h.window.document.body) }, __forceRedraw: function () { var a = this.__$tooltip.parent(); this.__$tooltip.detach(), this.__$tooltip.appendTo(a) }, constrain: function (a, b) { return this.constraints = { width: a, height: b }, this.__$tooltip.css({ display: "block", height: "", overflow: "auto", width: a }), this }, destroy: function () { this.__$tooltip.detach().find(".tooltipster-content").css({ display: "", overflow: "" }), this.$container.remove() }, free: function () { return this.constraints = null, this.__$tooltip.css({ display: "", height: "", overflow: "visible", width: "" }), this }, measure: function () { this.__forceRedraw(); var a = this.__$tooltip[0].getBoundingClientRect(), b = { size: { height: a.height || a.bottom - a.top, width: a.width || a.right - a.left } }; if (this.constraints) { var c = this.__$tooltip.find(".tooltipster-content"), d = this.__$tooltip.outerHeight(), e = c[0].getBoundingClientRect(), f = { height: d <= this.constraints.height, width: a.width <= this.constraints.width && e.width >= c[0].scrollWidth - 1 }; b.fits = f.height && f.width } return h.IE && h.IE <= 11 && b.size.width !== h.window.document.documentElement.clientWidth && (b.size.width = Math.ceil(b.size.width) + 1), b } }; var j = navigator.userAgent.toLowerCase(); -1 != j.indexOf("msie") ? h.IE = parseInt(j.split("msie")[1]) : -1 !== j.toLowerCase().indexOf("trident") && -1 !== j.indexOf(" rv:11") ? h.IE = 11 : -1 != j.toLowerCase().indexOf("edge/") && (h.IE = parseInt(j.toLowerCase().split("edge/")[1])); var k = "tooltipster.sideTip"; return a.tooltipster._plugin({
        name: k, instance: {
            __defaults: function () { return { arrow: !0, distance: 6, functionPosition: null, maxWidth: null, minIntersection: 16, minWidth: 0, position: null, side: "top", viewportAware: !0 } }, __init: function (a) { var b = this; b.__instance = a, b.__namespace = "tooltipster-sideTip-" + Math.round(1e6 * Math.random()), b.__previousState = "closed", b.__options, b.__optionsFormat(), b.__instance._on("state." + b.__namespace, function (a) { "closed" == a.state ? b.__close() : "appearing" == a.state && "closed" == b.__previousState && b.__create(), b.__previousState = a.state }), b.__instance._on("options." + b.__namespace, function () { b.__optionsFormat() }), b.__instance._on("reposition." + b.__namespace, function (a) { b.__reposition(a.event, a.helper) }) }, __close: function () { this.__instance.content() instanceof a && this.__instance.content().detach(), this.__instance._$tooltip.remove(), this.__instance._$tooltip = null }, __create: function () {
                var b = a('<div class="tooltipster-base tooltipster-sidetip"><div class="tooltipster-box"><div class="tooltipster-content"></div></div><div class="tooltipster-arrow"><div class="tooltipster-arrow-uncropped"><div class="tooltipster-arrow-border"></div><div class="tooltipster-arrow-background"></div></div></div></div>'); this.__options.arrow || b.find(".tooltipster-box").css("margin", 0).end().find(".tooltipster-arrow").hide(), this.__options.minWidth && b.css("min-width", this.__options.minWidth + "px"), this.__options.maxWidth && b.css("max-width", this.__options.maxWidth + "px"),
                    this.__instance._$tooltip = b, this.__instance._trigger("created")
            }, __destroy: function () { this.__instance._off("." + self.__namespace) }, __optionsFormat: function () { var b = this; if (b.__options = b.__instance._optionsExtract(k, b.__defaults()), b.__options.position && (b.__options.side = b.__options.position), "object" != typeof b.__options.distance && (b.__options.distance = [b.__options.distance]), b.__options.distance.length < 4 && (void 0 === b.__options.distance[1] && (b.__options.distance[1] = b.__options.distance[0]), void 0 === b.__options.distance[2] && (b.__options.distance[2] = b.__options.distance[0]), void 0 === b.__options.distance[3] && (b.__options.distance[3] = b.__options.distance[1]), b.__options.distance = { top: b.__options.distance[0], right: b.__options.distance[1], bottom: b.__options.distance[2], left: b.__options.distance[3] }), "string" == typeof b.__options.side) { var c = { top: "bottom", right: "left", bottom: "top", left: "right" }; b.__options.side = [b.__options.side, c[b.__options.side]], "left" == b.__options.side[0] || "right" == b.__options.side[0] ? b.__options.side.push("top", "bottom") : b.__options.side.push("right", "left") } 6 === a.tooltipster._env.IE && b.__options.arrow !== !0 && (b.__options.arrow = !1) }, __reposition: function (b, c) { var d, e = this, f = e.__targetFind(c), g = []; e.__instance._$tooltip.detach(); var h = e.__instance._$tooltip.clone(), i = a.tooltipster._getRuler(h), j = !1, k = e.__instance.option("animation"); switch (k && h.removeClass("tooltipster-" + k), a.each(["window", "document"], function (d, k) { var l = null; if (e.__instance._trigger({ container: k, helper: c, satisfied: j, takeTest: function (a) { l = a }, results: g, type: "positionTest" }), 1 == l || 0 != l && 0 == j && ("window" != k || e.__options.viewportAware)) for (var d = 0; d < e.__options.side.length; d++) { var m = { horizontal: 0, vertical: 0 }, n = e.__options.side[d]; "top" == n || "bottom" == n ? m.vertical = e.__options.distance[n] : m.horizontal = e.__options.distance[n], e.__sideChange(h, n), a.each(["natural", "constrained"], function (a, d) { if (l = null, e.__instance._trigger({ container: k, event: b, helper: c, mode: d, results: g, satisfied: j, side: n, takeTest: function (a) { l = a }, type: "positionTest" }), 1 == l || 0 != l && 0 == j) { var h = { container: k, distance: m, fits: null, mode: d, outerSize: null, side: n, size: null, target: f[n], whole: null }, o = "natural" == d ? i.free() : i.constrain(c.geo.available[k][n].width - m.horizontal, c.geo.available[k][n].height - m.vertical), p = o.measure(); if (h.size = p.size, h.outerSize = { height: p.size.height + m.vertical, width: p.size.width + m.horizontal }, "natural" == d ? c.geo.available[k][n].width >= h.outerSize.width && c.geo.available[k][n].height >= h.outerSize.height ? h.fits = !0 : h.fits = !1 : h.fits = p.fits, "window" == k && (h.fits ? "top" == n || "bottom" == n ? h.whole = c.geo.origin.windowOffset.right >= e.__options.minIntersection && c.geo.window.size.width - c.geo.origin.windowOffset.left >= e.__options.minIntersection : h.whole = c.geo.origin.windowOffset.bottom >= e.__options.minIntersection && c.geo.window.size.height - c.geo.origin.windowOffset.top >= e.__options.minIntersection : h.whole = !1), g.push(h), h.whole) j = !0; else if ("natural" == h.mode && (h.fits || h.size.width <= c.geo.available[k][n].width)) return !1 } }) } }), e.__instance._trigger({ edit: function (a) { g = a }, event: b, helper: c, results: g, type: "positionTested" }), g.sort(function (a, b) { if (a.whole && !b.whole) return -1; if (!a.whole && b.whole) return 1; if (a.whole && b.whole) { var c = e.__options.side.indexOf(a.side), d = e.__options.side.indexOf(b.side); return d > c ? -1 : c > d ? 1 : "natural" == a.mode ? -1 : 1 } if (a.fits && !b.fits) return -1; if (!a.fits && b.fits) return 1; if (a.fits && b.fits) { var c = e.__options.side.indexOf(a.side), d = e.__options.side.indexOf(b.side); return d > c ? -1 : c > d ? 1 : "natural" == a.mode ? -1 : 1 } return "document" == a.container && "bottom" == a.side && "natural" == a.mode ? -1 : 1 }), d = g[0], d.coord = {}, d.side) { case "left": case "right": d.coord.top = Math.floor(d.target - d.size.height / 2); break; case "bottom": case "top": d.coord.left = Math.floor(d.target - d.size.width / 2) }switch (d.side) { case "left": d.coord.left = c.geo.origin.windowOffset.left - d.outerSize.width; break; case "right": d.coord.left = c.geo.origin.windowOffset.right + d.distance.horizontal; break; case "top": d.coord.top = c.geo.origin.windowOffset.top - d.outerSize.height; break; case "bottom": d.coord.top = c.geo.origin.windowOffset.bottom + d.distance.vertical }"window" == d.container ? "top" == d.side || "bottom" == d.side ? d.coord.left < 0 ? c.geo.origin.windowOffset.right - this.__options.minIntersection >= 0 ? d.coord.left = 0 : d.coord.left = c.geo.origin.windowOffset.right - this.__options.minIntersection - 1 : d.coord.left > c.geo.window.size.width - d.size.width && (c.geo.origin.windowOffset.left + this.__options.minIntersection <= c.geo.window.size.width ? d.coord.left = c.geo.window.size.width - d.size.width : d.coord.left = c.geo.origin.windowOffset.left + this.__options.minIntersection + 1 - d.size.width) : d.coord.top < 0 ? c.geo.origin.windowOffset.bottom - this.__options.minIntersection >= 0 ? d.coord.top = 0 : d.coord.top = c.geo.origin.windowOffset.bottom - this.__options.minIntersection - 1 : d.coord.top > c.geo.window.size.height - d.size.height && (c.geo.origin.windowOffset.top + this.__options.minIntersection <= c.geo.window.size.height ? d.coord.top = c.geo.window.size.height - d.size.height : d.coord.top = c.geo.origin.windowOffset.top + this.__options.minIntersection + 1 - d.size.height) : (d.coord.left > c.geo.window.size.width - d.size.width && (d.coord.left = c.geo.window.size.width - d.size.width), d.coord.left < 0 && (d.coord.left = 0)), e.__sideChange(h, d.side), c.tooltipClone = h[0], c.tooltipParent = e.__instance.option("parent").parent[0], c.mode = d.mode, c.whole = d.whole, c.origin = e.__instance._$origin[0], c.tooltip = e.__instance._$tooltip[0], delete d.container, delete d.fits, delete d.mode, delete d.outerSize, delete d.whole, d.distance = d.distance.horizontal || d.distance.vertical; var l = a.extend(!0, {}, d); if (e.__instance._trigger({ edit: function (a) { d = a }, event: b, helper: c, position: l, type: "position" }), e.__options.functionPosition) { var m = e.__options.functionPosition.call(e, e.__instance, c, l); m && (d = m) } i.destroy(); var n, o; "top" == d.side || "bottom" == d.side ? (n = { prop: "left", val: d.target - d.coord.left }, o = d.size.width - this.__options.minIntersection) : (n = { prop: "top", val: d.target - d.coord.top }, o = d.size.height - this.__options.minIntersection), n.val < this.__options.minIntersection ? n.val = this.__options.minIntersection : n.val > o && (n.val = o); var p; p = c.geo.origin.fixedLineage ? c.geo.origin.windowOffset : { left: c.geo.origin.windowOffset.left + c.geo.window.scroll.left, top: c.geo.origin.windowOffset.top + c.geo.window.scroll.top }, d.coord = { left: p.left + (d.coord.left - c.geo.origin.windowOffset.left), top: p.top + (d.coord.top - c.geo.origin.windowOffset.top) }, e.__sideChange(e.__instance._$tooltip, d.side), c.geo.origin.fixedLineage ? e.__instance._$tooltip.css("position", "fixed") : e.__instance._$tooltip.css("position", ""), e.__instance._$tooltip.css({ left: d.coord.left, top: d.coord.top, height: d.size.height, width: d.size.width }).find(".tooltipster-arrow").css({ left: "", top: "" }).css(n.prop, n.val), e.__instance._$tooltip.appendTo(e.__instance.option("parent")), e.__instance._trigger({ type: "repositioned", event: b, position: d }) }, __sideChange: function (a, b) { a.removeClass("tooltipster-bottom").removeClass("tooltipster-left").removeClass("tooltipster-right").removeClass("tooltipster-top").addClass("tooltipster-" + b) }, __targetFind: function (a) { var b = {}, c = this.__instance._$origin[0].getClientRects(); if (c.length > 1) { var d = this.__instance._$origin.css("opacity"); 1 == d && (this.__instance._$origin.css("opacity", .99), c = this.__instance._$origin[0].getClientRects(), this.__instance._$origin.css("opacity", 1)) } if (c.length < 2) b.top = Math.floor(a.geo.origin.windowOffset.left + a.geo.origin.size.width / 2), b.bottom = b.top, b.left = Math.floor(a.geo.origin.windowOffset.top + a.geo.origin.size.height / 2), b.right = b.left; else { var e = c[0]; b.top = Math.floor(e.left + (e.right - e.left) / 2), e = c.length > 2 ? c[Math.ceil(c.length / 2) - 1] : c[0], b.right = Math.floor(e.top + (e.bottom - e.top) / 2), e = c[c.length - 1], b.bottom = Math.floor(e.left + (e.right - e.left) / 2), e = c.length > 2 ? c[Math.ceil((c.length + 1) / 2) - 1] : c[c.length - 1], b.left = Math.floor(e.top + (e.bottom - e.top) / 2) } return b }
        }
    }), a
});
/*!
 * jQuery throttle / debounce - v1.1 - 3/7/2010
 * http://benalman.com/projects/jquery-throttle-debounce-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */

// Script: jQuery throttle / debounce: Sometimes, less is more!
//
// *Version: 1.1, Last updated: 3/7/2010*
// 
// Project Home - http://benalman.com/projects/jquery-throttle-debounce-plugin/
// GitHub       - http://github.com/cowboy/jquery-throttle-debounce/
// Source       - http://github.com/cowboy/jquery-throttle-debounce/raw/master/jquery.ba-throttle-debounce.js
// (Minified)   - http://github.com/cowboy/jquery-throttle-debounce/raw/master/jquery.ba-throttle-debounce.min.js (0.7kb)
// 
// About: License
// 
// Copyright (c) 2010 "Cowboy" Ben Alman,
// Dual licensed under the MIT and GPL licenses.
// http://benalman.com/about/license/
// 
// About: Examples
// 
// These working examples, complete with fully commented code, illustrate a few
// ways in which this plugin can be used.
// 
// Throttle - http://benalman.com/code/projects/jquery-throttle-debounce/examples/throttle/
// Debounce - http://benalman.com/code/projects/jquery-throttle-debounce/examples/debounce/
// 
// About: Support and Testing
// 
// Information about what version or versions of jQuery this plugin has been
// tested with, what browsers it has been tested in, and where the unit tests
// reside (so you can test it yourself).
// 
// jQuery Versions - none, 1.3.2, 1.4.2
// Browsers Tested - Internet Explorer 6-8, Firefox 2-3.6, Safari 3-4, Chrome 4-5, Opera 9.6-10.1.
// Unit Tests      - http://benalman.com/code/projects/jquery-throttle-debounce/unit/
// 
// About: Release History
// 
// 1.1 - (3/7/2010) Fixed a bug in <jQuery.throttle> where trailing callbacks
//       executed later than they should. Reworked a fair amount of internal
//       logic as well.
// 1.0 - (3/6/2010) Initial release as a stand-alone project. Migrated over
//       from jquery-misc repo v0.4 to jquery-throttle repo v1.0, added the
//       no_trailing throttle parameter and debounce functionality.
// 
// Topic: Note for non-jQuery users
// 
// jQuery isn't actually required for this plugin, because nothing internal
// uses any jQuery methods or properties. jQuery is just used as a namespace
// under which these methods can exist.
// 
// Since jQuery isn't actually required for this plugin, if jQuery doesn't exist
// when this plugin is loaded, the method described below will be created in
// the `Cowboy` namespace. Usage will be exactly the same, but instead of
// $.method() or jQuery.method(), you'll need to use Cowboy.method().

(function (window, undefined) {
    '$:nomunge'; // Used by YUI compressor.

    // Since jQuery really isn't required for this plugin, use `jQuery` as the
    // namespace only if it already exists, otherwise use the `Cowboy` namespace,
    // creating it if necessary.
    var $ = window.jQuery || window.Cowboy || (window.Cowboy = {}),

        // Internal method reference.
        jq_throttle;

    // Method: jQuery.throttle
    // 
    // Throttle execution of a function. Especially useful for rate limiting
    // execution of handlers on events like resize and scroll. If you want to
    // rate-limit execution of a function to a single time, see the
    // <jQuery.debounce> method.
    // 
    // In this visualization, | is a throttled-function call and X is the actual
    // callback execution:
    // 
    // > Throttled with `no_trailing` specified as false or unspecified:
    // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
    // > X    X    X    X    X    X        X    X    X    X    X    X
    // > 
    // > Throttled with `no_trailing` specified as true:
    // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
    // > X    X    X    X    X             X    X    X    X    X
    // 
    // Usage:
    // 
    // > var throttled = jQuery.throttle( delay, [ no_trailing, ] callback );
    // > 
    // > jQuery('selector').bind( 'someevent', throttled );
    // > jQuery('selector').unbind( 'someevent', throttled );
    // 
    // This also works in jQuery 1.4+:
    // 
    // > jQuery('selector').bind( 'someevent', jQuery.throttle( delay, [ no_trailing, ] callback ) );
    // > jQuery('selector').unbind( 'someevent', callback );
    // 
    // Arguments:
    // 
    //  delay - (Number) A zero-or-greater delay in milliseconds. For event
    //    callbacks, values around 100 or 250 (or even higher) are most useful.
    //  no_trailing - (Boolean) Optional, defaults to false. If no_trailing is
    //    true, callback will only execute every `delay` milliseconds while the
    //    throttled-function is being called. If no_trailing is false or
    //    unspecified, callback will be executed one final time after the last
    //    throttled-function call. (After the throttled-function has not been
    //    called for `delay` milliseconds, the internal counter is reset)
    //  callback - (Function) A function to be executed after delay milliseconds.
    //    The `this` context and all arguments are passed through, as-is, to
    //    `callback` when the throttled-function is executed.
    // 
    // Returns:
    // 
    //  (Function) A new, throttled, function.

    $.throttle = jq_throttle = function (delay, no_trailing, callback, debounce_mode) {
        // After wrapper has stopped being called, this timeout ensures that
        // `callback` is executed at the proper times in `throttle` and `end`
        // debounce modes.
        var timeout_id,

            // Keep track of the last time `callback` was executed.
            last_exec = 0;

        // `no_trailing` defaults to falsy.
        if (typeof no_trailing !== 'boolean') {
            debounce_mode = callback;
            callback = no_trailing;
            no_trailing = undefined;
        }

        // The `wrapper` function encapsulates all of the throttling / debouncing
        // functionality and when executed will limit the rate at which `callback`
        // is executed.
        function wrapper() {
            var that = this,
                elapsed = +new Date() - last_exec,
                args = arguments;

            // Execute `callback` and update the `last_exec` timestamp.
            function exec() {
                last_exec = +new Date();
                callback.apply(that, args);
            };

            // If `debounce_mode` is true (at_begin) this is used to clear the flag
            // to allow future `callback` executions.
            function clear() {
                timeout_id = undefined;
            };

            if (debounce_mode && !timeout_id) {
                // Since `wrapper` is being called for the first time and
                // `debounce_mode` is true (at_begin), execute `callback`.
                exec();
            }

            // Clear any existing timeout.
            timeout_id && clearTimeout(timeout_id);

            if (debounce_mode === undefined && elapsed > delay) {
                // In throttle mode, if `delay` time has been exceeded, execute
                // `callback`.
                exec();

            } else if (no_trailing !== true) {
                // In trailing throttle mode, since `delay` time has not been
                // exceeded, schedule `callback` to execute `delay` ms after most
                // recent execution.
                // 
                // If `debounce_mode` is true (at_begin), schedule `clear` to execute
                // after `delay` ms.
                // 
                // If `debounce_mode` is false (at end), schedule `callback` to
                // execute after `delay` ms.
                timeout_id = setTimeout(debounce_mode ? clear : exec, debounce_mode === undefined ? delay - elapsed : delay);
            }
        };

        // Set the guid of `wrapper` function to the same of original callback, so
        // it can be removed in jQuery 1.4+ .unbind or .die by using the original
        // callback as a reference.
        if ($.guid) {
            wrapper.guid = callback.guid = callback.guid || $.guid++;
        }

        // Return the wrapper function.
        return wrapper;
    };

    // Method: jQuery.debounce
    // 
    // Debounce execution of a function. Debouncing, unlike throttling,
    // guarantees that a function is only executed a single time, either at the
    // very beginning of a series of calls, or at the very end. If you want to
    // simply rate-limit execution of a function, see the <jQuery.throttle>
    // method.
    // 
    // In this visualization, | is a debounced-function call and X is the actual
    // callback execution:
    // 
    // > Debounced with `at_begin` specified as false or unspecified:
    // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
    // >                          X                                 X
    // > 
    // > Debounced with `at_begin` specified as true:
    // > ||||||||||||||||||||||||| (pause) |||||||||||||||||||||||||
    // > X                                 X
    // 
    // Usage:
    // 
    // > var debounced = jQuery.debounce( delay, [ at_begin, ] callback );
    // > 
    // > jQuery('selector').bind( 'someevent', debounced );
    // > jQuery('selector').unbind( 'someevent', debounced );
    // 
    // This also works in jQuery 1.4+:
    // 
    // > jQuery('selector').bind( 'someevent', jQuery.debounce( delay, [ at_begin, ] callback ) );
    // > jQuery('selector').unbind( 'someevent', callback );
    // 
    // Arguments:
    // 
    //  delay - (Number) A zero-or-greater delay in milliseconds. For event
    //    callbacks, values around 100 or 250 (or even higher) are most useful.
    //  at_begin - (Boolean) Optional, defaults to false. If at_begin is false or
    //    unspecified, callback will only be executed `delay` milliseconds after
    //    the last debounced-function call. If at_begin is true, callback will be
    //    executed only at the first debounced-function call. (After the
    //    throttled-function has not been called for `delay` milliseconds, the
    //    internal counter is reset)
    //  callback - (Function) A function to be executed after delay milliseconds.
    //    The `this` context and all arguments are passed through, as-is, to
    //    `callback` when the debounced-function is executed.
    // 
    // Returns:
    // 
    //  (Function) A new, debounced, function.

    $.debounce = function (delay, at_begin, callback) {
        return callback === undefined
            ? jq_throttle(delay, at_begin, false)
            : jq_throttle(delay, callback, at_begin !== false);
    };

})(window);
(function ($) {

    $.fn.shuffle = function () {

        var allElems = this.get(),
            getRandom = function (max) {
                return Math.floor(Math.random() * max);
            },
            shuffled = $.map(allElems, function () {
                var random = getRandom(allElems.length),
                    randEl = $(allElems[random]).clone(true)[0];
                allElems.splice(random, 1);
                return randEl;
            });

        this.each(function (i) {
            $(this).replaceWith($(shuffled[i]));
        });

        return $(shuffled);

    };

})(jQuery);
/*!
 * Bowser - a browser detector
 * https://github.com/ded/bowser
 * MIT License | (c) Dustin Diaz 2015
 */
  
!function (root, name, definition) {
    if (typeof module != 'undefined' && module.exports) module.exports = definition()
    else if (typeof define == 'function' && define.amd) define(name, definition)
    else {
        window[name] = definition()
    }
}(this, 'bowser', function () {
    /**
      * See useragents.js for examples of navigator.userAgent
      */

    var t = true

    function detect(ua) {

        function getFirstMatch(regex) {
            var match = ua.match(regex);
            return (match && match.length > 1 && match[1]) || '';
        }

        function getSecondMatch(regex) {
            var match = ua.match(regex);
            return (match && match.length > 1 && match[2]) || '';
        }

        var iosdevice = getFirstMatch(/(ipod|iphone|ipad)/i).toLowerCase()
            , likeAndroid = /like android/i.test(ua)
            , android = !likeAndroid && /android/i.test(ua)
            , nexusMobile = /nexus\s*[0-6]\s*/i.test(ua)
            , nexusTablet = !nexusMobile && /nexus\s*[0-9]+/i.test(ua)
            , chromeos = /CrOS/.test(ua)
            , silk = /silk/i.test(ua)
            , sailfish = /sailfish/i.test(ua)
            , tizen = /tizen/i.test(ua)
            , webos = /(web|hpw)(o|0)s/i.test(ua)
            , windowsphone = /windows phone/i.test(ua)
            , samsungBrowser = /SamsungBrowser/i.test(ua)
            , windows = !windowsphone && /windows/i.test(ua)
            , mac = !iosdevice && !silk && /macintosh/i.test(ua)
            , linux = !android && !sailfish && !tizen && !webos && /linux/i.test(ua)
            , edgeVersion = getSecondMatch(/edg([ea]|ios)\/(\d+(\.\d+)?)/i)
            , versionIdentifier = getFirstMatch(/version\/(\d+(\.\d+)?)/i)
            , tablet = /tablet/i.test(ua) && !/tablet pc/i.test(ua)
            , mobile = !tablet && /[^-]mobi/i.test(ua)
            , xbox = /xbox/i.test(ua)
            , result

        if (/opera/i.test(ua)) {
            //  an old Opera
            result = {
                name: 'Opera'
                , opera: t
                , version: versionIdentifier || getFirstMatch(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)
            }
        } else if (/opr\/|opios/i.test(ua)) {
            // a new Opera
            result = {
                name: 'Opera'
                , opera: t
                , version: getFirstMatch(/(?:opr|opios)[\s\/](\d+(\.\d+)?)/i) || versionIdentifier
            }
        }
        else if (/SamsungBrowser/i.test(ua)) {
            result = {
                name: 'Samsung Internet for Android'
                , samsungBrowser: t
                , version: versionIdentifier || getFirstMatch(/(?:SamsungBrowser)[\s\/](\d+(\.\d+)?)/i)
            }
        }
        else if (/Whale/i.test(ua)) {
            result = {
                name: 'NAVER Whale browser'
                , whale: t
                , version: getFirstMatch(/(?:whale)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/MZBrowser/i.test(ua)) {
            result = {
                name: 'MZ Browser'
                , mzbrowser: t
                , version: getFirstMatch(/(?:MZBrowser)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/coast/i.test(ua)) {
            result = {
                name: 'Opera Coast'
                , coast: t
                , version: versionIdentifier || getFirstMatch(/(?:coast)[\s\/](\d+(\.\d+)?)/i)
            }
        }
        else if (/focus/i.test(ua)) {
            result = {
                name: 'Focus'
                , focus: t
                , version: getFirstMatch(/(?:focus)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/yabrowser/i.test(ua)) {
            result = {
                name: 'Yandex Browser'
                , yandexbrowser: t
                , version: versionIdentifier || getFirstMatch(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)
            }
        }
        else if (/ucbrowser/i.test(ua)) {
            result = {
                name: 'UC Browser'
                , ucbrowser: t
                , version: getFirstMatch(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/mxios/i.test(ua)) {
            result = {
                name: 'Maxthon'
                , maxthon: t
                , version: getFirstMatch(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/epiphany/i.test(ua)) {
            result = {
                name: 'Epiphany'
                , epiphany: t
                , version: getFirstMatch(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/puffin/i.test(ua)) {
            result = {
                name: 'Puffin'
                , puffin: t
                , version: getFirstMatch(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)
            }
        }
        else if (/sleipnir/i.test(ua)) {
            result = {
                name: 'Sleipnir'
                , sleipnir: t
                , version: getFirstMatch(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (/k-meleon/i.test(ua)) {
            result = {
                name: 'K-Meleon'
                , kMeleon: t
                , version: getFirstMatch(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)
            }
        }
        else if (windowsphone) {
            result = {
                name: 'Windows Phone'
                , osname: 'Windows Phone'
                , windowsphone: t
            }
            if (edgeVersion) {
                result.msedge = t
                result.version = edgeVersion
            }
            else {
                result.msie = t
                result.version = getFirstMatch(/iemobile\/(\d+(\.\d+)?)/i)
            }
        }
        else if (/msie|trident/i.test(ua)) {
            result = {
                name: 'Internet Explorer'
                , msie: t
                , version: getFirstMatch(/(?:msie |rv:)(\d+(\.\d+)?)/i)
            }
        } else if (chromeos) {
            result = {
                name: 'Chrome'
                , osname: 'Chrome OS'
                , chromeos: t
                , chromeBook: t
                , chrome: t
                , version: getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)
            }
        } else if (/edg([ea]|ios)/i.test(ua)) {
            result = {
                name: 'Microsoft Edge'
                , msedge: t
                , version: edgeVersion
            }
        }
        else if (/vivaldi/i.test(ua)) {
            result = {
                name: 'Vivaldi'
                , vivaldi: t
                , version: getFirstMatch(/vivaldi\/(\d+(\.\d+)?)/i) || versionIdentifier
            }
        }
        else if (sailfish) {
            result = {
                name: 'Sailfish'
                , osname: 'Sailfish OS'
                , sailfish: t
                , version: getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i)
            }
        }
        else if (/seamonkey\//i.test(ua)) {
            result = {
                name: 'SeaMonkey'
                , seamonkey: t
                , version: getFirstMatch(/seamonkey\/(\d+(\.\d+)?)/i)
            }
        }
        else if (/firefox|iceweasel|fxios/i.test(ua)) {
            result = {
                name: 'Firefox'
                , firefox: t
                , version: getFirstMatch(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)
            }
            if (/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(ua)) {
                result.firefoxos = t
                result.osname = 'Firefox OS'
            }
        }
        else if (silk) {
            result = {
                name: 'Amazon Silk'
                , silk: t
                , version: getFirstMatch(/silk\/(\d+(\.\d+)?)/i)
            }
        }
        else if (/phantom/i.test(ua)) {
            result = {
                name: 'PhantomJS'
                , phantom: t
                , version: getFirstMatch(/phantomjs\/(\d+(\.\d+)?)/i)
            }
        }
        else if (/slimerjs/i.test(ua)) {
            result = {
                name: 'SlimerJS'
                , slimer: t
                , version: getFirstMatch(/slimerjs\/(\d+(\.\d+)?)/i)
            }
        }
        else if (/blackberry|\bbb\d+/i.test(ua) || /rim\stablet/i.test(ua)) {
            result = {
                name: 'BlackBerry'
                , osname: 'BlackBerry OS'
                , blackberry: t
                , version: versionIdentifier || getFirstMatch(/blackberry[\d]+\/(\d+(\.\d+)?)/i)
            }
        }
        else if (webos) {
            result = {
                name: 'WebOS'
                , osname: 'WebOS'
                , webos: t
                , version: versionIdentifier || getFirstMatch(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)
            };
            /touchpad\//i.test(ua) && (result.touchpad = t)
        }
        else if (/bada/i.test(ua)) {
            result = {
                name: 'Bada'
                , osname: 'Bada'
                , bada: t
                , version: getFirstMatch(/dolfin\/(\d+(\.\d+)?)/i)
            };
        }
        else if (tizen) {
            result = {
                name: 'Tizen'
                , osname: 'Tizen'
                , tizen: t
                , version: getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i) || versionIdentifier
            };
        }
        else if (/qupzilla/i.test(ua)) {
            result = {
                name: 'QupZilla'
                , qupzilla: t
                , version: getFirstMatch(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i) || versionIdentifier
            }
        }
        else if (/chromium/i.test(ua)) {
            result = {
                name: 'Chromium'
                , chromium: t
                , version: getFirstMatch(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i) || versionIdentifier
            }
        }
        else if (/chrome|crios|crmo/i.test(ua)) {
            result = {
                name: 'Chrome'
                , chrome: t
                , version: getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)
            }
        }
        else if (android) {
            result = {
                name: 'Android'
                , version: versionIdentifier
            }
        }
        else if (/safari|applewebkit/i.test(ua)) {
            result = {
                name: 'Safari'
                , safari: t
            }
            if (versionIdentifier) {
                result.version = versionIdentifier
            }
        }
        else if (iosdevice) {
            result = {
                name: iosdevice == 'iphone' ? 'iPhone' : iosdevice == 'ipad' ? 'iPad' : 'iPod'
            }
            // WTF: version is not part of user agent in web apps
            if (versionIdentifier) {
                result.version = versionIdentifier
            }
        }
        else if (/googlebot/i.test(ua)) {
            result = {
                name: 'Googlebot'
                , googlebot: t
                , version: getFirstMatch(/googlebot\/(\d+(\.\d+))/i) || versionIdentifier
            }
        }
        else {
            result = {
                name: getFirstMatch(/^(.*)\/(.*) /),
                version: getSecondMatch(/^(.*)\/(.*) /)
            };
        }

        // set webkit or gecko flag for browsers based on these engines
        if (!result.msedge && /(apple)?webkit/i.test(ua)) {
            if (/(apple)?webkit\/537\.36/i.test(ua)) {
                result.name = result.name || "Blink"
                result.blink = t
            } else {
                result.name = result.name || "Webkit"
                result.webkit = t
            }
            if (!result.version && versionIdentifier) {
                result.version = versionIdentifier
            }
        } else if (!result.opera && /gecko\//i.test(ua)) {
            result.name = result.name || "Gecko"
            result.gecko = t
            result.version = result.version || getFirstMatch(/gecko\/(\d+(\.\d+)?)/i)
        }

        // set OS flags for platforms that have multiple browsers
        if (!result.windowsphone && (android || result.silk)) {
            result.android = t
            result.osname = 'Android'
        } else if (!result.windowsphone && iosdevice) {
            result[iosdevice] = t
            result.ios = t
            result.osname = 'iOS'
        } else if (mac) {
            result.mac = t
            result.osname = 'macOS'
        } else if (xbox) {
            result.xbox = t
            result.osname = 'Xbox'
        } else if (windows) {
            result.windows = t
            result.osname = 'Windows'
        } else if (linux) {
            result.linux = t
            result.osname = 'Linux'
        }

        function getWindowsVersion(s) {
            switch (s) {
                case 'NT': return 'NT'
                case 'XP': return 'XP'
                case 'NT 5.0': return '2000'
                case 'NT 5.1': return 'XP'
                case 'NT 5.2': return '2003'
                case 'NT 6.0': return 'Vista'
                case 'NT 6.1': return '7'
                case 'NT 6.2': return '8'
                case 'NT 6.3': return '8.1'
                case 'NT 10.0': return '10'
                default: return undefined
            }
        }

        // OS version extraction
        var osVersion = '';
        if (result.windows) {
            osVersion = getWindowsVersion(getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i))
        } else if (result.windowsphone) {
            osVersion = getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i);
        } else if (result.mac) {
            osVersion = getFirstMatch(/Mac OS X (\d+([_\.\s]\d+)*)/i);
            osVersion = osVersion.replace(/[_\s]/g, '.');
        } else if (iosdevice) {
            osVersion = getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i);
            osVersion = osVersion.replace(/[_\s]/g, '.');
        } else if (android) {
            osVersion = getFirstMatch(/android[ \/-](\d+(\.\d+)*)/i);
        } else if (result.webos) {
            osVersion = getFirstMatch(/(?:web|hpw)os\/(\d+(\.\d+)*)/i);
        } else if (result.blackberry) {
            osVersion = getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i);
        } else if (result.bada) {
            osVersion = getFirstMatch(/bada\/(\d+(\.\d+)*)/i);
        } else if (result.tizen) {
            osVersion = getFirstMatch(/tizen[\/\s](\d+(\.\d+)*)/i);
        }
        if (osVersion) {
            result.osversion = osVersion;
        }

        // device type extraction
        var osMajorVersion = !result.windows && osVersion.split('.')[0];
        if (
            tablet
            || nexusTablet
            || iosdevice == 'ipad'
            || (android && (osMajorVersion == 3 || (osMajorVersion >= 4 && !mobile)))
            || result.silk
        ) {
            result.tablet = t
        } else if (
            mobile
            || iosdevice == 'iphone'
            || iosdevice == 'ipod'
            || android
            || nexusMobile
            || result.blackberry
            || result.webos
            || result.bada
        ) {
            result.mobile = t
        }

        // Graded Browser Support
        // http://developer.yahoo.com/yui/articles/gbs
        if (result.msedge ||
            (result.msie && result.version >= 10) ||
            (result.yandexbrowser && result.version >= 15) ||
            (result.vivaldi && result.version >= 1.0) ||
            (result.chrome && result.version >= 20) ||
            (result.samsungBrowser && result.version >= 4) ||
            (result.whale && compareVersions([result.version, '1.0']) === 1) ||
            (result.mzbrowser && compareVersions([result.version, '6.0']) === 1) ||
            (result.focus && compareVersions([result.version, '1.0']) === 1) ||
            (result.firefox && result.version >= 20.0) ||
            (result.safari && result.version >= 6) ||
            (result.opera && result.version >= 10.0) ||
            (result.ios && result.osversion && result.osversion.split(".")[0] >= 6) ||
            (result.blackberry && result.version >= 10.1)
            || (result.chromium && result.version >= 20)
        ) {
            result.a = t;
        }
        else if ((result.msie && result.version < 10) ||
            (result.chrome && result.version < 20) ||
            (result.firefox && result.version < 20.0) ||
            (result.safari && result.version < 6) ||
            (result.opera && result.version < 10.0) ||
            (result.ios && result.osversion && result.osversion.split(".")[0] < 6)
            || (result.chromium && result.version < 20)
        ) {
            result.c = t
        } else result.x = t

        return result
    }

    var bowser = detect(typeof navigator !== 'undefined' ? navigator.userAgent || '' : '')

    bowser.test = function (browserList) {
        for (var i = 0; i < browserList.length; ++i) {
            var browserItem = browserList[i];
            if (typeof browserItem === 'string') {
                if (browserItem in bowser) {
                    return true;
                }
            }
        }
        return false;
    }

    /**
     * Get version precisions count
     *
     * @example
     *   getVersionPrecision("1.10.3") // 3
     *
     * @param  {string} version
     * @return {number}
     */
    function getVersionPrecision(version) {
        return version.split(".").length;
    }

    /**
     * Array::map polyfill
     *
     * @param  {Array} arr
     * @param  {Function} iterator
     * @return {Array}
     */
    function map(arr, iterator) {
        var result = [], i;
        if (Array.prototype.map) {
            return Array.prototype.map.call(arr, iterator);
        }
        for (i = 0; i < arr.length; i++) {
            result.push(iterator(arr[i]));
        }
        return result;
    }

    /**
     * Calculate browser version weight
     *
     * @example
     *   compareVersions(['1.10.2.1',  '1.8.2.1.90'])    // 1
     *   compareVersions(['1.010.2.1', '1.09.2.1.90']);  // 1
     *   compareVersions(['1.10.2.1',  '1.10.2.1']);     // 0
     *   compareVersions(['1.10.2.1',  '1.0800.2']);     // -1
     *
     * @param  {Array<String>} versions versions to compare
     * @return {Number} comparison result
     */
    function compareVersions(versions) {
        // 1) get common precision for both versions, for example for "10.0" and "9" it should be 2
        var precision = Math.max(getVersionPrecision(versions[0]), getVersionPrecision(versions[1]));
        var chunks = map(versions, function (version) {
            var delta = precision - getVersionPrecision(version);

            // 2) "9" -> "9.0" (for precision = 2)
            version = version + new Array(delta + 1).join(".0");

            // 3) "9.0" -> ["000000000"", "000000009"]
            return map(version.split("."), function (chunk) {
                return new Array(20 - chunk.length).join("0") + chunk;
            }).reverse();
        });

        // iterate in reverse order by reversed chunks array
        while (--precision >= 0) {
            // 4) compare: "000000009" > "000000010" = false (but "9" > "10" = true)
            if (chunks[0][precision] > chunks[1][precision]) {
                return 1;
            }
            else if (chunks[0][precision] === chunks[1][precision]) {
                if (precision === 0) {
                    // all version chunks are same
                    return 0;
                }
            }
            else {
                return -1;
            }
        }
    }

    /**
     * Check if browser is unsupported
     *
     * @example
     *   bowser.isUnsupportedBrowser({
     *     msie: "10",
     *     firefox: "23",
     *     chrome: "29",
     *     safari: "5.1",
     *     opera: "16",
     *     phantom: "534"
     *   });
     *
     * @param  {Object}  minVersions map of minimal version to browser
     * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map
     * @param  {String}  [ua] user agent string
     * @return {Boolean}
     */
    function isUnsupportedBrowser(minVersions, strictMode, ua) {
        var _bowser = bowser;

        // make strictMode param optional with ua param usage
        if (typeof strictMode === 'string') {
            ua = strictMode;
            strictMode = void (0);
        }

        if (strictMode === void (0)) {
            strictMode = false;
        }
        if (ua) {
            _bowser = detect(ua);
        }

        var version = "" + _bowser.version;
        for (var browser in minVersions) {
            if (minVersions.hasOwnProperty(browser)) {
                if (_bowser[browser]) {
                    if (typeof minVersions[browser] !== 'string') {
                        throw new Error('Browser version in the minVersion map should be a string: ' + browser + ': ' + String(minVersions));
                    }

                    // browser version and min supported version.
                    return compareVersions([version, minVersions[browser]]) < 0;
                }
            }
        }

        return strictMode; // not found
    }

    /**
     * Check if browser is supported
     *
     * @param  {Object} minVersions map of minimal version to browser
     * @param  {Boolean} [strictMode = false] flag to return false if browser wasn't found in map
     * @param  {String}  [ua] user agent string
     * @return {Boolean}
     */
    function check(minVersions, strictMode, ua) {
        return !isUnsupportedBrowser(minVersions, strictMode, ua);
    }

    bowser.isUnsupportedBrowser = isUnsupportedBrowser;
    bowser.compareVersions = compareVersions;
    bowser.check = check;

    /*
     * Set our detect method to the main bowser object so we can
     * reuse it to test other user agents.
     * This is needed to implement future tests.
     */
    bowser._detect = detect;

    /*
     * Set our detect public method to the main bowser object
     * This is needed to implement bowser in server side
     */
    bowser.detect = detect;
    return bowser
});
if (typeof String.prototype.endsWith !== 'function') {
    String.prototype.endsWith = function (suffix) {
        return this.indexOf(suffix, this.length - suffix.length) !== -1;
    };
}

if (typeof String.prototype.replaceAll !== 'function') {
    String.prototype.replaceAll = function (search, replacement) {
        var target = this;
        return target.replace(new RegExp(search, 'g'), replacement);
    };
}
var layoutr = window.layoutr || {};

{
    layoutr.siteName = 'layoutr';

    layoutr.throttleInterval = 50;
    layoutr.debounceInterval = 50;

    layoutr.transitionTime = 400;
    layoutr.fadeOutTime = 500;
    layoutr.htmlOverflowEnabled = true;
    layoutr.smallBreakpoint = 732;
    layoutr.scrollbarWidth = 0;
    layoutr.loadingCount = 0;
    layoutr.document = document.documentElement;
    layoutr.fullscreen = false;
    layoutr.ajax = 'dist/ajax/';

    layoutr.navigation = [];
    bowser.desktop = !bowser.mobile && !bowser.tablet;

    var l = window.location;

    var segmentCount = l.origin.endsWith('github.io') ? 1 : 0;
    layoutr.host = l.protocol + '//' + l.hostname + (l.port ? ':' + l.port : '') + l.pathname.split('/').slice(0, 1 + segmentCount).join('/') + '/';

    layoutr.awaitInterval = 50;

    layoutr.isLocalhost = l.hostname === 'localhost' || l.hostname === '127.0.0.1' || l.hostname === '192.168.40.100';

    layoutr.settings = JSON.parse(localStorage.getItem("settings"));
    if (layoutr.settings === null) layoutr.settings = [];
    layoutr.theme = 'light';
    layoutr.settings.forEach((entry) => {
        if (entry.name === 'theme') {
            layoutr.theme = entry.id.substring(entry.id.indexOf("-") + 1);
        }
    });

    $(() => {
        layoutr.html = $('html');
        layoutr.head = $('head');
        layoutr.body = $('body');
        layoutr.main = $('main');
        layoutr.content = $('#content > div');
        layoutr.header = $('header');
        layoutr.footer = $('footer');
        layoutr.left = $('#left');
        layoutr.right = $('#right');
        layoutr.loading = $('#loading');
        layoutr.overflow = $('#overflow');
        layoutr.modal = $('#modal');
        layoutr.title = $('#title');
        layoutr.authentication = $('#authentication');
        layoutr.unauthenticated = layoutr.authentication.children('.unauthenticated');
        layoutr.authenticated = layoutr.authentication.children('.authenticated');
        layoutr.authenticatedLinks = layoutr.authentication.find('.links');
        layoutr.cookie = $('#cookie');
        layoutr.focus = $('#focus');
    });
}
{
    layoutr.guid = () => {
        let s4 = () => {
            return Math.floor((1 + Math.random()) * 0x10000)
                .toString(16)
                .substring(1);
        }
        return s4() + s4() + '-' + s4() + '-' + s4() + '-' +
            s4() + '-' + s4() + s4() + s4();
    };

    layoutr.isSmallBreakpoint = () => {
        return $(window).outerWidth() < 732 || layoutr.isAsideLeft() && !layoutr.isAsideLeftShrink() || layoutr.isAsideRight() && !layoutr.isAsideRightShrink();
    };

    layoutr.isAside = () => {
        return layoutr.html.attr('data-aside').length;
    };

    layoutr.isAsideLeft = () => {
        return layoutr.html.attr('data-aside') === 'left';
    };

    layoutr.isAsideRight = () => {
        return layoutr.html.attr('data-aside') === 'right';
    };

    layoutr.isAsideLeftShrink = () => {
        return layoutr.html.hasClass('left-shrink') && layoutr.isAsideLeft();
    };

    layoutr.isAsideRightShrink = () => {
        return layoutr.html.hasClass('right-shrink') && layoutr.isAsideRight();
    };

    layoutr.isAsideLeftCloseOnClickOutside = () => {
        return layoutr.html.hasClass('close-left-click-outside');
    };
    layoutr.isAsideRightCloseOnClickOutside = () => {
        return layoutr.html.hasClass('close-right-click-outside');
    };

    layoutr.isModal = () => {
        return layoutr.html.hasClass('modal');
    };

    layoutr.isModalForm = () => {
        return layoutr.html.attr('data-modal') === 'form';
    };

    layoutr.isModalImage = () => {
        return layoutr.html.attr('data-modal') === 'image';
    };

    layoutr.isFocus = () => {
        return layoutr.html.hasClass('focus') && layoutr.html.attr('data-focus') === 'true';
    }

    layoutr.isTTS = () => {
        return layoutr.html.hasClass('tts');
    }

    layoutr.isTTSEnabled = () => {
        return layoutr.html.hasClass('tts') && layoutr.html.attr('data-tts') === 'true';
    }
    layoutr.isAuthentication = () => {
        return layoutr.html.attr('data-authentication') !== '';
    };

    layoutr.isLoading = () => {
        return layoutr.html.hasClass('loading');
    };

    layoutr.isScrollDisabled = () => {
        return layoutr.html.hasClass('scroll-disabled');
    };

    layoutr.isCloseLeftPageChange = () => {
        return layoutr.html.hasClass('close-left-page-change');
    };

    layoutr.isTransitions = () => {
        return layoutr.html.hasClass('transitions');
    };

    layoutr.isSwipe = () => {
        return layoutr.html.hasClass('swipe');
    };

    layoutr.isSiteLoaded = () => {
        return layoutr.html.hasClass('site-loaded');
    };

    layoutr.capitalize = (string) => {
        return string.charAt(0).toUpperCase() + string.slice(1);
    };

    layoutr.scrollTop = () => {
        return Math.max(layoutr.body.scrollTop(), layoutr.main.scrollTop(), layoutr.html.scrollTop());
    };

    layoutr.tryParseInt = (str, defaultValue) => {
        let retValue = defaultValue;
        if (str !== undefined && str !== null && str.length > 0 && !isNaN(str)) {
            retValue = parseInt(str);
        }
        return retValue;
    };

    layoutr.tryParseFloat = (str, defaultValue) => {
        let retValue = defaultValue;
        if (str !== undefined && str !== null && str.length > 0 && !isNaN(str)) {
            retValue = parseFloat(str);
        }
        return retValue;
    };

    layoutr.tryParseJSON = (str, defaultValue) => {
        let retValue = defaultValue;
        try {
            retValue = JSON.parse(str);
        } catch (e) {
        }
        return retValue;
    };

    layoutr.isTrue = (str) => {
        return str === 'true';
    };
}
{
    $(() => {
        if (bowser.msedge) {
            layoutr.html.addClass('msedge'); // used by layoutr.enableScroll()
        } else if (bowser.msie) {
            layoutr.html.addClass('msie'); // not currently used for anything
        }
        if (bowser.mobile) {
            layoutr.html.addClass('mobile'); // disables fixed footer
        } else if (bowser.tablet) {
            layoutr.html.addClass('tablet'); // does nothing currently
        } else {
            layoutr.html.addClass('desktop'); // enables hover effects
        }

        if (bowser.android) {
            layoutr.html.addClass('android'); // used by modal
        } else if (bowser.ios) {
            layoutr.html.addClass('ios'); // used to apply focus
        }

        if (bowser.msie || bowser.msedge) {
            // disable smooth scrolling, since it causes element jumping/lagging on scroll
            // https://stackoverflow.com/questions/29416448/how-to-disable-smooth-scrolling-in-ie11
            layoutr.body.on("mousewheel", (e) => {
                let target = $(e.target);
                if (!layoutr.isModal() && event.ctrlKey !== true) {
                    e.preventDefault();
                    let aside = target.closest('aside > .content') || target.parents('aside .content'),
                        wheelDelta = e.originalEvent.wheelDelta,
                        currentScrollPosition;
                    if (aside.length) {
                        currentScrollPosition = aside.scrollTop();
                        aside.scrollTop(currentScrollPosition - wheelDelta);
                    } else {
                        currentScrollPosition = window.pageYOffset;
                        window.scrollTo(0, currentScrollPosition - wheelDelta);
                    }
                }
            });

            // at some zoom levels edge/ie makes $(window) heigher than $(document)
            // it causes a gap between footer and the bottom of $(window).
            $(window).scroll(() => {
                let scrollTop = self.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop;
                if (scrollTop + $(window).height() >= $(document).height()) {
                    layoutr.html.addClass('subpixel');
                } else {
                    layoutr.html.removeClass('subpixel');
                }
            });
        }
    });
}
{
    $(() => {
        $.validator.setDefaults({
            submitHandler: () => {
                alert("Fake submitted!");
            }
        });

        $.validator.addMethod('password_regex', (value) => {
            return /^(?=.*[a-zæøå])(?=.*[A-ZÆØÅ])(?=.*\d).{8,}$/.test(value);
        }, 'Password must contain at least eight characters, one uppercase letter, one lowercase letter and one number');
    });

    layoutr.addValidation = (form, rules, messages) => {
        form.validate({
            rules: rules,
            messages: messages,
            errorElement: "em",
            errorPlacement: (error, element) => {
                element = element.parent();
                if (element.hasClass('checkbox') || element.hasClass('radio') || element.hasClass('input-group')) {
                    element = element.parent();
                }
                element.append(error);
            },
            highlight: (element, errorClass, validClass) => {
                $(element).parents(".form-group").addClass("theme-danger");
            },
            unhighlight: (element, errorClass, validClass) => {
                $(element).parents(".form-group").removeClass("theme-danger");
            }
        });
        form.on('change', 'input, textarea, select', (e) => {
            $(e.currentTarget).valid();
        });
    };
}
{
    layoutr.load = (() => {
        // Function which returns a function: https://davidwalsh.name/javascript-functions
        let _load = (tag) => {
            return (url) => {
                // This promise will be used by Promise.all to determine success or failure
                return new Promise((resolve, reject) => {
                    if (tag === 'link' || tag === 'script' || tag === 'img') {
                        var element = document.createElement(tag);
                        var parent = 'body';
                        var attr = 'src';

                        // Important success and error for the promise
                        element.onload = () => {
                            resolve();
                        };
                        element.onerror = () => {
                            reject();
                        };

                        // Need to set different attributes depending on tag type
                        switch (tag) {
                            case 'script':
                                element.async = true;
                                break;
                            case 'link':
                                element.type = 'text/css';
                                element.rel = 'stylesheet';
                                attr = 'href';
                                parent = 'head';
                        }

                        // Inject into document to kick off loading
                        element[attr] = url;

                        if (tag === 'link' || tag === 'script') {
                            document[parent].appendChild(element);
                        }
                    } else if (tag === 'html') {
                        fetch(url).then((response) => {
                            if (response.status === 200) {
                                return response.text();
                            } else {
                                reject(response.status);
                            }
                        }).then((response) => {
                            resolve(response);
                        });
                    }
                });
            };
        }

        return {
            css: _load('link'),
            js: _load('script'),
            img: _load('img'),
            html: _load('html')
        }
    })();
}
{
    // Set this to your tracking ID
    var trackingId = 'UA-99633521-2';

    function sendAnalyticsEvent(eventAction, eventCategory) {
        'use strict';

        console.log('Sending analytics event: ' + eventCategory + '/' + eventAction);

        if (!trackingId) {
            console.error('You need your tracking ID in analytics-helper.js');
            console.error('Add this code:\nvar trackingId = \'UA-XXXXXXXX-X\';');
            // We want this to be a safe method, so avoid throwing unless absolutely necessary.
            return Promise.resolve();
        }

        if (!eventAction && !eventCategory) {
            console.warn('sendAnalyticsEvent() called with no eventAction or ' +
                'eventCategory.');
            // We want this to be a safe method, so avoid throwing unless absolutely necessary.
            return Promise.resolve();
        }

        return self.registration.pushManager.getSubscription()
            .then((subscription) => {
                if (subscription === null) {
                    throw new Error('No subscription currently available.');
                }

                // Create hit data
                var payloadData = {
                    // Version Number
                    v: 1,
                    // Client ID
                    cid: subscription.endpoint,
                    // Tracking ID
                    tid: trackingId,
                    // Hit Type
                    t: 'event',
                    // Event Category
                    ec: eventCategory,
                    // Event Action
                    ea: eventAction,
                    // Event Label
                    el: 'serviceworker'
                };

                // Format hit data into URI
                var payloadString = Object.keys(payloadData)
                    .filter((analyticsKey) => {
                        return payloadData[analyticsKey];
                    })
                    .map((analyticsKey) => {
                        return analyticsKey + '=' + encodeURIComponent(payloadData[analyticsKey]);
                    })
                    .join('&');

                // Post to Google Analytics endpoint
                return fetch('https://www.google-analytics.com/collect', {
                    method: 'post',
                    body: payloadString
                });
            })
            .then((response) => {
                if (!response.ok) {
                    return response.text()
                        .then((responseText) => {
                            throw new Error(
                                'Bad response from Google Analytics:\n' + response.status
                            );
                        });
                } else {
                    console.log(eventCategory + '/' + eventAction +
                        'hit sent, check the Analytics dashboard');
                }
            })
            .catch((err) => {
                console.warn('Unable to send the analytics event', err);
            });
    }
}
{
    layoutr.promiseFont = new Promise((resolve, reject) => {
        WebFont.load({
            typekit: {
                id: ['bhz3dxx']
            },
            active: () => {
                resolve();
            },
            inactive: () => {
                reject();
            }
        });
    }).catch(() => {
        layoutr.showPopupAlert('Failed to load fonts', 'danger');
    });
}
{
    layoutr.promiseCSS = layoutr.load.css(layoutr.host + "dist/css/theme/" + layoutr.theme + '.css').catch(() => {
        console.error('Failed to load css');
    });
    
    $(() => {
        layoutr.footer.html('<p>\u00A9 ' + new Date().getFullYear() + ' Frederik Nielsen</p>');

        //layoutr.setHtmlScroll(); // outcomment if it can be disabled at first page load

        layoutr.load.html(layoutr.host + layoutr.ajax + 'svg/base.html').then((response) => {
            $(response).prependTo(layoutr.body);
        }).catch(() => {
            layoutr.showPopupAlert('Failed to load base svg html', 'danger');
        });

        if (bowser.android) {
            // android doesn't handle vh correctly, so it gets converted to px
            $(window).resize(() => {
                if (layoutr.isModal() && layoutr.isModalImage()) {
                    layoutr.modal.find('#modal-img').css('max-height', window.innerHeight);
                }
            });
        }
    });

    $(window).click((e) => {
        let target = $(e.target),
            modal = target.closest(layoutr.modal[0]);

        if (!layoutr.isLoading() && !layoutr.isFocus()) {
            if (bowser.ios) {
                // ios browsers doesn't apply :focus to buttons in many cases,
                // this forces :focus to be applied correctly.
                if (target.parents('button').length) {
                    target.parents('button').focus();
                } else if (target.closest('button').length) {
                    target.focus();
                }
            }

            if (layoutr.isAuthentication() && !target.closest('#authentication').length && !target.closest('#modal').length) {
                layoutr.html.attr('data-authentication', '');
            } else if (modal.length) {
                let image = layoutr.isModalImage() && !target.closest('#modal-toggle').length && !target.closest('#modal-title').length && !target.closest('#modal-description').length,
                    form = layoutr.isModalForm() && !target.closest('#modal > div > div > div').length;
                if (image || form || target.closest('#modal-close').length) {
                    layoutr.closeModal();
                }
            } else {
                let isSmallBreakpoint = layoutr.isSmallBreakpoint(),
                    left = layoutr.isAsideLeft() && (layoutr.isAsideLeftCloseOnClickOutside() || isSmallBreakpoint) && !target.closest("#left").length,
                    right = layoutr.isAsideRight() && (layoutr.isAsideRightCloseOnClickOutside() || isSmallBreakpoint) && !target.closest("#right").length,
                    notTarget = !target.closest(".aside").length && !target.closest('.popup').length && !target.closest('#cookie').length;
                if ((left || right) && notTarget && !layoutr.isLoading()) {
                    layoutr.enableScroll();
                    layoutr.toggleAside(undefined, false);
                }
            }
        }
    });
}
{
    layoutr.contentLoaded = (element) => {
        layoutr.checkResponsiveBackground(element.find('.rb'));
        layoutr.checkLazy(element.find('.lazy'));
        layoutr.checkAccordion(element.find('.accordion'));
        layoutr.checkDropdown(element.find('select.dropdown'));
        layoutr.checkTooltip(element.find('.tooltip'));
        layoutr.checkAssignment(element.find('.assignment'));
        layoutr.checkMath(element.find('.math'));
        layoutr.checkMedia(element.find('audio, video'));
        layoutr.checkMap(element.find('.map'));
        layoutr.checkDatatable(element.find('.dataTable'));
        layoutr.checkSwiper(element.find('.swiper'));
    }

    layoutr.pageLoaded = (initial) => {
        let promiseScrollTop = new Promise((resolve, reject) => {
            layoutr.main.css('overflow', 'auto');
            layoutr.main.scrollTop(0);
            layoutr.main.css('overflow', '');
            setTimeout(() => {
                layoutr.html.scrollTop(0);
                resolve();
            });
        }).then(() => {
            setTimeout(() => {
                if (!initial && layoutr.isCloseLeftPageChange()) {
                    layoutr.toggleAside(undefined, true);
                }
            }, 200);

            if (initial) {
                layoutr.promiseFont.then(() => {
                    layoutr.hideLoading();
                    layoutr.html.addClass('site-loaded');
                    layoutr.responsiveHeader();
                    layoutr.contentLoaded(layoutr.content);
                    let scroll = JSON.parse(localStorage.getItem("scroll"));
                    if (scroll !== null && window.location.href === scroll.href) {
                        layoutr.body.scrollTop(layoutr.body[0].scrollHeight >= scroll.scrollTop ? scroll.scrollTop : layoutr.body[0].scrollHeight); // edge, safari
                        layoutr.html.scrollTop(layoutr.html[0].scrollHeight >= scroll.scrollTop ? scroll.scrollTop : layoutr.html[0].scrollHeight); // chrome, firefox, ie
                    }
                });
            } else {
                layoutr.hideLoading();
                layoutr.contentLoaded(layoutr.content);
            }
        });
    };
}
{
    var fullscreenScrollTop;

    layoutr.requestFullScreen = () => {
        if (!layoutr.fullscreen && bowser.desktop) {
            fullscreenScrollTop = layoutr.scrollTop();
            if (layoutr.document.requestFullscreen) {
                layoutr.document.requestFullscreen();
            }
            else if (layoutr.document.msRequestFullscreen) {
                layoutr.document.msRequestFullscreen();
            }
            else if (layoutr.document.mozRequestFullScreen) {
                layoutr.document.mozRequestFullScreen();
            }
            else if (layoutr.document.webkitRequestFullscreen) {
                layoutr.document.webkitRequestFullscreen();
            }
        }
    };

    document.addEventListener('webkitfullscreenchange', fullscreenChange, false);
    document.addEventListener('mozfullscreenchange', fullscreenChange, false);
    document.addEventListener('fullscreenchange', fullscreenChange, false);
    document.addEventListener('MSFullscreenChange', fullscreenChange, false);

    function fullscreenChange(e) {
        layoutr.fullscreen = !layoutr.fullscreen;
        if (!layoutr.fullscreen && bowser.desktop) {
            if (layoutr.isModal()) {
                layoutr.closeModal();
            }
            layoutr.body.scrollTop(fullscreenScrollTop);
            layoutr.html.scrollTop(fullscreenScrollTop);
        }
    };

    layoutr.exitFullScreen = () => {
        if (layoutr.fullscreen && bowser.desktop) {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
            else if (document.msExitFullscreen) {
                document.msExitFullscreen();
            }
            else if (document.mozCancelFullScreen) {
                document.mozCancelFullScreen();
            }
            else if (document.webkitExitFullscreen) {
                document.webkitExitFullscreen();
            }
        }
    };

    layoutr.toggleFullScreen = (element) => {
        if (layoutr.fullscreen)
            exitFullScreen();
        else
            requestFullScreen(element);
    };
}
{
    var scrollbarWidth = () => {
        layoutr.body.append('<div id="scrollbar-width"></div>');
        let element = layoutr.body.children('#scrollbar-width');
        element.css({
            'overflow': "scroll",
            'visibility': "hidden",
            'position': 'absolute',
            'width': '100px',
            'height': '100px'
        });
        layoutr.scrollbarWidth = element[0].offsetWidth - element[0].clientWidth;
        element.remove();
    };

    layoutr.disableScroll = () => {
        if (layoutr.htmlOverflowEnabled) {
            layoutr.htmlOverflowEnabled = false;
            if (layoutr.isModal()) {
                layoutr.checkModal();
                layoutr.modal.focus();
            }
            let scrollTop = layoutr.scrollTop();
            layoutr.html.addClass('scroll-disabled');
            layoutr.body.scrollTop(scrollTop);
            layoutr.main.scrollTop(scrollTop);
        }
    };

    layoutr.enableScroll = () => {
        if (!layoutr.htmlOverflowEnabled) {
            layoutr.htmlOverflowEnabled = true;
            if (layoutr.isSiteLoaded()) {
                let scrollTop = layoutr.scrollTop();
                layoutr.html.removeClass('scroll-disabled modal');
                layoutr.main.focus();
                layoutr.body.scrollTop(scrollTop); // edge, safari
                layoutr.html.scrollTop(scrollTop); // chrome, firefox, ie
            } else {
                layoutr.html.removeClass('scroll-disabled modal');
            }
        }
    };

    layoutr.setHtmlScroll = () => {
        if (!layoutr.isModal() && !layoutr.isLoading() && !layoutr.htmlOverflowEnabled && (!layoutr.isSmallBreakpoint() || layoutr.isSmallBreakpoint() && !layoutr.isAsideLeft() && !layoutr.isAsideRight())) {
            layoutr.enableScroll();
        } else if (layoutr.isModal() || layoutr.isSmallBreakpoint() && layoutr.htmlOverflowEnabled && (layoutr.isAsideLeft() || layoutr.isAsideRight())) {
            layoutr.disableScroll();
        }
    };

    $(() => {
        scrollbarWidth();
    });

    $(window).resize($.throttle(layoutr.throttleInterval, false, () => {
        layoutr.checkModal();
        layoutr.setHtmlScroll();
        scrollbarWidth();
        setScrollTop();
    }));

    var setScrollTop = () => {
        let scrollTop = layoutr.scrollTop();

        let entry = {
            href: window.location.href,
            scrollTop: scrollTop
        };

        localStorage.setItem('scroll', JSON.stringify(entry));
    };

    $(window).scroll($.throttle(layoutr.throttleInterval, false, () => {
        setScrollTop();
    }));
}
{
    layoutr.showLoading = () => {
        layoutr.loadingCount++;
        layoutr.disableScroll();
        layoutr.html.addClass('loading');
    };

    layoutr.hideLoading = () => {
        layoutr.loadingCount--;
        if (layoutr.loadingCount <= 0) {
            layoutr.loadingCount = 0;
            layoutr.html.removeClass('loading');
            layoutr.setHtmlScroll();
        }
    };
}
{
    let transitionLock = false;

    layoutr.asideChanged = () => {
        let trigger = () => {
            layoutr.html.trigger('aside-changed.datatables');
            layoutr.html.trigger('aside-changed.rb');
            layoutr.html.trigger('aside-changed.map');
        }

        if (layoutr.isTransitions()) {
            let awaitInterval = setInterval(() => {
                if (!transitionLock) {
                    clearInterval(awaitInterval);
                } else {
                    trigger();
                }
            }, layoutr.awaitInterval);
            setTimeout(() => {
                transitionLock = false;
            }, layoutr.transitionTime);
        } else {
            transitionLock = false;
            trigger();
        }
    }

    layoutr.toggleAside = (aside, pageChanged) => {
        if (!transitionLock) {
            transitionLock = true;
            layoutr.html.attr('data-authentication', '');
            let currentAside = layoutr.html.attr('data-aside');
            if (currentAside.length) {
                if (aside === undefined || currentAside === aside) {
                    let scrollTop = layoutr.scrollTop();
                    layoutr.html.attr('data-aside', '');
                    layoutr.main.focus();
                    layoutr.body.scrollTop(scrollTop); // edge, safari
                    layoutr.html.scrollTop(scrollTop); // chrome, firefox, ie
                } else {
                    layoutr.html.attr('data-aside', aside);
                }
            } else {
                layoutr.html.attr('data-aside', aside);
            }
            if (aside === 'left') {
                layoutr.left.focus();
            } else if (aside === 'right') {
                layoutr.right.focus();
            }

            layoutr.asideChanged();
            layoutr.setHtmlScroll();
        }
    };

    $(() => {
        layoutr.main.find('.aside.left').click(() => {
            layoutr.toggleAside('left');
        });

        layoutr.main.find('.aside.right').click(() => {
            layoutr.toggleAside('right');
        });
    });
}
{
    $(() => {
        layoutr.authentication.on('click', '> div > button', (e) => {
            let $this = $(e.currentTarget),
                type = $this.attr('data-type');
            if (layoutr.html.attr('data-authentication') === type) {
                layoutr.html.attr('data-authentication', '');
            } else {
                layoutr.html.attr('data-authentication', type);
                layoutr.authentication.children(':last-child').focus();
            }
        });

        layoutr.authenticatedLinks.on('click', '> a', (e) => {
            e.preventDefault();
        });

        layoutr.addValidation(
            layoutr.authentication.find('.register > form'),
            {
                register_username: {
                    required: true,
                    minlength: 2
                },
                register_password: {
                    required: true,
                    password_regex: true
                },
                register_confirm_password: {
                    required: true,
                    equalTo: "#register_password"
                },
                register_email: {
                    required: true,
                    email: true
                }
            },
            {
                register_username: {
                    required: "Please enter your username"
                },
                register_password: {
                    required: "Please enter your password"
                },
                register_confirm_password: {
                    required: "Please provide a password",
                    equalTo: "Please enter the same password as above"
                },
                register_email: "Please enter a valid email address"
            }
        );

        layoutr.addValidation(
            layoutr.authentication.find('.login > form'),
            {
                username: {
                    required: true
                },
                password: {
                    required: true
                }
            },
            {
                username: {
                    required: "Please enter your username"
                },
                password: {
                    required: "Please enter your password"
                }
            }
        );
    });
}
{
    $(() => {
        layoutr.cookie.on('click', '#cookie-accept', () => {
            localStorage.setItem('cookie', 'cookie');
            layoutr.html.removeClass('cookie');
        });

        let cookie = localStorage.getItem("cookie");
        if (cookie === null) {
            layoutr.html.addClass('cookie');
        }
    });
}
{
    layoutr.loadPage = (url, pushState, initial) => {
        layoutr.showLoading();
        layoutr.load.html(layoutr.host + layoutr.ajax + 'pages' + (url === '/' ? '/home' : url) + '.html').then((response) => {
            layoutr.content.html(response);
            let q = url.indexOf('?');
            url = url.substring(0, q !== -1 ? q : url.length);
            layoutr.left.find('.tree a.label.active').removeClass('active');
            layoutr.left.find('a.label[href="' + url + '"]').addClass('active');
            layoutr.html.attr('data-status', '');
            layoutr.title.html('');
            document.title = layoutr.siteName;
            if (url === '/') {
                if (layoutr.body.children('#svg-browser').length === 0) {
                    layoutr.load.html(layoutr.host + layoutr.ajax + 'svg/browser.html').then((response) => {
                        $(response).prependTo(layoutr.body);
                    }).catch(() => {
                        layoutr.showPopupAlert('Failed to load browser svg html', 'danger');
                    });
                }
                if (layoutr.body.children('#svg-os').length === 0) {
                    layoutr.load.html(layoutr.host + layoutr.ajax + 'svg/os.html').then((response) => {
                        $(response).prependTo(layoutr.body);
                    }).catch((response) => {
                        layoutr.showPopupAlert('Failed to load os svg html', 'danger');
                    });
                }
            } else {
                let title = layoutr.capitalize(url.replace('/', '').replaceAll('-', ' '));
                layoutr.title.html(title);
                document.title = title + ' - ' + layoutr.siteName;
                if (url === '/form') {
                    layoutr.pageForm();
                }
            }
            layoutr.html.trigger('header-changed.responsiveHeader');
            layoutr.promiseCSS.then(() => {
                layoutr.pageLoaded(initial);
            });
        }).catch((response) => {
            layoutr.load.html(layoutr.host + layoutr.ajax + 'pages/error.html').then((response2) => {
                layoutr.content.html(response2);
                layoutr.html.attr('data-status', 'error');
                document.title = response + ' - ' + layoutr.siteName;
                let title = response + ' - ';
                if (response === 404) {
                    title += 'Page not found';
                } else {
                    title += 'Server error';
                }
                layoutr.content.find('#error-title').html(title);
                layoutr.html.trigger('header-changed.responsiveHeader');
            }).catch((response) => {
                layoutr.showPopupAlert('Failed to load content html', 'danger');
            }).finally(() => {
                layoutr.promiseCSS.then(() => {
                    layoutr.pageLoaded(initial);
                });
            });
        });

        let historyUrl = (layoutr.isLocalhost ? '' : '/' + window.location.pathname.split('/')[1]) + url;
        if (pushState) {
            window.history.pushState(null, null, historyUrl);
            loadPage = true;
        }
    };

    layoutr.internalLinkClick = (href, e) => {
        if (!e.ctrlKey) {
            e.preventDefault();
            layoutr.loadPage(href, true, false);
        }
    };

    if (window.location.search) {
        layoutr.url = {};
        window.location.search.slice(1).split('&').forEach((v) => {
            let a = v.split('=');
            layoutr.url[a[0]] = a.slice(1).join('=').replace(/~and~/g, '&');
        });
        if (layoutr.url.p !== undefined) {
            window.history.replaceState(null, null,
                window.location.pathname.slice(0, -1) + layoutr.url.p +
                (layoutr.url.q ? '?' + layoutr.url.q : '') +
                window.location.hash
            );
        }
    }

    let loadPage = window.history.state;
    window.onpopstate = (e) => {
        if (loadPage) {
            let url = location.pathname;
            if (!layoutr.isLocalhost) {
                url = url.substring(url.indexOf("/", url.indexOf("/") + 1));
            }
            layoutr.loadPage(url, false, true);
        }
    };

    layoutr.applyNavigation = (id, value, set) => {
        if (set) {
            let entry = {
                "id": id,
                "value": value
            },
                exists = $.grep(layoutr.navigation, (e) => { return e.name === name; });
            if (exists.length === 0) {
                // not found
                layoutr.navigation.push(entry);
            } else if (exists.length === 1) {
                // found
                exists[0].value = value;
            }
            localStorage.setItem('navigation', JSON.stringify(layoutr.navigation));
        } else {
            layoutr.left.find('#' + id).prop('checked', value);
        }
    };

    $(() => {
        layoutr.load.html(layoutr.host + layoutr.ajax + 'layout/navigation.html').then(function (response) {
            layoutr.left.find('> .content > div').html(response);
            layoutr.navigationTree = layoutr.left.find('.tree');
            layoutr.navigation = JSON.parse(localStorage.getItem("navigation"));
            if (layoutr.navigation === null) layoutr.navigation = [];
            $.each(layoutr.navigation, (i, entry) => {
                layoutr.applyNavigation(entry.id, entry.value, false);
            });
            layoutr.navigationTree.on('change', 'input[type=checkbox]', (e) => {
                let checkbox = $(e.currentTarget),
                    id = checkbox.attr('id'),
                    value = checkbox.is(':checked');
                layoutr.applyNavigation(id, value, true);
            });
            layoutr.header.find('.aside.left').addClass('loaded');
            if (layoutr.url && layoutr.url.p) {
                layoutr.navigationTree.find('a.label[href="' + layoutr.url.p.replace(/^\/+/g, '') + '"]').addClass('active');
            } else {
                layoutr.navigationTree.find('a.label[href=""]').addClass('active');
            }
        }).catch(function () {
            layoutr.showPopupAlert('Failed to load navigation html', 'danger');
        });

        if (layoutr.url && layoutr.url.p) {
            layoutr.loadPage(layoutr.url.p, true, true);
        } else {
            var l = window.location;
            var segmentCount = l.origin.endsWith('github.io') ? 1 : 0;
            var url = '/' + l.pathname.slice(1).split('/').slice(segmentCount);
            layoutr.loadPage(url, true, true);
        }
        layoutr.left.on('click', '.tree a.label:not(.active)', (e) => {
            layoutr.internalLinkClick($(e.currentTarget).attr('href'), e);
        });

        layoutr.body.on('click', '.internal-link', (e) => {
            layoutr.internalLinkClick($(e.currentTarget).attr('href'), e);
        });

        layoutr.left.on('click', '#navigation-expand', () => {
            layoutr.navigationTree.find('input[type=checkbox]:not(:checked)').click();
        });

        layoutr.left.on('click', '#navigation-collapse', () => {
            layoutr.navigationTree.find('input[type=checkbox]:checked').click();
        });
    });
}
{
    layoutr.applySettings = (id, name, type, value, set) => {
        if (set) {
            let entry = {
                "id": id,
                "name": name,
                "type": type,
                "value": value
            },
                exists = $.grep(layoutr.settings, (e) => { return e.name === name; });
            if (exists.length === 0) {
                // not found
                layoutr.settings.push(entry);
            } else if (exists.length === 1) {
                // found
                exists[0].id = id;
                exists[0].value = value;
            }
            localStorage.setItem('settings', JSON.stringify(layoutr.settings));
        } else {
            if (type === "checkbox" || type === "radio") {
                layoutr.right.find('#settings-' + id).prop('checked', value);
            } else if (type === "slider") {
                layoutr.right.find('#settings-' + id).slider('setValue', value);
            }
        }
        if (type === 'checkbox' || type === "radio") {
            if (type === 'radio') {
                $.each(layoutr.right.find('input[type=radio][name="settings-' + name + '"]:not(#settings-' + id + ')'), (i, radio) => {
                    layoutr.html.removeClass($(radio).attr('id').replace('settings-', ''));
                });
            }
            if (name === 'theme') {
                layoutr.loadTheme(id);
            }
            if (name === 'focus' && value) {
                layoutr.enableFocus();
            } else if (name === 'tts' && value) {
                layoutr.enableTTS();
            } else if (name === 'swipe' && value) {
                layoutr.enableSwipe();
            }
            if (value) {
                layoutr.html.addClass(id);
            } else {
                layoutr.html.removeClass(id);
            }
            if (id === 'two-columns') {
                layoutr.html.trigger('columns-changed.rb');
            }
            if (id === 'signed-in' || id === 'focus' || id === 'tts') {
                layoutr.html.trigger('header-changed.responsiveHeader');
            }
            if (name === 'aside-left' || 'aside-right') {
                layoutr.asideChanged();
            }
        }
    };

    $(() => {
        layoutr.load.html(layoutr.host + layoutr.ajax + 'layout/settings.html').then((response) => {
            let $this = layoutr.right.find('> .content > div');
            $this.html(response);
            layoutr.promiseCSS.then(() => {
                $.each(layoutr.settings, (i, entry) => {
                    layoutr.applySettings(entry.id, entry.name, entry.type, entry.value, false);
                });
                layoutr.header.find('.aside.right').addClass('loaded');
                $this.on('change', 'input[type=checkbox], input[type=radio]', (e) => {
                    let input = $(e.currentTarget),
                        id = input.attr('id').replace('settings-', ''),
                        name = input.attr('name').replace('settings-', ''),
                        type = input.attr('type'),
                        value = input.is(':checked');
                    layoutr.applySettings(id, name, type, value, true);
                    if (id === 'left-shrink' || id === 'right-shrink' ||
                        id === 'left-push' || id === 'right-push' ||
                        id === 'left-overlay' || id === 'right-overlay') {
                        layoutr.setHtmlScroll();
                    }
                });
            });
        }).catch(() => {
            layoutr.showPopupAlert('Failed to load settings html', 'danger');
        });

        layoutr.right.on('click', '#settings-clear-localstorage', () => {
            localStorage.clear();
            location.reload();
        });
    });
}
{
    $(() => {
        layoutr.body.on("keydown", (e) => {
            let target = $(e.target),
                parent = target.parent();
            if (layoutr.isLoading()) {
                if (e.which === 9 || e.ctrlKey && e.keyCode === 65) { // tab ||  ctrl + a
                    e.preventDefault();
                }
            } else {
                if (e.which === 37 && !layoutr.isFocus() && !layoutr.isModal()) { // left
                    if (layoutr.isAsideLeft()) {
                        layoutr.toggleAside(); // closes right
                    } else if (!layoutr.isAsideRight()) {
                        layoutr.toggleAside('right'); // opens right
                    }
                } else if (e.which === 39 && !layoutr.isFocus() && !layoutr.isModal()) { // right
                    if (layoutr.isAsideRight()) {
                        layoutr.toggleAside(); // closes left
                    } else if (!layoutr.isAsideLeft()) {
                        layoutr.toggleAside('left'); // opens left
                    }
                } else if (e.which === 27) { // esc
                    e.stopPropagation();
                    if (layoutr.tts !== undefined && layoutr.tts.IsSpeaking()) {
                        layoutr.stopTTS();
                    } else if (layoutr.isFocus()) {
                        layoutr.hideFocus();
                    } else if (layoutr.isModal()) {
                        layoutr.closeModal();
                    } else {
                        if (layoutr.isAside()) {
                            layoutr.toggleAside(); // closes aside
                        }
                        let popups = layoutr.body.children('.popup');
                        if (popups.length) {
                            popups.fadeOut(layoutr.fadeOutTime, () => {
                                popups.remove();
                            });
                        }
                        let dropdowns = layoutr.content.find('div.dropdown.open');
                        if (dropdowns.length) {
                            dropdowns.removeClass('open');
                        }
                        layoutr.html.attr('data-authentication', '');
                    }
                }
                if (e.which === 13) { // enter
                    let dropdown = target.parents('div.dropdown');
                    if (dropdown.length || parent.parent().hasClass('accordion')) {
                        target.click();
                        e.preventDefault();
                        if (dropdown.length) {
                            dropdown.children('div').focus();
                        }
                    } else if (parent.hasClass('checkbox') || parent.hasClass('radio') || parent.hasClass('switch') || target.hasClass('toggle')) {
                        target.siblings('input').click();
                        e.preventDefault();
                    }
                }
            }
        });

        layoutr.body.on('keyup', (e) => {
            if (!layoutr.isLoading() && !layoutr.isFocus()) {
                if (e.which === 9) { // tab
                    let target = $(e.target);
                    if (!target.parents('div.dropdown.open').length) {
                        $('div.dropdown.open').removeClass('open');
                    }
                    if (!target.parents('#authenticated.open').length || target.closest('#authenticated > button').length) {
                        $('#authenticated.open').removeClass('open');
                    }
                    if (layoutr.isModal()) {
                        if (!target.parents('#modal').length) {
                            layoutr.closeModal();
                        }
                    } else {
                        let aside = target.parents('aside');
                        if (aside.length === 0 && target.is('aside')) {
                            aside = target;
                        }
                        if (aside.length && aside.attr('id') !== layoutr.html.attr('data-aside')) {
                            layoutr.toggleAside(aside.attr('id'));
                        } else if (!aside.length && layoutr.isAside()) {
                            layoutr.toggleAside();
                        }
                    }
                }
            }
        });
    });
}
{
    layoutr.showModal = (type) => {
        layoutr.html.attr('data-modal', type);
        layoutr.html.addClass('modal');
        layoutr.hideLoading();
        layoutr.checkModal();
        layoutr.modal.focus();
    };

    layoutr.closeModal = () => {
        if (layoutr.fullscreen) {
            layoutr.exitFullScreen();
        } else {
            layoutr.html.removeClass('modal').attr('data-modal', '');
            layoutr.modal.removeClass('info-shown').empty();
            layoutr.checkModal();
            layoutr.setHtmlScroll();
        }
    };

    layoutr.checkModal = () => {
        if (layoutr.isModal()) {
            layoutr.body.css('padding-right', layoutr.scrollbarWidth);
            if (layoutr.html.attr('data-aside') === 'right') {
                layoutr.right.css('margin-right', layoutr.scrollbarWidth);
            }
            layoutr.body.children('.popup').css('margin-right', layoutr.scrollbarWidth);
        } else {
            layoutr.body.css('padding-right', 0);
            layoutr.right.css('margin-right', 0);
            layoutr.body.children('.popup').css('margin-right', 0);
        }
        layoutr.html.trigger('model-check');
    };

    $(() => {
        layoutr.body.on('click', '.modal', (e) => {
            let $this = $(e.currentTarget),
                type = $this.attr('data-modal');
            if (type !== undefined && type.length && (type === 'image' || type === 'form')) {
                layoutr.showLoading();
                let id = $this.attr('data-modal-id'),
                    html = [],
                    dataTitle = $this.attr('data-modal-title'),
                    dataContent = $this.attr('data-modal-content'),
                    dataFullscreen = $this.attr('data-modal-fullscreen') === 'true';
                html.push('<div><div><div id="modal-container">');
                if (type === 'image' && $this.attr('data-modal-img').length) {
                    if (dataTitle !== undefined || dataContent !== undefined) {
                        layoutr.modal.addClass('has-info');
                        html.push('<button id="modal-toggle" class="btn" aria-label="Toggle info">');
                        html.push('<svg focusable="false"><use xlink:href="#svg-info"></use></svg>');
                        html.push('</button>');
                    }
                    if (dataTitle !== undefined) {
                        html.push('<div id="modal-title">' + dataTitle + '</div>');
                    }
                    if (dataContent !== undefined) {
                        html.push('<div id="modal-content">' + dataContent + '</div>');
                    }
                    html.push('<img id="modal-img" />');
                } else if (type === 'form') {
                    html.push('<div class="header">');
                    if (dataTitle !== undefined) {
                        html.push('<span class="title">' + dataTitle + '</span>');
                    }
                    html.push('<button id="modal-close" class="close expand" aria-label="Close ' + (dataTitle !== undefined ? dataTitle : '') + '"><svg focusable="false"><use xlink:href="#svg-close"></use></svg></button >');
                    html.push('</div><div class="content">');
                }
                html.push('</div></div></div></div>');
                let div = html.join("");
                layoutr.modal.html(div);
                if (type === 'image') {
                    let image = layoutr.modal.find('#modal-img');
                    image.on('load', () => {
                        if (bowser.android) {
                            image.css('max-height', window.innerHeight);
                        }
                        layoutr.showModal(type);
                    });
                    image.attr('src', $this.attr('data-modal-img'));
                } else {
                    let dataSize = $this.attr('data-modal-size');
                    if (dataSize !== undefined) {
                        layoutr.modal.children('div').attr('data-modal-size', dataSize);
                    }
                    let content = layoutr.modal.find('#modal-container > .content');
                    content.append(dataContent);
                    layoutr.contentLoaded(content);
                    layoutr.showModal(type);
                }
                if (dataFullscreen) {
                    layoutr.requestFullScreen();
                }
            }
        });

        layoutr.body.on('click', '#modal-toggle', () => {
            layoutr.modal.toggleClass('info-shown');
        });
    });
}
{
    layoutr.responsiveHeader = () => {
        let h1 = layoutr.header.find('h1'),
            link = h1.children('a');

        let check = () => {
            h1.addClass('show-title');
            layoutr.unauthenticated.addClass('show-text');
            if (h1.outerWidth() < link.outerWidth()) {
                layoutr.unauthenticated.removeClass('show-text');
                if (h1.outerWidth() < link.outerWidth()) {
                    h1.removeClass('show-title');
                }
            }
        }

        $(window).on('resize', () => {
            check();
        });

        check();

        layoutr.html.on('header-changed.responsiveHeader', () => {
            check();
        });
    };
}
{
    layoutr.enableFocus = () => {
        let component = layoutr.focus.find('> .component > div');

        if (!layoutr.html.hasClass('focus-loaded')) {
            layoutr.showLoading();
            layoutr.promiseFocus = layoutr.load.js('dist/js/focus.js').finally(() => {
                layoutr.hideLoading();
            });
            layoutr.html.addClass('focus-loaded');
        }

        layoutr.promiseFocus.then(() => {
            component
                .draggable({
                    axis: "y",
                    containment: "parent",
                    handle: ".move"
                })
                .resizable({
                    handles: {
                        n: '.ui-resizable-n',
                        s: '.ui-resizable-s'
                    },
                    containment: "parent"
                }).on('resize', (e) => {
                    e.stopPropagation();
                });

            layoutr.focus.on('click', '.close', () => {
                layoutr.hideFocus();
            });

            layoutr.main.find('.focus').click(() => {
                layoutr.showFocus();
            });

            let height = $(window).height();
            $(window).resize(function () {
                // do nothing if the height is the same
                if ($(window).height() === height) return;
                height = $(window).height();
                component.removeAttr('style');
            });
        }).catch(() => {
            layoutr.showPopupAlert('Failed to load focus', 'danger');
        });
    };

    layoutr.showFocus = () => {
        layoutr.html.attr('data-authentication', '');
        layoutr.html.attr('data-focus', true);
        layoutr.focus.focus();
    };
    layoutr.hideFocus = () => {
        let scrollTop = layoutr.scrollTop();
        layoutr.html.attr('data-focus', false);
        layoutr.main.focus();
        layoutr.body.scrollTop(scrollTop); // edge, safari
        layoutr.html.scrollTop(scrollTop); // chrome, firefox, ie
    };
}
{
    layoutr.enableSwipe = () => {
        if (bowser.android) {
            let xDown = null,
                yDown = null,
                offsetBefore;

            let handleTouchStart = (e) => {
                if (layoutr.isSwipe()) {
                    xDown = e.touches[0].clientX;
                    yDown = e.touches[0].clientY;

                    offsetBefore = $(e.target).offset().left;
                }
            };

            let handleTouchMove = (e) => {
                if (layoutr.isSwipe()) {
                    let offsetAfter = $(e.target).offset().left;
                    if (!xDown || !yDown || offsetBefore !== offsetAfter) {
                        return;
                    }
                    let xUp = e.changedTouches[0].clientX,
                        yUp = e.changedTouches[0].clientY,
                        xDiff = xDown - xUp,
                        yDiff = yDown - yUp;
                    if (Math.abs(xDiff) > Math.abs(yDiff)) {
                        let distance = parseInt($(window).width() / 2);
                        if (yDiff > -100 || yDiff < 100) {
                            let currentAside;
                            if (xDiff > distance) {
                                /* left swipe */
                                if (!layoutr.isModal() && !layoutr.isLoading()) {
                                    currentAside = layoutr.html.attr('data-aside');
                                    if (currentAside === 'left' && currentAside !== 'right') {
                                        layoutr.toggleAside();
                                    } else if (currentAside !== 'right') {
                                        layoutr.toggleAside('right');
                                    }
                                }
                            } else if (xDiff < -distance) {
                                /* right swipe */
                                if (!layoutr.isModal() && !layoutr.isLoading()) {
                                    currentAside = layoutr.html.attr('data-aside');
                                    if (currentAside === 'right' && currentAside !== 'left') {
                                        layoutr.toggleAside();
                                    } else if (currentAside !== 'left') {
                                        layoutr.toggleAside('left');
                                    }
                                }
                            }
                        }

                    }
                    /* reset values */
                    xDown = null;
                    yDown = null;
                }
            };
            document.addEventListener('touchstart', handleTouchStart, false);
            document.addEventListener('touchend', handleTouchMove, false);
        }
    };
}
{
    layoutr.clearSelection = () => {
        let selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(document.createRange());
    }

    layoutr.stopTTS = () => {
        layoutr.clearSelection();
        if (layoutr.tts && layoutr.tts.IsSpeaking()) {
            layoutr.tts.ShutUp();
        }
    };

    layoutr.enableTTS = () => {
        if (bowser.desktop && !bowser.msie) {
            let snapSelectionToWord = () => {
                let selection = window.getSelection();
                if (!selection.isCollapsed) {
                    let range = selection.getRangeAt(0);
                    if (range.collapsed || range.toString().length === 0) {
                        return;
                    }

                    try {
                        // select full start word
                        while (range.startOffset > 0 && range.toString()[0].match(/[^\s]/)) {
                            range.setStart(range.startContainer, range.startOffset - 1);
                        }
                        // remove space as first selected
                        let start = range.startContainer.data.substring(range.startOffset).charAt(0);
                        if (start === ' ') {
                            range.setStart(range.startContainer, range.startOffset + 1);
                        }
                    } catch (e) {

                    }

                    try {
                        // select full end word
                        while (range.endOffset < range.endContainer.length && range.toString()[range.toString().length - 1].match(/[^\s]/)) {
                            range.setEnd(range.endContainer, range.endOffset + 1);
                        }
                        // remove space as last selected
                        let end = range.endContainer.data.substring(0, range.endOffset).slice(-1);
                        if (end === ' ') {
                            range.setEnd(range.endContainer, range.endOffset - 1);
                        }
                    } catch (e) {

                    }

                    selection.removeAllRanges();
                    selection.addRange(range);
                }
                return selection;
            }

            let getText = (node, selection) => {
                let text = [],
                    nonWhitespaceMatcher = /\S/,
                    getTextNodes = (node) => {
                        let parent = $(node.parentNode),
                            special = false;

                        if (selection.containsNode(node, false) && (node.nodeName.toLowerCase() === 'input' ||
                            node.nodeName.toLowerCase() === 'textarea') && nonWhitespaceMatcher.test(node.value)) {
                            special = true;
                        }

                        if (!special &&
                            selection.containsNode(node, true) &&
                            node.nodeType === 3 &&
                            nonWhitespaceMatcher.test(node.nodeValue) &&
                            parent.is(':visible') &&
                            parent.css('user-select') !== 'none' &&
                            parent.parents().css('user-select') !== 'none' &&
                            node.parentNode.tagName !== 'SCRIPT'
                        ) {
                            if (!(selection.extentNode.nodeType !== 3 && $(selection.extentNode).is(parent))) {
                                if (!node.nodeValue.match(/\.\s*$/) && node.nextElementSibling === null && parent.is('h1 span, h1, h2, h3, h4, h5, h6, p, th, td, .dataTable th span')) {
                                    text.push(node.nodeValue + '. ');
                                } else {
                                    text.push(node.nodeValue);
                                }
                            }
                            if (text.length === 1) {
                                if ($(selection.anchorNode).is(selection.focusNode)) {
                                    text[0] = text[0].substring(0, selection.focusOffset).substring(selection.baseOffset);
                                } else {
                                    text[0] = text[0].substring(selection.baseOffset);
                                }
                                if (text[0] === '. ' || text[0] === ' ') {
                                    text[0] = '';
                                }
                            }
                        } else {
                            for (let i = 0; i < node.childNodes.length; i++) {
                                getTextNodes(node.childNodes[i]);
                            }
                        }
                    }

                getTextNodes(node);
                if (text.length && text.length > 1) {
                    text[text.length - 1] = text[text.length - 1].substring(0, selection.focusOffset);
                }
                text = text.join(' ').replace(/(?:\r\n|\r|\n)/g, ' ').replace(/ +\./g, '. ').replace(/\s\s+/g, ' ').replace(',.', '.').trim();
                return text;
            }

            if (!layoutr.html.hasClass('tts-loaded')) {
                layoutr.showLoading();
                layoutr.PromiseTTS = layoutr.load.js('dist/js/tts.js').finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('tts-loaded');
            }
            layoutr.PromiseTTS.then(() => {
                let awsCredentials = new AWS.Credentials('AKIAI5JMCVBZ4CWSSOOQ', 'FM7j9FbQLkUU8u3tHScv0IOG4IoayUkp/RNNNNni'),
                    settings = {
                        awsCredentials: awsCredentials,
                        awsRegion: 'eu-central-1',
                        pollyVoiceId: 'Russell'
                    };

                layoutr.tts = ChattyKathy(settings);

                layoutr.html.attr('data-tts', true);

                $(window).on('mousedown touchstart', (e) => {
                    if (!layoutr.isLoading() && !layoutr.isFocus() && layoutr.isTTS() && layoutr.isTTSEnabled()) {
                        layoutr.clearSelection();
                    }
                });

                $(window).on('mouseup touchend', (e) => {
                    if (!$(document.activeElement).is('input, textarea, button, select, .dropdown')) {
                        if (!layoutr.isLoading() && !layoutr.isFocus() && layoutr.isTTS() && layoutr.isTTSEnabled() && e.originalEvent.detail < 3) {
                            setTimeout(() => {
                                let selection = snapSelectionToWord(),
                                    text = getText(selection.getRangeAt(0).commonAncestorContainer, selection);

                                if (text.length) {
                                    layoutr.tts.SpeakWithPromise(text).then(() => {
                                        layoutr.clearSelection();
                                    });
                                } else {
                                    layoutr.stopTTS();
                                }
                            });
                        }
                    }
                });

                layoutr.header.find('.tts').click(() => {
                    if (layoutr.html.attr('data-tts') === 'true') {
                        layoutr.html.attr('data-tts', false);
                        layoutr.stopTTS();
                    } else {
                        layoutr.html.attr('data-tts', true);
                    }
                });
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load tts', 'danger');
            });
        }
    };
}
{
    $(() => {
        layoutr.html.on('model-check', () => {
            let contentHeader = layoutr.content.children('.content-header:not(.full)');
            if (contentHeader.length) {
                if (layoutr.isModal() && contentHeader.css('position') === 'fixed') {
                    let halfOverflowY = layoutr.scrollbarWidth / 2;
                    contentHeader.children().css('width', 'calc(100% - ' + halfOverflowY + 'px)');
                } else {
                    contentHeader.children().css('width', '');
                }
            }
        });
    });
}
{
    layoutr.loadTheme = (id) => {
        let stylesheet = layoutr.head.children('link[rel="stylesheet"][href^="' + layoutr.host + 'dist/css/theme/"]'),
            href1 = stylesheet.attr('href'),
            split1 = href1.split('/'),
            split2 = split1[split1.length - 1].split('.');
        let href2 = [];
        for (let i = 0; i < split1.length - 1; i++) {
            href2.push(split1[i] + '/');
        }
        let theme = id.substring(id.indexOf("-") + 1);
        href2.push(theme);

        for (let i = 1; i < split2.length; i++) {
            href2.push('.' + split2[i]);
        }
        href2 = href2.join("");
        if (href1 !== href2) {
            layoutr.showLoading();
            layoutr.load.css(href2).then(() => {
                stylesheet.remove()
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load theme', 'danger');
            }).finally(() => {
                layoutr.hideLoading();
            });
        }
    }
}
{
    layoutr.setOnline = () => {
        let online = navigator.onLine;

        layoutr.body.find('.alert[data-type="connected"]').remove();
        if (online) {
            layoutr.showPopupAlert('You are online', 'success', 'bottom right', 'connected');
        } else {
            layoutr.showPopupAlert('You are offline', 'danger', 'bottom right', 'connected');
        }
    }

    $(() => {
        window.addEventListener('online', layoutr.setOnline);
        window.addEventListener('offline', layoutr.setOnline);

        if (!navigator.onLine) {
            layoutr.setOnline();
        }
    });
}
{
    layoutr.checkDropdown = (dropdowns) => {
        dropdowns.each((i, e) => {
            let $this = $(e),
                selected = $this.children('option:selected'),
                html = [],
                attr = $this.attr('class'),
                theme = '',
                width = $this.attr('data-width');
            if (selected.length !== 1) {
                selected = $this.children().first();
            }
            html.push('<div class="dropdown' +
                ($this.hasClass('not-first') ? ' not-first' : '') +
                ($this.hasClass('nowrap') ? ' nowrap' : '') +
                ($this.hasClass('check') ? ' check' : '') +
                ($this.hasClass('ellipsis') ? ' ellipsis' : '') +
                ($this.hasClass('align-left') ? ' align-left' : '') +
                ($this.hasClass('align-right') ? ' align-right' : '') +
                ($this.hasClass('direction-up') ? ' direction-up' : '') +
                '"' +
                (width !== undefined ? ' style="width:' + width + 'px"' : '')
                + '> ');

            if (typeof attr !== typeof undefined && attr !== false) {
                let temp = attr.split(' ');
                temp = $.grep(temp, (item, index) => {
                    return item.trim().match(/^theme-/);
                });
                if (temp.length === 1) {
                    theme = temp[0];
                }
            }
            html.push('<div tabindex="0" class="' + theme + '"><label>' + selected.text() + '</label><svg focusable="false"><use xlink:href="#svg-arrow"></use></svg></div>');
            html.push('<ul class="' + theme + '">');
            $this.children().each((i, e) => { /* ':not([value=""])' */
                let $that = $(e),
                    text = $that.text();
                if (!text.length) {
                    text = '&nbsp;';
                }
                if (text.indexOf('$$') === 0) {
                    $that.attr('data-math', text);
                }

                html.push('<li data-id="' + $that.val() + '"' + ($that.is(':selected') ? ' class="selected"' : '') + '><div tabindex="0" class="theme-light"><label>' + text + '</label><svg focusable="false"><use xlink:href="#svg-checkmark"></use></svg></div></li>');
            });
            html.push('</ul>');
            html.push('</div>');
            let dropdown = html.join("");
            $this.after(dropdown);
            dropdown = $this.next();


            if ($this.hasClass('nowrap')) {
                let top = dropdown.children().eq(0),
                    bottom = dropdown.children().eq(1),
                    topWidth = top.width(),
                    bottomWidth = bottom.width();
                if (bottomWidth > topWidth) {
                    top.css('min-width', bottomWidth);
                }
            }

            dropdown.on('click', '> div', (e) => {
                let $that = $(e.currentTarget);
                $that.parent().toggleClass('open');
            });
            dropdown.on('click', 'li', (e) => {
                let $that = $(e.currentTarget);
                if (!$that.hasClass('selected')) {
                    $that.siblings('.selected').removeClass('selected');
                    $that.addClass('selected');
                    let option = $this.children('[value="' + $that.attr('data-id') + '"]'),
                        text = $that.text(),
                        math = option.attr('data-math');
                    if (math !== undefined) {
                        text = math;
                    }
                    let label = dropdown.children('div').children('label');
                    label.text(text);
                    if (math !== undefined) {
                        renderMathInElement(label[0]);
                    }
                    $this.children(':selected').removeAttr('selected');
                    option.attr('selected', 'selected');
                    $this.change();
                }
                dropdown.removeClass('open');
            });
        });
    };

    $(window).click((e) => {
        let target = $(e.target);
        if (target.closest("div.dropdown").length) {
            $('div.dropdown').not(target.closest("div.dropdown")).removeClass('open');
        }

        if (!target.closest(".dropdown").length) {
            $('div.dropdown').removeClass('open');
        }
    });
}
{
    layoutr.checkAccordion = (elements) => {
        elements.on("click", ".headline", (e) => {
            let content = $(e.currentTarget).next();
            if (content.hasClass('open')) {
                content
                    .removeClass('open')
                    .slideUp("800");
            } else {
                content
                    .addClass("open")
                    .slideToggle("800")
                    .parents('.accordion').find(".content.open").not(content).removeClass('open').slideUp("800");
            }
        });
    };
}
{
    var closeAlert = (target) => {
        target.fadeOut(layoutr.fadeOutTime, () => {
            let parent = target.parent();
            if (parent.hasClass('popup') && parent.children().length === 1) {
                parent.remove();
            } else {
                target.remove();
            }
        });
    }

    $(() => {
        layoutr.body.on('click', '.alert .close', (e) => {
            let target = $(e.currentTarget).parent();
            closeAlert(target);
        });
    });
}
{
    layoutr.checkMap = (maps) => {
        layoutr.head.find('script[src^="https://maps.googleapis.com/maps-api-"]').remove();
        if (maps.length) {
            if (!layoutr.html.hasClass('map-loaded')) {
                layoutr.showLoading();
                layoutr.promiseMap = layoutr.load.js('https://maps.googleapis.com/maps/api/js?key=AIzaSyBEcomDjRS4Nu3RQCkkSIQ0nrBhuQM0gng').finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('map-loaded');
            }

            layoutr.promiseMap.then(() => {
                maps.each((i, e) => {
                    let $this = $(e),
                        lat = layoutr.tryParseFloat($this.attr('data-lat'), 37.4029937),
                        lng = layoutr.tryParseFloat($this.attr('data-lng'), -122.1811793),
                        zoom = layoutr.tryParseInt($this.attr('data-zoom'), 4),
                        cords = { lat: lat, lng: lng };

                    let map = new google.maps.Map($this[0], {
                        zoom: zoom,
                        center: cords
                    });

                    let marker = new google.maps.Marker({
                        position: cords,
                        map: map
                    });

                    $(window).bind('resize.map', $.throttle(layoutr.throttleInterval, false, () => {
                        google.maps.event.trigger($this[0], 'resize');
                    }));

                    layoutr.html.on('aside-changed.map', () => {
                        google.maps.event.trigger($this[0], 'resize');
                    });
                })
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load maps', 'danger');
            });
        } else {
            $(window).unbind('resize.map');
            layoutr.html.off('aside-changed.map');
        }
    };
}
{
    layoutr.checkMath = (math) => {
        if (math.length) {
            if (!layoutr.html.hasClass('math-loaded')) {
                layoutr.showLoading();
                layoutr.promiseMath = Promise.all([
                    layoutr.load.css('dist/css/katex.css'),
                    layoutr.load.js('dist/js/katex.js')
                ]).finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('math-loaded');
            }

            layoutr.promiseMath.then(() => {
                math.each((i, e) => {
                    let $this = $(e);
                    renderMathInElement($this[0]);
                    setTimeout(() => {
                        $this.removeClass('math');
                    });
                });
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load math', 'danger');
            });
        }
    };
}
{
    layoutr.checkMedia = (media) => {
        if (media.length) {
            if (!layoutr.html.hasClass('media-loaded')) {
                layoutr.showLoading();
                layoutr.promiseMedia = Promise.all([
                    layoutr.load.css('dist/css/plyr.css'),
                    layoutr.load.js('dist/js/plyr.js')
                ]).finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('media-loaded');
            }

            layoutr.promiseMedia.then(() => {
                media.each((i, item) => {
                    new Plyr(item);
                });
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load media', 'danger');
            });
        }
    };
}
{
    layoutr.checkLazy = (elements) => {
        elements.lazy({
            afterLoad: (element) => {
                element.removeClass('lazy');
            }
        });
    };
};
{
    $(() => {
        layoutr.body.on('click', '.show-popup-alert', (e) => {
            let $this = $(e.currentTarget),
                title = $this.attr('data-popup-title'),
                theme = $this.attr('data-popup-theme'),
                position = $this.attr('data-popup-position');
            layoutr.showPopupAlert(title, theme, position);
        });
    });

    layoutr.showPopupAlert = (title, theme = 'light', position = 'top left', type = 'default') => {
        if (title !== undefined) {
            let alert = [],
                popup = layoutr.body.children('.popup[data-position="' + position + '"]');
            alert.push('<div class="alert theme-' + theme + '" data-type="' + type + '">');
            alert.push('<div><p>' + title + '</p></div>');
            alert.push('<button class="close" aria-label="Close popup"><svg focusable="false"><use xlink:href="#svg-close"></use></svg></button>');
            alert.push('</div>');
            alert = alert.join('');
            if (popup.length) {
                popup.append(alert);
            } else {
                let html = [];
                html.push('<div class="popup position ' + position + '" data-position="' + position + '">');
                html.push(alert);
                html.push('</div>');
                html = html.join("");
                layoutr.body.prepend(html);
            }
        }
    }
}
{
    layoutr.checkResponsiveBackground = (elements) => {
        let setRb = (element) => {
            let image = element.attr('data-rb-image'),
                filetype = element.attr('data-rb-image-filetype'),
                sizesWidth = element.attr('data-rb-sizes'),
                current = element.attr('data-rb-current'),
                aspectRatio = element.attr('data-rb-aspect-ratio');
            if (image !== undefined && image.length &&
                filetype !== undefined && filetype.length &&
                sizesWidth !== undefined && sizesWidth.length &&
                aspectRatio !== undefined && aspectRatio.length) {
                if ((filetype === 'jpg' || filetype === 'jpeg' || filetype === 'png') &&
                    (aspectRatio === '21by9' || aspectRatio === '16by9' || aspectRatio === '4by3' || aspectRatio === '1by1')) {
                    sizesWidth = sizesWidth.replace(/\s/g, '').split(',').sort((a, b) => { return a - b; });
                    let goalWidth = element.width(),
                        goalHeight = element.height(),
                        closestWidth,
                        closestHeight,
                        heightPercentage;

                    function getHeightInPercentage(num, amount) {
                        return num * 100 / amount;
                    };

                    if (aspectRatio === '21by9') {
                        heightPercentage = getHeightInPercentage(9, 21);
                    } else if (aspectRatio === '16by9') {
                        heightPercentage = getHeightInPercentage(9, 16);

                    } else if (aspectRatio === '4by3') {
                        heightPercentage = getHeightInPercentage(3, 4);

                    } else if (aspectRatio === '1by1') {
                        heightPercentage = 100;
                    }

                    function getHeightInPixels(num, amount) {
                        return num * amount / 100;
                    };

                    $.each(sizesWidth, (i, e) => {
                        let width = parseInt(e),
                            height = getHeightInPixels(heightPercentage, width);
                        if (closestWidth === undefined || width < goalWidth || closestWidth < goalWidth ||
                            closestHeight === undefined || height < goalHeight || closestHeight < goalHeight) {
                            closestWidth = width;
                            closestHeight = height;
                        }
                    });

                    if (current !== undefined && current.length && parseInt(current) < closestWidth || current === undefined || current.length === 0) {
                        let src = image + '-' + closestWidth + '.' + filetype;
                        layoutr.load.img(src).then(() => {
                            element.css('background-image', 'url(' + src + ')');
                            element.attr('data-rb-current', closestWidth);
                        }).catch(() => {
                            layoutr.showPopupAlert('Failed to load responsive background image', 'danger');
                        });
                    }
                }
            }
        }

        if (elements.length) {
            elements.each((i, e) => {
                let element = $(e);

                setRb(element);

                $(window).on('resize.rb', () => {
                    setRb(element);
                });

                layoutr.html.on('columns-changed.rb', () => {
                    setRb(element);
                });

                layoutr.html.on('aside-changed.rb', () => {
                    setRb(element);
                });
            });

        } else {
            $(window).off('resize.rb');
            layoutr.html.off('columns-changed.rb');
            layoutr.html.off('aside-changed.rb');
        }

    };
}
{
    layoutr.checkTooltip = (tooltips) => {
        tooltips.each((i, e) => {
            let $this = $(e),
                interactive = $this.hasClass('interactive');
            $this.tooltipster({
                animationDuration: 0,
                interactive: interactive,
                trigger: 'custom',
                triggerOpen: {
                    mouseenter: true,
                    touchstart: true
                },
                triggerClose: {
                    mouseleave: true,
                    tap: true,
                    scroll: true
                }
            });
        });
    };
}
{
    layoutr.checkDatatable = (tables) => {
        if (tables.length) {
            if (!layoutr.html.hasClass('datatables-loaded')) {
                layoutr.showLoading();
                layoutr.promiseDatatables = layoutr.load.js('dist/js/datatables.js').finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('datatables-loaded');
            }
            layoutr.promiseDatatables.then(() => {
                let count = 0;
                let spacing = 'space-3';

                let table_header_input = function (instance) {
                    let columns = instance.columns().header();
                    let elements = jQuery.grep(columns, (e) => {
                        let column = $(e);
                        return column.hasClass('dropdown') || column.hasClass('text');
                    });
                    instance.columns().every(function () {
                        let th = this.header(),
                            text = th.innerText,
                            column = $(th),
                            style = '';


                        let minWidth = column.attr('data-min-width');
                        if (minWidth) {
                            style += 'min-width: ' + minWidth + 'px;';
                        }

                        column.empty().append('<div style="' + style + '"><div><span>' + text + '</span></div>' + (elements.length ? '<div></div>' : '') + '</div>');
                        let index = column.index();

                        if (column.hasClass('dropdown')) {
                            let select = $('<select class="dropdown align-left nowrap"><option value=""></option></select>')
                                .appendTo(column.find('> div > div:last-child'))
                                .on('change', (e) => {
                                    instance.column(index).search(e.currentTarget.value).draw();
                                });

                            this.data().unique().sort().each((d, j) => {
                                select.append('<option value="' + d + '">' + d + '</option>');
                            });
                        } else if (column.hasClass('text')) {
                            let input = $('<input type="text" />')
                                .appendTo(column.find('> div > div:last-child'))
                                .on('keyup change', (e) => {
                                    instance.column(index).search(e.currentTarget.value).draw();
                                });
                            input.parent().addClass('form-group');
                        }
                    });
                }
                let table_header_sort = (instance, wrapper) => {
                    let th = wrapper.find('thead th');
                    th.unbind('click');
                    th.find('> div > div:first-child').append('<span class="sort-btn"></span>');
                    th.click((e) => {
                        let $this = $(e.target);
                        if (!$this.closest('div.dropdown').length && !$this.closest('input').length) {
                            let parent = $this.parents('th'),
                                index = parent.index();
                            if (parent.hasClass('sorting_asc')) {
                                instance.column(index).order('desc').draw();

                            } else {
                                instance.column(index).order('asc').draw();
                            }
                        }
                    });
                }
                let table_header_length = (wrapper, header) => {
                    let length = wrapper.find('.dataTables_length'),
                        dropdown = length.find('select');

                    length.append(dropdown);
                    length.children('label').remove();
                    dropdown.addClass('dropdown').attr('data-width', 100);
                    header.append(length);
                }
                let table_header_buttons = (wrapper, header) => {
                    let container = wrapper.find('.dt-buttons');

                    container.append('<div class="flex column wrap ' + spacing + '"></div>');

                    let div = container.children('div'),
                        buttons = container.children('button');

                    container.append(div);
                    buttons.addClass('btn');
                    div.append(buttons);
                    header.append(container);
                }
                let table_header_filter = (wrapper, header) => {
                    let filter = wrapper.find('.dataTables_filter');

                    filter.addClass('input-group');
                    filter.find('input').appendTo(filter);
                    filter.append('<div class="input-group-addon"><svg focusable="false"><use xlink:href="#svg-search"></use></svg></div>');
                    filter.find('label').remove();
                    header.append(filter);
                }
                let table_content = (wrapper, content) => {
                    let table = wrapper.find('table');
                    content.append(table);
                    return table;
                }
                let table_footer_info = (wrapper, footer) => {
                    let info = wrapper.find('.dataTables_info');
                    footer.append(info);
                }
                let paginateFix = (paginate) => {
                    let span = paginate.children('span'),
                        prev = paginate.find('.paginate_button.previous'),
                        next = paginate.find('.paginate_button.next');

                    prev.html('<svg focusable="false"><use xlink:href="#svg-arrow"></use></svg>');
                    next.html('<svg focusable="false"><use xlink:href="#svg-arrow"></use></svg>');

                    prev.prependTo(span);
                    next.appendTo(span);
                }
                let table_footer_paginate = (wrapper, footer, paginate) => {
                    paginate.addClass('flex column wrap');
                    footer.append('<div class="dataTables_paginate_container"></div>');
                    let container = footer.find('.dataTables_paginate_container');
                    paginateFix(paginate);
                    container.append(paginate);
                }
                let table_dropdowns = (wrapper) => {
                    let dropdowns = wrapper.find('select.dropdown');
                    layoutr.checkDropdown(dropdowns);
                }

                tables.each((i, e) => {
                    let $this = $(e);
                    $this.addClass('nowrap');
                    $this.DataTable({
                        "dom": 'lBfrtip',
                        "bSortCellsTop": true,
                        buttons: [
                            //'copy', 'excel', 'csv'
                            {
                                extend: 'copyHtml5',
                                footer: false

                            },
                            {
                                extend: 'excelHtml5',
                                footer: false,
                                exportOptions: {
                                    "format": {
                                        header: (text, index, th) => {
                                            return $(th).find('span:first').html();
                                        }
                                    }
                                }
                            },
                            {
                                extend: 'csvHtml5',
                                footer: false,
                                exportOptions: {
                                    "format": {
                                        header: (text, index, th) => {
                                            return $(th).find('span:first').html();
                                        }
                                    }
                                }
                            }
                        ],
                        responsive: true,
                        initComplete: function (settings, json) {
                            let instance = this.api(),
                                wrapper = $(settings.nTableWrapper);

                            wrapper.append('<div class="dataTables_header flex grow"><div class="flex column wrap ' + spacing + '"></div></div>');
                            let header = wrapper.find('> .dataTables_header > div');

                            wrapper.append('<div class="dataTables_content table"></div>');
                            let content = wrapper.find('> .dataTables_content');

                            wrapper.append('<div class="dataTables_footer"><div class="flex column wrap vertical-center ' + spacing + '"></div></div>');
                            let footer = wrapper.find('> .dataTables_footer > div');

                            table_header_input(instance);
                            table_header_sort(instance, wrapper);
                            table_header_length(wrapper, header);
                            table_header_buttons(wrapper, header);
                            table_header_filter(wrapper, header);

                            let table = table_content(wrapper, content);

                            table_footer_info(wrapper, footer);

                            let paginate = wrapper.find('.dataTables_paginate');
                            table_footer_paginate(wrapper, footer, paginate);

                            table_dropdowns(wrapper);

                            count++;
                            if (count = tables.length) {
                                layoutr.hideLoading();
                            }

                            $this.on('draw.dt', function () {
                                paginateFix(paginate);
                                let columns = instance.columns().responsiveHidden();
                                $this.trigger('responsive-resize.dt', [this, columns]);
                            });

                            layoutr.html.on('aside-changed.datatables', () => {
                                instance.responsive.recalc();
                            });

                            $this.on('responsive-resize.dt', (e, datatable, columns) => {
                                let count = columns.reduce((a, b) => {
                                    return b === false ? a + 1 : a;
                                }, 0);

                                let elements = table.find('tbody tr:not(.child) > *:first-child:not(.dataTables_empty)');
                                elements.removeAttr('tabindex');

                                elements.children('i').remove();
                                if (count) {
                                    elements.prepend('<i tabindex="0"><svg focusable="false"><use xlink:href="#svg-plus"></use></svg><svg focusable="false"><use xlink:href="#svg-minus"></use></svg></i>');
                                }
                            });

                        }
                    });
                });
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load datatables', 'danger');
            });
        } else {
            layoutr.html.off('aside-changed.datatables');
        }
    };
}
{
    layoutr.checkSwiper = (swiper) => {
        if (swiper.length) {
            if (!layoutr.html.hasClass('swiper-loaded')) {
                layoutr.showLoading();
                layoutr.promiseSwiper = Promise.all([
                    layoutr.load.css('dist/css/swiper.css'),
                    layoutr.load.js('dist/js/swiper.js')
                ]).finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('swiper-loaded');
            }

            layoutr.promiseSwiper.then(() => {
                swiper.each((i, e) => {
                    let $this = $(e);
                    if (!$this.hasClass('loaded')) {
                        $this.append('<div class="swiper-footer"></div>');
                        $this.children('.swiper-footer').append('<div></div>')

                        let footer = $this.find('> .swiper-footer > div'),
                            pagination = $this.hasClass('pagination'),
                            dynamicBullets = $this.hasClass('dynamic-bullets'),
                            navigation = $this.hasClass('navigation'),
                            loop = layoutr.isTrue($this.attr('data-loop')),
                            spaceBetween = $this.hasClass('space-between'),
                            slidesPerView = layoutr.tryParseInt($this.attr('data-slides-per-view'), 1),
                            breakpoints = layoutr.tryParseJSON($this.attr('data-breakpoints'), {});

                        footer.addClass('flex column wrap space-3 center');

                        if (pagination || dynamicBullets) {
                            footer.append('<div class="swiper-pagination"><div class="flex column wrap space-1 center"></div></div>');
                        }

                        if (navigation) {
                            footer.append('<button class="btn square circle prev theme-dark"><svg focusable="false"><use xlink:href="#svg-arrow"></use></svg></button>');
                            footer.append('<button class="btn square circle next theme-dark"><svg focusable="false"><use xlink:href="#svg-arrow"></use></svg></button>');
                        }

                        if (spaceBetween) {
                            spaceBetween = 16;
                        }

                        var swiper = new Swiper($this[0], {
                            loop: loop,
                            slidesPerView: slidesPerView,
                            spaceBetween: spaceBetween,

                            // If we need pagination
                            pagination: {
                                el: '.swiper-pagination > div',
                                dynamicBullets: dynamicBullets
                            },

                            // Navigation arrows
                            navigation: {
                                nextEl: '.swiper-footer .next',
                                prevEl: '.swiper-footer .prev',
                            },

                            // And if we need scrollbar
                            scrollbar: {
                                el: '.swiper-scrollbar',
                            },
                            breakpoints: breakpoints,
                            on: {
                                init: () => {
                                    $this.addClass('loaded');
                                },
                                slideChange: () => {
                                    layoutr.checkLazy($this.find('.lazy'));
                                },
                                paginationRender: (el) => {
                                    //if (navigation) {
                                    //    $(el).append(footer.children('.btn'))
                                    //}
                                }
                            }
                        });
                    }
                });
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load swiper', 'danger');
            });
        }
    };
}
{
    layoutr.getAssignmentItem = (items, id) => {
        return $($.map(items, (item) => {
            if (item.getAttribute("data-id") === id) {
                return item;
            }
        }));
    };

    layoutr.checkAssignment = (assignments) => {
        if (assignments.length) {
            if (!layoutr.html.hasClass('assignment-loaded')) {
                layoutr.showLoading();
                layoutr.promiseAssignment = layoutr.load.js('dist/js/assignment.js').finally(() => {
                    layoutr.hideLoading();
                });
                layoutr.html.addClass('assignment-loaded');
            }

            layoutr.promiseAssignment.then(() => {
                $(assignments).each((i, assignment) => {
                    assignment = $(assignment);
                    layoutr.checkAssignmentSort(assignment);
                    layoutr.checkAssignmentDragAndDrop(assignment);
                    layoutr.checkAssignmentColor(assignment);
                });
            }).catch(() => {
                layoutr.showPopupAlert('Failed to load assignment', 'danger');
            });
        }
    };
}
{
    layoutr.pageForm = () => {
        layoutr.addValidation(
            layoutr.content.find('#form'),
            {
                firstName: {
                    required: true,
                    minlength: 2
                },
                lastName: {
                    required: true,
                    minlength: 2
                },
                username: {
                    required: true,
                    minlength: 2
                },
                password: {
                    required: true,
                    password_regex: true
                },
                confirm_password: {
                    required: true,
                    equalTo: "#password"
                },
                email: {
                    required: true,
                    email: true
                },
                dropdown_1: "required",
                dropdown_2: "required",
                dropdown_3: "required",
                dropdown_4: "required",
                dropdown_5: "required",
                dropdown_6: "required",
                gender: "required",
                interests: "required",
                agree: "required",
                font_size: "required"
            },
            {
                firstName: {
                    required: "Please enter your first name",
                    minlength: "Your first name must consist of at least 2 characters"
                },
                lastName: {
                    required: "Please enter your last name",
                    minlength: "Your last name must consist of at least 2 characters"
                },
                username: {
                    required: "Please enter a username",
                    minlength: "Your username must consist of at least 2 characters"
                },
                password: {
                    required: "Please provide a password"
                },
                confirm_password: {
                    required: "Please provide a password",
                    equalTo: "Please enter the same password as above"
                },
                email: "Please enter a valid email address",
                dropdown_1: "Please select an option",
                dropdown_2: "Please select an option",
                dropdown_3: "Please select an option",
                dropdown_4: "Please select an option",
                dropdown_5: "Please select an option",
                dropdown_6: "Please select an option",
                gender: "Please select your gender",
                interests: "Please select at least one interest",
                agree: "Please accept our policy"
            }
        );
    };
}
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb21pc2UubWluLmpzIiwiZmV0Y2gubWluLmpzIiwid2ViZm9udGxvYWRlci5taW4uanMiLCJqcXVlcnktMy4xLjEuc2xpbS5taW4uanMiLCJqcXVlcnkuZmFkZS5qcyIsImpxdWVyeS52YWxpZGF0ZS5taW4uanMiLCJqcXVlcnkubGF6eS5taW4uanMiLCJ0b29sdGlwc3Rlci5taW4uanMiLCJqcXVlcnkuYmEtdGhyb3R0bGUtZGVib3VuY2UuanMiLCJqcXVlcnkuc2h1ZmZsZS5qcyIsImJvd3Nlci5qcyIsIl9wb2x5ZmlsbC5qcyIsIl92YXJpYWJsZS5qcyIsIl9mdW5jdGlvbi5qcyIsIl9ib3dzZXIuanMiLCJfZm9ybS5qcyIsImxvYWQuanMiLCJhbmFseXRpY3MtaGVscGVyLmpzIiwiZm9udC5qcyIsIl9hcHAuanMiLCJsb2FkZWQuanMiLCJmdWxsc2NyZWVuLmpzIiwic2Nyb2xsLmpzIiwibG9hZGluZy5qcyIsImFzaWRlLmpzIiwiYXV0aGVudGljYXRpb24uanMiLCJjb29raWUuanMiLCJuYXZpZ2F0aW9uLmpzIiwic2V0dGluZ3MuanMiLCJrZXlib2FyZC5qcyIsIm1vZGFsLmpzIiwicmVzcG9uc2l2ZUhlYWRlci5qcyIsImZvY3VzLmpzIiwic3dpcGUuanMiLCJ0dHMuanMiLCJjb250ZW50SGVhZGVyLmpzIiwidGhlbWUuanMiLCJjb25uZWN0ZWQuanMiLCJkcm9wZG93bi5qcyIsImFjY29yZGlvbi5qcyIsImFsZXJ0LmpzIiwibWFwLmpzIiwibWF0aC5qcyIsIm1lZGlhLmpzIiwibGF6eS5qcyIsInBvcHVwLmpzIiwicmVzcG9uc2l2ZUJhY2tncm91bmQuanMiLCJ0b29sdGlwLmpzIiwiZGF0YXRhYmxlcy5qcyIsInN3aXBlci5qcyIsIl9hc3NpZ25tZW50LmpzIiwiZm9ybS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakJBO0FBQ0E7QUNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwRUE7QUFDQTtBQUNBO0FBQ0E7QUNIQTtBQUNBO0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDcm9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNYQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNoQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzdFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNyR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN4S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDZEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzVCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDaEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDbEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ1JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzFGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3JCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hQQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDeEZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyIhZnVuY3Rpb24oZSxuKXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZT9uKCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShuKTpuKCl9KDAsZnVuY3Rpb24oKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiBlKGUpe3ZhciBuPXRoaXMuY29uc3RydWN0b3I7cmV0dXJuIHRoaXMudGhlbihmdW5jdGlvbih0KXtyZXR1cm4gbi5yZXNvbHZlKGUoKSkudGhlbihmdW5jdGlvbigpe3JldHVybiB0fSl9LGZ1bmN0aW9uKHQpe3JldHVybiBuLnJlc29sdmUoZSgpKS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIG4ucmVqZWN0KHQpfSl9KX1mdW5jdGlvbiBuKCl7fWZ1bmN0aW9uIHQoZSl7aWYoISh0aGlzIGluc3RhbmNlb2YgdCkpdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByb21pc2VzIG11c3QgYmUgY29uc3RydWN0ZWQgdmlhIG5ld1wiKTtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBlKXRocm93IG5ldyBUeXBlRXJyb3IoXCJub3QgYSBmdW5jdGlvblwiKTt0aGlzLl9zdGF0ZT0wLHRoaXMuX2hhbmRsZWQ9ITEsdGhpcy5fdmFsdWU9dW5kZWZpbmVkLHRoaXMuX2RlZmVycmVkcz1bXSx1KGUsdGhpcyl9ZnVuY3Rpb24gbyhlLG4pe2Zvcig7Mz09PWUuX3N0YXRlOyllPWUuX3ZhbHVlOzAhPT1lLl9zdGF0ZT8oZS5faGFuZGxlZD0hMCx0Ll9pbW1lZGlhdGVGbihmdW5jdGlvbigpe3ZhciB0PTE9PT1lLl9zdGF0ZT9uLm9uRnVsZmlsbGVkOm4ub25SZWplY3RlZDtpZihudWxsIT09dCl7dmFyIG87dHJ5e289dChlLl92YWx1ZSl9Y2F0Y2goZil7cmV0dXJuIHZvaWQgaShuLnByb21pc2UsZil9cihuLnByb21pc2Usbyl9ZWxzZSgxPT09ZS5fc3RhdGU/cjppKShuLnByb21pc2UsZS5fdmFsdWUpfSkpOmUuX2RlZmVycmVkcy5wdXNoKG4pfWZ1bmN0aW9uIHIoZSxuKXt0cnl7aWYobj09PWUpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkEgcHJvbWlzZSBjYW5ub3QgYmUgcmVzb2x2ZWQgd2l0aCBpdHNlbGYuXCIpO2lmKG4mJihcIm9iamVjdFwiPT10eXBlb2Ygbnx8XCJmdW5jdGlvblwiPT10eXBlb2Ygbikpe3ZhciBvPW4udGhlbjtpZihuIGluc3RhbmNlb2YgdClyZXR1cm4gZS5fc3RhdGU9MyxlLl92YWx1ZT1uLHZvaWQgZihlKTtpZihcImZ1bmN0aW9uXCI9PXR5cGVvZiBvKXJldHVybiB2b2lkIHUoZnVuY3Rpb24oZSxuKXtyZXR1cm4gZnVuY3Rpb24oKXtlLmFwcGx5KG4sYXJndW1lbnRzKX19KG8sbiksZSl9ZS5fc3RhdGU9MSxlLl92YWx1ZT1uLGYoZSl9Y2F0Y2gocil7aShlLHIpfX1mdW5jdGlvbiBpKGUsbil7ZS5fc3RhdGU9MixlLl92YWx1ZT1uLGYoZSl9ZnVuY3Rpb24gZihlKXsyPT09ZS5fc3RhdGUmJjA9PT1lLl9kZWZlcnJlZHMubGVuZ3RoJiZ0Ll9pbW1lZGlhdGVGbihmdW5jdGlvbigpe2UuX2hhbmRsZWR8fHQuX3VuaGFuZGxlZFJlamVjdGlvbkZuKGUuX3ZhbHVlKX0pO2Zvcih2YXIgbj0wLHI9ZS5fZGVmZXJyZWRzLmxlbmd0aDtyPm47bisrKW8oZSxlLl9kZWZlcnJlZHNbbl0pO2UuX2RlZmVycmVkcz1udWxsfWZ1bmN0aW9uIHUoZSxuKXt2YXIgdD0hMTt0cnl7ZShmdW5jdGlvbihlKXt0fHwodD0hMCxyKG4sZSkpfSxmdW5jdGlvbihlKXt0fHwodD0hMCxpKG4sZSkpfSl9Y2F0Y2gobyl7aWYodClyZXR1cm47dD0hMCxpKG4sbyl9fXZhciBjPXNldFRpbWVvdXQ7dC5wcm90b3R5cGVbXCJjYXRjaFwiXT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy50aGVuKG51bGwsZSl9LHQucHJvdG90eXBlLnRoZW49ZnVuY3Rpb24oZSx0KXt2YXIgcj1uZXcgdGhpcy5jb25zdHJ1Y3RvcihuKTtyZXR1cm4gbyh0aGlzLG5ldyBmdW5jdGlvbihlLG4sdCl7dGhpcy5vbkZ1bGZpbGxlZD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBlP2U6bnVsbCx0aGlzLm9uUmVqZWN0ZWQ9XCJmdW5jdGlvblwiPT10eXBlb2Ygbj9uOm51bGwsdGhpcy5wcm9taXNlPXR9KGUsdCxyKSkscn0sdC5wcm90b3R5cGVbXCJmaW5hbGx5XCJdPWUsdC5hbGw9ZnVuY3Rpb24oZSl7cmV0dXJuIG5ldyB0KGZ1bmN0aW9uKG4sdCl7ZnVuY3Rpb24gbyhlLGYpe3RyeXtpZihmJiYoXCJvYmplY3RcIj09dHlwZW9mIGZ8fFwiZnVuY3Rpb25cIj09dHlwZW9mIGYpKXt2YXIgdT1mLnRoZW47aWYoXCJmdW5jdGlvblwiPT10eXBlb2YgdSlyZXR1cm4gdm9pZCB1LmNhbGwoZixmdW5jdGlvbihuKXtvKGUsbil9LHQpfXJbZV09ZiwwPT0tLWkmJm4ocil9Y2F0Y2goYyl7dChjKX19aWYoIWV8fFwidW5kZWZpbmVkXCI9PXR5cGVvZiBlLmxlbmd0aCl0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJvbWlzZS5hbGwgYWNjZXB0cyBhbiBhcnJheVwiKTt2YXIgcj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChlKTtpZigwPT09ci5sZW5ndGgpcmV0dXJuIG4oW10pO2Zvcih2YXIgaT1yLmxlbmd0aCxmPTA7ci5sZW5ndGg+ZjtmKyspbyhmLHJbZl0pfSl9LHQucmVzb2x2ZT1mdW5jdGlvbihlKXtyZXR1cm4gZSYmXCJvYmplY3RcIj09dHlwZW9mIGUmJmUuY29uc3RydWN0b3I9PT10P2U6bmV3IHQoZnVuY3Rpb24obil7bihlKX0pfSx0LnJlamVjdD1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IHQoZnVuY3Rpb24obix0KXt0KGUpfSl9LHQucmFjZT1mdW5jdGlvbihlKXtyZXR1cm4gbmV3IHQoZnVuY3Rpb24obix0KXtmb3IodmFyIG89MCxyPWUubGVuZ3RoO3I+bztvKyspZVtvXS50aGVuKG4sdCl9KX0sdC5faW1tZWRpYXRlRm49XCJmdW5jdGlvblwiPT10eXBlb2Ygc2V0SW1tZWRpYXRlJiZmdW5jdGlvbihlKXtzZXRJbW1lZGlhdGUoZSl9fHxmdW5jdGlvbihlKXtjKGUsMCl9LHQuX3VuaGFuZGxlZFJlamVjdGlvbkZuPWZ1bmN0aW9uKGUpe3ZvaWQgMCE9PWNvbnNvbGUmJmNvbnNvbGUmJmNvbnNvbGUud2FybihcIlBvc3NpYmxlIFVuaGFuZGxlZCBQcm9taXNlIFJlamVjdGlvbjpcIixlKX07dmFyIGw9ZnVuY3Rpb24oKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2Ygc2VsZilyZXR1cm4gc2VsZjtpZihcInVuZGVmaW5lZFwiIT10eXBlb2Ygd2luZG93KXJldHVybiB3aW5kb3c7aWYoXCJ1bmRlZmluZWRcIiE9dHlwZW9mIGdsb2JhbClyZXR1cm4gZ2xvYmFsO3Rocm93IEVycm9yKFwidW5hYmxlIHRvIGxvY2F0ZSBnbG9iYWwgb2JqZWN0XCIpfSgpO1wiUHJvbWlzZVwiaW4gbD9sLlByb21pc2UucHJvdG90eXBlW1wiZmluYWxseVwiXXx8KGwuUHJvbWlzZS5wcm90b3R5cGVbXCJmaW5hbGx5XCJdPWUpOmwuUHJvbWlzZT10fSk7Iiwic2VsZi5mZXRjaCB8fCAoc2VsZi5mZXRjaCA9IGZ1bmN0aW9uIChlLCBuKSB7IHJldHVybiBuID0gbiB8fCB7fSwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHQsIHIpIHsgdmFyIHMgPSBuZXcgWE1MSHR0cFJlcXVlc3Q7IGZvciAodmFyIG8gaW4gcy5vcGVuKG4ubWV0aG9kIHx8IFwiZ2V0XCIsIGUsICEwKSwgbi5oZWFkZXJzKSBzLnNldFJlcXVlc3RIZWFkZXIobywgbi5oZWFkZXJzW29dKTsgZnVuY3Rpb24gdSgpIHsgdmFyIGUsIG4gPSBbXSwgdCA9IFtdLCByID0ge307IHJldHVybiBzLmdldEFsbFJlc3BvbnNlSGVhZGVycygpLnJlcGxhY2UoL14oLio/KTpbXlxcU1xcbl0qKFtcXHNcXFNdKj8pJC9nbSwgZnVuY3Rpb24gKHMsIG8sIHUpIHsgbi5wdXNoKG8gPSBvLnRvTG93ZXJDYXNlKCkpLCB0LnB1c2goW28sIHVdKSwgcltvXSA9IChlID0gcltvXSkgPyBlICsgXCIsXCIgKyB1IDogdSB9KSwgeyBvazogMiA9PSAocy5zdGF0dXMgLyAxMDAgfCAwKSwgc3RhdHVzOiBzLnN0YXR1cywgc3RhdHVzVGV4dDogcy5zdGF0dXNUZXh0LCB1cmw6IHMucmVzcG9uc2VVUkwsIGNsb25lOiB1LCB0ZXh0OiBmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUocy5yZXNwb25zZVRleHQpIH0sIGpzb246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFByb21pc2UucmVzb2x2ZShzLnJlc3BvbnNlVGV4dCkudGhlbihKU09OLnBhcnNlKSB9LCBibG9iOiBmdW5jdGlvbiAoKSB7IHJldHVybiBQcm9taXNlLnJlc29sdmUobmV3IEJsb2IoW3MucmVzcG9uc2VdKSkgfSwgaGVhZGVyczogeyBrZXlzOiBmdW5jdGlvbiAoKSB7IHJldHVybiBuIH0sIGVudHJpZXM6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHQgfSwgZ2V0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gcltlLnRvTG93ZXJDYXNlKCldIH0sIGhhczogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUudG9Mb3dlckNhc2UoKSBpbiByIH0gfSB9IH0gcy53aXRoQ3JlZGVudGlhbHMgPSBcImluY2x1ZGVcIiA9PSBuLmNyZWRlbnRpYWxzLCBzLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHsgdCh1KCkpIH0sIHMub25lcnJvciA9IHIsIHMuc2VuZChuLmJvZHkgfHwgbnVsbCkgfSkgfSk7IiwiLyogV2ViIEZvbnQgTG9hZGVyIHYxLjYuMjggLSAoYykgQWRvYmUgU3lzdGVtcywgR29vZ2xlLiBMaWNlbnNlOiBBcGFjaGUgMi4wICovKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gYWEoYSxiLGMpe3JldHVybiBhLmNhbGwuYXBwbHkoYS5iaW5kLGFyZ3VtZW50cyl9ZnVuY3Rpb24gYmEoYSxiLGMpe2lmKCFhKXRocm93IEVycm9yKCk7aWYoMjxhcmd1bWVudHMubGVuZ3RoKXt2YXIgZD1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIGM9QXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzKTtBcnJheS5wcm90b3R5cGUudW5zaGlmdC5hcHBseShjLGQpO3JldHVybiBhLmFwcGx5KGIsYyl9fXJldHVybiBmdW5jdGlvbigpe3JldHVybiBhLmFwcGx5KGIsYXJndW1lbnRzKX19ZnVuY3Rpb24gcChhLGIsYyl7cD1GdW5jdGlvbi5wcm90b3R5cGUuYmluZCYmLTEhPUZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kLnRvU3RyaW5nKCkuaW5kZXhPZihcIm5hdGl2ZSBjb2RlXCIpP2FhOmJhO3JldHVybiBwLmFwcGx5KG51bGwsYXJndW1lbnRzKX12YXIgcT1EYXRlLm5vd3x8ZnVuY3Rpb24oKXtyZXR1cm4rbmV3IERhdGV9O2Z1bmN0aW9uIGNhKGEsYil7dGhpcy5hPWE7dGhpcy5vPWJ8fGE7dGhpcy5jPXRoaXMuby5kb2N1bWVudH12YXIgZGE9ISF3aW5kb3cuRm9udEZhY2U7ZnVuY3Rpb24gdChhLGIsYyxkKXtiPWEuYy5jcmVhdGVFbGVtZW50KGIpO2lmKGMpZm9yKHZhciBlIGluIGMpYy5oYXNPd25Qcm9wZXJ0eShlKSYmKFwic3R5bGVcIj09ZT9iLnN0eWxlLmNzc1RleHQ9Y1tlXTpiLnNldEF0dHJpYnV0ZShlLGNbZV0pKTtkJiZiLmFwcGVuZENoaWxkKGEuYy5jcmVhdGVUZXh0Tm9kZShkKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gdShhLGIsYyl7YT1hLmMuZ2V0RWxlbWVudHNCeVRhZ05hbWUoYilbMF07YXx8KGE9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KTthLmluc2VydEJlZm9yZShjLGEubGFzdENoaWxkKX1mdW5jdGlvbiB2KGEpe2EucGFyZW50Tm9kZSYmYS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGEpfVxyXG5mdW5jdGlvbiB3KGEsYixjKXtiPWJ8fFtdO2M9Y3x8W107Zm9yKHZhciBkPWEuY2xhc3NOYW1lLnNwbGl0KC9cXHMrLyksZT0wO2U8Yi5sZW5ndGg7ZSs9MSl7Zm9yKHZhciBmPSExLGc9MDtnPGQubGVuZ3RoO2crPTEpaWYoYltlXT09PWRbZ10pe2Y9ITA7YnJlYWt9Znx8ZC5wdXNoKGJbZV0pfWI9W107Zm9yKGU9MDtlPGQubGVuZ3RoO2UrPTEpe2Y9ITE7Zm9yKGc9MDtnPGMubGVuZ3RoO2crPTEpaWYoZFtlXT09PWNbZ10pe2Y9ITA7YnJlYWt9Znx8Yi5wdXNoKGRbZV0pfWEuY2xhc3NOYW1lPWIuam9pbihcIiBcIikucmVwbGFjZSgvXFxzKy9nLFwiIFwiKS5yZXBsYWNlKC9eXFxzK3xcXHMrJC8sXCJcIil9ZnVuY3Rpb24geShhLGIpe2Zvcih2YXIgYz1hLmNsYXNzTmFtZS5zcGxpdCgvXFxzKy8pLGQ9MCxlPWMubGVuZ3RoO2Q8ZTtkKyspaWYoY1tkXT09YilyZXR1cm4hMDtyZXR1cm4hMX1cclxuZnVuY3Rpb24gZWEoYSl7cmV0dXJuIGEuby5sb2NhdGlvbi5ob3N0bmFtZXx8YS5hLmxvY2F0aW9uLmhvc3RuYW1lfWZ1bmN0aW9uIHooYSxiLGMpe2Z1bmN0aW9uIGQoKXttJiZlJiZmJiYobShnKSxtPW51bGwpfWI9dChhLFwibGlua1wiLHtyZWw6XCJzdHlsZXNoZWV0XCIsaHJlZjpiLG1lZGlhOlwiYWxsXCJ9KTt2YXIgZT0hMSxmPSEwLGc9bnVsbCxtPWN8fG51bGw7ZGE/KGIub25sb2FkPWZ1bmN0aW9uKCl7ZT0hMDtkKCl9LGIub25lcnJvcj1mdW5jdGlvbigpe2U9ITA7Zz1FcnJvcihcIlN0eWxlc2hlZXQgZmFpbGVkIHRvIGxvYWRcIik7ZCgpfSk6c2V0VGltZW91dChmdW5jdGlvbigpe2U9ITA7ZCgpfSwwKTt1KGEsXCJoZWFkXCIsYil9XHJcbmZ1bmN0aW9uIEEoYSxiLGMsZCl7dmFyIGU9YS5jLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaGVhZFwiKVswXTtpZihlKXt2YXIgZj10KGEsXCJzY3JpcHRcIix7c3JjOmJ9KSxnPSExO2Yub25sb2FkPWYub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7Z3x8dGhpcy5yZWFkeVN0YXRlJiZcImxvYWRlZFwiIT10aGlzLnJlYWR5U3RhdGUmJlwiY29tcGxldGVcIiE9dGhpcy5yZWFkeVN0YXRlfHwoZz0hMCxjJiZjKG51bGwpLGYub25sb2FkPWYub25yZWFkeXN0YXRlY2hhbmdlPW51bGwsXCJIRUFEXCI9PWYucGFyZW50Tm9kZS50YWdOYW1lJiZlLnJlbW92ZUNoaWxkKGYpKX07ZS5hcHBlbmRDaGlsZChmKTtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7Z3x8KGc9ITAsYyYmYyhFcnJvcihcIlNjcmlwdCBsb2FkIHRpbWVvdXRcIikpKX0sZHx8NUUzKTtyZXR1cm4gZn1yZXR1cm4gbnVsbH07ZnVuY3Rpb24gQigpe3RoaXMuYT0wO3RoaXMuYz1udWxsfWZ1bmN0aW9uIEMoYSl7YS5hKys7cmV0dXJuIGZ1bmN0aW9uKCl7YS5hLS07RChhKX19ZnVuY3Rpb24gRShhLGIpe2EuYz1iO0QoYSl9ZnVuY3Rpb24gRChhKXswPT1hLmEmJmEuYyYmKGEuYygpLGEuYz1udWxsKX07ZnVuY3Rpb24gRihhKXt0aGlzLmE9YXx8XCItXCJ9Ri5wcm90b3R5cGUuYz1mdW5jdGlvbihhKXtmb3IodmFyIGI9W10sYz0wO2M8YXJndW1lbnRzLmxlbmd0aDtjKyspYi5wdXNoKGFyZ3VtZW50c1tjXS5yZXBsYWNlKC9bXFxXX10rL2csXCJcIikudG9Mb3dlckNhc2UoKSk7cmV0dXJuIGIuam9pbih0aGlzLmEpfTtmdW5jdGlvbiBHKGEsYil7dGhpcy5jPWE7dGhpcy5mPTQ7dGhpcy5hPVwiblwiO3ZhciBjPShifHxcIm40XCIpLm1hdGNoKC9eKFtuaW9dKShbMS05XSkkL2kpO2MmJih0aGlzLmE9Y1sxXSx0aGlzLmY9cGFyc2VJbnQoY1syXSwxMCkpfWZ1bmN0aW9uIGZhKGEpe3JldHVybiBIKGEpK1wiIFwiKyhhLmYrXCIwMFwiKStcIiAzMDBweCBcIitJKGEuYyl9ZnVuY3Rpb24gSShhKXt2YXIgYj1bXTthPWEuc3BsaXQoLyxcXHMqLyk7Zm9yKHZhciBjPTA7YzxhLmxlbmd0aDtjKyspe3ZhciBkPWFbY10ucmVwbGFjZSgvWydcIl0vZyxcIlwiKTstMSE9ZC5pbmRleE9mKFwiIFwiKXx8L15cXGQvLnRlc3QoZCk/Yi5wdXNoKFwiJ1wiK2QrXCInXCIpOmIucHVzaChkKX1yZXR1cm4gYi5qb2luKFwiLFwiKX1mdW5jdGlvbiBKKGEpe3JldHVybiBhLmErYS5mfWZ1bmN0aW9uIEgoYSl7dmFyIGI9XCJub3JtYWxcIjtcIm9cIj09PWEuYT9iPVwib2JsaXF1ZVwiOlwiaVwiPT09YS5hJiYoYj1cIml0YWxpY1wiKTtyZXR1cm4gYn1cclxuZnVuY3Rpb24gZ2EoYSl7dmFyIGI9NCxjPVwiblwiLGQ9bnVsbDthJiYoKGQ9YS5tYXRjaCgvKG5vcm1hbHxvYmxpcXVlfGl0YWxpYykvaSkpJiZkWzFdJiYoYz1kWzFdLnN1YnN0cigwLDEpLnRvTG93ZXJDYXNlKCkpLChkPWEubWF0Y2goLyhbMS05XTAwfG5vcm1hbHxib2xkKS9pKSkmJmRbMV0mJigvYm9sZC9pLnRlc3QoZFsxXSk/Yj03Oi9bMS05XTAwLy50ZXN0KGRbMV0pJiYoYj1wYXJzZUludChkWzFdLnN1YnN0cigwLDEpLDEwKSkpKTtyZXR1cm4gYytifTtmdW5jdGlvbiBoYShhLGIpe3RoaXMuYz1hO3RoaXMuZj1hLm8uZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50O3RoaXMuaD1iO3RoaXMuYT1uZXcgRihcIi1cIik7dGhpcy5qPSExIT09Yi5ldmVudHM7dGhpcy5nPSExIT09Yi5jbGFzc2VzfWZ1bmN0aW9uIGlhKGEpe2EuZyYmdyhhLmYsW2EuYS5jKFwid2ZcIixcImxvYWRpbmdcIildKTtLKGEsXCJsb2FkaW5nXCIpfWZ1bmN0aW9uIEwoYSl7aWYoYS5nKXt2YXIgYj15KGEuZixhLmEuYyhcIndmXCIsXCJhY3RpdmVcIikpLGM9W10sZD1bYS5hLmMoXCJ3ZlwiLFwibG9hZGluZ1wiKV07Ynx8Yy5wdXNoKGEuYS5jKFwid2ZcIixcImluYWN0aXZlXCIpKTt3KGEuZixjLGQpfUsoYSxcImluYWN0aXZlXCIpfWZ1bmN0aW9uIEsoYSxiLGMpe2lmKGEuaiYmYS5oW2JdKWlmKGMpYS5oW2JdKGMuYyxKKGMpKTtlbHNlIGEuaFtiXSgpfTtmdW5jdGlvbiBqYSgpe3RoaXMuYz17fX1mdW5jdGlvbiBrYShhLGIsYyl7dmFyIGQ9W10sZTtmb3IoZSBpbiBiKWlmKGIuaGFzT3duUHJvcGVydHkoZSkpe3ZhciBmPWEuY1tlXTtmJiZkLnB1c2goZihiW2VdLGMpKX1yZXR1cm4gZH07ZnVuY3Rpb24gTShhLGIpe3RoaXMuYz1hO3RoaXMuZj1iO3RoaXMuYT10KHRoaXMuYyxcInNwYW5cIix7XCJhcmlhLWhpZGRlblwiOlwidHJ1ZVwifSx0aGlzLmYpfWZ1bmN0aW9uIE4oYSl7dShhLmMsXCJib2R5XCIsYS5hKX1mdW5jdGlvbiBPKGEpe3JldHVyblwiZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTk5OTlweDtsZWZ0Oi05OTk5cHg7Zm9udC1zaXplOjMwMHB4O3dpZHRoOmF1dG87aGVpZ2h0OmF1dG87bGluZS1oZWlnaHQ6bm9ybWFsO21hcmdpbjowO3BhZGRpbmc6MDtmb250LXZhcmlhbnQ6bm9ybWFsO3doaXRlLXNwYWNlOm5vd3JhcDtmb250LWZhbWlseTpcIitJKGEuYykrXCI7XCIrKFwiZm9udC1zdHlsZTpcIitIKGEpK1wiO2ZvbnQtd2VpZ2h0OlwiKyhhLmYrXCIwMFwiKStcIjtcIil9O2Z1bmN0aW9uIFAoYSxiLGMsZCxlLGYpe3RoaXMuZz1hO3RoaXMuaj1iO3RoaXMuYT1kO3RoaXMuYz1jO3RoaXMuZj1lfHwzRTM7dGhpcy5oPWZ8fHZvaWQgMH1QLnByb3RvdHlwZS5zdGFydD1mdW5jdGlvbigpe3ZhciBhPXRoaXMuYy5vLmRvY3VtZW50LGI9dGhpcyxjPXEoKSxkPW5ldyBQcm9taXNlKGZ1bmN0aW9uKGQsZSl7ZnVuY3Rpb24gZigpe3EoKS1jPj1iLmY/ZSgpOmEuZm9udHMubG9hZChmYShiLmEpLGIuaCkudGhlbihmdW5jdGlvbihhKXsxPD1hLmxlbmd0aD9kKCk6c2V0VGltZW91dChmLDI1KX0sZnVuY3Rpb24oKXtlKCl9KX1mKCl9KSxlPW51bGwsZj1uZXcgUHJvbWlzZShmdW5jdGlvbihhLGQpe2U9c2V0VGltZW91dChkLGIuZil9KTtQcm9taXNlLnJhY2UoW2YsZF0pLnRoZW4oZnVuY3Rpb24oKXtlJiYoY2xlYXJUaW1lb3V0KGUpLGU9bnVsbCk7Yi5nKGIuYSl9LGZ1bmN0aW9uKCl7Yi5qKGIuYSl9KX07ZnVuY3Rpb24gUShhLGIsYyxkLGUsZixnKXt0aGlzLnY9YTt0aGlzLkI9Yjt0aGlzLmM9Yzt0aGlzLmE9ZDt0aGlzLnM9Z3x8XCJCRVNic3d5XCI7dGhpcy5mPXt9O3RoaXMudz1lfHwzRTM7dGhpcy51PWZ8fG51bGw7dGhpcy5tPXRoaXMuaj10aGlzLmg9dGhpcy5nPW51bGw7dGhpcy5nPW5ldyBNKHRoaXMuYyx0aGlzLnMpO3RoaXMuaD1uZXcgTSh0aGlzLmMsdGhpcy5zKTt0aGlzLmo9bmV3IE0odGhpcy5jLHRoaXMucyk7dGhpcy5tPW5ldyBNKHRoaXMuYyx0aGlzLnMpO2E9bmV3IEcodGhpcy5hLmMrXCIsc2VyaWZcIixKKHRoaXMuYSkpO2E9TyhhKTt0aGlzLmcuYS5zdHlsZS5jc3NUZXh0PWE7YT1uZXcgRyh0aGlzLmEuYytcIixzYW5zLXNlcmlmXCIsSih0aGlzLmEpKTthPU8oYSk7dGhpcy5oLmEuc3R5bGUuY3NzVGV4dD1hO2E9bmV3IEcoXCJzZXJpZlwiLEoodGhpcy5hKSk7YT1PKGEpO3RoaXMuai5hLnN0eWxlLmNzc1RleHQ9YTthPW5ldyBHKFwic2Fucy1zZXJpZlwiLEoodGhpcy5hKSk7YT1cclxuTyhhKTt0aGlzLm0uYS5zdHlsZS5jc3NUZXh0PWE7Tih0aGlzLmcpO04odGhpcy5oKTtOKHRoaXMuaik7Tih0aGlzLm0pfXZhciBSPXtEOlwic2VyaWZcIixDOlwic2Fucy1zZXJpZlwifSxTPW51bGw7ZnVuY3Rpb24gVCgpe2lmKG51bGw9PT1TKXt2YXIgYT0vQXBwbGVXZWJLaXRcXC8oWzAtOV0rKSg/OlxcLihbMC05XSspKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7Uz0hIWEmJig1MzY+cGFyc2VJbnQoYVsxXSwxMCl8fDUzNj09PXBhcnNlSW50KGFbMV0sMTApJiYxMT49cGFyc2VJbnQoYVsyXSwxMCkpfXJldHVybiBTfVEucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7dGhpcy5mLnNlcmlmPXRoaXMuai5hLm9mZnNldFdpZHRoO3RoaXMuZltcInNhbnMtc2VyaWZcIl09dGhpcy5tLmEub2Zmc2V0V2lkdGg7dGhpcy5BPXEoKTtVKHRoaXMpfTtcclxuZnVuY3Rpb24gbGEoYSxiLGMpe2Zvcih2YXIgZCBpbiBSKWlmKFIuaGFzT3duUHJvcGVydHkoZCkmJmI9PT1hLmZbUltkXV0mJmM9PT1hLmZbUltkXV0pcmV0dXJuITA7cmV0dXJuITF9ZnVuY3Rpb24gVShhKXt2YXIgYj1hLmcuYS5vZmZzZXRXaWR0aCxjPWEuaC5hLm9mZnNldFdpZHRoLGQ7KGQ9Yj09PWEuZi5zZXJpZiYmYz09PWEuZltcInNhbnMtc2VyaWZcIl0pfHwoZD1UKCkmJmxhKGEsYixjKSk7ZD9xKCktYS5BPj1hLnc/VCgpJiZsYShhLGIsYykmJihudWxsPT09YS51fHxhLnUuaGFzT3duUHJvcGVydHkoYS5hLmMpKT9WKGEsYS52KTpWKGEsYS5CKTptYShhKTpWKGEsYS52KX1mdW5jdGlvbiBtYShhKXtzZXRUaW1lb3V0KHAoZnVuY3Rpb24oKXtVKHRoaXMpfSxhKSw1MCl9ZnVuY3Rpb24gVihhLGIpe3NldFRpbWVvdXQocChmdW5jdGlvbigpe3YodGhpcy5nLmEpO3YodGhpcy5oLmEpO3YodGhpcy5qLmEpO3YodGhpcy5tLmEpO2IodGhpcy5hKX0sYSksMCl9O2Z1bmN0aW9uIFcoYSxiLGMpe3RoaXMuYz1hO3RoaXMuYT1iO3RoaXMuZj0wO3RoaXMubT10aGlzLmo9ITE7dGhpcy5zPWN9dmFyIFg9bnVsbDtXLnByb3RvdHlwZS5nPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYTtiLmcmJncoYi5mLFtiLmEuYyhcIndmXCIsYS5jLEooYSkudG9TdHJpbmcoKSxcImFjdGl2ZVwiKV0sW2IuYS5jKFwid2ZcIixhLmMsSihhKS50b1N0cmluZygpLFwibG9hZGluZ1wiKSxiLmEuYyhcIndmXCIsYS5jLEooYSkudG9TdHJpbmcoKSxcImluYWN0aXZlXCIpXSk7SyhiLFwiZm9udGFjdGl2ZVwiLGEpO3RoaXMubT0hMDtuYSh0aGlzKX07XHJcblcucHJvdG90eXBlLmg9ZnVuY3Rpb24oYSl7dmFyIGI9dGhpcy5hO2lmKGIuZyl7dmFyIGM9eShiLmYsYi5hLmMoXCJ3ZlwiLGEuYyxKKGEpLnRvU3RyaW5nKCksXCJhY3RpdmVcIikpLGQ9W10sZT1bYi5hLmMoXCJ3ZlwiLGEuYyxKKGEpLnRvU3RyaW5nKCksXCJsb2FkaW5nXCIpXTtjfHxkLnB1c2goYi5hLmMoXCJ3ZlwiLGEuYyxKKGEpLnRvU3RyaW5nKCksXCJpbmFjdGl2ZVwiKSk7dyhiLmYsZCxlKX1LKGIsXCJmb250aW5hY3RpdmVcIixhKTtuYSh0aGlzKX07ZnVuY3Rpb24gbmEoYSl7MD09LS1hLmYmJmEuaiYmKGEubT8oYT1hLmEsYS5nJiZ3KGEuZixbYS5hLmMoXCJ3ZlwiLFwiYWN0aXZlXCIpXSxbYS5hLmMoXCJ3ZlwiLFwibG9hZGluZ1wiKSxhLmEuYyhcIndmXCIsXCJpbmFjdGl2ZVwiKV0pLEsoYSxcImFjdGl2ZVwiKSk6TChhLmEpKX07ZnVuY3Rpb24gb2EoYSl7dGhpcy5qPWE7dGhpcy5hPW5ldyBqYTt0aGlzLmg9MDt0aGlzLmY9dGhpcy5nPSEwfW9hLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEpe3RoaXMuYz1uZXcgY2EodGhpcy5qLGEuY29udGV4dHx8dGhpcy5qKTt0aGlzLmc9ITEhPT1hLmV2ZW50czt0aGlzLmY9ITEhPT1hLmNsYXNzZXM7cGEodGhpcyxuZXcgaGEodGhpcy5jLGEpLGEpfTtcclxuZnVuY3Rpb24gcWEoYSxiLGMsZCxlKXt2YXIgZj0wPT0tLWEuaDsoYS5mfHxhLmcpJiZzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7dmFyIGE9ZXx8bnVsbCxtPWR8fG51bGx8fHt9O2lmKDA9PT1jLmxlbmd0aCYmZilMKGIuYSk7ZWxzZXtiLmYrPWMubGVuZ3RoO2YmJihiLmo9Zik7dmFyIGgsbD1bXTtmb3IoaD0wO2g8Yy5sZW5ndGg7aCsrKXt2YXIgaz1jW2hdLG49bVtrLmNdLHI9Yi5hLHg9aztyLmcmJncoci5mLFtyLmEuYyhcIndmXCIseC5jLEooeCkudG9TdHJpbmcoKSxcImxvYWRpbmdcIildKTtLKHIsXCJmb250bG9hZGluZ1wiLHgpO3I9bnVsbDtpZihudWxsPT09WClpZih3aW5kb3cuRm9udEZhY2Upe3ZhciB4PS9HZWNrby4qRmlyZWZveFxcLyhcXGQrKS8uZXhlYyh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCkseGE9L09TIFguKlZlcnNpb25cXC8xMFxcLi4qU2FmYXJpLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudXNlckFnZW50KSYmL0FwcGxlLy5leGVjKHdpbmRvdy5uYXZpZ2F0b3IudmVuZG9yKTtcclxuWD14PzQyPHBhcnNlSW50KHhbMV0sMTApOnhhPyExOiEwfWVsc2UgWD0hMTtYP3I9bmV3IFAocChiLmcsYikscChiLmgsYiksYi5jLGssYi5zLG4pOnI9bmV3IFEocChiLmcsYikscChiLmgsYiksYi5jLGssYi5zLGEsbik7bC5wdXNoKHIpfWZvcihoPTA7aDxsLmxlbmd0aDtoKyspbFtoXS5zdGFydCgpfX0sMCl9ZnVuY3Rpb24gcGEoYSxiLGMpe3ZhciBkPVtdLGU9Yy50aW1lb3V0O2lhKGIpO3ZhciBkPWthKGEuYSxjLGEuYyksZj1uZXcgVyhhLmMsYixlKTthLmg9ZC5sZW5ndGg7Yj0wO2ZvcihjPWQubGVuZ3RoO2I8YztiKyspZFtiXS5sb2FkKGZ1bmN0aW9uKGIsZCxjKXtxYShhLGYsYixkLGMpfSl9O2Z1bmN0aW9uIHJhKGEsYil7dGhpcy5jPWE7dGhpcy5hPWJ9XHJcbnJhLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGIoKXtpZihmW1wiX19tdGlfZm50THN0XCIrZF0pe3ZhciBjPWZbXCJfX210aV9mbnRMc3RcIitkXSgpLGU9W10saDtpZihjKWZvcih2YXIgbD0wO2w8Yy5sZW5ndGg7bCsrKXt2YXIgaz1jW2xdLmZvbnRmYW1pbHk7dm9pZCAwIT1jW2xdLmZvbnRTdHlsZSYmdm9pZCAwIT1jW2xdLmZvbnRXZWlnaHQ/KGg9Y1tsXS5mb250U3R5bGUrY1tsXS5mb250V2VpZ2h0LGUucHVzaChuZXcgRyhrLGgpKSk6ZS5wdXNoKG5ldyBHKGspKX1hKGUpfWVsc2Ugc2V0VGltZW91dChmdW5jdGlvbigpe2IoKX0sNTApfXZhciBjPXRoaXMsZD1jLmEucHJvamVjdElkLGU9Yy5hLnZlcnNpb247aWYoZCl7dmFyIGY9Yy5jLm87QSh0aGlzLmMsKGMuYS5hcGl8fFwiaHR0cHM6Ly9mYXN0LmZvbnRzLm5ldC9qc2FwaVwiKStcIi9cIitkK1wiLmpzXCIrKGU/XCI/dj1cIitlOlwiXCIpLGZ1bmN0aW9uKGUpe2U/YShbXSk6KGZbXCJfX01vbm90eXBlQ29uZmlndXJhdGlvbl9fXCIrXHJcbmRdPWZ1bmN0aW9uKCl7cmV0dXJuIGMuYX0sYigpKX0pLmlkPVwiX19Nb25vdHlwZUFQSVNjcmlwdF9fXCIrZH1lbHNlIGEoW10pfTtmdW5jdGlvbiBzYShhLGIpe3RoaXMuYz1hO3RoaXMuYT1ifXNhLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEpe3ZhciBiLGMsZD10aGlzLmEudXJsc3x8W10sZT10aGlzLmEuZmFtaWxpZXN8fFtdLGY9dGhpcy5hLnRlc3RTdHJpbmdzfHx7fSxnPW5ldyBCO2I9MDtmb3IoYz1kLmxlbmd0aDtiPGM7YisrKXoodGhpcy5jLGRbYl0sQyhnKSk7dmFyIG09W107Yj0wO2ZvcihjPWUubGVuZ3RoO2I8YztiKyspaWYoZD1lW2JdLnNwbGl0KFwiOlwiKSxkWzFdKWZvcih2YXIgaD1kWzFdLnNwbGl0KFwiLFwiKSxsPTA7bDxoLmxlbmd0aDtsKz0xKW0ucHVzaChuZXcgRyhkWzBdLGhbbF0pKTtlbHNlIG0ucHVzaChuZXcgRyhkWzBdKSk7RShnLGZ1bmN0aW9uKCl7YShtLGYpfSl9O2Z1bmN0aW9uIHRhKGEsYil7YT90aGlzLmM9YTp0aGlzLmM9dWE7dGhpcy5hPVtdO3RoaXMuZj1bXTt0aGlzLmc9Ynx8XCJcIn12YXIgdWE9XCJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2Nzc1wiO2Z1bmN0aW9uIHZhKGEsYil7Zm9yKHZhciBjPWIubGVuZ3RoLGQ9MDtkPGM7ZCsrKXt2YXIgZT1iW2RdLnNwbGl0KFwiOlwiKTszPT1lLmxlbmd0aCYmYS5mLnB1c2goZS5wb3AoKSk7dmFyIGY9XCJcIjsyPT1lLmxlbmd0aCYmXCJcIiE9ZVsxXSYmKGY9XCI6XCIpO2EuYS5wdXNoKGUuam9pbihmKSl9fVxyXG5mdW5jdGlvbiB3YShhKXtpZigwPT1hLmEubGVuZ3RoKXRocm93IEVycm9yKFwiTm8gZm9udHMgdG8gbG9hZCFcIik7aWYoLTEhPWEuYy5pbmRleE9mKFwia2l0PVwiKSlyZXR1cm4gYS5jO2Zvcih2YXIgYj1hLmEubGVuZ3RoLGM9W10sZD0wO2Q8YjtkKyspYy5wdXNoKGEuYVtkXS5yZXBsYWNlKC8gL2csXCIrXCIpKTtiPWEuYytcIj9mYW1pbHk9XCIrYy5qb2luKFwiJTdDXCIpOzA8YS5mLmxlbmd0aCYmKGIrPVwiJnN1YnNldD1cIithLmYuam9pbihcIixcIikpOzA8YS5nLmxlbmd0aCYmKGIrPVwiJnRleHQ9XCIrZW5jb2RlVVJJQ29tcG9uZW50KGEuZykpO3JldHVybiBifTtmdW5jdGlvbiB5YShhKXt0aGlzLmY9YTt0aGlzLmE9W107dGhpcy5jPXt9fVxyXG52YXIgemE9e2xhdGluOlwiQkVTYnN3eVwiLFwibGF0aW4tZXh0XCI6XCJcXHUwMGU3XFx1MDBmNlxcdTAwZmNcXHUwMTFmXFx1MDE1ZlwiLGN5cmlsbGljOlwiXFx1MDQzOVxcdTA0NGZcXHUwNDE2XCIsZ3JlZWs6XCJcXHUwM2IxXFx1MDNiMlxcdTAzYTNcIixraG1lcjpcIlxcdTE3ODBcXHUxNzgxXFx1MTc4MlwiLEhhbnVtYW46XCJcXHUxNzgwXFx1MTc4MVxcdTE3ODJcIn0sQWE9e3RoaW46XCIxXCIsZXh0cmFsaWdodDpcIjJcIixcImV4dHJhLWxpZ2h0XCI6XCIyXCIsdWx0cmFsaWdodDpcIjJcIixcInVsdHJhLWxpZ2h0XCI6XCIyXCIsbGlnaHQ6XCIzXCIscmVndWxhcjpcIjRcIixib29rOlwiNFwiLG1lZGl1bTpcIjVcIixcInNlbWktYm9sZFwiOlwiNlwiLHNlbWlib2xkOlwiNlwiLFwiZGVtaS1ib2xkXCI6XCI2XCIsZGVtaWJvbGQ6XCI2XCIsYm9sZDpcIjdcIixcImV4dHJhLWJvbGRcIjpcIjhcIixleHRyYWJvbGQ6XCI4XCIsXCJ1bHRyYS1ib2xkXCI6XCI4XCIsdWx0cmFib2xkOlwiOFwiLGJsYWNrOlwiOVwiLGhlYXZ5OlwiOVwiLGw6XCIzXCIscjpcIjRcIixiOlwiN1wifSxCYT17aTpcImlcIixpdGFsaWM6XCJpXCIsbjpcIm5cIixub3JtYWw6XCJuXCJ9LFxyXG5DYT0vXih0aGlufCg/Oig/OmV4dHJhfHVsdHJhKS0/KT9saWdodHxyZWd1bGFyfGJvb2t8bWVkaXVtfCg/Oig/OnNlbWl8ZGVtaXxleHRyYXx1bHRyYSktPyk/Ym9sZHxibGFja3xoZWF2eXxsfHJ8YnxbMS05XTAwKT8obnxpfG5vcm1hbHxpdGFsaWMpPyQvO1xyXG5mdW5jdGlvbiBEYShhKXtmb3IodmFyIGI9YS5mLmxlbmd0aCxjPTA7YzxiO2MrKyl7dmFyIGQ9YS5mW2NdLnNwbGl0KFwiOlwiKSxlPWRbMF0ucmVwbGFjZSgvXFwrL2csXCIgXCIpLGY9W1wibjRcIl07aWYoMjw9ZC5sZW5ndGgpe3ZhciBnO3ZhciBtPWRbMV07Zz1bXTtpZihtKWZvcih2YXIgbT1tLnNwbGl0KFwiLFwiKSxoPW0ubGVuZ3RoLGw9MDtsPGg7bCsrKXt2YXIgaztrPW1bbF07aWYoay5tYXRjaCgvXltcXHctXSskLykpe3ZhciBuPUNhLmV4ZWMoay50b0xvd2VyQ2FzZSgpKTtpZihudWxsPT1uKWs9XCJcIjtlbHNle2s9blsyXTtrPW51bGw9PWt8fFwiXCI9PWs/XCJuXCI6QmFba107bj1uWzFdO2lmKG51bGw9PW58fFwiXCI9PW4pbj1cIjRcIjtlbHNlIHZhciByPUFhW25dLG49cj9yOmlzTmFOKG4pP1wiNFwiOm4uc3Vic3RyKDAsMSk7az1bayxuXS5qb2luKFwiXCIpfX1lbHNlIGs9XCJcIjtrJiZnLnB1c2goayl9MDxnLmxlbmd0aCYmKGY9Zyk7Mz09ZC5sZW5ndGgmJihkPWRbMl0sZz1bXSxkPWQ/ZC5zcGxpdChcIixcIik6XHJcbmcsMDxkLmxlbmd0aCYmKGQ9emFbZFswXV0pJiYoYS5jW2VdPWQpKX1hLmNbZV18fChkPXphW2VdKSYmKGEuY1tlXT1kKTtmb3IoZD0wO2Q8Zi5sZW5ndGg7ZCs9MSlhLmEucHVzaChuZXcgRyhlLGZbZF0pKX19O2Z1bmN0aW9uIEVhKGEsYil7dGhpcy5jPWE7dGhpcy5hPWJ9dmFyIEZhPXtBcmltbzohMCxDb3VzaW5lOiEwLFRpbm9zOiEwfTtFYS5wcm90b3R5cGUubG9hZD1mdW5jdGlvbihhKXt2YXIgYj1uZXcgQixjPXRoaXMuYyxkPW5ldyB0YSh0aGlzLmEuYXBpLHRoaXMuYS50ZXh0KSxlPXRoaXMuYS5mYW1pbGllczt2YShkLGUpO3ZhciBmPW5ldyB5YShlKTtEYShmKTt6KGMsd2EoZCksQyhiKSk7RShiLGZ1bmN0aW9uKCl7YShmLmEsZi5jLEZhKX0pfTtmdW5jdGlvbiBHYShhLGIpe3RoaXMuYz1hO3RoaXMuYT1ifUdhLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuYS5pZCxjPXRoaXMuYy5vO2I/QSh0aGlzLmMsKHRoaXMuYS5hcGl8fFwiaHR0cHM6Ly91c2UudHlwZWtpdC5uZXRcIikrXCIvXCIrYitcIi5qc1wiLGZ1bmN0aW9uKGIpe2lmKGIpYShbXSk7ZWxzZSBpZihjLlR5cGVraXQmJmMuVHlwZWtpdC5jb25maWcmJmMuVHlwZWtpdC5jb25maWcuZm4pe2I9Yy5UeXBla2l0LmNvbmZpZy5mbjtmb3IodmFyIGU9W10sZj0wO2Y8Yi5sZW5ndGg7Zis9Milmb3IodmFyIGc9YltmXSxtPWJbZisxXSxoPTA7aDxtLmxlbmd0aDtoKyspZS5wdXNoKG5ldyBHKGcsbVtoXSkpO3RyeXtjLlR5cGVraXQubG9hZCh7ZXZlbnRzOiExLGNsYXNzZXM6ITEsYXN5bmM6ITB9KX1jYXRjaChsKXt9YShlKX19LDJFMyk6YShbXSl9O2Z1bmN0aW9uIEhhKGEsYil7dGhpcy5jPWE7dGhpcy5mPWI7dGhpcy5hPVtdfUhhLnByb3RvdHlwZS5sb2FkPWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXMuZi5pZCxjPXRoaXMuYy5vLGQ9dGhpcztiPyhjLl9fd2ViZm9udGZvbnRkZWNrbW9kdWxlX198fChjLl9fd2ViZm9udGZvbnRkZWNrbW9kdWxlX189e30pLGMuX193ZWJmb250Zm9udGRlY2ttb2R1bGVfX1tiXT1mdW5jdGlvbihiLGMpe2Zvcih2YXIgZz0wLG09Yy5mb250cy5sZW5ndGg7ZzxtOysrZyl7dmFyIGg9Yy5mb250c1tnXTtkLmEucHVzaChuZXcgRyhoLm5hbWUsZ2EoXCJmb250LXdlaWdodDpcIitoLndlaWdodCtcIjtmb250LXN0eWxlOlwiK2guc3R5bGUpKSl9YShkLmEpfSxBKHRoaXMuYywodGhpcy5mLmFwaXx8XCJodHRwczovL2YuZm9udGRlY2suY29tL3MvY3NzL2pzL1wiKStlYSh0aGlzLmMpK1wiL1wiK2IrXCIuanNcIixmdW5jdGlvbihiKXtiJiZhKFtdKX0pKTphKFtdKX07dmFyIFk9bmV3IG9hKHdpbmRvdyk7WS5hLmMuY3VzdG9tPWZ1bmN0aW9uKGEsYil7cmV0dXJuIG5ldyBzYShiLGEpfTtZLmEuYy5mb250ZGVjaz1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgSGEoYixhKX07WS5hLmMubW9ub3R5cGU9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IHJhKGIsYSl9O1kuYS5jLnR5cGVraXQ9ZnVuY3Rpb24oYSxiKXtyZXR1cm4gbmV3IEdhKGIsYSl9O1kuYS5jLmdvb2dsZT1mdW5jdGlvbihhLGIpe3JldHVybiBuZXcgRWEoYixhKX07dmFyIFo9e2xvYWQ6cChZLmxvYWQsWSl9O1wiZnVuY3Rpb25cIj09PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKGZ1bmN0aW9uKCl7cmV0dXJuIFp9KTpcInVuZGVmaW5lZFwiIT09dHlwZW9mIG1vZHVsZSYmbW9kdWxlLmV4cG9ydHM/bW9kdWxlLmV4cG9ydHM9Wjood2luZG93LldlYkZvbnQ9Wix3aW5kb3cuV2ViRm9udENvbmZpZyYmWS5sb2FkKHdpbmRvdy5XZWJGb250Q29uZmlnKSk7fSgpKTtcclxuIiwiLyohIGpRdWVyeSB2My4zLjEgLWFqYXgsLWFqYXgvanNvbnAsLWFqYXgvbG9hZCwtYWpheC9wYXJzZVhNTCwtYWpheC9zY3JpcHQsLWFqYXgvdmFyL2xvY2F0aW9uLC1hamF4L3Zhci9ub25jZSwtYWpheC92YXIvcnF1ZXJ5LC1hamF4L3hociwtbWFuaXB1bGF0aW9uL19ldmFsVXJsLC1ldmVudC9hamF4LC1lZmZlY3RzLC1lZmZlY3RzL1R3ZWVuLC1lZmZlY3RzL2FuaW1hdGVkU2VsZWN0b3IgfCAoYykgSlMgRm91bmRhdGlvbiBhbmQgb3RoZXIgY29udHJpYnV0b3JzIHwganF1ZXJ5Lm9yZy9saWNlbnNlICovXHJcbiFmdW5jdGlvbiAoZSwgdCkgeyBcInVzZSBzdHJpY3RcIjsgXCJvYmplY3RcIiA9PSB0eXBlb2YgbW9kdWxlICYmIFwib2JqZWN0XCIgPT0gdHlwZW9mIG1vZHVsZS5leHBvcnRzID8gbW9kdWxlLmV4cG9ydHMgPSBlLmRvY3VtZW50ID8gdChlLCAhMCkgOiBmdW5jdGlvbiAoZSkgeyBpZiAoIWUuZG9jdW1lbnQpIHRocm93IG5ldyBFcnJvcihcImpRdWVyeSByZXF1aXJlcyBhIHdpbmRvdyB3aXRoIGEgZG9jdW1lbnRcIik7IHJldHVybiB0KGUpIH0gOiB0KGUpIH0oXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2Ygd2luZG93ID8gd2luZG93IDogdGhpcywgZnVuY3Rpb24gKGUsIHQpIHsgXCJ1c2Ugc3RyaWN0XCI7IHZhciBuID0gW10sIHIgPSBlLmRvY3VtZW50LCBpID0gT2JqZWN0LmdldFByb3RvdHlwZU9mLCBvID0gbi5zbGljZSwgYSA9IG4uY29uY2F0LCB1ID0gbi5wdXNoLCBzID0gbi5pbmRleE9mLCBsID0ge30sIGMgPSBsLnRvU3RyaW5nLCBmID0gbC5oYXNPd25Qcm9wZXJ0eSwgZCA9IGYudG9TdHJpbmcsIHAgPSBkLmNhbGwoT2JqZWN0KSwgaCA9IHt9LCBnID0gZnVuY3Rpb24gZSh0KSB7IHJldHVybiBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQgJiYgXCJudW1iZXJcIiAhPSB0eXBlb2YgdC5ub2RlVHlwZSB9LCB2ID0gZnVuY3Rpb24gZSh0KSB7IHJldHVybiBudWxsICE9IHQgJiYgdCA9PT0gdC53aW5kb3cgfSwgeSA9IHsgdHlwZTogITAsIHNyYzogITAsIG5vTW9kdWxlOiAhMCB9OyBmdW5jdGlvbiBtKGUsIHQsIG4pIHsgdmFyIGksIG8gPSAodCA9IHQgfHwgcikuY3JlYXRlRWxlbWVudChcInNjcmlwdFwiKTsgaWYgKG8udGV4dCA9IGUsIG4pIGZvciAoaSBpbiB5KSBuW2ldICYmIChvW2ldID0gbltpXSk7IHQuaGVhZC5hcHBlbmRDaGlsZChvKS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKG8pIH0gZnVuY3Rpb24gYihlKSB7IHJldHVybiBudWxsID09IGUgPyBlICsgXCJcIiA6IFwib2JqZWN0XCIgPT0gdHlwZW9mIGUgfHwgXCJmdW5jdGlvblwiID09IHR5cGVvZiBlID8gbFtjLmNhbGwoZSldIHx8IFwib2JqZWN0XCIgOiB0eXBlb2YgZSB9IHZhciB4ID0gXCIzLjMuMSAtYWpheCwtYWpheC9qc29ucCwtYWpheC9sb2FkLC1hamF4L3BhcnNlWE1MLC1hamF4L3NjcmlwdCwtYWpheC92YXIvbG9jYXRpb24sLWFqYXgvdmFyL25vbmNlLC1hamF4L3Zhci9ycXVlcnksLWFqYXgveGhyLC1tYW5pcHVsYXRpb24vX2V2YWxVcmwsLWV2ZW50L2FqYXgsLWVmZmVjdHMsLWVmZmVjdHMvVHdlZW4sLWVmZmVjdHMvYW5pbWF0ZWRTZWxlY3RvclwiLCB3ID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIG5ldyB3LmZuLmluaXQoZSwgdCkgfSwgQyA9IC9eW1xcc1xcdUZFRkZcXHhBMF0rfFtcXHNcXHVGRUZGXFx4QTBdKyQvZzsgdy5mbiA9IHcucHJvdG90eXBlID0geyBqcXVlcnk6IHgsIGNvbnN0cnVjdG9yOiB3LCBsZW5ndGg6IDAsIHRvQXJyYXk6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG8uY2FsbCh0aGlzKSB9LCBnZXQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBudWxsID09IGUgPyBvLmNhbGwodGhpcykgOiBlIDwgMCA/IHRoaXNbZSArIHRoaXMubGVuZ3RoXSA6IHRoaXNbZV0gfSwgcHVzaFN0YWNrOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IHcubWVyZ2UodGhpcy5jb25zdHJ1Y3RvcigpLCBlKTsgcmV0dXJuIHQucHJldk9iamVjdCA9IHRoaXMsIHQgfSwgZWFjaDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHcuZWFjaCh0aGlzLCBlKSB9LCBtYXA6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLnB1c2hTdGFjayh3Lm1hcCh0aGlzLCBmdW5jdGlvbiAodCwgbikgeyByZXR1cm4gZS5jYWxsKHQsIG4sIHQpIH0pKSB9LCBzbGljZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5wdXNoU3RhY2soby5hcHBseSh0aGlzLCBhcmd1bWVudHMpKSB9LCBmaXJzdDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5lcSgwKSB9LCBsYXN0OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmVxKC0xKSB9LCBlcTogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSB0aGlzLmxlbmd0aCwgbiA9ICtlICsgKGUgPCAwID8gdCA6IDApOyByZXR1cm4gdGhpcy5wdXNoU3RhY2sobiA+PSAwICYmIG4gPCB0ID8gW3RoaXNbbl1dIDogW10pIH0sIGVuZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5wcmV2T2JqZWN0IHx8IHRoaXMuY29uc3RydWN0b3IoKSB9LCBwdXNoOiB1LCBzb3J0OiBuLnNvcnQsIHNwbGljZTogbi5zcGxpY2UgfSwgdy5leHRlbmQgPSB3LmZuLmV4dGVuZCA9IGZ1bmN0aW9uICgpIHsgdmFyIGUsIHQsIG4sIHIsIGksIG8sIGEgPSBhcmd1bWVudHNbMF0gfHwge30sIHUgPSAxLCBzID0gYXJndW1lbnRzLmxlbmd0aCwgbCA9ICExOyBmb3IgKFwiYm9vbGVhblwiID09IHR5cGVvZiBhICYmIChsID0gYSwgYSA9IGFyZ3VtZW50c1t1XSB8fCB7fSwgdSsrKSwgXCJvYmplY3RcIiA9PSB0eXBlb2YgYSB8fCBnKGEpIHx8IChhID0ge30pLCB1ID09PSBzICYmIChhID0gdGhpcywgdS0tKTsgdSA8IHM7IHUrKylpZiAobnVsbCAhPSAoZSA9IGFyZ3VtZW50c1t1XSkpIGZvciAodCBpbiBlKSBuID0gYVt0XSwgYSAhPT0gKHIgPSBlW3RdKSAmJiAobCAmJiByICYmICh3LmlzUGxhaW5PYmplY3QocikgfHwgKGkgPSBBcnJheS5pc0FycmF5KHIpKSkgPyAoaSA/IChpID0gITEsIG8gPSBuICYmIEFycmF5LmlzQXJyYXkobikgPyBuIDogW10pIDogbyA9IG4gJiYgdy5pc1BsYWluT2JqZWN0KG4pID8gbiA6IHt9LCBhW3RdID0gdy5leHRlbmQobCwgbywgcikpIDogdm9pZCAwICE9PSByICYmIChhW3RdID0gcikpOyByZXR1cm4gYSB9LCB3LmV4dGVuZCh7IGV4cGFuZG86IFwialF1ZXJ5XCIgKyAoeCArIE1hdGgucmFuZG9tKCkpLnJlcGxhY2UoL1xcRC9nLCBcIlwiKSwgaXNSZWFkeTogITAsIGVycm9yOiBmdW5jdGlvbiAoZSkgeyB0aHJvdyBuZXcgRXJyb3IoZSkgfSwgbm9vcDogZnVuY3Rpb24gKCkgeyB9LCBpc1BsYWluT2JqZWN0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbjsgcmV0dXJuICEoIWUgfHwgXCJbb2JqZWN0IE9iamVjdF1cIiAhPT0gYy5jYWxsKGUpKSAmJiAoISh0ID0gaShlKSkgfHwgXCJmdW5jdGlvblwiID09IHR5cGVvZiAobiA9IGYuY2FsbCh0LCBcImNvbnN0cnVjdG9yXCIpICYmIHQuY29uc3RydWN0b3IpICYmIGQuY2FsbChuKSA9PT0gcCkgfSwgaXNFbXB0eU9iamVjdDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IGZvciAodCBpbiBlKSByZXR1cm4gITE7IHJldHVybiAhMCB9LCBnbG9iYWxFdmFsOiBmdW5jdGlvbiAoZSkgeyBtKGUpIH0sIGVhY2g6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCByID0gMDsgaWYgKFQoZSkpIHsgZm9yIChuID0gZS5sZW5ndGg7IHIgPCBuOyByKyspaWYgKCExID09PSB0LmNhbGwoZVtyXSwgciwgZVtyXSkpIGJyZWFrIH0gZWxzZSBmb3IgKHIgaW4gZSkgaWYgKCExID09PSB0LmNhbGwoZVtyXSwgciwgZVtyXSkpIGJyZWFrOyByZXR1cm4gZSB9LCB0cmltOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbnVsbCA9PSBlID8gXCJcIiA6IChlICsgXCJcIikucmVwbGFjZShDLCBcIlwiKSB9LCBtYWtlQXJyYXk6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gdCB8fCBbXTsgcmV0dXJuIG51bGwgIT0gZSAmJiAoVChPYmplY3QoZSkpID8gdy5tZXJnZShuLCBcInN0cmluZ1wiID09IHR5cGVvZiBlID8gW2VdIDogZSkgOiB1LmNhbGwobiwgZSkpLCBuIH0sIGluQXJyYXk6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiBudWxsID09IHQgPyAtMSA6IHMuY2FsbCh0LCBlLCBuKSB9LCBtZXJnZTogZnVuY3Rpb24gKGUsIHQpIHsgZm9yICh2YXIgbiA9ICt0Lmxlbmd0aCwgciA9IDAsIGkgPSBlLmxlbmd0aDsgciA8IG47IHIrKyllW2krK10gPSB0W3JdOyByZXR1cm4gZS5sZW5ndGggPSBpLCBlIH0sIGdyZXA6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IGZvciAodmFyIHIsIGkgPSBbXSwgbyA9IDAsIGEgPSBlLmxlbmd0aCwgdSA9ICFuOyBvIDwgYTsgbysrKShyID0gIXQoZVtvXSwgbykpICE9PSB1ICYmIGkucHVzaChlW29dKTsgcmV0dXJuIGkgfSwgbWFwOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbyA9IDAsIHUgPSBbXTsgaWYgKFQoZSkpIGZvciAociA9IGUubGVuZ3RoOyBvIDwgcjsgbysrKW51bGwgIT0gKGkgPSB0KGVbb10sIG8sIG4pKSAmJiB1LnB1c2goaSk7IGVsc2UgZm9yIChvIGluIGUpIG51bGwgIT0gKGkgPSB0KGVbb10sIG8sIG4pKSAmJiB1LnB1c2goaSk7IHJldHVybiBhLmFwcGx5KFtdLCB1KSB9LCBndWlkOiAxLCBzdXBwb3J0OiBoIH0pLCBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIFN5bWJvbCAmJiAody5mbltTeW1ib2wuaXRlcmF0b3JdID0gbltTeW1ib2wuaXRlcmF0b3JdKSwgdy5lYWNoKFwiQm9vbGVhbiBOdW1iZXIgU3RyaW5nIEZ1bmN0aW9uIEFycmF5IERhdGUgUmVnRXhwIE9iamVjdCBFcnJvciBTeW1ib2xcIi5zcGxpdChcIiBcIiksIGZ1bmN0aW9uIChlLCB0KSB7IGxbXCJbb2JqZWN0IFwiICsgdCArIFwiXVwiXSA9IHQudG9Mb3dlckNhc2UoKSB9KTsgZnVuY3Rpb24gVChlKSB7IHZhciB0ID0gISFlICYmIFwibGVuZ3RoXCIgaW4gZSAmJiBlLmxlbmd0aCwgbiA9IGIoZSk7IHJldHVybiAhZyhlKSAmJiAhdihlKSAmJiAoXCJhcnJheVwiID09PSBuIHx8IDAgPT09IHQgfHwgXCJudW1iZXJcIiA9PSB0eXBlb2YgdCAmJiB0ID4gMCAmJiB0IC0gMSBpbiBlKSB9IHZhciBFID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4sIHIsIGksIG8sIGEsIHUsIHMsIGwsIGMsIGYsIGQsIHAsIGgsIGcsIHYsIHksIG0sIGIsIHggPSBcInNpenpsZVwiICsgMSAqIG5ldyBEYXRlLCB3ID0gZS5kb2N1bWVudCwgQyA9IDAsIFQgPSAwLCBFID0gYWUoKSwgTiA9IGFlKCksIGsgPSBhZSgpLCBBID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIGUgPT09IHQgJiYgKGYgPSAhMCksIDAgfSwgRCA9IHt9Lmhhc093blByb3BlcnR5LCBTID0gW10sIEwgPSBTLnBvcCwgaiA9IFMucHVzaCwgcSA9IFMucHVzaCwgTyA9IFMuc2xpY2UsIFAgPSBmdW5jdGlvbiAoZSwgdCkgeyBmb3IgKHZhciBuID0gMCwgciA9IGUubGVuZ3RoOyBuIDwgcjsgbisrKWlmIChlW25dID09PSB0KSByZXR1cm4gbjsgcmV0dXJuIC0xIH0sIEggPSBcImNoZWNrZWR8c2VsZWN0ZWR8YXN5bmN8YXV0b2ZvY3VzfGF1dG9wbGF5fGNvbnRyb2xzfGRlZmVyfGRpc2FibGVkfGhpZGRlbnxpc21hcHxsb29wfG11bHRpcGxlfG9wZW58cmVhZG9ubHl8cmVxdWlyZWR8c2NvcGVkXCIsIEkgPSBcIltcXFxceDIwXFxcXHRcXFxcclxcXFxuXFxcXGZdXCIsIFIgPSBcIig/OlxcXFxcXFxcLnxbXFxcXHctXXxbXlxcMC1cXFxceGEwXSkrXCIsIEIgPSBcIlxcXFxbXCIgKyBJICsgXCIqKFwiICsgUiArIFwiKSg/OlwiICsgSSArIFwiKihbKl4kfCF+XT89KVwiICsgSSArIFwiKig/OicoKD86XFxcXFxcXFwufFteXFxcXFxcXFwnXSkqKSd8XFxcIigoPzpcXFxcXFxcXC58W15cXFxcXFxcXFxcXCJdKSopXFxcInwoXCIgKyBSICsgXCIpKXwpXCIgKyBJICsgXCIqXFxcXF1cIiwgTSA9IFwiOihcIiArIFIgKyBcIikoPzpcXFxcKCgoJygoPzpcXFxcXFxcXC58W15cXFxcXFxcXCddKSopJ3xcXFwiKCg/OlxcXFxcXFxcLnxbXlxcXFxcXFxcXFxcIl0pKilcXFwiKXwoKD86XFxcXFxcXFwufFteXFxcXFxcXFwoKVtcXFxcXV18XCIgKyBCICsgXCIpKil8LiopXFxcXCl8KVwiLCBXID0gbmV3IFJlZ0V4cChJICsgXCIrXCIsIFwiZ1wiKSwgJCA9IG5ldyBSZWdFeHAoXCJeXCIgKyBJICsgXCIrfCgoPzpefFteXFxcXFxcXFxdKSg/OlxcXFxcXFxcLikqKVwiICsgSSArIFwiKyRcIiwgXCJnXCIpLCBGID0gbmV3IFJlZ0V4cChcIl5cIiArIEkgKyBcIiosXCIgKyBJICsgXCIqXCIpLCB6ID0gbmV3IFJlZ0V4cChcIl5cIiArIEkgKyBcIiooWz4rfl18XCIgKyBJICsgXCIpXCIgKyBJICsgXCIqXCIpLCBfID0gbmV3IFJlZ0V4cChcIj1cIiArIEkgKyBcIiooW15cXFxcXSdcXFwiXSo/KVwiICsgSSArIFwiKlxcXFxdXCIsIFwiZ1wiKSwgVSA9IG5ldyBSZWdFeHAoTSksIFYgPSBuZXcgUmVnRXhwKFwiXlwiICsgUiArIFwiJFwiKSwgWCA9IHsgSUQ6IG5ldyBSZWdFeHAoXCJeIyhcIiArIFIgKyBcIilcIiksIENMQVNTOiBuZXcgUmVnRXhwKFwiXlxcXFwuKFwiICsgUiArIFwiKVwiKSwgVEFHOiBuZXcgUmVnRXhwKFwiXihcIiArIFIgKyBcInxbKl0pXCIpLCBBVFRSOiBuZXcgUmVnRXhwKFwiXlwiICsgQiksIFBTRVVETzogbmV3IFJlZ0V4cChcIl5cIiArIE0pLCBDSElMRDogbmV3IFJlZ0V4cChcIl46KG9ubHl8Zmlyc3R8bGFzdHxudGh8bnRoLWxhc3QpLShjaGlsZHxvZi10eXBlKSg/OlxcXFwoXCIgKyBJICsgXCIqKGV2ZW58b2RkfCgoWystXXwpKFxcXFxkKilufClcIiArIEkgKyBcIiooPzooWystXXwpXCIgKyBJICsgXCIqKFxcXFxkKyl8KSlcIiArIEkgKyBcIipcXFxcKXwpXCIsIFwiaVwiKSwgYm9vbDogbmV3IFJlZ0V4cChcIl4oPzpcIiArIEggKyBcIikkXCIsIFwiaVwiKSwgbmVlZHNDb250ZXh0OiBuZXcgUmVnRXhwKFwiXlwiICsgSSArIFwiKls+K35dfDooZXZlbnxvZGR8ZXF8Z3R8bHR8bnRofGZpcnN0fGxhc3QpKD86XFxcXChcIiArIEkgKyBcIiooKD86LVxcXFxkKT9cXFxcZCopXCIgKyBJICsgXCIqXFxcXCl8KSg/PVteLV18JClcIiwgXCJpXCIpIH0sIFEgPSAvXig/OmlucHV0fHNlbGVjdHx0ZXh0YXJlYXxidXR0b24pJC9pLCBZID0gL15oXFxkJC9pLCBHID0gL15bXntdK1xce1xccypcXFtuYXRpdmUgXFx3LywgSyA9IC9eKD86IyhbXFx3LV0rKXwoXFx3Kyl8XFwuKFtcXHctXSspKSQvLCBKID0gL1srfl0vLCBaID0gbmV3IFJlZ0V4cChcIlxcXFxcXFxcKFtcXFxcZGEtZl17MSw2fVwiICsgSSArIFwiP3woXCIgKyBJICsgXCIpfC4pXCIsIFwiaWdcIiksIGVlID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIgPSBcIjB4XCIgKyB0IC0gNjU1MzY7IHJldHVybiByICE9PSByIHx8IG4gPyB0IDogciA8IDAgPyBTdHJpbmcuZnJvbUNoYXJDb2RlKHIgKyA2NTUzNikgOiBTdHJpbmcuZnJvbUNoYXJDb2RlKHIgPj4gMTAgfCA1NTI5NiwgMTAyMyAmIHIgfCA1NjMyMCkgfSwgdGUgPSAvKFtcXDAtXFx4MWZcXHg3Zl18Xi0/XFxkKXxeLSR8W15cXDAtXFx4MWZcXHg3Zi1cXHVGRkZGXFx3LV0vZywgbmUgPSBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gdCA/IFwiXFwwXCIgPT09IGUgPyBcIlxcdWZmZmRcIiA6IGUuc2xpY2UoMCwgLTEpICsgXCJcXFxcXCIgKyBlLmNoYXJDb2RlQXQoZS5sZW5ndGggLSAxKS50b1N0cmluZygxNikgKyBcIiBcIiA6IFwiXFxcXFwiICsgZSB9LCByZSA9IGZ1bmN0aW9uICgpIHsgZCgpIH0sIGllID0gbWUoZnVuY3Rpb24gKGUpIHsgcmV0dXJuICEwID09PSBlLmRpc2FibGVkICYmIChcImZvcm1cIiBpbiBlIHx8IFwibGFiZWxcIiBpbiBlKSB9LCB7IGRpcjogXCJwYXJlbnROb2RlXCIsIG5leHQ6IFwibGVnZW5kXCIgfSk7IHRyeSB7IHEuYXBwbHkoUyA9IE8uY2FsbCh3LmNoaWxkTm9kZXMpLCB3LmNoaWxkTm9kZXMpLCBTW3cuY2hpbGROb2Rlcy5sZW5ndGhdLm5vZGVUeXBlIH0gY2F0Y2ggKGUpIHsgcSA9IHsgYXBwbHk6IFMubGVuZ3RoID8gZnVuY3Rpb24gKGUsIHQpIHsgai5hcHBseShlLCBPLmNhbGwodCkpIH0gOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IGUubGVuZ3RoLCByID0gMDsgd2hpbGUgKGVbbisrXSA9IHRbcisrXSk7IGUubGVuZ3RoID0gbiAtIDEgfSB9IH0gZnVuY3Rpb24gb2UoZSwgdCwgciwgaSkgeyB2YXIgbywgdSwgbCwgYywgZiwgaCwgeSwgbSA9IHQgJiYgdC5vd25lckRvY3VtZW50LCBDID0gdCA/IHQubm9kZVR5cGUgOiA5OyBpZiAociA9IHIgfHwgW10sIFwic3RyaW5nXCIgIT0gdHlwZW9mIGUgfHwgIWUgfHwgMSAhPT0gQyAmJiA5ICE9PSBDICYmIDExICE9PSBDKSByZXR1cm4gcjsgaWYgKCFpICYmICgodCA/IHQub3duZXJEb2N1bWVudCB8fCB0IDogdykgIT09IHAgJiYgZCh0KSwgdCA9IHQgfHwgcCwgZykpIHsgaWYgKDExICE9PSBDICYmIChmID0gSy5leGVjKGUpKSkgaWYgKG8gPSBmWzFdKSB7IGlmICg5ID09PSBDKSB7IGlmICghKGwgPSB0LmdldEVsZW1lbnRCeUlkKG8pKSkgcmV0dXJuIHI7IGlmIChsLmlkID09PSBvKSByZXR1cm4gci5wdXNoKGwpLCByIH0gZWxzZSBpZiAobSAmJiAobCA9IG0uZ2V0RWxlbWVudEJ5SWQobykpICYmIGIodCwgbCkgJiYgbC5pZCA9PT0gbykgcmV0dXJuIHIucHVzaChsKSwgciB9IGVsc2UgeyBpZiAoZlsyXSkgcmV0dXJuIHEuYXBwbHkociwgdC5nZXRFbGVtZW50c0J5VGFnTmFtZShlKSksIHI7IGlmICgobyA9IGZbM10pICYmIG4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiB0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUpIHJldHVybiBxLmFwcGx5KHIsIHQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShvKSksIHIgfSBpZiAobi5xc2EgJiYgIWtbZSArIFwiIFwiXSAmJiAoIXYgfHwgIXYudGVzdChlKSkpIHsgaWYgKDEgIT09IEMpIG0gPSB0LCB5ID0gZTsgZWxzZSBpZiAoXCJvYmplY3RcIiAhPT0gdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSB7IChjID0gdC5nZXRBdHRyaWJ1dGUoXCJpZFwiKSkgPyBjID0gYy5yZXBsYWNlKHRlLCBuZSkgOiB0LnNldEF0dHJpYnV0ZShcImlkXCIsIGMgPSB4KSwgdSA9IChoID0gYShlKSkubGVuZ3RoOyB3aGlsZSAodS0tKSBoW3VdID0gXCIjXCIgKyBjICsgXCIgXCIgKyB5ZShoW3VdKTsgeSA9IGguam9pbihcIixcIiksIG0gPSBKLnRlc3QoZSkgJiYgZ2UodC5wYXJlbnROb2RlKSB8fCB0IH0gaWYgKHkpIHRyeSB7IHJldHVybiBxLmFwcGx5KHIsIG0ucXVlcnlTZWxlY3RvckFsbCh5KSksIHIgfSBjYXRjaCAoZSkgeyB9IGZpbmFsbHkgeyBjID09PSB4ICYmIHQucmVtb3ZlQXR0cmlidXRlKFwiaWRcIikgfSB9IH0gcmV0dXJuIHMoZS5yZXBsYWNlKCQsIFwiJDFcIiksIHQsIHIsIGkpIH0gZnVuY3Rpb24gYWUoKSB7IHZhciBlID0gW107IGZ1bmN0aW9uIHQobiwgaSkgeyByZXR1cm4gZS5wdXNoKG4gKyBcIiBcIikgPiByLmNhY2hlTGVuZ3RoICYmIGRlbGV0ZSB0W2Uuc2hpZnQoKV0sIHRbbiArIFwiIFwiXSA9IGkgfSByZXR1cm4gdCB9IGZ1bmN0aW9uIHVlKGUpIHsgcmV0dXJuIGVbeF0gPSAhMCwgZSB9IGZ1bmN0aW9uIHNlKGUpIHsgdmFyIHQgPSBwLmNyZWF0ZUVsZW1lbnQoXCJmaWVsZHNldFwiKTsgdHJ5IHsgcmV0dXJuICEhZSh0KSB9IGNhdGNoIChlKSB7IHJldHVybiAhMSB9IGZpbmFsbHkgeyB0LnBhcmVudE5vZGUgJiYgdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHQpLCB0ID0gbnVsbCB9IH0gZnVuY3Rpb24gbGUoZSwgdCkgeyB2YXIgbiA9IGUuc3BsaXQoXCJ8XCIpLCBpID0gbi5sZW5ndGg7IHdoaWxlIChpLS0pIHIuYXR0ckhhbmRsZVtuW2ldXSA9IHQgfSBmdW5jdGlvbiBjZShlLCB0KSB7IHZhciBuID0gdCAmJiBlLCByID0gbiAmJiAxID09PSBlLm5vZGVUeXBlICYmIDEgPT09IHQubm9kZVR5cGUgJiYgZS5zb3VyY2VJbmRleCAtIHQuc291cmNlSW5kZXg7IGlmIChyKSByZXR1cm4gcjsgaWYgKG4pIHdoaWxlIChuID0gbi5uZXh0U2libGluZykgaWYgKG4gPT09IHQpIHJldHVybiAtMTsgcmV0dXJuIGUgPyAxIDogLTEgfSBmdW5jdGlvbiBmZShlKSB7IHJldHVybiBmdW5jdGlvbiAodCkgeyByZXR1cm4gXCJpbnB1dFwiID09PSB0Lm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgJiYgdC50eXBlID09PSBlIH0gfSBmdW5jdGlvbiBkZShlKSB7IHJldHVybiBmdW5jdGlvbiAodCkgeyB2YXIgbiA9IHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsgcmV0dXJuIChcImlucHV0XCIgPT09IG4gfHwgXCJidXR0b25cIiA9PT0gbikgJiYgdC50eXBlID09PSBlIH0gfSBmdW5jdGlvbiBwZShlKSB7IHJldHVybiBmdW5jdGlvbiAodCkgeyByZXR1cm4gXCJmb3JtXCIgaW4gdCA/IHQucGFyZW50Tm9kZSAmJiAhMSA9PT0gdC5kaXNhYmxlZCA/IFwibGFiZWxcIiBpbiB0ID8gXCJsYWJlbFwiIGluIHQucGFyZW50Tm9kZSA/IHQucGFyZW50Tm9kZS5kaXNhYmxlZCA9PT0gZSA6IHQuZGlzYWJsZWQgPT09IGUgOiB0LmlzRGlzYWJsZWQgPT09IGUgfHwgdC5pc0Rpc2FibGVkICE9PSAhZSAmJiBpZSh0KSA9PT0gZSA6IHQuZGlzYWJsZWQgPT09IGUgOiBcImxhYmVsXCIgaW4gdCAmJiB0LmRpc2FibGVkID09PSBlIH0gfSBmdW5jdGlvbiBoZShlKSB7IHJldHVybiB1ZShmdW5jdGlvbiAodCkgeyByZXR1cm4gdCA9ICt0LCB1ZShmdW5jdGlvbiAobiwgcikgeyB2YXIgaSwgbyA9IGUoW10sIG4ubGVuZ3RoLCB0KSwgYSA9IG8ubGVuZ3RoOyB3aGlsZSAoYS0tKSBuW2kgPSBvW2FdXSAmJiAobltpXSA9ICEocltpXSA9IG5baV0pKSB9KSB9KSB9IGZ1bmN0aW9uIGdlKGUpIHsgcmV0dXJuIGUgJiYgXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZS5nZXRFbGVtZW50c0J5VGFnTmFtZSAmJiBlIH0gbiA9IG9lLnN1cHBvcnQgPSB7fSwgbyA9IG9lLmlzWE1MID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlICYmIChlLm93bmVyRG9jdW1lbnQgfHwgZSkuZG9jdW1lbnRFbGVtZW50OyByZXR1cm4gISF0ICYmIFwiSFRNTFwiICE9PSB0Lm5vZGVOYW1lIH0sIGQgPSBvZS5zZXREb2N1bWVudCA9IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBpLCBhID0gZSA/IGUub3duZXJEb2N1bWVudCB8fCBlIDogdzsgcmV0dXJuIGEgIT09IHAgJiYgOSA9PT0gYS5ub2RlVHlwZSAmJiBhLmRvY3VtZW50RWxlbWVudCA/IChwID0gYSwgaCA9IHAuZG9jdW1lbnRFbGVtZW50LCBnID0gIW8ocCksIHcgIT09IHAgJiYgKGkgPSBwLmRlZmF1bHRWaWV3KSAmJiBpLnRvcCAhPT0gaSAmJiAoaS5hZGRFdmVudExpc3RlbmVyID8gaS5hZGRFdmVudExpc3RlbmVyKFwidW5sb2FkXCIsIHJlLCAhMSkgOiBpLmF0dGFjaEV2ZW50ICYmIGkuYXR0YWNoRXZlbnQoXCJvbnVubG9hZFwiLCByZSkpLCBuLmF0dHJpYnV0ZXMgPSBzZShmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5jbGFzc05hbWUgPSBcImlcIiwgIWUuZ2V0QXR0cmlidXRlKFwiY2xhc3NOYW1lXCIpIH0pLCBuLmdldEVsZW1lbnRzQnlUYWdOYW1lID0gc2UoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUuYXBwZW5kQ2hpbGQocC5jcmVhdGVDb21tZW50KFwiXCIpKSwgIWUuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCIqXCIpLmxlbmd0aCB9KSwgbi5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lID0gRy50ZXN0KHAuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSksIG4uZ2V0QnlJZCA9IHNlKGZ1bmN0aW9uIChlKSB7IHJldHVybiBoLmFwcGVuZENoaWxkKGUpLmlkID0geCwgIXAuZ2V0RWxlbWVudHNCeU5hbWUgfHwgIXAuZ2V0RWxlbWVudHNCeU5hbWUoeCkubGVuZ3RoIH0pLCBuLmdldEJ5SWQgPyAoci5maWx0ZXIuSUQgPSBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUucmVwbGFjZShaLCBlZSk7IHJldHVybiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5nZXRBdHRyaWJ1dGUoXCJpZFwiKSA9PT0gdCB9IH0sIHIuZmluZC5JRCA9IGZ1bmN0aW9uIChlLCB0KSB7IGlmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB0LmdldEVsZW1lbnRCeUlkICYmIGcpIHsgdmFyIG4gPSB0LmdldEVsZW1lbnRCeUlkKGUpOyByZXR1cm4gbiA/IFtuXSA6IFtdIH0gfSkgOiAoci5maWx0ZXIuSUQgPSBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUucmVwbGFjZShaLCBlZSk7IHJldHVybiBmdW5jdGlvbiAoZSkgeyB2YXIgbiA9IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGUuZ2V0QXR0cmlidXRlTm9kZSAmJiBlLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKTsgcmV0dXJuIG4gJiYgbi52YWx1ZSA9PT0gdCB9IH0sIHIuZmluZC5JRCA9IGZ1bmN0aW9uIChlLCB0KSB7IGlmIChcInVuZGVmaW5lZFwiICE9IHR5cGVvZiB0LmdldEVsZW1lbnRCeUlkICYmIGcpIHsgdmFyIG4sIHIsIGksIG8gPSB0LmdldEVsZW1lbnRCeUlkKGUpOyBpZiAobykgeyBpZiAoKG4gPSBvLmdldEF0dHJpYnV0ZU5vZGUoXCJpZFwiKSkgJiYgbi52YWx1ZSA9PT0gZSkgcmV0dXJuIFtvXTsgaSA9IHQuZ2V0RWxlbWVudHNCeU5hbWUoZSksIHIgPSAwOyB3aGlsZSAobyA9IGlbcisrXSkgaWYgKChuID0gby5nZXRBdHRyaWJ1dGVOb2RlKFwiaWRcIikpICYmIG4udmFsdWUgPT09IGUpIHJldHVybiBbb10gfSByZXR1cm4gW10gfSB9KSwgci5maW5kLlRBRyA9IG4uZ2V0RWxlbWVudHNCeVRhZ05hbWUgPyBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgdC5nZXRFbGVtZW50c0J5VGFnTmFtZSA/IHQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoZSkgOiBuLnFzYSA/IHQucXVlcnlTZWxlY3RvckFsbChlKSA6IHZvaWQgMCB9IDogZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIgPSBbXSwgaSA9IDAsIG8gPSB0LmdldEVsZW1lbnRzQnlUYWdOYW1lKGUpOyBpZiAoXCIqXCIgPT09IGUpIHsgd2hpbGUgKG4gPSBvW2krK10pIDEgPT09IG4ubm9kZVR5cGUgJiYgci5wdXNoKG4pOyByZXR1cm4gciB9IHJldHVybiBvIH0sIHIuZmluZC5DTEFTUyA9IG4uZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSAmJiBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgdC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lICYmIGcpIHJldHVybiB0LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoZSkgfSwgeSA9IFtdLCB2ID0gW10sIChuLnFzYSA9IEcudGVzdChwLnF1ZXJ5U2VsZWN0b3JBbGwpKSAmJiAoc2UoZnVuY3Rpb24gKGUpIHsgaC5hcHBlbmRDaGlsZChlKS5pbm5lckhUTUwgPSBcIjxhIGlkPSdcIiArIHggKyBcIic+PC9hPjxzZWxlY3QgaWQ9J1wiICsgeCArIFwiLVxcclxcXFwnIG1zYWxsb3djYXB0dXJlPScnPjxvcHRpb24gc2VsZWN0ZWQ9Jyc+PC9vcHRpb24+PC9zZWxlY3Q+XCIsIGUucXVlcnlTZWxlY3RvckFsbChcIlttc2FsbG93Y2FwdHVyZV49JyddXCIpLmxlbmd0aCAmJiB2LnB1c2goXCJbKl4kXT1cIiArIEkgKyBcIiooPzonJ3xcXFwiXFxcIilcIiksIGUucXVlcnlTZWxlY3RvckFsbChcIltzZWxlY3RlZF1cIikubGVuZ3RoIHx8IHYucHVzaChcIlxcXFxbXCIgKyBJICsgXCIqKD86dmFsdWV8XCIgKyBIICsgXCIpXCIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbaWR+PVwiICsgeCArIFwiLV1cIikubGVuZ3RoIHx8IHYucHVzaChcIn49XCIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoXCI6Y2hlY2tlZFwiKS5sZW5ndGggfHwgdi5wdXNoKFwiOmNoZWNrZWRcIiksIGUucXVlcnlTZWxlY3RvckFsbChcImEjXCIgKyB4ICsgXCIrKlwiKS5sZW5ndGggfHwgdi5wdXNoKFwiLiMuK1srfl1cIikgfSksIHNlKGZ1bmN0aW9uIChlKSB7IGUuaW5uZXJIVE1MID0gXCI8YSBocmVmPScnIGRpc2FibGVkPSdkaXNhYmxlZCc+PC9hPjxzZWxlY3QgZGlzYWJsZWQ9J2Rpc2FibGVkJz48b3B0aW9uLz48L3NlbGVjdD5cIjsgdmFyIHQgPSBwLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTsgdC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwiaGlkZGVuXCIpLCBlLmFwcGVuZENoaWxkKHQpLnNldEF0dHJpYnV0ZShcIm5hbWVcIiwgXCJEXCIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbbmFtZT1kXVwiKS5sZW5ndGggJiYgdi5wdXNoKFwibmFtZVwiICsgSSArIFwiKlsqXiR8IX5dPz1cIiksIDIgIT09IGUucXVlcnlTZWxlY3RvckFsbChcIjplbmFibGVkXCIpLmxlbmd0aCAmJiB2LnB1c2goXCI6ZW5hYmxlZFwiLCBcIjpkaXNhYmxlZFwiKSwgaC5hcHBlbmRDaGlsZChlKS5kaXNhYmxlZCA9ICEwLCAyICE9PSBlLnF1ZXJ5U2VsZWN0b3JBbGwoXCI6ZGlzYWJsZWRcIikubGVuZ3RoICYmIHYucHVzaChcIjplbmFibGVkXCIsIFwiOmRpc2FibGVkXCIpLCBlLnF1ZXJ5U2VsZWN0b3JBbGwoXCIqLDp4XCIpLCB2LnB1c2goXCIsLio6XCIpIH0pKSwgKG4ubWF0Y2hlc1NlbGVjdG9yID0gRy50ZXN0KG0gPSBoLm1hdGNoZXMgfHwgaC53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgaC5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgaC5vTWF0Y2hlc1NlbGVjdG9yIHx8IGgubXNNYXRjaGVzU2VsZWN0b3IpKSAmJiBzZShmdW5jdGlvbiAoZSkgeyBuLmRpc2Nvbm5lY3RlZE1hdGNoID0gbS5jYWxsKGUsIFwiKlwiKSwgbS5jYWxsKGUsIFwiW3MhPScnXTp4XCIpLCB5LnB1c2goXCIhPVwiLCBNKSB9KSwgdiA9IHYubGVuZ3RoICYmIG5ldyBSZWdFeHAodi5qb2luKFwifFwiKSksIHkgPSB5Lmxlbmd0aCAmJiBuZXcgUmVnRXhwKHkuam9pbihcInxcIikpLCB0ID0gRy50ZXN0KGguY29tcGFyZURvY3VtZW50UG9zaXRpb24pLCBiID0gdCB8fCBHLnRlc3QoaC5jb250YWlucykgPyBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IDkgPT09IGUubm9kZVR5cGUgPyBlLmRvY3VtZW50RWxlbWVudCA6IGUsIHIgPSB0ICYmIHQucGFyZW50Tm9kZTsgcmV0dXJuIGUgPT09IHIgfHwgISghciB8fCAxICE9PSByLm5vZGVUeXBlIHx8ICEobi5jb250YWlucyA/IG4uY29udGFpbnMocikgOiBlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uICYmIDE2ICYgZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbihyKSkpIH0gOiBmdW5jdGlvbiAoZSwgdCkgeyBpZiAodCkgd2hpbGUgKHQgPSB0LnBhcmVudE5vZGUpIGlmICh0ID09PSBlKSByZXR1cm4gITA7IHJldHVybiAhMSB9LCBBID0gdCA/IGZ1bmN0aW9uIChlLCB0KSB7IGlmIChlID09PSB0KSByZXR1cm4gZiA9ICEwLCAwOyB2YXIgciA9ICFlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uIC0gIXQuY29tcGFyZURvY3VtZW50UG9zaXRpb247IHJldHVybiByIHx8ICgxICYgKHIgPSAoZS5vd25lckRvY3VtZW50IHx8IGUpID09PSAodC5vd25lckRvY3VtZW50IHx8IHQpID8gZS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbih0KSA6IDEpIHx8ICFuLnNvcnREZXRhY2hlZCAmJiB0LmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGUpID09PSByID8gZSA9PT0gcCB8fCBlLm93bmVyRG9jdW1lbnQgPT09IHcgJiYgYih3LCBlKSA/IC0xIDogdCA9PT0gcCB8fCB0Lm93bmVyRG9jdW1lbnQgPT09IHcgJiYgYih3LCB0KSA/IDEgOiBjID8gUChjLCBlKSAtIFAoYywgdCkgOiAwIDogNCAmIHIgPyAtMSA6IDEpIH0gOiBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoZSA9PT0gdCkgcmV0dXJuIGYgPSAhMCwgMDsgdmFyIG4sIHIgPSAwLCBpID0gZS5wYXJlbnROb2RlLCBvID0gdC5wYXJlbnROb2RlLCBhID0gW2VdLCB1ID0gW3RdOyBpZiAoIWkgfHwgIW8pIHJldHVybiBlID09PSBwID8gLTEgOiB0ID09PSBwID8gMSA6IGkgPyAtMSA6IG8gPyAxIDogYyA/IFAoYywgZSkgLSBQKGMsIHQpIDogMDsgaWYgKGkgPT09IG8pIHJldHVybiBjZShlLCB0KTsgbiA9IGU7IHdoaWxlIChuID0gbi5wYXJlbnROb2RlKSBhLnVuc2hpZnQobik7IG4gPSB0OyB3aGlsZSAobiA9IG4ucGFyZW50Tm9kZSkgdS51bnNoaWZ0KG4pOyB3aGlsZSAoYVtyXSA9PT0gdVtyXSkgcisrOyByZXR1cm4gciA/IGNlKGFbcl0sIHVbcl0pIDogYVtyXSA9PT0gdyA/IC0xIDogdVtyXSA9PT0gdyA/IDEgOiAwIH0sIHApIDogcCB9LCBvZS5tYXRjaGVzID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIG9lKGUsIG51bGwsIG51bGwsIHQpIH0sIG9lLm1hdGNoZXNTZWxlY3RvciA9IGZ1bmN0aW9uIChlLCB0KSB7IGlmICgoZS5vd25lckRvY3VtZW50IHx8IGUpICE9PSBwICYmIGQoZSksIHQgPSB0LnJlcGxhY2UoXywgXCI9JyQxJ11cIiksIG4ubWF0Y2hlc1NlbGVjdG9yICYmIGcgJiYgIWtbdCArIFwiIFwiXSAmJiAoIXkgfHwgIXkudGVzdCh0KSkgJiYgKCF2IHx8ICF2LnRlc3QodCkpKSB0cnkgeyB2YXIgciA9IG0uY2FsbChlLCB0KTsgaWYgKHIgfHwgbi5kaXNjb25uZWN0ZWRNYXRjaCB8fCBlLmRvY3VtZW50ICYmIDExICE9PSBlLmRvY3VtZW50Lm5vZGVUeXBlKSByZXR1cm4gciB9IGNhdGNoIChlKSB7IH0gcmV0dXJuIG9lKHQsIHAsIG51bGwsIFtlXSkubGVuZ3RoID4gMCB9LCBvZS5jb250YWlucyA9IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiAoZS5vd25lckRvY3VtZW50IHx8IGUpICE9PSBwICYmIGQoZSksIGIoZSwgdCkgfSwgb2UuYXR0ciA9IGZ1bmN0aW9uIChlLCB0KSB7IChlLm93bmVyRG9jdW1lbnQgfHwgZSkgIT09IHAgJiYgZChlKTsgdmFyIGkgPSByLmF0dHJIYW5kbGVbdC50b0xvd2VyQ2FzZSgpXSwgbyA9IGkgJiYgRC5jYWxsKHIuYXR0ckhhbmRsZSwgdC50b0xvd2VyQ2FzZSgpKSA/IGkoZSwgdCwgIWcpIDogdm9pZCAwOyByZXR1cm4gdm9pZCAwICE9PSBvID8gbyA6IG4uYXR0cmlidXRlcyB8fCAhZyA/IGUuZ2V0QXR0cmlidXRlKHQpIDogKG8gPSBlLmdldEF0dHJpYnV0ZU5vZGUodCkpICYmIG8uc3BlY2lmaWVkID8gby52YWx1ZSA6IG51bGwgfSwgb2UuZXNjYXBlID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIChlICsgXCJcIikucmVwbGFjZSh0ZSwgbmUpIH0sIG9lLmVycm9yID0gZnVuY3Rpb24gKGUpIHsgdGhyb3cgbmV3IEVycm9yKFwiU3ludGF4IGVycm9yLCB1bnJlY29nbml6ZWQgZXhwcmVzc2lvbjogXCIgKyBlKSB9LCBvZS51bmlxdWVTb3J0ID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQsIHIgPSBbXSwgaSA9IDAsIG8gPSAwOyBpZiAoZiA9ICFuLmRldGVjdER1cGxpY2F0ZXMsIGMgPSAhbi5zb3J0U3RhYmxlICYmIGUuc2xpY2UoMCksIGUuc29ydChBKSwgZikgeyB3aGlsZSAodCA9IGVbbysrXSkgdCA9PT0gZVtvXSAmJiAoaSA9IHIucHVzaChvKSk7IHdoaWxlIChpLS0pIGUuc3BsaWNlKHJbaV0sIDEpIH0gcmV0dXJuIGMgPSBudWxsLCBlIH0sIGkgPSBvZS5nZXRUZXh0ID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4gPSBcIlwiLCByID0gMCwgbyA9IGUubm9kZVR5cGU7IGlmIChvKSB7IGlmICgxID09PSBvIHx8IDkgPT09IG8gfHwgMTEgPT09IG8pIHsgaWYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIGUudGV4dENvbnRlbnQpIHJldHVybiBlLnRleHRDb250ZW50OyBmb3IgKGUgPSBlLmZpcnN0Q2hpbGQ7IGU7IGUgPSBlLm5leHRTaWJsaW5nKW4gKz0gaShlKSB9IGVsc2UgaWYgKDMgPT09IG8gfHwgNCA9PT0gbykgcmV0dXJuIGUubm9kZVZhbHVlIH0gZWxzZSB3aGlsZSAodCA9IGVbcisrXSkgbiArPSBpKHQpOyByZXR1cm4gbiB9LCAociA9IG9lLnNlbGVjdG9ycyA9IHsgY2FjaGVMZW5ndGg6IDUwLCBjcmVhdGVQc2V1ZG86IHVlLCBtYXRjaDogWCwgYXR0ckhhbmRsZToge30sIGZpbmQ6IHt9LCByZWxhdGl2ZTogeyBcIj5cIjogeyBkaXI6IFwicGFyZW50Tm9kZVwiLCBmaXJzdDogITAgfSwgXCIgXCI6IHsgZGlyOiBcInBhcmVudE5vZGVcIiB9LCBcIitcIjogeyBkaXI6IFwicHJldmlvdXNTaWJsaW5nXCIsIGZpcnN0OiAhMCB9LCBcIn5cIjogeyBkaXI6IFwicHJldmlvdXNTaWJsaW5nXCIgfSB9LCBwcmVGaWx0ZXI6IHsgQVRUUjogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGVbMV0gPSBlWzFdLnJlcGxhY2UoWiwgZWUpLCBlWzNdID0gKGVbM10gfHwgZVs0XSB8fCBlWzVdIHx8IFwiXCIpLnJlcGxhY2UoWiwgZWUpLCBcIn49XCIgPT09IGVbMl0gJiYgKGVbM10gPSBcIiBcIiArIGVbM10gKyBcIiBcIiksIGUuc2xpY2UoMCwgNCkgfSwgQ0hJTEQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlWzFdID0gZVsxXS50b0xvd2VyQ2FzZSgpLCBcIm50aFwiID09PSBlWzFdLnNsaWNlKDAsIDMpID8gKGVbM10gfHwgb2UuZXJyb3IoZVswXSksIGVbNF0gPSArKGVbNF0gPyBlWzVdICsgKGVbNl0gfHwgMSkgOiAyICogKFwiZXZlblwiID09PSBlWzNdIHx8IFwib2RkXCIgPT09IGVbM10pKSwgZVs1XSA9ICsoZVs3XSArIGVbOF0gfHwgXCJvZGRcIiA9PT0gZVszXSkpIDogZVszXSAmJiBvZS5lcnJvcihlWzBdKSwgZSB9LCBQU0VVRE86IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuID0gIWVbNl0gJiYgZVsyXTsgcmV0dXJuIFguQ0hJTEQudGVzdChlWzBdKSA/IG51bGwgOiAoZVszXSA/IGVbMl0gPSBlWzRdIHx8IGVbNV0gfHwgXCJcIiA6IG4gJiYgVS50ZXN0KG4pICYmICh0ID0gYShuLCAhMCkpICYmICh0ID0gbi5pbmRleE9mKFwiKVwiLCBuLmxlbmd0aCAtIHQpIC0gbi5sZW5ndGgpICYmIChlWzBdID0gZVswXS5zbGljZSgwLCB0KSwgZVsyXSA9IG4uc2xpY2UoMCwgdCkpLCBlLnNsaWNlKDAsIDMpKSB9IH0sIGZpbHRlcjogeyBUQUc6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZS5yZXBsYWNlKFosIGVlKS50b0xvd2VyQ2FzZSgpOyByZXR1cm4gXCIqXCIgPT09IGUgPyBmdW5jdGlvbiAoKSB7IHJldHVybiAhMCB9IDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUubm9kZU5hbWUgJiYgZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB0IH0gfSwgQ0xBU1M6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gRVtlICsgXCIgXCJdOyByZXR1cm4gdCB8fCAodCA9IG5ldyBSZWdFeHAoXCIoXnxcIiArIEkgKyBcIilcIiArIGUgKyBcIihcIiArIEkgKyBcInwkKVwiKSkgJiYgRShlLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdC50ZXN0KFwic3RyaW5nXCIgPT0gdHlwZW9mIGUuY2xhc3NOYW1lICYmIGUuY2xhc3NOYW1lIHx8IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGUuZ2V0QXR0cmlidXRlICYmIGUuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikgfHwgXCJcIikgfSkgfSwgQVRUUjogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIGZ1bmN0aW9uIChyKSB7IHZhciBpID0gb2UuYXR0cihyLCBlKTsgcmV0dXJuIG51bGwgPT0gaSA/IFwiIT1cIiA9PT0gdCA6ICF0IHx8IChpICs9IFwiXCIsIFwiPVwiID09PSB0ID8gaSA9PT0gbiA6IFwiIT1cIiA9PT0gdCA/IGkgIT09IG4gOiBcIl49XCIgPT09IHQgPyBuICYmIDAgPT09IGkuaW5kZXhPZihuKSA6IFwiKj1cIiA9PT0gdCA/IG4gJiYgaS5pbmRleE9mKG4pID4gLTEgOiBcIiQ9XCIgPT09IHQgPyBuICYmIGkuc2xpY2UoLW4ubGVuZ3RoKSA9PT0gbiA6IFwifj1cIiA9PT0gdCA/IChcIiBcIiArIGkucmVwbGFjZShXLCBcIiBcIikgKyBcIiBcIikuaW5kZXhPZihuKSA+IC0xIDogXCJ8PVwiID09PSB0ICYmIChpID09PSBuIHx8IGkuc2xpY2UoMCwgbi5sZW5ndGggKyAxKSA9PT0gbiArIFwiLVwiKSkgfSB9LCBDSElMRDogZnVuY3Rpb24gKGUsIHQsIG4sIHIsIGkpIHsgdmFyIG8gPSBcIm50aFwiICE9PSBlLnNsaWNlKDAsIDMpLCBhID0gXCJsYXN0XCIgIT09IGUuc2xpY2UoLTQpLCB1ID0gXCJvZi10eXBlXCIgPT09IHQ7IHJldHVybiAxID09PSByICYmIDAgPT09IGkgPyBmdW5jdGlvbiAoZSkgeyByZXR1cm4gISFlLnBhcmVudE5vZGUgfSA6IGZ1bmN0aW9uICh0LCBuLCBzKSB7IHZhciBsLCBjLCBmLCBkLCBwLCBoLCBnID0gbyAhPT0gYSA/IFwibmV4dFNpYmxpbmdcIiA6IFwicHJldmlvdXNTaWJsaW5nXCIsIHYgPSB0LnBhcmVudE5vZGUsIHkgPSB1ICYmIHQubm9kZU5hbWUudG9Mb3dlckNhc2UoKSwgbSA9ICFzICYmICF1LCBiID0gITE7IGlmICh2KSB7IGlmIChvKSB7IHdoaWxlIChnKSB7IGQgPSB0OyB3aGlsZSAoZCA9IGRbZ10pIGlmICh1ID8gZC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB5IDogMSA9PT0gZC5ub2RlVHlwZSkgcmV0dXJuICExOyBoID0gZyA9IFwib25seVwiID09PSBlICYmICFoICYmIFwibmV4dFNpYmxpbmdcIiB9IHJldHVybiAhMCB9IGlmIChoID0gW2EgPyB2LmZpcnN0Q2hpbGQgOiB2Lmxhc3RDaGlsZF0sIGEgJiYgbSkgeyBiID0gKHAgPSAobCA9IChjID0gKGYgPSAoZCA9IHYpW3hdIHx8IChkW3hdID0ge30pKVtkLnVuaXF1ZUlEXSB8fCAoZltkLnVuaXF1ZUlEXSA9IHt9KSlbZV0gfHwgW10pWzBdID09PSBDICYmIGxbMV0pICYmIGxbMl0sIGQgPSBwICYmIHYuY2hpbGROb2Rlc1twXTsgd2hpbGUgKGQgPSArK3AgJiYgZCAmJiBkW2ddIHx8IChiID0gcCA9IDApIHx8IGgucG9wKCkpIGlmICgxID09PSBkLm5vZGVUeXBlICYmICsrYiAmJiBkID09PSB0KSB7IGNbZV0gPSBbQywgcCwgYl07IGJyZWFrIH0gfSBlbHNlIGlmIChtICYmIChiID0gcCA9IChsID0gKGMgPSAoZiA9IChkID0gdClbeF0gfHwgKGRbeF0gPSB7fSkpW2QudW5pcXVlSURdIHx8IChmW2QudW5pcXVlSURdID0ge30pKVtlXSB8fCBbXSlbMF0gPT09IEMgJiYgbFsxXSksICExID09PSBiKSB3aGlsZSAoZCA9ICsrcCAmJiBkICYmIGRbZ10gfHwgKGIgPSBwID0gMCkgfHwgaC5wb3AoKSkgaWYgKCh1ID8gZC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB5IDogMSA9PT0gZC5ub2RlVHlwZSkgJiYgKytiICYmIChtICYmICgoYyA9IChmID0gZFt4XSB8fCAoZFt4XSA9IHt9KSlbZC51bmlxdWVJRF0gfHwgKGZbZC51bmlxdWVJRF0gPSB7fSkpW2VdID0gW0MsIGJdKSwgZCA9PT0gdCkpIGJyZWFrOyByZXR1cm4gKGIgLT0gaSkgPT09IHIgfHwgYiAlIHIgPT0gMCAmJiBiIC8gciA+PSAwIH0gfSB9LCBQU0VVRE86IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCBpID0gci5wc2V1ZG9zW2VdIHx8IHIuc2V0RmlsdGVyc1tlLnRvTG93ZXJDYXNlKCldIHx8IG9lLmVycm9yKFwidW5zdXBwb3J0ZWQgcHNldWRvOiBcIiArIGUpOyByZXR1cm4gaVt4XSA/IGkodCkgOiBpLmxlbmd0aCA+IDEgPyAobiA9IFtlLCBlLCBcIlwiLCB0XSwgci5zZXRGaWx0ZXJzLmhhc093blByb3BlcnR5KGUudG9Mb3dlckNhc2UoKSkgPyB1ZShmdW5jdGlvbiAoZSwgbikgeyB2YXIgciwgbyA9IGkoZSwgdCksIGEgPSBvLmxlbmd0aDsgd2hpbGUgKGEtLSkgZVtyID0gUChlLCBvW2FdKV0gPSAhKG5bcl0gPSBvW2FdKSB9KSA6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBpKGUsIDAsIG4pIH0pIDogaSB9IH0sIHBzZXVkb3M6IHsgbm90OiB1ZShmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IFtdLCBuID0gW10sIHIgPSB1KGUucmVwbGFjZSgkLCBcIiQxXCIpKTsgcmV0dXJuIHJbeF0gPyB1ZShmdW5jdGlvbiAoZSwgdCwgbiwgaSkgeyB2YXIgbywgYSA9IHIoZSwgbnVsbCwgaSwgW10pLCB1ID0gZS5sZW5ndGg7IHdoaWxlICh1LS0pIChvID0gYVt1XSkgJiYgKGVbdV0gPSAhKHRbdV0gPSBvKSkgfSkgOiBmdW5jdGlvbiAoZSwgaSwgbykgeyByZXR1cm4gdFswXSA9IGUsIHIodCwgbnVsbCwgbywgbiksIHRbMF0gPSBudWxsLCAhbi5wb3AoKSB9IH0pLCBoYXM6IHVlKGZ1bmN0aW9uIChlKSB7IHJldHVybiBmdW5jdGlvbiAodCkgeyByZXR1cm4gb2UoZSwgdCkubGVuZ3RoID4gMCB9IH0pLCBjb250YWluczogdWUoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUgPSBlLnJlcGxhY2UoWiwgZWUpLCBmdW5jdGlvbiAodCkgeyByZXR1cm4gKHQudGV4dENvbnRlbnQgfHwgdC5pbm5lclRleHQgfHwgaSh0KSkuaW5kZXhPZihlKSA+IC0xIH0gfSksIGxhbmc6IHVlKGZ1bmN0aW9uIChlKSB7IHJldHVybiBWLnRlc3QoZSB8fCBcIlwiKSB8fCBvZS5lcnJvcihcInVuc3VwcG9ydGVkIGxhbmc6IFwiICsgZSksIGUgPSBlLnJlcGxhY2UoWiwgZWUpLnRvTG93ZXJDYXNlKCksIGZ1bmN0aW9uICh0KSB7IHZhciBuOyBkbyB7IGlmIChuID0gZyA/IHQubGFuZyA6IHQuZ2V0QXR0cmlidXRlKFwieG1sOmxhbmdcIikgfHwgdC5nZXRBdHRyaWJ1dGUoXCJsYW5nXCIpKSByZXR1cm4gKG4gPSBuLnRvTG93ZXJDYXNlKCkpID09PSBlIHx8IDAgPT09IG4uaW5kZXhPZihlICsgXCItXCIpIH0gd2hpbGUgKCh0ID0gdC5wYXJlbnROb2RlKSAmJiAxID09PSB0Lm5vZGVUeXBlKTsgcmV0dXJuICExIH0gfSksIHRhcmdldDogZnVuY3Rpb24gKHQpIHsgdmFyIG4gPSBlLmxvY2F0aW9uICYmIGUubG9jYXRpb24uaGFzaDsgcmV0dXJuIG4gJiYgbi5zbGljZSgxKSA9PT0gdC5pZCB9LCByb290OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZSA9PT0gaCB9LCBmb2N1czogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUgPT09IHAuYWN0aXZlRWxlbWVudCAmJiAoIXAuaGFzRm9jdXMgfHwgcC5oYXNGb2N1cygpKSAmJiAhIShlLnR5cGUgfHwgZS5ocmVmIHx8IH5lLnRhYkluZGV4KSB9LCBlbmFibGVkOiBwZSghMSksIGRpc2FibGVkOiBwZSghMCksIGNoZWNrZWQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyByZXR1cm4gXCJpbnB1dFwiID09PSB0ICYmICEhZS5jaGVja2VkIHx8IFwib3B0aW9uXCIgPT09IHQgJiYgISFlLnNlbGVjdGVkIH0sIHNlbGVjdGVkOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZS5wYXJlbnROb2RlICYmIGUucGFyZW50Tm9kZS5zZWxlY3RlZEluZGV4LCAhMCA9PT0gZS5zZWxlY3RlZCB9LCBlbXB0eTogZnVuY3Rpb24gKGUpIHsgZm9yIChlID0gZS5maXJzdENoaWxkOyBlOyBlID0gZS5uZXh0U2libGluZylpZiAoZS5ub2RlVHlwZSA8IDYpIHJldHVybiAhMTsgcmV0dXJuICEwIH0sIHBhcmVudDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuICFyLnBzZXVkb3MuZW1wdHkoZSkgfSwgaGVhZGVyOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gWS50ZXN0KGUubm9kZU5hbWUpIH0sIGlucHV0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gUS50ZXN0KGUubm9kZU5hbWUpIH0sIGJ1dHRvbjogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7IHJldHVybiBcImlucHV0XCIgPT09IHQgJiYgXCJidXR0b25cIiA9PT0gZS50eXBlIHx8IFwiYnV0dG9uXCIgPT09IHQgfSwgdGV4dDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IHJldHVybiBcImlucHV0XCIgPT09IGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAmJiBcInRleHRcIiA9PT0gZS50eXBlICYmIChudWxsID09ICh0ID0gZS5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpKSB8fCBcInRleHRcIiA9PT0gdC50b0xvd2VyQ2FzZSgpKSB9LCBmaXJzdDogaGUoZnVuY3Rpb24gKCkgeyByZXR1cm4gWzBdIH0pLCBsYXN0OiBoZShmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gW3QgLSAxXSB9KSwgZXE6IGhlKGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiBbbiA8IDAgPyBuICsgdCA6IG5dIH0pLCBldmVuOiBoZShmdW5jdGlvbiAoZSwgdCkgeyBmb3IgKHZhciBuID0gMDsgbiA8IHQ7IG4gKz0gMillLnB1c2gobik7IHJldHVybiBlIH0pLCBvZGQ6IGhlKGZ1bmN0aW9uIChlLCB0KSB7IGZvciAodmFyIG4gPSAxOyBuIDwgdDsgbiArPSAyKWUucHVzaChuKTsgcmV0dXJuIGUgfSksIGx0OiBoZShmdW5jdGlvbiAoZSwgdCwgbikgeyBmb3IgKHZhciByID0gbiA8IDAgPyBuICsgdCA6IG47IC0tciA+PSAwOyllLnB1c2gocik7IHJldHVybiBlIH0pLCBndDogaGUoZnVuY3Rpb24gKGUsIHQsIG4pIHsgZm9yICh2YXIgciA9IG4gPCAwID8gbiArIHQgOiBuOyArK3IgPCB0OyllLnB1c2gocik7IHJldHVybiBlIH0pIH0gfSkucHNldWRvcy5udGggPSByLnBzZXVkb3MuZXE7IGZvciAodCBpbiB7IHJhZGlvOiAhMCwgY2hlY2tib3g6ICEwLCBmaWxlOiAhMCwgcGFzc3dvcmQ6ICEwLCBpbWFnZTogITAgfSkgci5wc2V1ZG9zW3RdID0gZmUodCk7IGZvciAodCBpbiB7IHN1Ym1pdDogITAsIHJlc2V0OiAhMCB9KSByLnBzZXVkb3NbdF0gPSBkZSh0KTsgZnVuY3Rpb24gdmUoKSB7IH0gdmUucHJvdG90eXBlID0gci5maWx0ZXJzID0gci5wc2V1ZG9zLCByLnNldEZpbHRlcnMgPSBuZXcgdmUsIGEgPSBvZS50b2tlbml6ZSA9IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCBpLCBvLCBhLCB1LCBzLCBsLCBjID0gTltlICsgXCIgXCJdOyBpZiAoYykgcmV0dXJuIHQgPyAwIDogYy5zbGljZSgwKTsgdSA9IGUsIHMgPSBbXSwgbCA9IHIucHJlRmlsdGVyOyB3aGlsZSAodSkgeyBuICYmICEoaSA9IEYuZXhlYyh1KSkgfHwgKGkgJiYgKHUgPSB1LnNsaWNlKGlbMF0ubGVuZ3RoKSB8fCB1KSwgcy5wdXNoKG8gPSBbXSkpLCBuID0gITEsIChpID0gei5leGVjKHUpKSAmJiAobiA9IGkuc2hpZnQoKSwgby5wdXNoKHsgdmFsdWU6IG4sIHR5cGU6IGlbMF0ucmVwbGFjZSgkLCBcIiBcIikgfSksIHUgPSB1LnNsaWNlKG4ubGVuZ3RoKSk7IGZvciAoYSBpbiByLmZpbHRlcikgIShpID0gWFthXS5leGVjKHUpKSB8fCBsW2FdICYmICEoaSA9IGxbYV0oaSkpIHx8IChuID0gaS5zaGlmdCgpLCBvLnB1c2goeyB2YWx1ZTogbiwgdHlwZTogYSwgbWF0Y2hlczogaSB9KSwgdSA9IHUuc2xpY2Uobi5sZW5ndGgpKTsgaWYgKCFuKSBicmVhayB9IHJldHVybiB0ID8gdS5sZW5ndGggOiB1ID8gb2UuZXJyb3IoZSkgOiBOKGUsIHMpLnNsaWNlKDApIH07IGZ1bmN0aW9uIHllKGUpIHsgZm9yICh2YXIgdCA9IDAsIG4gPSBlLmxlbmd0aCwgciA9IFwiXCI7IHQgPCBuOyB0KyspciArPSBlW3RdLnZhbHVlOyByZXR1cm4gciB9IGZ1bmN0aW9uIG1lKGUsIHQsIG4pIHsgdmFyIHIgPSB0LmRpciwgaSA9IHQubmV4dCwgbyA9IGkgfHwgciwgYSA9IG4gJiYgXCJwYXJlbnROb2RlXCIgPT09IG8sIHUgPSBUKys7IHJldHVybiB0LmZpcnN0ID8gZnVuY3Rpb24gKHQsIG4sIGkpIHsgd2hpbGUgKHQgPSB0W3JdKSBpZiAoMSA9PT0gdC5ub2RlVHlwZSB8fCBhKSByZXR1cm4gZSh0LCBuLCBpKTsgcmV0dXJuICExIH0gOiBmdW5jdGlvbiAodCwgbiwgcykgeyB2YXIgbCwgYywgZiwgZCA9IFtDLCB1XTsgaWYgKHMpIHsgd2hpbGUgKHQgPSB0W3JdKSBpZiAoKDEgPT09IHQubm9kZVR5cGUgfHwgYSkgJiYgZSh0LCBuLCBzKSkgcmV0dXJuICEwIH0gZWxzZSB3aGlsZSAodCA9IHRbcl0pIGlmICgxID09PSB0Lm5vZGVUeXBlIHx8IGEpIGlmIChmID0gdFt4XSB8fCAodFt4XSA9IHt9KSwgYyA9IGZbdC51bmlxdWVJRF0gfHwgKGZbdC51bmlxdWVJRF0gPSB7fSksIGkgJiYgaSA9PT0gdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpKSB0ID0gdFtyXSB8fCB0OyBlbHNlIHsgaWYgKChsID0gY1tvXSkgJiYgbFswXSA9PT0gQyAmJiBsWzFdID09PSB1KSByZXR1cm4gZFsyXSA9IGxbMl07IGlmIChjW29dID0gZCwgZFsyXSA9IGUodCwgbiwgcykpIHJldHVybiAhMCB9IHJldHVybiAhMSB9IH0gZnVuY3Rpb24gYmUoZSkgeyByZXR1cm4gZS5sZW5ndGggPiAxID8gZnVuY3Rpb24gKHQsIG4sIHIpIHsgdmFyIGkgPSBlLmxlbmd0aDsgd2hpbGUgKGktLSkgaWYgKCFlW2ldKHQsIG4sIHIpKSByZXR1cm4gITE7IHJldHVybiAhMCB9IDogZVswXSB9IGZ1bmN0aW9uIHhlKGUsIHQsIG4pIHsgZm9yICh2YXIgciA9IDAsIGkgPSB0Lmxlbmd0aDsgciA8IGk7IHIrKylvZShlLCB0W3JdLCBuKTsgcmV0dXJuIG4gfSBmdW5jdGlvbiB3ZShlLCB0LCBuLCByLCBpKSB7IGZvciAodmFyIG8sIGEgPSBbXSwgdSA9IDAsIHMgPSBlLmxlbmd0aCwgbCA9IG51bGwgIT0gdDsgdSA8IHM7IHUrKykobyA9IGVbdV0pICYmIChuICYmICFuKG8sIHIsIGkpIHx8IChhLnB1c2gobyksIGwgJiYgdC5wdXNoKHUpKSk7IHJldHVybiBhIH0gZnVuY3Rpb24gQ2UoZSwgdCwgbiwgciwgaSwgbykgeyByZXR1cm4gciAmJiAhclt4XSAmJiAociA9IENlKHIpKSwgaSAmJiAhaVt4XSAmJiAoaSA9IENlKGksIG8pKSwgdWUoZnVuY3Rpb24gKG8sIGEsIHUsIHMpIHsgdmFyIGwsIGMsIGYsIGQgPSBbXSwgcCA9IFtdLCBoID0gYS5sZW5ndGgsIGcgPSBvIHx8IHhlKHQgfHwgXCIqXCIsIHUubm9kZVR5cGUgPyBbdV0gOiB1LCBbXSksIHYgPSAhZSB8fCAhbyAmJiB0ID8gZyA6IHdlKGcsIGQsIGUsIHUsIHMpLCB5ID0gbiA/IGkgfHwgKG8gPyBlIDogaCB8fCByKSA/IFtdIDogYSA6IHY7IGlmIChuICYmIG4odiwgeSwgdSwgcyksIHIpIHsgbCA9IHdlKHksIHApLCByKGwsIFtdLCB1LCBzKSwgYyA9IGwubGVuZ3RoOyB3aGlsZSAoYy0tKSAoZiA9IGxbY10pICYmICh5W3BbY11dID0gISh2W3BbY11dID0gZikpIH0gaWYgKG8pIHsgaWYgKGkgfHwgZSkgeyBpZiAoaSkgeyBsID0gW10sIGMgPSB5Lmxlbmd0aDsgd2hpbGUgKGMtLSkgKGYgPSB5W2NdKSAmJiBsLnB1c2godltjXSA9IGYpOyBpKG51bGwsIHkgPSBbXSwgbCwgcykgfSBjID0geS5sZW5ndGg7IHdoaWxlIChjLS0pIChmID0geVtjXSkgJiYgKGwgPSBpID8gUChvLCBmKSA6IGRbY10pID4gLTEgJiYgKG9bbF0gPSAhKGFbbF0gPSBmKSkgfSB9IGVsc2UgeSA9IHdlKHkgPT09IGEgPyB5LnNwbGljZShoLCB5Lmxlbmd0aCkgOiB5KSwgaSA/IGkobnVsbCwgYSwgeSwgcykgOiBxLmFwcGx5KGEsIHkpIH0pIH0gZnVuY3Rpb24gVGUoZSkgeyBmb3IgKHZhciB0LCBuLCBpLCBvID0gZS5sZW5ndGgsIGEgPSByLnJlbGF0aXZlW2VbMF0udHlwZV0sIHUgPSBhIHx8IHIucmVsYXRpdmVbXCIgXCJdLCBzID0gYSA/IDEgOiAwLCBjID0gbWUoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUgPT09IHQgfSwgdSwgITApLCBmID0gbWUoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIFAodCwgZSkgPiAtMSB9LCB1LCAhMCksIGQgPSBbZnVuY3Rpb24gKGUsIG4sIHIpIHsgdmFyIGkgPSAhYSAmJiAociB8fCBuICE9PSBsKSB8fCAoKHQgPSBuKS5ub2RlVHlwZSA/IGMoZSwgbiwgcikgOiBmKGUsIG4sIHIpKTsgcmV0dXJuIHQgPSBudWxsLCBpIH1dOyBzIDwgbzsgcysrKWlmIChuID0gci5yZWxhdGl2ZVtlW3NdLnR5cGVdKSBkID0gW21lKGJlKGQpLCBuKV07IGVsc2UgeyBpZiAoKG4gPSByLmZpbHRlcltlW3NdLnR5cGVdLmFwcGx5KG51bGwsIGVbc10ubWF0Y2hlcykpW3hdKSB7IGZvciAoaSA9ICsrczsgaSA8IG87IGkrKylpZiAoci5yZWxhdGl2ZVtlW2ldLnR5cGVdKSBicmVhazsgcmV0dXJuIENlKHMgPiAxICYmIGJlKGQpLCBzID4gMSAmJiB5ZShlLnNsaWNlKDAsIHMgLSAxKS5jb25jYXQoeyB2YWx1ZTogXCIgXCIgPT09IGVbcyAtIDJdLnR5cGUgPyBcIipcIiA6IFwiXCIgfSkpLnJlcGxhY2UoJCwgXCIkMVwiKSwgbiwgcyA8IGkgJiYgVGUoZS5zbGljZShzLCBpKSksIGkgPCBvICYmIFRlKGUgPSBlLnNsaWNlKGkpKSwgaSA8IG8gJiYgeWUoZSkpIH0gZC5wdXNoKG4pIH0gcmV0dXJuIGJlKGQpIH0gZnVuY3Rpb24gRWUoZSwgdCkgeyB2YXIgbiA9IHQubGVuZ3RoID4gMCwgaSA9IGUubGVuZ3RoID4gMCwgbyA9IGZ1bmN0aW9uIChvLCBhLCB1LCBzLCBjKSB7IHZhciBmLCBoLCB2LCB5ID0gMCwgbSA9IFwiMFwiLCBiID0gbyAmJiBbXSwgeCA9IFtdLCB3ID0gbCwgVCA9IG8gfHwgaSAmJiByLmZpbmQuVEFHKFwiKlwiLCBjKSwgRSA9IEMgKz0gbnVsbCA9PSB3ID8gMSA6IE1hdGgucmFuZG9tKCkgfHwgLjEsIE4gPSBULmxlbmd0aDsgZm9yIChjICYmIChsID0gYSA9PT0gcCB8fCBhIHx8IGMpOyBtICE9PSBOICYmIG51bGwgIT0gKGYgPSBUW21dKTsgbSsrKSB7IGlmIChpICYmIGYpIHsgaCA9IDAsIGEgfHwgZi5vd25lckRvY3VtZW50ID09PSBwIHx8IChkKGYpLCB1ID0gIWcpOyB3aGlsZSAodiA9IGVbaCsrXSkgaWYgKHYoZiwgYSB8fCBwLCB1KSkgeyBzLnB1c2goZik7IGJyZWFrIH0gYyAmJiAoQyA9IEUpIH0gbiAmJiAoKGYgPSAhdiAmJiBmKSAmJiB5LS0gLCBvICYmIGIucHVzaChmKSkgfSBpZiAoeSArPSBtLCBuICYmIG0gIT09IHkpIHsgaCA9IDA7IHdoaWxlICh2ID0gdFtoKytdKSB2KGIsIHgsIGEsIHUpOyBpZiAobykgeyBpZiAoeSA+IDApIHdoaWxlIChtLS0pIGJbbV0gfHwgeFttXSB8fCAoeFttXSA9IEwuY2FsbChzKSk7IHggPSB3ZSh4KSB9IHEuYXBwbHkocywgeCksIGMgJiYgIW8gJiYgeC5sZW5ndGggPiAwICYmIHkgKyB0Lmxlbmd0aCA+IDEgJiYgb2UudW5pcXVlU29ydChzKSB9IHJldHVybiBjICYmIChDID0gRSwgbCA9IHcpLCBiIH07IHJldHVybiBuID8gdWUobykgOiBvIH0gcmV0dXJuIHUgPSBvZS5jb21waWxlID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIgPSBbXSwgaSA9IFtdLCBvID0ga1tlICsgXCIgXCJdOyBpZiAoIW8pIHsgdCB8fCAodCA9IGEoZSkpLCBuID0gdC5sZW5ndGg7IHdoaWxlIChuLS0pIChvID0gVGUodFtuXSkpW3hdID8gci5wdXNoKG8pIDogaS5wdXNoKG8pOyAobyA9IGsoZSwgRWUoaSwgcikpKS5zZWxlY3RvciA9IGUgfSByZXR1cm4gbyB9LCBzID0gb2Uuc2VsZWN0ID0gZnVuY3Rpb24gKGUsIHQsIG4sIGkpIHsgdmFyIG8sIHMsIGwsIGMsIGYsIGQgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUgJiYgZSwgcCA9ICFpICYmIGEoZSA9IGQuc2VsZWN0b3IgfHwgZSk7IGlmIChuID0gbiB8fCBbXSwgMSA9PT0gcC5sZW5ndGgpIHsgaWYgKChzID0gcFswXSA9IHBbMF0uc2xpY2UoMCkpLmxlbmd0aCA+IDIgJiYgXCJJRFwiID09PSAobCA9IHNbMF0pLnR5cGUgJiYgOSA9PT0gdC5ub2RlVHlwZSAmJiBnICYmIHIucmVsYXRpdmVbc1sxXS50eXBlXSkgeyBpZiAoISh0ID0gKHIuZmluZC5JRChsLm1hdGNoZXNbMF0ucmVwbGFjZShaLCBlZSksIHQpIHx8IFtdKVswXSkpIHJldHVybiBuOyBkICYmICh0ID0gdC5wYXJlbnROb2RlKSwgZSA9IGUuc2xpY2Uocy5zaGlmdCgpLnZhbHVlLmxlbmd0aCkgfSBvID0gWC5uZWVkc0NvbnRleHQudGVzdChlKSA/IDAgOiBzLmxlbmd0aDsgd2hpbGUgKG8tLSkgeyBpZiAobCA9IHNbb10sIHIucmVsYXRpdmVbYyA9IGwudHlwZV0pIGJyZWFrOyBpZiAoKGYgPSByLmZpbmRbY10pICYmIChpID0gZihsLm1hdGNoZXNbMF0ucmVwbGFjZShaLCBlZSksIEoudGVzdChzWzBdLnR5cGUpICYmIGdlKHQucGFyZW50Tm9kZSkgfHwgdCkpKSB7IGlmIChzLnNwbGljZShvLCAxKSwgIShlID0gaS5sZW5ndGggJiYgeWUocykpKSByZXR1cm4gcS5hcHBseShuLCBpKSwgbjsgYnJlYWsgfSB9IH0gcmV0dXJuIChkIHx8IHUoZSwgcCkpKGksIHQsICFnLCBuLCAhdCB8fCBKLnRlc3QoZSkgJiYgZ2UodC5wYXJlbnROb2RlKSB8fCB0KSwgbiB9LCBuLnNvcnRTdGFibGUgPSB4LnNwbGl0KFwiXCIpLnNvcnQoQSkuam9pbihcIlwiKSA9PT0geCwgbi5kZXRlY3REdXBsaWNhdGVzID0gISFmLCBkKCksIG4uc29ydERldGFjaGVkID0gc2UoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIDEgJiBlLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKHAuY3JlYXRlRWxlbWVudChcImZpZWxkc2V0XCIpKSB9KSwgc2UoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUuaW5uZXJIVE1MID0gXCI8YSBocmVmPScjJz48L2E+XCIsIFwiI1wiID09PSBlLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKFwiaHJlZlwiKSB9KSB8fCBsZShcInR5cGV8aHJlZnxoZWlnaHR8d2lkdGhcIiwgZnVuY3Rpb24gKGUsIHQsIG4pIHsgaWYgKCFuKSByZXR1cm4gZS5nZXRBdHRyaWJ1dGUodCwgXCJ0eXBlXCIgPT09IHQudG9Mb3dlckNhc2UoKSA/IDEgOiAyKSB9KSwgbi5hdHRyaWJ1dGVzICYmIHNlKGZ1bmN0aW9uIChlKSB7IHJldHVybiBlLmlubmVySFRNTCA9IFwiPGlucHV0Lz5cIiwgZS5maXJzdENoaWxkLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsIFwiXCIpLCBcIlwiID09PSBlLmZpcnN0Q2hpbGQuZ2V0QXR0cmlidXRlKFwidmFsdWVcIikgfSkgfHwgbGUoXCJ2YWx1ZVwiLCBmdW5jdGlvbiAoZSwgdCwgbikgeyBpZiAoIW4gJiYgXCJpbnB1dFwiID09PSBlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpIHJldHVybiBlLmRlZmF1bHRWYWx1ZSB9KSwgc2UoZnVuY3Rpb24gKGUpIHsgcmV0dXJuIG51bGwgPT0gZS5nZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKSB9KSB8fCBsZShILCBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgcjsgaWYgKCFuKSByZXR1cm4gITAgPT09IGVbdF0gPyB0LnRvTG93ZXJDYXNlKCkgOiAociA9IGUuZ2V0QXR0cmlidXRlTm9kZSh0KSkgJiYgci5zcGVjaWZpZWQgPyByLnZhbHVlIDogbnVsbCB9KSwgb2UgfShlKTsgdy5maW5kID0gRSwgdy5leHByID0gRS5zZWxlY3RvcnMsIHcuZXhwcltcIjpcIl0gPSB3LmV4cHIucHNldWRvcywgdy51bmlxdWVTb3J0ID0gdy51bmlxdWUgPSBFLnVuaXF1ZVNvcnQsIHcudGV4dCA9IEUuZ2V0VGV4dCwgdy5pc1hNTERvYyA9IEUuaXNYTUwsIHcuY29udGFpbnMgPSBFLmNvbnRhaW5zLCB3LmVzY2FwZVNlbGVjdG9yID0gRS5lc2NhcGU7IHZhciBOID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIgPSBbXSwgaSA9IHZvaWQgMCAhPT0gbjsgd2hpbGUgKChlID0gZVt0XSkgJiYgOSAhPT0gZS5ub2RlVHlwZSkgaWYgKDEgPT09IGUubm9kZVR5cGUpIHsgaWYgKGkgJiYgdyhlKS5pcyhuKSkgYnJlYWs7IHIucHVzaChlKSB9IHJldHVybiByIH0sIGsgPSBmdW5jdGlvbiAoZSwgdCkgeyBmb3IgKHZhciBuID0gW107IGU7IGUgPSBlLm5leHRTaWJsaW5nKTEgPT09IGUubm9kZVR5cGUgJiYgZSAhPT0gdCAmJiBuLnB1c2goZSk7IHJldHVybiBuIH0sIEEgPSB3LmV4cHIubWF0Y2gubmVlZHNDb250ZXh0OyBmdW5jdGlvbiBEKGUsIHQpIHsgcmV0dXJuIGUubm9kZU5hbWUgJiYgZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSB0LnRvTG93ZXJDYXNlKCkgfSB2YXIgUyA9IC9ePChbYS16XVteXFwvXFwwPjpcXHgyMFxcdFxcclxcblxcZl0qKVtcXHgyMFxcdFxcclxcblxcZl0qXFwvPz4oPzo8XFwvXFwxPnwpJC9pOyBmdW5jdGlvbiBMKGUsIHQsIG4pIHsgcmV0dXJuIGcodCkgPyB3LmdyZXAoZSwgZnVuY3Rpb24gKGUsIHIpIHsgcmV0dXJuICEhdC5jYWxsKGUsIHIsIGUpICE9PSBuIH0pIDogdC5ub2RlVHlwZSA/IHcuZ3JlcChlLCBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZSA9PT0gdCAhPT0gbiB9KSA6IFwic3RyaW5nXCIgIT0gdHlwZW9mIHQgPyB3LmdyZXAoZSwgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHMuY2FsbCh0LCBlKSA+IC0xICE9PSBuIH0pIDogdy5maWx0ZXIodCwgZSwgbikgfSB3LmZpbHRlciA9IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByID0gdFswXTsgcmV0dXJuIG4gJiYgKGUgPSBcIjpub3QoXCIgKyBlICsgXCIpXCIpLCAxID09PSB0Lmxlbmd0aCAmJiAxID09PSByLm5vZGVUeXBlID8gdy5maW5kLm1hdGNoZXNTZWxlY3RvcihyLCBlKSA/IFtyXSA6IFtdIDogdy5maW5kLm1hdGNoZXMoZSwgdy5ncmVwKHQsIGZ1bmN0aW9uIChlKSB7IHJldHVybiAxID09PSBlLm5vZGVUeXBlIH0pKSB9LCB3LmZuLmV4dGVuZCh7IGZpbmQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuLCByID0gdGhpcy5sZW5ndGgsIGkgPSB0aGlzOyBpZiAoXCJzdHJpbmdcIiAhPSB0eXBlb2YgZSkgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHcoZSkuZmlsdGVyKGZ1bmN0aW9uICgpIHsgZm9yICh0ID0gMDsgdCA8IHI7IHQrKylpZiAody5jb250YWlucyhpW3RdLCB0aGlzKSkgcmV0dXJuICEwIH0pKTsgZm9yIChuID0gdGhpcy5wdXNoU3RhY2soW10pLCB0ID0gMDsgdCA8IHI7IHQrKyl3LmZpbmQoZSwgaVt0XSwgbik7IHJldHVybiByID4gMSA/IHcudW5pcXVlU29ydChuKSA6IG4gfSwgZmlsdGVyOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdGhpcy5wdXNoU3RhY2soTCh0aGlzLCBlIHx8IFtdLCAhMSkpIH0sIG5vdDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKEwodGhpcywgZSB8fCBbXSwgITApKSB9LCBpczogZnVuY3Rpb24gKGUpIHsgcmV0dXJuICEhTCh0aGlzLCBcInN0cmluZ1wiID09IHR5cGVvZiBlICYmIEEudGVzdChlKSA/IHcoZSkgOiBlIHx8IFtdLCAhMSkubGVuZ3RoIH0gfSk7IHZhciBqLCBxID0gL14oPzpcXHMqKDxbXFx3XFxXXSs+KVtePl0qfCMoW1xcdy1dKykpJC87ICh3LmZuLmluaXQgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgaSwgbzsgaWYgKCFlKSByZXR1cm4gdGhpczsgaWYgKG4gPSBuIHx8IGosIFwic3RyaW5nXCIgPT0gdHlwZW9mIGUpIHsgaWYgKCEoaSA9IFwiPFwiID09PSBlWzBdICYmIFwiPlwiID09PSBlW2UubGVuZ3RoIC0gMV0gJiYgZS5sZW5ndGggPj0gMyA/IFtudWxsLCBlLCBudWxsXSA6IHEuZXhlYyhlKSkgfHwgIWlbMV0gJiYgdCkgcmV0dXJuICF0IHx8IHQuanF1ZXJ5ID8gKHQgfHwgbikuZmluZChlKSA6IHRoaXMuY29uc3RydWN0b3IodCkuZmluZChlKTsgaWYgKGlbMV0pIHsgaWYgKHQgPSB0IGluc3RhbmNlb2YgdyA/IHRbMF0gOiB0LCB3Lm1lcmdlKHRoaXMsIHcucGFyc2VIVE1MKGlbMV0sIHQgJiYgdC5ub2RlVHlwZSA/IHQub3duZXJEb2N1bWVudCB8fCB0IDogciwgITApKSwgUy50ZXN0KGlbMV0pICYmIHcuaXNQbGFpbk9iamVjdCh0KSkgZm9yIChpIGluIHQpIGcodGhpc1tpXSkgPyB0aGlzW2ldKHRbaV0pIDogdGhpcy5hdHRyKGksIHRbaV0pOyByZXR1cm4gdGhpcyB9IHJldHVybiAobyA9IHIuZ2V0RWxlbWVudEJ5SWQoaVsyXSkpICYmICh0aGlzWzBdID0gbywgdGhpcy5sZW5ndGggPSAxKSwgdGhpcyB9IHJldHVybiBlLm5vZGVUeXBlID8gKHRoaXNbMF0gPSBlLCB0aGlzLmxlbmd0aCA9IDEsIHRoaXMpIDogZyhlKSA/IHZvaWQgMCAhPT0gbi5yZWFkeSA/IG4ucmVhZHkoZSkgOiBlKHcpIDogdy5tYWtlQXJyYXkoZSwgdGhpcykgfSkucHJvdG90eXBlID0gdy5mbiwgaiA9IHcocik7IHZhciBPID0gL14oPzpwYXJlbnRzfHByZXYoPzpVbnRpbHxBbGwpKS8sIFAgPSB7IGNoaWxkcmVuOiAhMCwgY29udGVudHM6ICEwLCBuZXh0OiAhMCwgcHJldjogITAgfTsgdy5mbi5leHRlbmQoeyBoYXM6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gdyhlLCB0aGlzKSwgbiA9IHQubGVuZ3RoOyByZXR1cm4gdGhpcy5maWx0ZXIoZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBlID0gMDsgZSA8IG47IGUrKylpZiAody5jb250YWlucyh0aGlzLCB0W2VdKSkgcmV0dXJuICEwIH0pIH0sIGNsb3Nlc3Q6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCByID0gMCwgaSA9IHRoaXMubGVuZ3RoLCBvID0gW10sIGEgPSBcInN0cmluZ1wiICE9IHR5cGVvZiBlICYmIHcoZSk7IGlmICghQS50ZXN0KGUpKSBmb3IgKDsgciA8IGk7IHIrKylmb3IgKG4gPSB0aGlzW3JdOyBuICYmIG4gIT09IHQ7IG4gPSBuLnBhcmVudE5vZGUpaWYgKG4ubm9kZVR5cGUgPCAxMSAmJiAoYSA/IGEuaW5kZXgobikgPiAtMSA6IDEgPT09IG4ubm9kZVR5cGUgJiYgdy5maW5kLm1hdGNoZXNTZWxlY3RvcihuLCBlKSkpIHsgby5wdXNoKG4pOyBicmVhayB9IHJldHVybiB0aGlzLnB1c2hTdGFjayhvLmxlbmd0aCA+IDEgPyB3LnVuaXF1ZVNvcnQobykgOiBvKSB9LCBpbmRleDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUgPyBcInN0cmluZ1wiID09IHR5cGVvZiBlID8gcy5jYWxsKHcoZSksIHRoaXNbMF0pIDogcy5jYWxsKHRoaXMsIGUuanF1ZXJ5ID8gZVswXSA6IGUpIDogdGhpc1swXSAmJiB0aGlzWzBdLnBhcmVudE5vZGUgPyB0aGlzLmZpcnN0KCkucHJldkFsbCgpLmxlbmd0aCA6IC0xIH0sIGFkZDogZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHcudW5pcXVlU29ydCh3Lm1lcmdlKHRoaXMuZ2V0KCksIHcoZSwgdCkpKSkgfSwgYWRkQmFjazogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMuYWRkKG51bGwgPT0gZSA/IHRoaXMucHJldk9iamVjdCA6IHRoaXMucHJldk9iamVjdC5maWx0ZXIoZSkpIH0gfSk7IGZ1bmN0aW9uIEgoZSwgdCkgeyB3aGlsZSAoKGUgPSBlW3RdKSAmJiAxICE9PSBlLm5vZGVUeXBlKTsgcmV0dXJuIGUgfSB3LmVhY2goeyBwYXJlbnQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZS5wYXJlbnROb2RlOyByZXR1cm4gdCAmJiAxMSAhPT0gdC5ub2RlVHlwZSA/IHQgOiBudWxsIH0sIHBhcmVudHM6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBOKGUsIFwicGFyZW50Tm9kZVwiKSB9LCBwYXJlbnRzVW50aWw6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiBOKGUsIFwicGFyZW50Tm9kZVwiLCBuKSB9LCBuZXh0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gSChlLCBcIm5leHRTaWJsaW5nXCIpIH0sIHByZXY6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBIKGUsIFwicHJldmlvdXNTaWJsaW5nXCIpIH0sIG5leHRBbGw6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBOKGUsIFwibmV4dFNpYmxpbmdcIikgfSwgcHJldkFsbDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIE4oZSwgXCJwcmV2aW91c1NpYmxpbmdcIikgfSwgbmV4dFVudGlsOiBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gTihlLCBcIm5leHRTaWJsaW5nXCIsIG4pIH0sIHByZXZVbnRpbDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIE4oZSwgXCJwcmV2aW91c1NpYmxpbmdcIiwgbikgfSwgc2libGluZ3M6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBrKChlLnBhcmVudE5vZGUgfHwge30pLmZpcnN0Q2hpbGQsIGUpIH0sIGNoaWxkcmVuOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gayhlLmZpcnN0Q2hpbGQpIH0sIGNvbnRlbnRzOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gRChlLCBcImlmcmFtZVwiKSA/IGUuY29udGVudERvY3VtZW50IDogKEQoZSwgXCJ0ZW1wbGF0ZVwiKSAmJiAoZSA9IGUuY29udGVudCB8fCBlKSwgdy5tZXJnZShbXSwgZS5jaGlsZE5vZGVzKSkgfSB9LCBmdW5jdGlvbiAoZSwgdCkgeyB3LmZuW2VdID0gZnVuY3Rpb24gKG4sIHIpIHsgdmFyIGkgPSB3Lm1hcCh0aGlzLCB0LCBuKTsgcmV0dXJuIFwiVW50aWxcIiAhPT0gZS5zbGljZSgtNSkgJiYgKHIgPSBuKSwgciAmJiBcInN0cmluZ1wiID09IHR5cGVvZiByICYmIChpID0gdy5maWx0ZXIociwgaSkpLCB0aGlzLmxlbmd0aCA+IDEgJiYgKFBbZV0gfHwgdy51bmlxdWVTb3J0KGkpLCBPLnRlc3QoZSkgJiYgaS5yZXZlcnNlKCkpLCB0aGlzLnB1c2hTdGFjayhpKSB9IH0pOyB2YXIgSSA9IC9bXlxceDIwXFx0XFxyXFxuXFxmXSsvZzsgZnVuY3Rpb24gUihlKSB7IHZhciB0ID0ge307IHJldHVybiB3LmVhY2goZS5tYXRjaChJKSB8fCBbXSwgZnVuY3Rpb24gKGUsIG4pIHsgdFtuXSA9ICEwIH0pLCB0IH0gdy5DYWxsYmFja3MgPSBmdW5jdGlvbiAoZSkgeyBlID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSA/IFIoZSkgOiB3LmV4dGVuZCh7fSwgZSk7IHZhciB0LCBuLCByLCBpLCBvID0gW10sIGEgPSBbXSwgdSA9IC0xLCBzID0gZnVuY3Rpb24gKCkgeyBmb3IgKGkgPSBpIHx8IGUub25jZSwgciA9IHQgPSAhMDsgYS5sZW5ndGg7IHUgPSAtMSkgeyBuID0gYS5zaGlmdCgpOyB3aGlsZSAoKyt1IDwgby5sZW5ndGgpICExID09PSBvW3VdLmFwcGx5KG5bMF0sIG5bMV0pICYmIGUuc3RvcE9uRmFsc2UgJiYgKHUgPSBvLmxlbmd0aCwgbiA9ICExKSB9IGUubWVtb3J5IHx8IChuID0gITEpLCB0ID0gITEsIGkgJiYgKG8gPSBuID8gW10gOiBcIlwiKSB9LCBsID0geyBhZGQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG8gJiYgKG4gJiYgIXQgJiYgKHUgPSBvLmxlbmd0aCAtIDEsIGEucHVzaChuKSksIGZ1bmN0aW9uIHQobikgeyB3LmVhY2gobiwgZnVuY3Rpb24gKG4sIHIpIHsgZyhyKSA/IGUudW5pcXVlICYmIGwuaGFzKHIpIHx8IG8ucHVzaChyKSA6IHIgJiYgci5sZW5ndGggJiYgXCJzdHJpbmdcIiAhPT0gYihyKSAmJiB0KHIpIH0pIH0oYXJndW1lbnRzKSwgbiAmJiAhdCAmJiBzKCkpLCB0aGlzIH0sIHJlbW92ZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdy5lYWNoKGFyZ3VtZW50cywgZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG47IHdoaWxlICgobiA9IHcuaW5BcnJheSh0LCBvLCBuKSkgPiAtMSkgby5zcGxpY2UobiwgMSksIG4gPD0gdSAmJiB1LS0gfSksIHRoaXMgfSwgaGFzOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gZSA/IHcuaW5BcnJheShlLCBvKSA+IC0xIDogby5sZW5ndGggPiAwIH0sIGVtcHR5OiBmdW5jdGlvbiAoKSB7IHJldHVybiBvICYmIChvID0gW10pLCB0aGlzIH0sIGRpc2FibGU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGkgPSBhID0gW10sIG8gPSBuID0gXCJcIiwgdGhpcyB9LCBkaXNhYmxlZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gIW8gfSwgbG9jazogZnVuY3Rpb24gKCkgeyByZXR1cm4gaSA9IGEgPSBbXSwgbiB8fCB0IHx8IChvID0gbiA9IFwiXCIpLCB0aGlzIH0sIGxvY2tlZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISFpIH0sIGZpcmVXaXRoOiBmdW5jdGlvbiAoZSwgbikgeyByZXR1cm4gaSB8fCAobiA9IFtlLCAobiA9IG4gfHwgW10pLnNsaWNlID8gbi5zbGljZSgpIDogbl0sIGEucHVzaChuKSwgdCB8fCBzKCkpLCB0aGlzIH0sIGZpcmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGwuZmlyZVdpdGgodGhpcywgYXJndW1lbnRzKSwgdGhpcyB9LCBmaXJlZDogZnVuY3Rpb24gKCkgeyByZXR1cm4gISFyIH0gfTsgcmV0dXJuIGwgfTsgZnVuY3Rpb24gQihlKSB7IHJldHVybiBlIH0gZnVuY3Rpb24gTShlKSB7IHRocm93IGUgfSBmdW5jdGlvbiBXKGUsIHQsIG4sIHIpIHsgdmFyIGk7IHRyeSB7IGUgJiYgZyhpID0gZS5wcm9taXNlKSA/IGkuY2FsbChlKS5kb25lKHQpLmZhaWwobikgOiBlICYmIGcoaSA9IGUudGhlbikgPyBpLmNhbGwoZSwgdCwgbikgOiB0LmFwcGx5KHZvaWQgMCwgW2VdLnNsaWNlKHIpKSB9IGNhdGNoIChlKSB7IG4uYXBwbHkodm9pZCAwLCBbZV0pIH0gfSB3LmV4dGVuZCh7IERlZmVycmVkOiBmdW5jdGlvbiAodCkgeyB2YXIgbiA9IFtbXCJub3RpZnlcIiwgXCJwcm9ncmVzc1wiLCB3LkNhbGxiYWNrcyhcIm1lbW9yeVwiKSwgdy5DYWxsYmFja3MoXCJtZW1vcnlcIiksIDJdLCBbXCJyZXNvbHZlXCIsIFwiZG9uZVwiLCB3LkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLCB3LkNhbGxiYWNrcyhcIm9uY2UgbWVtb3J5XCIpLCAwLCBcInJlc29sdmVkXCJdLCBbXCJyZWplY3RcIiwgXCJmYWlsXCIsIHcuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksIHcuQ2FsbGJhY2tzKFwib25jZSBtZW1vcnlcIiksIDEsIFwicmVqZWN0ZWRcIl1dLCByID0gXCJwZW5kaW5nXCIsIGkgPSB7IHN0YXRlOiBmdW5jdGlvbiAoKSB7IHJldHVybiByIH0sIGFsd2F5czogZnVuY3Rpb24gKCkgeyByZXR1cm4gby5kb25lKGFyZ3VtZW50cykuZmFpbChhcmd1bWVudHMpLCB0aGlzIH0sIFwiY2F0Y2hcIjogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGkudGhlbihudWxsLCBlKSB9LCBwaXBlOiBmdW5jdGlvbiAoKSB7IHZhciBlID0gYXJndW1lbnRzOyByZXR1cm4gdy5EZWZlcnJlZChmdW5jdGlvbiAodCkgeyB3LmVhY2gobiwgZnVuY3Rpb24gKG4sIHIpIHsgdmFyIGkgPSBnKGVbcls0XV0pICYmIGVbcls0XV07IG9bclsxXV0oZnVuY3Rpb24gKCkgeyB2YXIgZSA9IGkgJiYgaS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOyBlICYmIGcoZS5wcm9taXNlKSA/IGUucHJvbWlzZSgpLnByb2dyZXNzKHQubm90aWZ5KS5kb25lKHQucmVzb2x2ZSkuZmFpbCh0LnJlamVjdCkgOiB0W3JbMF0gKyBcIldpdGhcIl0odGhpcywgaSA/IFtlXSA6IGFyZ3VtZW50cykgfSkgfSksIGUgPSBudWxsIH0pLnByb21pc2UoKSB9LCB0aGVuOiBmdW5jdGlvbiAodCwgciwgaSkgeyB2YXIgbyA9IDA7IGZ1bmN0aW9uIGEodCwgbiwgciwgaSkgeyByZXR1cm4gZnVuY3Rpb24gKCkgeyB2YXIgdSA9IHRoaXMsIHMgPSBhcmd1bWVudHMsIGwgPSBmdW5jdGlvbiAoKSB7IHZhciBlLCBsOyBpZiAoISh0IDwgbykpIHsgaWYgKChlID0gci5hcHBseSh1LCBzKSkgPT09IG4ucHJvbWlzZSgpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiVGhlbmFibGUgc2VsZi1yZXNvbHV0aW9uXCIpOyBsID0gZSAmJiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgZSB8fCBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGUpICYmIGUudGhlbiwgZyhsKSA/IGkgPyBsLmNhbGwoZSwgYShvLCBuLCBCLCBpKSwgYShvLCBuLCBNLCBpKSkgOiAobysrICwgbC5jYWxsKGUsIGEobywgbiwgQiwgaSksIGEobywgbiwgTSwgaSksIGEobywgbiwgQiwgbi5ub3RpZnlXaXRoKSkpIDogKHIgIT09IEIgJiYgKHUgPSB2b2lkIDAsIHMgPSBbZV0pLCAoaSB8fCBuLnJlc29sdmVXaXRoKSh1LCBzKSkgfSB9LCBjID0gaSA/IGwgOiBmdW5jdGlvbiAoKSB7IHRyeSB7IGwoKSB9IGNhdGNoIChlKSB7IHcuRGVmZXJyZWQuZXhjZXB0aW9uSG9vayAmJiB3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2soZSwgYy5zdGFja1RyYWNlKSwgdCArIDEgPj0gbyAmJiAociAhPT0gTSAmJiAodSA9IHZvaWQgMCwgcyA9IFtlXSksIG4ucmVqZWN0V2l0aCh1LCBzKSkgfSB9OyB0ID8gYygpIDogKHcuRGVmZXJyZWQuZ2V0U3RhY2tIb29rICYmIChjLnN0YWNrVHJhY2UgPSB3LkRlZmVycmVkLmdldFN0YWNrSG9vaygpKSwgZS5zZXRUaW1lb3V0KGMpKSB9IH0gcmV0dXJuIHcuRGVmZXJyZWQoZnVuY3Rpb24gKGUpIHsgblswXVszXS5hZGQoYSgwLCBlLCBnKGkpID8gaSA6IEIsIGUubm90aWZ5V2l0aCkpLCBuWzFdWzNdLmFkZChhKDAsIGUsIGcodCkgPyB0IDogQikpLCBuWzJdWzNdLmFkZChhKDAsIGUsIGcocikgPyByIDogTSkpIH0pLnByb21pc2UoKSB9LCBwcm9taXNlOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbnVsbCAhPSBlID8gdy5leHRlbmQoZSwgaSkgOiBpIH0gfSwgbyA9IHt9OyByZXR1cm4gdy5lYWNoKG4sIGZ1bmN0aW9uIChlLCB0KSB7IHZhciBhID0gdFsyXSwgdSA9IHRbNV07IGlbdFsxXV0gPSBhLmFkZCwgdSAmJiBhLmFkZChmdW5jdGlvbiAoKSB7IHIgPSB1IH0sIG5bMyAtIGVdWzJdLmRpc2FibGUsIG5bMyAtIGVdWzNdLmRpc2FibGUsIG5bMF1bMl0ubG9jaywgblswXVszXS5sb2NrKSwgYS5hZGQodFszXS5maXJlKSwgb1t0WzBdXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIG9bdFswXSArIFwiV2l0aFwiXSh0aGlzID09PSBvID8gdm9pZCAwIDogdGhpcywgYXJndW1lbnRzKSwgdGhpcyB9LCBvW3RbMF0gKyBcIldpdGhcIl0gPSBhLmZpcmVXaXRoIH0pLCBpLnByb21pc2UobyksIHQgJiYgdC5jYWxsKG8sIG8pLCBvIH0sIHdoZW46IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gYXJndW1lbnRzLmxlbmd0aCwgbiA9IHQsIHIgPSBBcnJheShuKSwgaSA9IG8uY2FsbChhcmd1bWVudHMpLCBhID0gdy5EZWZlcnJlZCgpLCB1ID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGZ1bmN0aW9uIChuKSB7IHJbZV0gPSB0aGlzLCBpW2VdID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgPyBvLmNhbGwoYXJndW1lbnRzKSA6IG4sIC0tdCB8fCBhLnJlc29sdmVXaXRoKHIsIGkpIH0gfTsgaWYgKHQgPD0gMSAmJiAoVyhlLCBhLmRvbmUodShuKSkucmVzb2x2ZSwgYS5yZWplY3QsICF0KSwgXCJwZW5kaW5nXCIgPT09IGEuc3RhdGUoKSB8fCBnKGlbbl0gJiYgaVtuXS50aGVuKSkpIHJldHVybiBhLnRoZW4oKTsgd2hpbGUgKG4tLSkgVyhpW25dLCB1KG4pLCBhLnJlamVjdCk7IHJldHVybiBhLnByb21pc2UoKSB9IH0pOyB2YXIgJCA9IC9eKEV2YWx8SW50ZXJuYWx8UmFuZ2V8UmVmZXJlbmNlfFN5bnRheHxUeXBlfFVSSSlFcnJvciQvOyB3LkRlZmVycmVkLmV4Y2VwdGlvbkhvb2sgPSBmdW5jdGlvbiAodCwgbikgeyBlLmNvbnNvbGUgJiYgZS5jb25zb2xlLndhcm4gJiYgdCAmJiAkLnRlc3QodC5uYW1lKSAmJiBlLmNvbnNvbGUud2FybihcImpRdWVyeS5EZWZlcnJlZCBleGNlcHRpb246IFwiICsgdC5tZXNzYWdlLCB0LnN0YWNrLCBuKSB9LCB3LnJlYWR5RXhjZXB0aW9uID0gZnVuY3Rpb24gKHQpIHsgZS5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgdGhyb3cgdCB9KSB9OyB2YXIgRiA9IHcuRGVmZXJyZWQoKTsgdy5mbi5yZWFkeSA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiBGLnRoZW4oZSlbXCJjYXRjaFwiXShmdW5jdGlvbiAoZSkgeyB3LnJlYWR5RXhjZXB0aW9uKGUpIH0pLCB0aGlzIH0sIHcuZXh0ZW5kKHsgaXNSZWFkeTogITEsIHJlYWR5V2FpdDogMSwgcmVhZHk6IGZ1bmN0aW9uIChlKSB7ICghMCA9PT0gZSA/IC0tdy5yZWFkeVdhaXQgOiB3LmlzUmVhZHkpIHx8ICh3LmlzUmVhZHkgPSAhMCwgITAgIT09IGUgJiYgLS13LnJlYWR5V2FpdCA+IDAgfHwgRi5yZXNvbHZlV2l0aChyLCBbd10pKSB9IH0pLCB3LnJlYWR5LnRoZW4gPSBGLnRoZW47IGZ1bmN0aW9uIHooKSB7IHIucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgeiksIGUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgeiksIHcucmVhZHkoKSB9IFwiY29tcGxldGVcIiA9PT0gci5yZWFkeVN0YXRlIHx8IFwibG9hZGluZ1wiICE9PSByLnJlYWR5U3RhdGUgJiYgIXIuZG9jdW1lbnRFbGVtZW50LmRvU2Nyb2xsID8gZS5zZXRUaW1lb3V0KHcucmVhZHkpIDogKHIuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgeiksIGUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIiwgeikpOyB2YXIgXyA9IGZ1bmN0aW9uIChlLCB0LCBuLCByLCBpLCBvLCBhKSB7IHZhciB1ID0gMCwgcyA9IGUubGVuZ3RoLCBsID0gbnVsbCA9PSBuOyBpZiAoXCJvYmplY3RcIiA9PT0gYihuKSkgeyBpID0gITA7IGZvciAodSBpbiBuKSBfKGUsIHQsIHUsIG5bdV0sICEwLCBvLCBhKSB9IGVsc2UgaWYgKHZvaWQgMCAhPT0gciAmJiAoaSA9ICEwLCBnKHIpIHx8IChhID0gITApLCBsICYmIChhID8gKHQuY2FsbChlLCByKSwgdCA9IG51bGwpIDogKGwgPSB0LCB0ID0gZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIGwuY2FsbCh3KGUpLCBuKSB9KSksIHQpKSBmb3IgKDsgdSA8IHM7IHUrKyl0KGVbdV0sIG4sIGEgPyByIDogci5jYWxsKGVbdV0sIHUsIHQoZVt1XSwgbikpKTsgcmV0dXJuIGkgPyBlIDogbCA/IHQuY2FsbChlKSA6IHMgPyB0KGVbMF0sIG4pIDogbyB9LCBVID0gL14tbXMtLywgViA9IC8tKFthLXpdKS9nOyBmdW5jdGlvbiBYKGUsIHQpIHsgcmV0dXJuIHQudG9VcHBlckNhc2UoKSB9IGZ1bmN0aW9uIFEoZSkgeyByZXR1cm4gZS5yZXBsYWNlKFUsIFwibXMtXCIpLnJlcGxhY2UoViwgWCkgfSB2YXIgWSA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAxID09PSBlLm5vZGVUeXBlIHx8IDkgPT09IGUubm9kZVR5cGUgfHwgIStlLm5vZGVUeXBlIH07IGZ1bmN0aW9uIEcoKSB7IHRoaXMuZXhwYW5kbyA9IHcuZXhwYW5kbyArIEcudWlkKysgfSBHLnVpZCA9IDEsIEcucHJvdG90eXBlID0geyBjYWNoZTogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlW3RoaXMuZXhwYW5kb107IHJldHVybiB0IHx8ICh0ID0ge30sIFkoZSkgJiYgKGUubm9kZVR5cGUgPyBlW3RoaXMuZXhwYW5kb10gPSB0IDogT2JqZWN0LmRlZmluZVByb3BlcnR5KGUsIHRoaXMuZXhwYW5kbywgeyB2YWx1ZTogdCwgY29uZmlndXJhYmxlOiAhMCB9KSkpLCB0IH0sIHNldDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGkgPSB0aGlzLmNhY2hlKGUpOyBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgdCkgaVtRKHQpXSA9IG47IGVsc2UgZm9yIChyIGluIHQpIGlbUShyKV0gPSB0W3JdOyByZXR1cm4gaSB9LCBnZXQ6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiB2b2lkIDAgPT09IHQgPyB0aGlzLmNhY2hlKGUpIDogZVt0aGlzLmV4cGFuZG9dICYmIGVbdGhpcy5leHBhbmRvXVtRKHQpXSB9LCBhY2Nlc3M6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiB2b2lkIDAgPT09IHQgfHwgdCAmJiBcInN0cmluZ1wiID09IHR5cGVvZiB0ICYmIHZvaWQgMCA9PT0gbiA/IHRoaXMuZ2V0KGUsIHQpIDogKHRoaXMuc2V0KGUsIHQsIG4pLCB2b2lkIDAgIT09IG4gPyBuIDogdCkgfSwgcmVtb3ZlOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IGVbdGhpcy5leHBhbmRvXTsgaWYgKHZvaWQgMCAhPT0gcikgeyBpZiAodm9pZCAwICE9PSB0KSB7IG4gPSAodCA9IEFycmF5LmlzQXJyYXkodCkgPyB0Lm1hcChRKSA6ICh0ID0gUSh0KSkgaW4gciA/IFt0XSA6IHQubWF0Y2goSSkgfHwgW10pLmxlbmd0aDsgd2hpbGUgKG4tLSkgZGVsZXRlIHJbdFtuXV0gfSAodm9pZCAwID09PSB0IHx8IHcuaXNFbXB0eU9iamVjdChyKSkgJiYgKGUubm9kZVR5cGUgPyBlW3RoaXMuZXhwYW5kb10gPSB2b2lkIDAgOiBkZWxldGUgZVt0aGlzLmV4cGFuZG9dKSB9IH0sIGhhc0RhdGE6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZVt0aGlzLmV4cGFuZG9dOyByZXR1cm4gdm9pZCAwICE9PSB0ICYmICF3LmlzRW1wdHlPYmplY3QodCkgfSB9OyB2YXIgSyA9IG5ldyBHLCBKID0gbmV3IEcsIFogPSAvXig/Olxce1tcXHdcXFddKlxcfXxcXFtbXFx3XFxXXSpcXF0pJC8sIGVlID0gL1tBLVpdL2c7IGZ1bmN0aW9uIHRlKGUpIHsgcmV0dXJuIFwidHJ1ZVwiID09PSBlIHx8IFwiZmFsc2VcIiAhPT0gZSAmJiAoXCJudWxsXCIgPT09IGUgPyBudWxsIDogZSA9PT0gK2UgKyBcIlwiID8gK2UgOiBaLnRlc3QoZSkgPyBKU09OLnBhcnNlKGUpIDogZSkgfSBmdW5jdGlvbiBuZShlLCB0LCBuKSB7IHZhciByOyBpZiAodm9pZCAwID09PSBuICYmIDEgPT09IGUubm9kZVR5cGUpIGlmIChyID0gXCJkYXRhLVwiICsgdC5yZXBsYWNlKGVlLCBcIi0kJlwiKS50b0xvd2VyQ2FzZSgpLCBcInN0cmluZ1wiID09IHR5cGVvZiAobiA9IGUuZ2V0QXR0cmlidXRlKHIpKSkgeyB0cnkgeyBuID0gdGUobikgfSBjYXRjaCAoZSkgeyB9IEouc2V0KGUsIHQsIG4pIH0gZWxzZSBuID0gdm9pZCAwOyByZXR1cm4gbiB9IHcuZXh0ZW5kKHsgaGFzRGF0YTogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIEouaGFzRGF0YShlKSB8fCBLLmhhc0RhdGEoZSkgfSwgZGF0YTogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIEouYWNjZXNzKGUsIHQsIG4pIH0sIHJlbW92ZURhdGE6IGZ1bmN0aW9uIChlLCB0KSB7IEoucmVtb3ZlKGUsIHQpIH0sIF9kYXRhOiBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gSy5hY2Nlc3MoZSwgdCwgbikgfSwgX3JlbW92ZURhdGE6IGZ1bmN0aW9uIChlLCB0KSB7IEsucmVtb3ZlKGUsIHQpIH0gfSksIHcuZm4uZXh0ZW5kKHsgZGF0YTogZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIsIGksIG8gPSB0aGlzWzBdLCBhID0gbyAmJiBvLmF0dHJpYnV0ZXM7IGlmICh2b2lkIDAgPT09IGUpIHsgaWYgKHRoaXMubGVuZ3RoICYmIChpID0gSi5nZXQobyksIDEgPT09IG8ubm9kZVR5cGUgJiYgIUsuZ2V0KG8sIFwiaGFzRGF0YUF0dHJzXCIpKSkgeyBuID0gYS5sZW5ndGg7IHdoaWxlIChuLS0pIGFbbl0gJiYgMCA9PT0gKHIgPSBhW25dLm5hbWUpLmluZGV4T2YoXCJkYXRhLVwiKSAmJiAociA9IFEoci5zbGljZSg1KSksIG5lKG8sIHIsIGlbcl0pKTsgSy5zZXQobywgXCJoYXNEYXRhQXR0cnNcIiwgITApIH0gcmV0dXJuIGkgfSByZXR1cm4gXCJvYmplY3RcIiA9PSB0eXBlb2YgZSA/IHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7IEouc2V0KHRoaXMsIGUpIH0pIDogXyh0aGlzLCBmdW5jdGlvbiAodCkgeyB2YXIgbjsgaWYgKG8gJiYgdm9pZCAwID09PSB0KSB7IGlmICh2b2lkIDAgIT09IChuID0gSi5nZXQobywgZSkpKSByZXR1cm4gbjsgaWYgKHZvaWQgMCAhPT0gKG4gPSBuZShvLCBlKSkpIHJldHVybiBuIH0gZWxzZSB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBKLnNldCh0aGlzLCBlLCB0KSB9KSB9LCBudWxsLCB0LCBhcmd1bWVudHMubGVuZ3RoID4gMSwgbnVsbCwgITApIH0sIHJlbW92ZURhdGE6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBKLnJlbW92ZSh0aGlzLCBlKSB9KSB9IH0pLCB3LmV4dGVuZCh7IHF1ZXVlOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgcjsgaWYgKGUpIHJldHVybiB0ID0gKHQgfHwgXCJmeFwiKSArIFwicXVldWVcIiwgciA9IEsuZ2V0KGUsIHQpLCBuICYmICghciB8fCBBcnJheS5pc0FycmF5KG4pID8gciA9IEsuYWNjZXNzKGUsIHQsIHcubWFrZUFycmF5KG4pKSA6IHIucHVzaChuKSksIHIgfHwgW10gfSwgZGVxdWV1ZTogZnVuY3Rpb24gKGUsIHQpIHsgdCA9IHQgfHwgXCJmeFwiOyB2YXIgbiA9IHcucXVldWUoZSwgdCksIHIgPSBuLmxlbmd0aCwgaSA9IG4uc2hpZnQoKSwgbyA9IHcuX3F1ZXVlSG9va3MoZSwgdCksIGEgPSBmdW5jdGlvbiAoKSB7IHcuZGVxdWV1ZShlLCB0KSB9OyBcImlucHJvZ3Jlc3NcIiA9PT0gaSAmJiAoaSA9IG4uc2hpZnQoKSwgci0tKSwgaSAmJiAoXCJmeFwiID09PSB0ICYmIG4udW5zaGlmdChcImlucHJvZ3Jlc3NcIiksIGRlbGV0ZSBvLnN0b3AsIGkuY2FsbChlLCBhLCBvKSksICFyICYmIG8gJiYgby5lbXB0eS5maXJlKCkgfSwgX3F1ZXVlSG9va3M6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gdCArIFwicXVldWVIb29rc1wiOyByZXR1cm4gSy5nZXQoZSwgbikgfHwgSy5hY2Nlc3MoZSwgbiwgeyBlbXB0eTogdy5DYWxsYmFja3MoXCJvbmNlIG1lbW9yeVwiKS5hZGQoZnVuY3Rpb24gKCkgeyBLLnJlbW92ZShlLCBbdCArIFwicXVldWVcIiwgbl0pIH0pIH0pIH0gfSksIHcuZm4uZXh0ZW5kKHsgcXVldWU6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gMjsgcmV0dXJuIFwic3RyaW5nXCIgIT0gdHlwZW9mIGUgJiYgKHQgPSBlLCBlID0gXCJmeFwiLCBuLS0pLCBhcmd1bWVudHMubGVuZ3RoIDwgbiA/IHcucXVldWUodGhpc1swXSwgZSkgOiB2b2lkIDAgPT09IHQgPyB0aGlzIDogdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgdmFyIG4gPSB3LnF1ZXVlKHRoaXMsIGUsIHQpOyB3Ll9xdWV1ZUhvb2tzKHRoaXMsIGUpLCBcImZ4XCIgPT09IGUgJiYgXCJpbnByb2dyZXNzXCIgIT09IG5bMF0gJiYgdy5kZXF1ZXVlKHRoaXMsIGUpIH0pIH0sIGRlcXVldWU6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB3LmRlcXVldWUodGhpcywgZSkgfSkgfSwgY2xlYXJRdWV1ZTogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHRoaXMucXVldWUoZSB8fCBcImZ4XCIsIFtdKSB9LCBwcm9taXNlOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IDEsIGkgPSB3LkRlZmVycmVkKCksIG8gPSB0aGlzLCBhID0gdGhpcy5sZW5ndGgsIHUgPSBmdW5jdGlvbiAoKSB7IC0tciB8fCBpLnJlc29sdmVXaXRoKG8sIFtvXSkgfTsgXCJzdHJpbmdcIiAhPSB0eXBlb2YgZSAmJiAodCA9IGUsIGUgPSB2b2lkIDApLCBlID0gZSB8fCBcImZ4XCI7IHdoaWxlIChhLS0pIChuID0gSy5nZXQob1thXSwgZSArIFwicXVldWVIb29rc1wiKSkgJiYgbi5lbXB0eSAmJiAocisrICwgbi5lbXB0eS5hZGQodSkpOyByZXR1cm4gdSgpLCBpLnByb21pc2UodCkgfSB9KTsgdmFyIHJlID0gL1srLV0/KD86XFxkKlxcLnwpXFxkKyg/OltlRV1bKy1dP1xcZCt8KS8uc291cmNlLCBpZSA9IG5ldyBSZWdFeHAoXCJeKD86KFsrLV0pPXwpKFwiICsgcmUgKyBcIikoW2EteiVdKikkXCIsIFwiaVwiKSwgb2UgPSBbXCJUb3BcIiwgXCJSaWdodFwiLCBcIkJvdHRvbVwiLCBcIkxlZnRcIl0sIGFlID0gZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIFwibm9uZVwiID09PSAoZSA9IHQgfHwgZSkuc3R5bGUuZGlzcGxheSB8fCBcIlwiID09PSBlLnN0eWxlLmRpc3BsYXkgJiYgdy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsIGUpICYmIFwibm9uZVwiID09PSB3LmNzcyhlLCBcImRpc3BsYXlcIikgfSwgdWUgPSBmdW5jdGlvbiAoZSwgdCwgbiwgcikgeyB2YXIgaSwgbywgYSA9IHt9OyBmb3IgKG8gaW4gdCkgYVtvXSA9IGUuc3R5bGVbb10sIGUuc3R5bGVbb10gPSB0W29dOyBpID0gbi5hcHBseShlLCByIHx8IFtdKTsgZm9yIChvIGluIHQpIGUuc3R5bGVbb10gPSBhW29dOyByZXR1cm4gaSB9OyBmdW5jdGlvbiBzZShlLCB0LCBuLCByKSB7IHZhciBpLCBvLCBhID0gMjAsIHUgPSByID8gZnVuY3Rpb24gKCkgeyByZXR1cm4gci5jdXIoKSB9IDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdy5jc3MoZSwgdCwgXCJcIikgfSwgcyA9IHUoKSwgbCA9IG4gJiYgblszXSB8fCAody5jc3NOdW1iZXJbdF0gPyBcIlwiIDogXCJweFwiKSwgYyA9ICh3LmNzc051bWJlclt0XSB8fCBcInB4XCIgIT09IGwgJiYgK3MpICYmIGllLmV4ZWMody5jc3MoZSwgdCkpOyBpZiAoYyAmJiBjWzNdICE9PSBsKSB7IHMgLz0gMiwgbCA9IGwgfHwgY1szXSwgYyA9ICtzIHx8IDE7IHdoaWxlIChhLS0pIHcuc3R5bGUoZSwgdCwgYyArIGwpLCAoMSAtIG8pICogKDEgLSAobyA9IHUoKSAvIHMgfHwgLjUpKSA8PSAwICYmIChhID0gMCksIGMgLz0gbzsgYyAqPSAyLCB3LnN0eWxlKGUsIHQsIGMgKyBsKSwgbiA9IG4gfHwgW10gfSByZXR1cm4gbiAmJiAoYyA9ICtjIHx8ICtzIHx8IDAsIGkgPSBuWzFdID8gYyArIChuWzFdICsgMSkgKiBuWzJdIDogK25bMl0sIHIgJiYgKHIudW5pdCA9IGwsIHIuc3RhcnQgPSBjLCByLmVuZCA9IGkpKSwgaSB9IHZhciBsZSA9IHt9OyBmdW5jdGlvbiBjZShlKSB7IHZhciB0LCBuID0gZS5vd25lckRvY3VtZW50LCByID0gZS5ub2RlTmFtZSwgaSA9IGxlW3JdOyByZXR1cm4gaSB8fCAodCA9IG4uYm9keS5hcHBlbmRDaGlsZChuLmNyZWF0ZUVsZW1lbnQocikpLCBpID0gdy5jc3ModCwgXCJkaXNwbGF5XCIpLCB0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCksIFwibm9uZVwiID09PSBpICYmIChpID0gXCJibG9ja1wiKSwgbGVbcl0gPSBpLCBpKSB9IGZ1bmN0aW9uIGZlKGUsIHQpIHsgZm9yICh2YXIgbiwgciwgaSA9IFtdLCBvID0gMCwgYSA9IGUubGVuZ3RoOyBvIDwgYTsgbysrKShyID0gZVtvXSkuc3R5bGUgJiYgKG4gPSByLnN0eWxlLmRpc3BsYXksIHQgPyAoXCJub25lXCIgPT09IG4gJiYgKGlbb10gPSBLLmdldChyLCBcImRpc3BsYXlcIikgfHwgbnVsbCwgaVtvXSB8fCAoci5zdHlsZS5kaXNwbGF5ID0gXCJcIikpLCBcIlwiID09PSByLnN0eWxlLmRpc3BsYXkgJiYgYWUocikgJiYgKGlbb10gPSBjZShyKSkpIDogXCJub25lXCIgIT09IG4gJiYgKGlbb10gPSBcIm5vbmVcIiwgSy5zZXQociwgXCJkaXNwbGF5XCIsIG4pKSk7IGZvciAobyA9IDA7IG8gPCBhOyBvKyspbnVsbCAhPSBpW29dICYmIChlW29dLnN0eWxlLmRpc3BsYXkgPSBpW29dKTsgcmV0dXJuIGUgfSB3LmZuLmV4dGVuZCh7IHNob3c6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGZlKHRoaXMsICEwKSB9LCBoaWRlOiBmdW5jdGlvbiAoKSB7IHJldHVybiBmZSh0aGlzKSB9LCB0b2dnbGU6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBcImJvb2xlYW5cIiA9PSB0eXBlb2YgZSA/IGUgPyB0aGlzLnNob3coKSA6IHRoaXMuaGlkZSgpIDogdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgYWUodGhpcykgPyB3KHRoaXMpLnNob3coKSA6IHcodGhpcykuaGlkZSgpIH0pIH0gfSk7IHZhciBkZSA9IC9eKD86Y2hlY2tib3h8cmFkaW8pJC9pLCBwZSA9IC88KFthLXpdW15cXC9cXDA+XFx4MjBcXHRcXHJcXG5cXGZdKykvaSwgaGUgPSAvXiR8Xm1vZHVsZSR8XFwvKD86amF2YXxlY21hKXNjcmlwdC9pLCBnZSA9IHsgb3B0aW9uOiBbMSwgXCI8c2VsZWN0IG11bHRpcGxlPSdtdWx0aXBsZSc+XCIsIFwiPC9zZWxlY3Q+XCJdLCB0aGVhZDogWzEsIFwiPHRhYmxlPlwiLCBcIjwvdGFibGU+XCJdLCBjb2w6IFsyLCBcIjx0YWJsZT48Y29sZ3JvdXA+XCIsIFwiPC9jb2xncm91cD48L3RhYmxlPlwiXSwgdHI6IFsyLCBcIjx0YWJsZT48dGJvZHk+XCIsIFwiPC90Ym9keT48L3RhYmxlPlwiXSwgdGQ6IFszLCBcIjx0YWJsZT48dGJvZHk+PHRyPlwiLCBcIjwvdHI+PC90Ym9keT48L3RhYmxlPlwiXSwgX2RlZmF1bHQ6IFswLCBcIlwiLCBcIlwiXSB9OyBnZS5vcHRncm91cCA9IGdlLm9wdGlvbiwgZ2UudGJvZHkgPSBnZS50Zm9vdCA9IGdlLmNvbGdyb3VwID0gZ2UuY2FwdGlvbiA9IGdlLnRoZWFkLCBnZS50aCA9IGdlLnRkOyBmdW5jdGlvbiB2ZShlLCB0KSB7IHZhciBuOyByZXR1cm4gbiA9IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGUuZ2V0RWxlbWVudHNCeVRhZ05hbWUgPyBlLmdldEVsZW1lbnRzQnlUYWdOYW1lKHQgfHwgXCIqXCIpIDogXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgZS5xdWVyeVNlbGVjdG9yQWxsID8gZS5xdWVyeVNlbGVjdG9yQWxsKHQgfHwgXCIqXCIpIDogW10sIHZvaWQgMCA9PT0gdCB8fCB0ICYmIEQoZSwgdCkgPyB3Lm1lcmdlKFtlXSwgbikgOiBuIH0gZnVuY3Rpb24geWUoZSwgdCkgeyBmb3IgKHZhciBuID0gMCwgciA9IGUubGVuZ3RoOyBuIDwgcjsgbisrKUsuc2V0KGVbbl0sIFwiZ2xvYmFsRXZhbFwiLCAhdCB8fCBLLmdldCh0W25dLCBcImdsb2JhbEV2YWxcIikpIH0gdmFyIG1lID0gLzx8JiM/XFx3KzsvOyBmdW5jdGlvbiBiZShlLCB0LCBuLCByLCBpKSB7IGZvciAodmFyIG8sIGEsIHUsIHMsIGwsIGMsIGYgPSB0LmNyZWF0ZURvY3VtZW50RnJhZ21lbnQoKSwgZCA9IFtdLCBwID0gMCwgaCA9IGUubGVuZ3RoOyBwIDwgaDsgcCsrKWlmICgobyA9IGVbcF0pIHx8IDAgPT09IG8pIGlmIChcIm9iamVjdFwiID09PSBiKG8pKSB3Lm1lcmdlKGQsIG8ubm9kZVR5cGUgPyBbb10gOiBvKTsgZWxzZSBpZiAobWUudGVzdChvKSkgeyBhID0gYSB8fCBmLmFwcGVuZENoaWxkKHQuY3JlYXRlRWxlbWVudChcImRpdlwiKSksIHUgPSAocGUuZXhlYyhvKSB8fCBbXCJcIiwgXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCksIHMgPSBnZVt1XSB8fCBnZS5fZGVmYXVsdCwgYS5pbm5lckhUTUwgPSBzWzFdICsgdy5odG1sUHJlZmlsdGVyKG8pICsgc1syXSwgYyA9IHNbMF07IHdoaWxlIChjLS0pIGEgPSBhLmxhc3RDaGlsZDsgdy5tZXJnZShkLCBhLmNoaWxkTm9kZXMpLCAoYSA9IGYuZmlyc3RDaGlsZCkudGV4dENvbnRlbnQgPSBcIlwiIH0gZWxzZSBkLnB1c2godC5jcmVhdGVUZXh0Tm9kZShvKSk7IGYudGV4dENvbnRlbnQgPSBcIlwiLCBwID0gMDsgd2hpbGUgKG8gPSBkW3ArK10pIGlmIChyICYmIHcuaW5BcnJheShvLCByKSA+IC0xKSBpICYmIGkucHVzaChvKTsgZWxzZSBpZiAobCA9IHcuY29udGFpbnMoby5vd25lckRvY3VtZW50LCBvKSwgYSA9IHZlKGYuYXBwZW5kQ2hpbGQobyksIFwic2NyaXB0XCIpLCBsICYmIHllKGEpLCBuKSB7IGMgPSAwOyB3aGlsZSAobyA9IGFbYysrXSkgaGUudGVzdChvLnR5cGUgfHwgXCJcIikgJiYgbi5wdXNoKG8pIH0gcmV0dXJuIGYgfSAhZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHIuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpLmFwcGVuZENoaWxkKHIuY3JlYXRlRWxlbWVudChcImRpdlwiKSksIHQgPSByLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKTsgdC5zZXRBdHRyaWJ1dGUoXCJ0eXBlXCIsIFwicmFkaW9cIiksIHQuc2V0QXR0cmlidXRlKFwiY2hlY2tlZFwiLCBcImNoZWNrZWRcIiksIHQuc2V0QXR0cmlidXRlKFwibmFtZVwiLCBcInRcIiksIGUuYXBwZW5kQ2hpbGQodCksIGguY2hlY2tDbG9uZSA9IGUuY2xvbmVOb2RlKCEwKS5jbG9uZU5vZGUoITApLmxhc3RDaGlsZC5jaGVja2VkLCBlLmlubmVySFRNTCA9IFwiPHRleHRhcmVhPng8L3RleHRhcmVhPlwiLCBoLm5vQ2xvbmVDaGVja2VkID0gISFlLmNsb25lTm9kZSghMCkubGFzdENoaWxkLmRlZmF1bHRWYWx1ZSB9KCk7IHZhciB4ZSA9IHIuZG9jdW1lbnRFbGVtZW50LCB3ZSA9IC9ea2V5LywgQ2UgPSAvXig/Om1vdXNlfHBvaW50ZXJ8Y29udGV4dG1lbnV8ZHJhZ3xkcm9wKXxjbGljay8sIFRlID0gL14oW14uXSopKD86XFwuKC4rKXwpLzsgZnVuY3Rpb24gRWUoKSB7IHJldHVybiAhMCB9IGZ1bmN0aW9uIE5lKCkgeyByZXR1cm4gITEgfSBmdW5jdGlvbiBrZSgpIHsgdHJ5IHsgcmV0dXJuIHIuYWN0aXZlRWxlbWVudCB9IGNhdGNoIChlKSB7IH0gfSBmdW5jdGlvbiBBZShlLCB0LCBuLCByLCBpLCBvKSB7IHZhciBhLCB1OyBpZiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgdCkgeyBcInN0cmluZ1wiICE9IHR5cGVvZiBuICYmIChyID0gciB8fCBuLCBuID0gdm9pZCAwKTsgZm9yICh1IGluIHQpIEFlKGUsIHUsIG4sIHIsIHRbdV0sIG8pOyByZXR1cm4gZSB9IGlmIChudWxsID09IHIgJiYgbnVsbCA9PSBpID8gKGkgPSBuLCByID0gbiA9IHZvaWQgMCkgOiBudWxsID09IGkgJiYgKFwic3RyaW5nXCIgPT0gdHlwZW9mIG4gPyAoaSA9IHIsIHIgPSB2b2lkIDApIDogKGkgPSByLCByID0gbiwgbiA9IHZvaWQgMCkpLCAhMSA9PT0gaSkgaSA9IE5lOyBlbHNlIGlmICghaSkgcmV0dXJuIGU7IHJldHVybiAxID09PSBvICYmIChhID0gaSwgKGkgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdygpLm9mZihlKSwgYS5hcHBseSh0aGlzLCBhcmd1bWVudHMpIH0pLmd1aWQgPSBhLmd1aWQgfHwgKGEuZ3VpZCA9IHcuZ3VpZCsrKSksIGUuZWFjaChmdW5jdGlvbiAoKSB7IHcuZXZlbnQuYWRkKHRoaXMsIHQsIGksIHIsIG4pIH0pIH0gdy5ldmVudCA9IHsgZ2xvYmFsOiB7fSwgYWRkOiBmdW5jdGlvbiAoZSwgdCwgbiwgciwgaSkgeyB2YXIgbywgYSwgdSwgcywgbCwgYywgZiwgZCwgcCwgaCwgZywgdiA9IEsuZ2V0KGUpOyBpZiAodikgeyBuLmhhbmRsZXIgJiYgKG4gPSAobyA9IG4pLmhhbmRsZXIsIGkgPSBvLnNlbGVjdG9yKSwgaSAmJiB3LmZpbmQubWF0Y2hlc1NlbGVjdG9yKHhlLCBpKSwgbi5ndWlkIHx8IChuLmd1aWQgPSB3Lmd1aWQrKyksIChzID0gdi5ldmVudHMpIHx8IChzID0gdi5ldmVudHMgPSB7fSksIChhID0gdi5oYW5kbGUpIHx8IChhID0gdi5oYW5kbGUgPSBmdW5jdGlvbiAodCkgeyByZXR1cm4gXCJ1bmRlZmluZWRcIiAhPSB0eXBlb2YgdyAmJiB3LmV2ZW50LnRyaWdnZXJlZCAhPT0gdC50eXBlID8gdy5ldmVudC5kaXNwYXRjaC5hcHBseShlLCBhcmd1bWVudHMpIDogdm9pZCAwIH0pLCBsID0gKHQgPSAodCB8fCBcIlwiKS5tYXRjaChJKSB8fCBbXCJcIl0pLmxlbmd0aDsgd2hpbGUgKGwtLSkgcCA9IGcgPSAodSA9IFRlLmV4ZWModFtsXSkgfHwgW10pWzFdLCBoID0gKHVbMl0gfHwgXCJcIikuc3BsaXQoXCIuXCIpLnNvcnQoKSwgcCAmJiAoZiA9IHcuZXZlbnQuc3BlY2lhbFtwXSB8fCB7fSwgcCA9IChpID8gZi5kZWxlZ2F0ZVR5cGUgOiBmLmJpbmRUeXBlKSB8fCBwLCBmID0gdy5ldmVudC5zcGVjaWFsW3BdIHx8IHt9LCBjID0gdy5leHRlbmQoeyB0eXBlOiBwLCBvcmlnVHlwZTogZywgZGF0YTogciwgaGFuZGxlcjogbiwgZ3VpZDogbi5ndWlkLCBzZWxlY3RvcjogaSwgbmVlZHNDb250ZXh0OiBpICYmIHcuZXhwci5tYXRjaC5uZWVkc0NvbnRleHQudGVzdChpKSwgbmFtZXNwYWNlOiBoLmpvaW4oXCIuXCIpIH0sIG8pLCAoZCA9IHNbcF0pIHx8ICgoZCA9IHNbcF0gPSBbXSkuZGVsZWdhdGVDb3VudCA9IDAsIGYuc2V0dXAgJiYgITEgIT09IGYuc2V0dXAuY2FsbChlLCByLCBoLCBhKSB8fCBlLmFkZEV2ZW50TGlzdGVuZXIgJiYgZS5hZGRFdmVudExpc3RlbmVyKHAsIGEpKSwgZi5hZGQgJiYgKGYuYWRkLmNhbGwoZSwgYyksIGMuaGFuZGxlci5ndWlkIHx8IChjLmhhbmRsZXIuZ3VpZCA9IG4uZ3VpZCkpLCBpID8gZC5zcGxpY2UoZC5kZWxlZ2F0ZUNvdW50KyssIDAsIGMpIDogZC5wdXNoKGMpLCB3LmV2ZW50Lmdsb2JhbFtwXSA9ICEwKSB9IH0sIHJlbW92ZTogZnVuY3Rpb24gKGUsIHQsIG4sIHIsIGkpIHsgdmFyIG8sIGEsIHUsIHMsIGwsIGMsIGYsIGQsIHAsIGgsIGcsIHYgPSBLLmhhc0RhdGEoZSkgJiYgSy5nZXQoZSk7IGlmICh2ICYmIChzID0gdi5ldmVudHMpKSB7IGwgPSAodCA9ICh0IHx8IFwiXCIpLm1hdGNoKEkpIHx8IFtcIlwiXSkubGVuZ3RoOyB3aGlsZSAobC0tKSBpZiAodSA9IFRlLmV4ZWModFtsXSkgfHwgW10sIHAgPSBnID0gdVsxXSwgaCA9ICh1WzJdIHx8IFwiXCIpLnNwbGl0KFwiLlwiKS5zb3J0KCksIHApIHsgZiA9IHcuZXZlbnQuc3BlY2lhbFtwXSB8fCB7fSwgZCA9IHNbcCA9IChyID8gZi5kZWxlZ2F0ZVR5cGUgOiBmLmJpbmRUeXBlKSB8fCBwXSB8fCBbXSwgdSA9IHVbMl0gJiYgbmV3IFJlZ0V4cChcIihefFxcXFwuKVwiICsgaC5qb2luKFwiXFxcXC4oPzouKlxcXFwufClcIikgKyBcIihcXFxcLnwkKVwiKSwgYSA9IG8gPSBkLmxlbmd0aDsgd2hpbGUgKG8tLSkgYyA9IGRbb10sICFpICYmIGcgIT09IGMub3JpZ1R5cGUgfHwgbiAmJiBuLmd1aWQgIT09IGMuZ3VpZCB8fCB1ICYmICF1LnRlc3QoYy5uYW1lc3BhY2UpIHx8IHIgJiYgciAhPT0gYy5zZWxlY3RvciAmJiAoXCIqKlwiICE9PSByIHx8ICFjLnNlbGVjdG9yKSB8fCAoZC5zcGxpY2UobywgMSksIGMuc2VsZWN0b3IgJiYgZC5kZWxlZ2F0ZUNvdW50LS0gLCBmLnJlbW92ZSAmJiBmLnJlbW92ZS5jYWxsKGUsIGMpKTsgYSAmJiAhZC5sZW5ndGggJiYgKGYudGVhcmRvd24gJiYgITEgIT09IGYudGVhcmRvd24uY2FsbChlLCBoLCB2LmhhbmRsZSkgfHwgdy5yZW1vdmVFdmVudChlLCBwLCB2LmhhbmRsZSksIGRlbGV0ZSBzW3BdKSB9IGVsc2UgZm9yIChwIGluIHMpIHcuZXZlbnQucmVtb3ZlKGUsIHAgKyB0W2xdLCBuLCByLCAhMCk7IHcuaXNFbXB0eU9iamVjdChzKSAmJiBLLnJlbW92ZShlLCBcImhhbmRsZSBldmVudHNcIikgfSB9LCBkaXNwYXRjaDogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSB3LmV2ZW50LmZpeChlKSwgbiwgciwgaSwgbywgYSwgdSwgcyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKSwgbCA9IChLLmdldCh0aGlzLCBcImV2ZW50c1wiKSB8fCB7fSlbdC50eXBlXSB8fCBbXSwgYyA9IHcuZXZlbnQuc3BlY2lhbFt0LnR5cGVdIHx8IHt9OyBmb3IgKHNbMF0gPSB0LCBuID0gMTsgbiA8IGFyZ3VtZW50cy5sZW5ndGg7IG4rKylzW25dID0gYXJndW1lbnRzW25dOyBpZiAodC5kZWxlZ2F0ZVRhcmdldCA9IHRoaXMsICFjLnByZURpc3BhdGNoIHx8ICExICE9PSBjLnByZURpc3BhdGNoLmNhbGwodGhpcywgdCkpIHsgdSA9IHcuZXZlbnQuaGFuZGxlcnMuY2FsbCh0aGlzLCB0LCBsKSwgbiA9IDA7IHdoaWxlICgobyA9IHVbbisrXSkgJiYgIXQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSkgeyB0LmN1cnJlbnRUYXJnZXQgPSBvLmVsZW0sIHIgPSAwOyB3aGlsZSAoKGEgPSBvLmhhbmRsZXJzW3IrK10pICYmICF0LmlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkKCkpIHQucm5hbWVzcGFjZSAmJiAhdC5ybmFtZXNwYWNlLnRlc3QoYS5uYW1lc3BhY2UpIHx8ICh0LmhhbmRsZU9iaiA9IGEsIHQuZGF0YSA9IGEuZGF0YSwgdm9pZCAwICE9PSAoaSA9ICgody5ldmVudC5zcGVjaWFsW2Eub3JpZ1R5cGVdIHx8IHt9KS5oYW5kbGUgfHwgYS5oYW5kbGVyKS5hcHBseShvLmVsZW0sIHMpKSAmJiAhMSA9PT0gKHQucmVzdWx0ID0gaSkgJiYgKHQucHJldmVudERlZmF1bHQoKSwgdC5zdG9wUHJvcGFnYXRpb24oKSkpIH0gcmV0dXJuIGMucG9zdERpc3BhdGNoICYmIGMucG9zdERpc3BhdGNoLmNhbGwodGhpcywgdCksIHQucmVzdWx0IH0gfSwgaGFuZGxlcnM6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuLCByLCBpLCBvLCBhLCB1ID0gW10sIHMgPSB0LmRlbGVnYXRlQ291bnQsIGwgPSBlLnRhcmdldDsgaWYgKHMgJiYgbC5ub2RlVHlwZSAmJiAhKFwiY2xpY2tcIiA9PT0gZS50eXBlICYmIGUuYnV0dG9uID49IDEpKSBmb3IgKDsgbCAhPT0gdGhpczsgbCA9IGwucGFyZW50Tm9kZSB8fCB0aGlzKWlmICgxID09PSBsLm5vZGVUeXBlICYmIChcImNsaWNrXCIgIT09IGUudHlwZSB8fCAhMCAhPT0gbC5kaXNhYmxlZCkpIHsgZm9yIChvID0gW10sIGEgPSB7fSwgbiA9IDA7IG4gPCBzOyBuKyspdm9pZCAwID09PSBhW2kgPSAociA9IHRbbl0pLnNlbGVjdG9yICsgXCIgXCJdICYmIChhW2ldID0gci5uZWVkc0NvbnRleHQgPyB3KGksIHRoaXMpLmluZGV4KGwpID4gLTEgOiB3LmZpbmQoaSwgdGhpcywgbnVsbCwgW2xdKS5sZW5ndGgpLCBhW2ldICYmIG8ucHVzaChyKTsgby5sZW5ndGggJiYgdS5wdXNoKHsgZWxlbTogbCwgaGFuZGxlcnM6IG8gfSkgfSByZXR1cm4gbCA9IHRoaXMsIHMgPCB0Lmxlbmd0aCAmJiB1LnB1c2goeyBlbGVtOiBsLCBoYW5kbGVyczogdC5zbGljZShzKSB9KSwgdSB9LCBhZGRQcm9wOiBmdW5jdGlvbiAoZSwgdCkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkody5FdmVudC5wcm90b3R5cGUsIGUsIHsgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIGdldDogZyh0KSA/IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXMub3JpZ2luYWxFdmVudCkgcmV0dXJuIHQodGhpcy5vcmlnaW5hbEV2ZW50KSB9IDogZnVuY3Rpb24gKCkgeyBpZiAodGhpcy5vcmlnaW5hbEV2ZW50KSByZXR1cm4gdGhpcy5vcmlnaW5hbEV2ZW50W2VdIH0sIHNldDogZnVuY3Rpb24gKHQpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsIGUsIHsgZW51bWVyYWJsZTogITAsIGNvbmZpZ3VyYWJsZTogITAsIHdyaXRhYmxlOiAhMCwgdmFsdWU6IHQgfSkgfSB9KSB9LCBmaXg6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBlW3cuZXhwYW5kb10gPyBlIDogbmV3IHcuRXZlbnQoZSkgfSwgc3BlY2lhbDogeyBsb2FkOiB7IG5vQnViYmxlOiAhMCB9LCBmb2N1czogeyB0cmlnZ2VyOiBmdW5jdGlvbiAoKSB7IGlmICh0aGlzICE9PSBrZSgpICYmIHRoaXMuZm9jdXMpIHJldHVybiB0aGlzLmZvY3VzKCksICExIH0sIGRlbGVnYXRlVHlwZTogXCJmb2N1c2luXCIgfSwgYmx1cjogeyB0cmlnZ2VyOiBmdW5jdGlvbiAoKSB7IGlmICh0aGlzID09PSBrZSgpICYmIHRoaXMuYmx1cikgcmV0dXJuIHRoaXMuYmx1cigpLCAhMSB9LCBkZWxlZ2F0ZVR5cGU6IFwiZm9jdXNvdXRcIiB9LCBjbGljazogeyB0cmlnZ2VyOiBmdW5jdGlvbiAoKSB7IGlmIChcImNoZWNrYm94XCIgPT09IHRoaXMudHlwZSAmJiB0aGlzLmNsaWNrICYmIEQodGhpcywgXCJpbnB1dFwiKSkgcmV0dXJuIHRoaXMuY2xpY2soKSwgITEgfSwgX2RlZmF1bHQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBEKGUudGFyZ2V0LCBcImFcIikgfSB9LCBiZWZvcmV1bmxvYWQ6IHsgcG9zdERpc3BhdGNoOiBmdW5jdGlvbiAoZSkgeyB2b2lkIDAgIT09IGUucmVzdWx0ICYmIGUub3JpZ2luYWxFdmVudCAmJiAoZS5vcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID0gZS5yZXN1bHQpIH0gfSB9IH0sIHcucmVtb3ZlRXZlbnQgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgJiYgZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsIG4pIH0sIHcuRXZlbnQgPSBmdW5jdGlvbiAoZSwgdCkgeyBpZiAoISh0aGlzIGluc3RhbmNlb2Ygdy5FdmVudCkpIHJldHVybiBuZXcgdy5FdmVudChlLCB0KTsgZSAmJiBlLnR5cGUgPyAodGhpcy5vcmlnaW5hbEV2ZW50ID0gZSwgdGhpcy50eXBlID0gZS50eXBlLCB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IGUuZGVmYXVsdFByZXZlbnRlZCB8fCB2b2lkIDAgPT09IGUuZGVmYXVsdFByZXZlbnRlZCAmJiAhMSA9PT0gZS5yZXR1cm5WYWx1ZSA/IEVlIDogTmUsIHRoaXMudGFyZ2V0ID0gZS50YXJnZXQgJiYgMyA9PT0gZS50YXJnZXQubm9kZVR5cGUgPyBlLnRhcmdldC5wYXJlbnROb2RlIDogZS50YXJnZXQsIHRoaXMuY3VycmVudFRhcmdldCA9IGUuY3VycmVudFRhcmdldCwgdGhpcy5yZWxhdGVkVGFyZ2V0ID0gZS5yZWxhdGVkVGFyZ2V0KSA6IHRoaXMudHlwZSA9IGUsIHQgJiYgdy5leHRlbmQodGhpcywgdCksIHRoaXMudGltZVN0YW1wID0gZSAmJiBlLnRpbWVTdGFtcCB8fCBEYXRlLm5vdygpLCB0aGlzW3cuZXhwYW5kb10gPSAhMCB9LCB3LkV2ZW50LnByb3RvdHlwZSA9IHsgY29uc3RydWN0b3I6IHcuRXZlbnQsIGlzRGVmYXVsdFByZXZlbnRlZDogTmUsIGlzUHJvcGFnYXRpb25TdG9wcGVkOiBOZSwgaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQ6IE5lLCBpc1NpbXVsYXRlZDogITEsIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbiAoKSB7IHZhciBlID0gdGhpcy5vcmlnaW5hbEV2ZW50OyB0aGlzLmlzRGVmYXVsdFByZXZlbnRlZCA9IEVlLCBlICYmICF0aGlzLmlzU2ltdWxhdGVkICYmIGUucHJldmVudERlZmF1bHQoKSB9LCBzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uICgpIHsgdmFyIGUgPSB0aGlzLm9yaWdpbmFsRXZlbnQ7IHRoaXMuaXNQcm9wYWdhdGlvblN0b3BwZWQgPSBFZSwgZSAmJiAhdGhpcy5pc1NpbXVsYXRlZCAmJiBlLnN0b3BQcm9wYWdhdGlvbigpIH0sIHN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbjogZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHRoaXMub3JpZ2luYWxFdmVudDsgdGhpcy5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IEVlLCBlICYmICF0aGlzLmlzU2ltdWxhdGVkICYmIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCksIHRoaXMuc3RvcFByb3BhZ2F0aW9uKCkgfSB9LCB3LmVhY2goeyBhbHRLZXk6ICEwLCBidWJibGVzOiAhMCwgY2FuY2VsYWJsZTogITAsIGNoYW5nZWRUb3VjaGVzOiAhMCwgY3RybEtleTogITAsIGRldGFpbDogITAsIGV2ZW50UGhhc2U6ICEwLCBtZXRhS2V5OiAhMCwgcGFnZVg6ICEwLCBwYWdlWTogITAsIHNoaWZ0S2V5OiAhMCwgdmlldzogITAsIFwiY2hhclwiOiAhMCwgY2hhckNvZGU6ICEwLCBrZXk6ICEwLCBrZXlDb2RlOiAhMCwgYnV0dG9uOiAhMCwgYnV0dG9uczogITAsIGNsaWVudFg6ICEwLCBjbGllbnRZOiAhMCwgb2Zmc2V0WDogITAsIG9mZnNldFk6ICEwLCBwb2ludGVySWQ6ICEwLCBwb2ludGVyVHlwZTogITAsIHNjcmVlblg6ICEwLCBzY3JlZW5ZOiAhMCwgdGFyZ2V0VG91Y2hlczogITAsIHRvRWxlbWVudDogITAsIHRvdWNoZXM6ICEwLCB3aGljaDogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBlLmJ1dHRvbjsgcmV0dXJuIG51bGwgPT0gZS53aGljaCAmJiB3ZS50ZXN0KGUudHlwZSkgPyBudWxsICE9IGUuY2hhckNvZGUgPyBlLmNoYXJDb2RlIDogZS5rZXlDb2RlIDogIWUud2hpY2ggJiYgdm9pZCAwICE9PSB0ICYmIENlLnRlc3QoZS50eXBlKSA/IDEgJiB0ID8gMSA6IDIgJiB0ID8gMyA6IDQgJiB0ID8gMiA6IDAgOiBlLndoaWNoIH0gfSwgdy5ldmVudC5hZGRQcm9wKSwgdy5lYWNoKHsgbW91c2VlbnRlcjogXCJtb3VzZW92ZXJcIiwgbW91c2VsZWF2ZTogXCJtb3VzZW91dFwiLCBwb2ludGVyZW50ZXI6IFwicG9pbnRlcm92ZXJcIiwgcG9pbnRlcmxlYXZlOiBcInBvaW50ZXJvdXRcIiB9LCBmdW5jdGlvbiAoZSwgdCkgeyB3LmV2ZW50LnNwZWNpYWxbZV0gPSB7IGRlbGVnYXRlVHlwZTogdCwgYmluZFR5cGU6IHQsIGhhbmRsZTogZnVuY3Rpb24gKGUpIHsgdmFyIG4sIHIgPSB0aGlzLCBpID0gZS5yZWxhdGVkVGFyZ2V0LCBvID0gZS5oYW5kbGVPYmo7IHJldHVybiBpICYmIChpID09PSByIHx8IHcuY29udGFpbnMociwgaSkpIHx8IChlLnR5cGUgPSBvLm9yaWdUeXBlLCBuID0gby5oYW5kbGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyksIGUudHlwZSA9IHQpLCBuIH0gfSB9KSwgdy5mbi5leHRlbmQoeyBvbjogZnVuY3Rpb24gKGUsIHQsIG4sIHIpIHsgcmV0dXJuIEFlKHRoaXMsIGUsIHQsIG4sIHIpIH0sIG9uZTogZnVuY3Rpb24gKGUsIHQsIG4sIHIpIHsgcmV0dXJuIEFlKHRoaXMsIGUsIHQsIG4sIHIsIDEpIH0sIG9mZjogZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGk7IGlmIChlICYmIGUucHJldmVudERlZmF1bHQgJiYgZS5oYW5kbGVPYmopIHJldHVybiByID0gZS5oYW5kbGVPYmosIHcoZS5kZWxlZ2F0ZVRhcmdldCkub2ZmKHIubmFtZXNwYWNlID8gci5vcmlnVHlwZSArIFwiLlwiICsgci5uYW1lc3BhY2UgOiByLm9yaWdUeXBlLCByLnNlbGVjdG9yLCByLmhhbmRsZXIpLCB0aGlzOyBpZiAoXCJvYmplY3RcIiA9PSB0eXBlb2YgZSkgeyBmb3IgKGkgaW4gZSkgdGhpcy5vZmYoaSwgdCwgZVtpXSk7IHJldHVybiB0aGlzIH0gcmV0dXJuICExICE9PSB0ICYmIFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgdCB8fCAobiA9IHQsIHQgPSB2b2lkIDApLCAhMSA9PT0gbiAmJiAobiA9IE5lKSwgdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgdy5ldmVudC5yZW1vdmUodGhpcywgZSwgbiwgdCkgfSkgfSB9KTsgdmFyIERlID0gLzwoPyFhcmVhfGJyfGNvbHxlbWJlZHxocnxpbWd8aW5wdXR8bGlua3xtZXRhfHBhcmFtKSgoW2Etel1bXlxcL1xcMD5cXHgyMFxcdFxcclxcblxcZl0qKVtePl0qKVxcLz4vZ2ksIFNlID0gLzxzY3JpcHR8PHN0eWxlfDxsaW5rL2ksIExlID0gL2NoZWNrZWRcXHMqKD86W149XXw9XFxzKi5jaGVja2VkLikvaSwgamUgPSAvXlxccyo8ISg/OlxcW0NEQVRBXFxbfC0tKXwoPzpcXF1cXF18LS0pPlxccyokL2c7IGZ1bmN0aW9uIHFlKGUsIHQpIHsgcmV0dXJuIEQoZSwgXCJ0YWJsZVwiKSAmJiBEKDExICE9PSB0Lm5vZGVUeXBlID8gdCA6IHQuZmlyc3RDaGlsZCwgXCJ0clwiKSA/IHcoZSkuY2hpbGRyZW4oXCJ0Ym9keVwiKVswXSB8fCBlIDogZSB9IGZ1bmN0aW9uIE9lKGUpIHsgcmV0dXJuIGUudHlwZSA9IChudWxsICE9PSBlLmdldEF0dHJpYnV0ZShcInR5cGVcIikpICsgXCIvXCIgKyBlLnR5cGUsIGUgfSBmdW5jdGlvbiBQZShlKSB7IHJldHVybiBcInRydWUvXCIgPT09IChlLnR5cGUgfHwgXCJcIikuc2xpY2UoMCwgNSkgPyBlLnR5cGUgPSBlLnR5cGUuc2xpY2UoNSkgOiBlLnJlbW92ZUF0dHJpYnV0ZShcInR5cGVcIiksIGUgfSBmdW5jdGlvbiBIZShlLCB0KSB7IHZhciBuLCByLCBpLCBvLCBhLCB1LCBzLCBsOyBpZiAoMSA9PT0gdC5ub2RlVHlwZSkgeyBpZiAoSy5oYXNEYXRhKGUpICYmIChvID0gSy5hY2Nlc3MoZSksIGEgPSBLLnNldCh0LCBvKSwgbCA9IG8uZXZlbnRzKSkgeyBkZWxldGUgYS5oYW5kbGUsIGEuZXZlbnRzID0ge307IGZvciAoaSBpbiBsKSBmb3IgKG4gPSAwLCByID0gbFtpXS5sZW5ndGg7IG4gPCByOyBuKyspdy5ldmVudC5hZGQodCwgaSwgbFtpXVtuXSkgfSBKLmhhc0RhdGEoZSkgJiYgKHUgPSBKLmFjY2VzcyhlKSwgcyA9IHcuZXh0ZW5kKHt9LCB1KSwgSi5zZXQodCwgcykpIH0gfSBmdW5jdGlvbiBJZShlLCB0KSB7IHZhciBuID0gdC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOyBcImlucHV0XCIgPT09IG4gJiYgZGUudGVzdChlLnR5cGUpID8gdC5jaGVja2VkID0gZS5jaGVja2VkIDogXCJpbnB1dFwiICE9PSBuICYmIFwidGV4dGFyZWFcIiAhPT0gbiB8fCAodC5kZWZhdWx0VmFsdWUgPSBlLmRlZmF1bHRWYWx1ZSkgfSBmdW5jdGlvbiBSZShlLCB0LCBuLCByKSB7IHQgPSBhLmFwcGx5KFtdLCB0KTsgdmFyIGksIG8sIHUsIHMsIGwsIGMsIGYgPSAwLCBkID0gZS5sZW5ndGgsIHAgPSBkIC0gMSwgdiA9IHRbMF0sIHkgPSBnKHYpOyBpZiAoeSB8fCBkID4gMSAmJiBcInN0cmluZ1wiID09IHR5cGVvZiB2ICYmICFoLmNoZWNrQ2xvbmUgJiYgTGUudGVzdCh2KSkgcmV0dXJuIGUuZWFjaChmdW5jdGlvbiAoaSkgeyB2YXIgbyA9IGUuZXEoaSk7IHkgJiYgKHRbMF0gPSB2LmNhbGwodGhpcywgaSwgby5odG1sKCkpKSwgUmUobywgdCwgbiwgcikgfSk7IGlmIChkICYmIChpID0gYmUodCwgZVswXS5vd25lckRvY3VtZW50LCAhMSwgZSwgciksIG8gPSBpLmZpcnN0Q2hpbGQsIDEgPT09IGkuY2hpbGROb2Rlcy5sZW5ndGggJiYgKGkgPSBvKSwgbyB8fCByKSkgeyBmb3IgKHMgPSAodSA9IHcubWFwKHZlKGksIFwic2NyaXB0XCIpLCBPZSkpLmxlbmd0aDsgZiA8IGQ7IGYrKylsID0gaSwgZiAhPT0gcCAmJiAobCA9IHcuY2xvbmUobCwgITAsICEwKSwgcyAmJiB3Lm1lcmdlKHUsIHZlKGwsIFwic2NyaXB0XCIpKSksIG4uY2FsbChlW2ZdLCBsLCBmKTsgaWYgKHMpIGZvciAoYyA9IHVbdS5sZW5ndGggLSAxXS5vd25lckRvY3VtZW50LCB3Lm1hcCh1LCBQZSksIGYgPSAwOyBmIDwgczsgZisrKWwgPSB1W2ZdLCBoZS50ZXN0KGwudHlwZSB8fCBcIlwiKSAmJiAhSy5hY2Nlc3MobCwgXCJnbG9iYWxFdmFsXCIpICYmIHcuY29udGFpbnMoYywgbCkgJiYgKGwuc3JjICYmIFwibW9kdWxlXCIgIT09IChsLnR5cGUgfHwgXCJcIikudG9Mb3dlckNhc2UoKSA/IHcuX2V2YWxVcmwgJiYgdy5fZXZhbFVybChsLnNyYykgOiBtKGwudGV4dENvbnRlbnQucmVwbGFjZShqZSwgXCJcIiksIGMsIGwpKSB9IHJldHVybiBlIH0gZnVuY3Rpb24gQmUoZSwgdCwgbikgeyBmb3IgKHZhciByLCBpID0gdCA/IHcuZmlsdGVyKHQsIGUpIDogZSwgbyA9IDA7IG51bGwgIT0gKHIgPSBpW29dKTsgbysrKW4gfHwgMSAhPT0gci5ub2RlVHlwZSB8fCB3LmNsZWFuRGF0YSh2ZShyKSksIHIucGFyZW50Tm9kZSAmJiAobiAmJiB3LmNvbnRhaW5zKHIub3duZXJEb2N1bWVudCwgcikgJiYgeWUodmUociwgXCJzY3JpcHRcIikpLCByLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocikpOyByZXR1cm4gZSB9IHcuZXh0ZW5kKHsgaHRtbFByZWZpbHRlcjogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGUucmVwbGFjZShEZSwgXCI8JDE+PC8kMj5cIikgfSwgY2xvbmU6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHZhciByLCBpLCBvLCBhLCB1ID0gZS5jbG9uZU5vZGUoITApLCBzID0gdy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsIGUpOyBpZiAoIShoLm5vQ2xvbmVDaGVja2VkIHx8IDEgIT09IGUubm9kZVR5cGUgJiYgMTEgIT09IGUubm9kZVR5cGUgfHwgdy5pc1hNTERvYyhlKSkpIGZvciAoYSA9IHZlKHUpLCByID0gMCwgaSA9IChvID0gdmUoZSkpLmxlbmd0aDsgciA8IGk7IHIrKylJZShvW3JdLCBhW3JdKTsgaWYgKHQpIGlmIChuKSBmb3IgKG8gPSBvIHx8IHZlKGUpLCBhID0gYSB8fCB2ZSh1KSwgciA9IDAsIGkgPSBvLmxlbmd0aDsgciA8IGk7IHIrKylIZShvW3JdLCBhW3JdKTsgZWxzZSBIZShlLCB1KTsgcmV0dXJuIChhID0gdmUodSwgXCJzY3JpcHRcIikpLmxlbmd0aCA+IDAgJiYgeWUoYSwgIXMgJiYgdmUoZSwgXCJzY3JpcHRcIikpLCB1IH0sIGNsZWFuRGF0YTogZnVuY3Rpb24gKGUpIHsgZm9yICh2YXIgdCwgbiwgciwgaSA9IHcuZXZlbnQuc3BlY2lhbCwgbyA9IDA7IHZvaWQgMCAhPT0gKG4gPSBlW29dKTsgbysrKWlmIChZKG4pKSB7IGlmICh0ID0gbltLLmV4cGFuZG9dKSB7IGlmICh0LmV2ZW50cykgZm9yIChyIGluIHQuZXZlbnRzKSBpW3JdID8gdy5ldmVudC5yZW1vdmUobiwgcikgOiB3LnJlbW92ZUV2ZW50KG4sIHIsIHQuaGFuZGxlKTsgbltLLmV4cGFuZG9dID0gdm9pZCAwIH0gbltKLmV4cGFuZG9dICYmIChuW0ouZXhwYW5kb10gPSB2b2lkIDApIH0gfSB9KSwgdy5mbi5leHRlbmQoeyBkZXRhY2g6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBCZSh0aGlzLCBlLCAhMCkgfSwgcmVtb3ZlOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gQmUodGhpcywgZSkgfSwgdGV4dDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF8odGhpcywgZnVuY3Rpb24gKGUpIHsgcmV0dXJuIHZvaWQgMCA9PT0gZSA/IHcudGV4dCh0aGlzKSA6IHRoaXMuZW1wdHkoKS5lYWNoKGZ1bmN0aW9uICgpIHsgMSAhPT0gdGhpcy5ub2RlVHlwZSAmJiAxMSAhPT0gdGhpcy5ub2RlVHlwZSAmJiA5ICE9PSB0aGlzLm5vZGVUeXBlIHx8ICh0aGlzLnRleHRDb250ZW50ID0gZSkgfSkgfSwgbnVsbCwgZSwgYXJndW1lbnRzLmxlbmd0aCkgfSwgYXBwZW5kOiBmdW5jdGlvbiAoKSB7IHJldHVybiBSZSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlKSB7IDEgIT09IHRoaXMubm9kZVR5cGUgJiYgMTEgIT09IHRoaXMubm9kZVR5cGUgJiYgOSAhPT0gdGhpcy5ub2RlVHlwZSB8fCBxZSh0aGlzLCBlKS5hcHBlbmRDaGlsZChlKSB9KSB9LCBwcmVwZW5kOiBmdW5jdGlvbiAoKSB7IHJldHVybiBSZSh0aGlzLCBhcmd1bWVudHMsIGZ1bmN0aW9uIChlKSB7IGlmICgxID09PSB0aGlzLm5vZGVUeXBlIHx8IDExID09PSB0aGlzLm5vZGVUeXBlIHx8IDkgPT09IHRoaXMubm9kZVR5cGUpIHsgdmFyIHQgPSBxZSh0aGlzLCBlKTsgdC5pbnNlcnRCZWZvcmUoZSwgdC5maXJzdENoaWxkKSB9IH0pIH0sIGJlZm9yZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gUmUodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZSkgeyB0aGlzLnBhcmVudE5vZGUgJiYgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCB0aGlzKSB9KSB9LCBhZnRlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gUmUodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAoZSkgeyB0aGlzLnBhcmVudE5vZGUgJiYgdGhpcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShlLCB0aGlzLm5leHRTaWJsaW5nKSB9KSB9LCBlbXB0eTogZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBlLCB0ID0gMDsgbnVsbCAhPSAoZSA9IHRoaXNbdF0pOyB0KyspMSA9PT0gZS5ub2RlVHlwZSAmJiAody5jbGVhbkRhdGEodmUoZSwgITEpKSwgZS50ZXh0Q29udGVudCA9IFwiXCIpOyByZXR1cm4gdGhpcyB9LCBjbG9uZTogZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIGUgPSBudWxsICE9IGUgJiYgZSwgdCA9IG51bGwgPT0gdCA/IGUgOiB0LCB0aGlzLm1hcChmdW5jdGlvbiAoKSB7IHJldHVybiB3LmNsb25lKHRoaXMsIGUsIHQpIH0pIH0sIGh0bWw6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfKHRoaXMsIGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gdGhpc1swXSB8fCB7fSwgbiA9IDAsIHIgPSB0aGlzLmxlbmd0aDsgaWYgKHZvaWQgMCA9PT0gZSAmJiAxID09PSB0Lm5vZGVUeXBlKSByZXR1cm4gdC5pbm5lckhUTUw7IGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBlICYmICFTZS50ZXN0KGUpICYmICFnZVsocGUuZXhlYyhlKSB8fCBbXCJcIiwgXCJcIl0pWzFdLnRvTG93ZXJDYXNlKCldKSB7IGUgPSB3Lmh0bWxQcmVmaWx0ZXIoZSk7IHRyeSB7IGZvciAoOyBuIDwgcjsgbisrKTEgPT09ICh0ID0gdGhpc1tuXSB8fCB7fSkubm9kZVR5cGUgJiYgKHcuY2xlYW5EYXRhKHZlKHQsICExKSksIHQuaW5uZXJIVE1MID0gZSk7IHQgPSAwIH0gY2F0Y2ggKGUpIHsgfSB9IHQgJiYgdGhpcy5lbXB0eSgpLmFwcGVuZChlKSB9LCBudWxsLCBlLCBhcmd1bWVudHMubGVuZ3RoKSB9LCByZXBsYWNlV2l0aDogZnVuY3Rpb24gKCkgeyB2YXIgZSA9IFtdOyByZXR1cm4gUmUodGhpcywgYXJndW1lbnRzLCBmdW5jdGlvbiAodCkgeyB2YXIgbiA9IHRoaXMucGFyZW50Tm9kZTsgdy5pbkFycmF5KHRoaXMsIGUpIDwgMCAmJiAody5jbGVhbkRhdGEodmUodGhpcykpLCBuICYmIG4ucmVwbGFjZUNoaWxkKHQsIHRoaXMpKSB9LCBlKSB9IH0pLCB3LmVhY2goeyBhcHBlbmRUbzogXCJhcHBlbmRcIiwgcHJlcGVuZFRvOiBcInByZXBlbmRcIiwgaW5zZXJ0QmVmb3JlOiBcImJlZm9yZVwiLCBpbnNlcnRBZnRlcjogXCJhZnRlclwiLCByZXBsYWNlQWxsOiBcInJlcGxhY2VXaXRoXCIgfSwgZnVuY3Rpb24gKGUsIHQpIHsgdy5mbltlXSA9IGZ1bmN0aW9uIChlKSB7IGZvciAodmFyIG4sIHIgPSBbXSwgaSA9IHcoZSksIG8gPSBpLmxlbmd0aCAtIDEsIGEgPSAwOyBhIDw9IG87IGErKyluID0gYSA9PT0gbyA/IHRoaXMgOiB0aGlzLmNsb25lKCEwKSwgdyhpW2FdKVt0XShuKSwgdS5hcHBseShyLCBuLmdldCgpKTsgcmV0dXJuIHRoaXMucHVzaFN0YWNrKHIpIH0gfSk7IHZhciBNZSA9IG5ldyBSZWdFeHAoXCJeKFwiICsgcmUgKyBcIikoPyFweClbYS16JV0rJFwiLCBcImlcIiksIFdlID0gZnVuY3Rpb24gKHQpIHsgdmFyIG4gPSB0Lm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXc7IHJldHVybiBuICYmIG4ub3BlbmVyIHx8IChuID0gZSksIG4uZ2V0Q29tcHV0ZWRTdHlsZSh0KSB9LCAkZSA9IG5ldyBSZWdFeHAob2Uuam9pbihcInxcIiksIFwiaVwiKTsgIWZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gdCgpIHsgaWYgKGMpIHsgbC5zdHlsZS5jc3NUZXh0ID0gXCJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xMTExMXB4O3dpZHRoOjYwcHg7bWFyZ2luLXRvcDoxcHg7cGFkZGluZzowO2JvcmRlcjowXCIsIGMuc3R5bGUuY3NzVGV4dCA9IFwicG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpibG9jaztib3gtc2l6aW5nOmJvcmRlci1ib3g7b3ZlcmZsb3c6c2Nyb2xsO21hcmdpbjphdXRvO2JvcmRlcjoxcHg7cGFkZGluZzoxcHg7d2lkdGg6NjAlO3RvcDoxJVwiLCB4ZS5hcHBlbmRDaGlsZChsKS5hcHBlbmRDaGlsZChjKTsgdmFyIHQgPSBlLmdldENvbXB1dGVkU3R5bGUoYyk7IGkgPSBcIjElXCIgIT09IHQudG9wLCBzID0gMTIgPT09IG4odC5tYXJnaW5MZWZ0KSwgYy5zdHlsZS5yaWdodCA9IFwiNjAlXCIsIHUgPSAzNiA9PT0gbih0LnJpZ2h0KSwgbyA9IDM2ID09PSBuKHQud2lkdGgpLCBjLnN0eWxlLnBvc2l0aW9uID0gXCJhYnNvbHV0ZVwiLCBhID0gMzYgPT09IGMub2Zmc2V0V2lkdGggfHwgXCJhYnNvbHV0ZVwiLCB4ZS5yZW1vdmVDaGlsZChsKSwgYyA9IG51bGwgfSB9IGZ1bmN0aW9uIG4oZSkgeyByZXR1cm4gTWF0aC5yb3VuZChwYXJzZUZsb2F0KGUpKSB9IHZhciBpLCBvLCBhLCB1LCBzLCBsID0gci5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLCBjID0gci5jcmVhdGVFbGVtZW50KFwiZGl2XCIpOyBjLnN0eWxlICYmIChjLnN0eWxlLmJhY2tncm91bmRDbGlwID0gXCJjb250ZW50LWJveFwiLCBjLmNsb25lTm9kZSghMCkuc3R5bGUuYmFja2dyb3VuZENsaXAgPSBcIlwiLCBoLmNsZWFyQ2xvbmVTdHlsZSA9IFwiY29udGVudC1ib3hcIiA9PT0gYy5zdHlsZS5iYWNrZ3JvdW5kQ2xpcCwgdy5leHRlbmQoaCwgeyBib3hTaXppbmdSZWxpYWJsZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdCgpLCBvIH0sIHBpeGVsQm94U3R5bGVzOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0KCksIHUgfSwgcGl4ZWxQb3NpdGlvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gdCgpLCBpIH0sIHJlbGlhYmxlTWFyZ2luTGVmdDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdCgpLCBzIH0sIHNjcm9sbGJveFNpemU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHQoKSwgYSB9IH0pKSB9KCk7IGZ1bmN0aW9uIEZlKGUsIHQsIG4pIHsgdmFyIHIsIGksIG8sIGEsIHUgPSBlLnN0eWxlOyByZXR1cm4gKG4gPSBuIHx8IFdlKGUpKSAmJiAoXCJcIiAhPT0gKGEgPSBuLmdldFByb3BlcnR5VmFsdWUodCkgfHwgblt0XSkgfHwgdy5jb250YWlucyhlLm93bmVyRG9jdW1lbnQsIGUpIHx8IChhID0gdy5zdHlsZShlLCB0KSksICFoLnBpeGVsQm94U3R5bGVzKCkgJiYgTWUudGVzdChhKSAmJiAkZS50ZXN0KHQpICYmIChyID0gdS53aWR0aCwgaSA9IHUubWluV2lkdGgsIG8gPSB1Lm1heFdpZHRoLCB1Lm1pbldpZHRoID0gdS5tYXhXaWR0aCA9IHUud2lkdGggPSBhLCBhID0gbi53aWR0aCwgdS53aWR0aCA9IHIsIHUubWluV2lkdGggPSBpLCB1Lm1heFdpZHRoID0gbykpLCB2b2lkIDAgIT09IGEgPyBhICsgXCJcIiA6IGEgfSBmdW5jdGlvbiB6ZShlLCB0KSB7IHJldHVybiB7IGdldDogZnVuY3Rpb24gKCkgeyBpZiAoIWUoKSkgcmV0dXJuICh0aGlzLmdldCA9IHQpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7IGRlbGV0ZSB0aGlzLmdldCB9IH0gfSB2YXIgX2UgPSAvXihub25lfHRhYmxlKD8hLWNbZWFdKS4rKS8sIFVlID0gL14tLS8sIFZlID0geyBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB2aXNpYmlsaXR5OiBcImhpZGRlblwiLCBkaXNwbGF5OiBcImJsb2NrXCIgfSwgWGUgPSB7IGxldHRlclNwYWNpbmc6IFwiMFwiLCBmb250V2VpZ2h0OiBcIjQwMFwiIH0sIFFlID0gW1wiV2Via2l0XCIsIFwiTW96XCIsIFwibXNcIl0sIFllID0gci5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLnN0eWxlOyBmdW5jdGlvbiBHZShlKSB7IGlmIChlIGluIFllKSByZXR1cm4gZTsgdmFyIHQgPSBlWzBdLnRvVXBwZXJDYXNlKCkgKyBlLnNsaWNlKDEpLCBuID0gUWUubGVuZ3RoOyB3aGlsZSAobi0tKSBpZiAoKGUgPSBRZVtuXSArIHQpIGluIFllKSByZXR1cm4gZSB9IGZ1bmN0aW9uIEtlKGUpIHsgdmFyIHQgPSB3LmNzc1Byb3BzW2VdOyByZXR1cm4gdCB8fCAodCA9IHcuY3NzUHJvcHNbZV0gPSBHZShlKSB8fCBlKSwgdCB9IGZ1bmN0aW9uIEplKGUsIHQsIG4pIHsgdmFyIHIgPSBpZS5leGVjKHQpOyByZXR1cm4gciA/IE1hdGgubWF4KDAsIHJbMl0gLSAobiB8fCAwKSkgKyAoclszXSB8fCBcInB4XCIpIDogdCB9IGZ1bmN0aW9uIFplKGUsIHQsIG4sIHIsIGksIG8pIHsgdmFyIGEgPSBcIndpZHRoXCIgPT09IHQgPyAxIDogMCwgdSA9IDAsIHMgPSAwOyBpZiAobiA9PT0gKHIgPyBcImJvcmRlclwiIDogXCJjb250ZW50XCIpKSByZXR1cm4gMDsgZm9yICg7IGEgPCA0OyBhICs9IDIpXCJtYXJnaW5cIiA9PT0gbiAmJiAocyArPSB3LmNzcyhlLCBuICsgb2VbYV0sICEwLCBpKSksIHIgPyAoXCJjb250ZW50XCIgPT09IG4gJiYgKHMgLT0gdy5jc3MoZSwgXCJwYWRkaW5nXCIgKyBvZVthXSwgITAsIGkpKSwgXCJtYXJnaW5cIiAhPT0gbiAmJiAocyAtPSB3LmNzcyhlLCBcImJvcmRlclwiICsgb2VbYV0gKyBcIldpZHRoXCIsICEwLCBpKSkpIDogKHMgKz0gdy5jc3MoZSwgXCJwYWRkaW5nXCIgKyBvZVthXSwgITAsIGkpLCBcInBhZGRpbmdcIiAhPT0gbiA/IHMgKz0gdy5jc3MoZSwgXCJib3JkZXJcIiArIG9lW2FdICsgXCJXaWR0aFwiLCAhMCwgaSkgOiB1ICs9IHcuY3NzKGUsIFwiYm9yZGVyXCIgKyBvZVthXSArIFwiV2lkdGhcIiwgITAsIGkpKTsgcmV0dXJuICFyICYmIG8gPj0gMCAmJiAocyArPSBNYXRoLm1heCgwLCBNYXRoLmNlaWwoZVtcIm9mZnNldFwiICsgdFswXS50b1VwcGVyQ2FzZSgpICsgdC5zbGljZSgxKV0gLSBvIC0gcyAtIHUgLSAuNSkpKSwgcyB9IGZ1bmN0aW9uIGV0KGUsIHQsIG4pIHsgdmFyIHIgPSBXZShlKSwgaSA9IEZlKGUsIHQsIHIpLCBvID0gXCJib3JkZXItYm94XCIgPT09IHcuY3NzKGUsIFwiYm94U2l6aW5nXCIsICExLCByKSwgYSA9IG87IGlmIChNZS50ZXN0KGkpKSB7IGlmICghbikgcmV0dXJuIGk7IGkgPSBcImF1dG9cIiB9IHJldHVybiBhID0gYSAmJiAoaC5ib3hTaXppbmdSZWxpYWJsZSgpIHx8IGkgPT09IGUuc3R5bGVbdF0pLCAoXCJhdXRvXCIgPT09IGkgfHwgIXBhcnNlRmxvYXQoaSkgJiYgXCJpbmxpbmVcIiA9PT0gdy5jc3MoZSwgXCJkaXNwbGF5XCIsICExLCByKSkgJiYgKGkgPSBlW1wib2Zmc2V0XCIgKyB0WzBdLnRvVXBwZXJDYXNlKCkgKyB0LnNsaWNlKDEpXSwgYSA9ICEwKSwgKGkgPSBwYXJzZUZsb2F0KGkpIHx8IDApICsgWmUoZSwgdCwgbiB8fCAobyA/IFwiYm9yZGVyXCIgOiBcImNvbnRlbnRcIiksIGEsIHIsIGkpICsgXCJweFwiIH0gdy5leHRlbmQoeyBjc3NIb29rczogeyBvcGFjaXR5OiB7IGdldDogZnVuY3Rpb24gKGUsIHQpIHsgaWYgKHQpIHsgdmFyIG4gPSBGZShlLCBcIm9wYWNpdHlcIik7IHJldHVybiBcIlwiID09PSBuID8gXCIxXCIgOiBuIH0gfSB9IH0sIGNzc051bWJlcjogeyBhbmltYXRpb25JdGVyYXRpb25Db3VudDogITAsIGNvbHVtbkNvdW50OiAhMCwgZmlsbE9wYWNpdHk6ICEwLCBmbGV4R3JvdzogITAsIGZsZXhTaHJpbms6ICEwLCBmb250V2VpZ2h0OiAhMCwgbGluZUhlaWdodDogITAsIG9wYWNpdHk6ICEwLCBvcmRlcjogITAsIG9ycGhhbnM6ICEwLCB3aWRvd3M6ICEwLCB6SW5kZXg6ICEwLCB6b29tOiAhMCB9LCBjc3NQcm9wczoge30sIHN0eWxlOiBmdW5jdGlvbiAoZSwgdCwgbiwgcikgeyBpZiAoZSAmJiAzICE9PSBlLm5vZGVUeXBlICYmIDggIT09IGUubm9kZVR5cGUgJiYgZS5zdHlsZSkgeyB2YXIgaSwgbywgYSwgdSA9IFEodCksIHMgPSBVZS50ZXN0KHQpLCBsID0gZS5zdHlsZTsgaWYgKHMgfHwgKHQgPSBLZSh1KSksIGEgPSB3LmNzc0hvb2tzW3RdIHx8IHcuY3NzSG9va3NbdV0sIHZvaWQgMCA9PT0gbikgcmV0dXJuIGEgJiYgXCJnZXRcIiBpbiBhICYmIHZvaWQgMCAhPT0gKGkgPSBhLmdldChlLCAhMSwgcikpID8gaSA6IGxbdF07IFwic3RyaW5nXCIgPT0gKG8gPSB0eXBlb2YgbikgJiYgKGkgPSBpZS5leGVjKG4pKSAmJiBpWzFdICYmIChuID0gc2UoZSwgdCwgaSksIG8gPSBcIm51bWJlclwiKSwgbnVsbCAhPSBuICYmIG4gPT09IG4gJiYgKFwibnVtYmVyXCIgPT09IG8gJiYgKG4gKz0gaSAmJiBpWzNdIHx8ICh3LmNzc051bWJlclt1XSA/IFwiXCIgOiBcInB4XCIpKSwgaC5jbGVhckNsb25lU3R5bGUgfHwgXCJcIiAhPT0gbiB8fCAwICE9PSB0LmluZGV4T2YoXCJiYWNrZ3JvdW5kXCIpIHx8IChsW3RdID0gXCJpbmhlcml0XCIpLCBhICYmIFwic2V0XCIgaW4gYSAmJiB2b2lkIDAgPT09IChuID0gYS5zZXQoZSwgbiwgcikpIHx8IChzID8gbC5zZXRQcm9wZXJ0eSh0LCBuKSA6IGxbdF0gPSBuKSkgfSB9LCBjc3M6IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHZhciBpLCBvLCBhLCB1ID0gUSh0KTsgcmV0dXJuIFVlLnRlc3QodCkgfHwgKHQgPSBLZSh1KSksIChhID0gdy5jc3NIb29rc1t0XSB8fCB3LmNzc0hvb2tzW3VdKSAmJiBcImdldFwiIGluIGEgJiYgKGkgPSBhLmdldChlLCAhMCwgbikpLCB2b2lkIDAgPT09IGkgJiYgKGkgPSBGZShlLCB0LCByKSksIFwibm9ybWFsXCIgPT09IGkgJiYgdCBpbiBYZSAmJiAoaSA9IFhlW3RdKSwgXCJcIiA9PT0gbiB8fCBuID8gKG8gPSBwYXJzZUZsb2F0KGkpLCAhMCA9PT0gbiB8fCBpc0Zpbml0ZShvKSA/IG8gfHwgMCA6IGkpIDogaSB9IH0pLCB3LmVhY2goW1wiaGVpZ2h0XCIsIFwid2lkdGhcIl0sIGZ1bmN0aW9uIChlLCB0KSB7IHcuY3NzSG9va3NbdF0gPSB7IGdldDogZnVuY3Rpb24gKGUsIG4sIHIpIHsgaWYgKG4pIHJldHVybiAhX2UudGVzdCh3LmNzcyhlLCBcImRpc3BsYXlcIikpIHx8IGUuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggJiYgZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aCA/IGV0KGUsIHQsIHIpIDogdWUoZSwgVmUsIGZ1bmN0aW9uICgpIHsgcmV0dXJuIGV0KGUsIHQsIHIpIH0pIH0sIHNldDogZnVuY3Rpb24gKGUsIG4sIHIpIHsgdmFyIGksIG8gPSBXZShlKSwgYSA9IFwiYm9yZGVyLWJveFwiID09PSB3LmNzcyhlLCBcImJveFNpemluZ1wiLCAhMSwgbyksIHUgPSByICYmIFplKGUsIHQsIHIsIGEsIG8pOyByZXR1cm4gYSAmJiBoLnNjcm9sbGJveFNpemUoKSA9PT0gby5wb3NpdGlvbiAmJiAodSAtPSBNYXRoLmNlaWwoZVtcIm9mZnNldFwiICsgdFswXS50b1VwcGVyQ2FzZSgpICsgdC5zbGljZSgxKV0gLSBwYXJzZUZsb2F0KG9bdF0pIC0gWmUoZSwgdCwgXCJib3JkZXJcIiwgITEsIG8pIC0gLjUpKSwgdSAmJiAoaSA9IGllLmV4ZWMobikpICYmIFwicHhcIiAhPT0gKGlbM10gfHwgXCJweFwiKSAmJiAoZS5zdHlsZVt0XSA9IG4sIG4gPSB3LmNzcyhlLCB0KSksIEplKGUsIG4sIHUpIH0gfSB9KSwgdy5jc3NIb29rcy5tYXJnaW5MZWZ0ID0gemUoaC5yZWxpYWJsZU1hcmdpbkxlZnQsIGZ1bmN0aW9uIChlLCB0KSB7IGlmICh0KSByZXR1cm4gKHBhcnNlRmxvYXQoRmUoZSwgXCJtYXJnaW5MZWZ0XCIpKSB8fCBlLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLSB1ZShlLCB7IG1hcmdpbkxlZnQ6IDAgfSwgZnVuY3Rpb24gKCkgeyByZXR1cm4gZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0IH0pKSArIFwicHhcIiB9KSwgdy5lYWNoKHsgbWFyZ2luOiBcIlwiLCBwYWRkaW5nOiBcIlwiLCBib3JkZXI6IFwiV2lkdGhcIiB9LCBmdW5jdGlvbiAoZSwgdCkgeyB3LmNzc0hvb2tzW2UgKyB0XSA9IHsgZXhwYW5kOiBmdW5jdGlvbiAobikgeyBmb3IgKHZhciByID0gMCwgaSA9IHt9LCBvID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgbiA/IG4uc3BsaXQoXCIgXCIpIDogW25dOyByIDwgNDsgcisrKWlbZSArIG9lW3JdICsgdF0gPSBvW3JdIHx8IG9bciAtIDJdIHx8IG9bMF07IHJldHVybiBpIH0gfSwgXCJtYXJnaW5cIiAhPT0gZSAmJiAody5jc3NIb29rc1tlICsgdF0uc2V0ID0gSmUpIH0pLCB3LmZuLmV4dGVuZCh7IGNzczogZnVuY3Rpb24gKGUsIHQpIHsgcmV0dXJuIF8odGhpcywgZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGksIG8gPSB7fSwgYSA9IDA7IGlmIChBcnJheS5pc0FycmF5KHQpKSB7IGZvciAociA9IFdlKGUpLCBpID0gdC5sZW5ndGg7IGEgPCBpOyBhKyspb1t0W2FdXSA9IHcuY3NzKGUsIHRbYV0sICExLCByKTsgcmV0dXJuIG8gfSByZXR1cm4gdm9pZCAwICE9PSBuID8gdy5zdHlsZShlLCB0LCBuKSA6IHcuY3NzKGUsIHQpIH0sIGUsIHQsIGFyZ3VtZW50cy5sZW5ndGggPiAxKSB9IH0pLCB3LmZuLmRlbGF5ID0gZnVuY3Rpb24gKHQsIG4pIHsgcmV0dXJuIHQgPSB3LmZ4ID8gdy5meC5zcGVlZHNbdF0gfHwgdCA6IHQsIG4gPSBuIHx8IFwiZnhcIiwgdGhpcy5xdWV1ZShuLCBmdW5jdGlvbiAobiwgcikgeyB2YXIgaSA9IGUuc2V0VGltZW91dChuLCB0KTsgci5zdG9wID0gZnVuY3Rpb24gKCkgeyBlLmNsZWFyVGltZW91dChpKSB9IH0pIH0sIGZ1bmN0aW9uICgpIHsgdmFyIGUgPSByLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSwgdCA9IHIuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKS5hcHBlbmRDaGlsZChyLmNyZWF0ZUVsZW1lbnQoXCJvcHRpb25cIikpOyBlLnR5cGUgPSBcImNoZWNrYm94XCIsIGguY2hlY2tPbiA9IFwiXCIgIT09IGUudmFsdWUsIGgub3B0U2VsZWN0ZWQgPSB0LnNlbGVjdGVkLCAoZSA9IHIuY3JlYXRlRWxlbWVudChcImlucHV0XCIpKS52YWx1ZSA9IFwidFwiLCBlLnR5cGUgPSBcInJhZGlvXCIsIGgucmFkaW9WYWx1ZSA9IFwidFwiID09PSBlLnZhbHVlIH0oKTsgdmFyIHR0LCBudCA9IHcuZXhwci5hdHRySGFuZGxlOyB3LmZuLmV4dGVuZCh7IGF0dHI6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiBfKHRoaXMsIHcuYXR0ciwgZSwgdCwgYXJndW1lbnRzLmxlbmd0aCA+IDEpIH0sIHJlbW92ZUF0dHI6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB3LnJlbW92ZUF0dHIodGhpcywgZSkgfSkgfSB9KSwgdy5leHRlbmQoeyBhdHRyOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbyA9IGUubm9kZVR5cGU7IGlmICgzICE9PSBvICYmIDggIT09IG8gJiYgMiAhPT0gbykgcmV0dXJuIFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIGUuZ2V0QXR0cmlidXRlID8gdy5wcm9wKGUsIHQsIG4pIDogKDEgPT09IG8gJiYgdy5pc1hNTERvYyhlKSB8fCAoaSA9IHcuYXR0ckhvb2tzW3QudG9Mb3dlckNhc2UoKV0gfHwgKHcuZXhwci5tYXRjaC5ib29sLnRlc3QodCkgPyB0dCA6IHZvaWQgMCkpLCB2b2lkIDAgIT09IG4gPyBudWxsID09PSBuID8gdm9pZCB3LnJlbW92ZUF0dHIoZSwgdCkgOiBpICYmIFwic2V0XCIgaW4gaSAmJiB2b2lkIDAgIT09IChyID0gaS5zZXQoZSwgbiwgdCkpID8gciA6IChlLnNldEF0dHJpYnV0ZSh0LCBuICsgXCJcIiksIG4pIDogaSAmJiBcImdldFwiIGluIGkgJiYgbnVsbCAhPT0gKHIgPSBpLmdldChlLCB0KSkgPyByIDogbnVsbCA9PSAociA9IHcuZmluZC5hdHRyKGUsIHQpKSA/IHZvaWQgMCA6IHIpIH0sIGF0dHJIb29rczogeyB0eXBlOiB7IHNldDogZnVuY3Rpb24gKGUsIHQpIHsgaWYgKCFoLnJhZGlvVmFsdWUgJiYgXCJyYWRpb1wiID09PSB0ICYmIEQoZSwgXCJpbnB1dFwiKSkgeyB2YXIgbiA9IGUudmFsdWU7IHJldHVybiBlLnNldEF0dHJpYnV0ZShcInR5cGVcIiwgdCksIG4gJiYgKGUudmFsdWUgPSBuKSwgdCB9IH0gfSB9LCByZW1vdmVBdHRyOiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IDAsIGkgPSB0ICYmIHQubWF0Y2goSSk7IGlmIChpICYmIDEgPT09IGUubm9kZVR5cGUpIHdoaWxlIChuID0gaVtyKytdKSBlLnJlbW92ZUF0dHJpYnV0ZShuKSB9IH0pLCB0dCA9IHsgc2V0OiBmdW5jdGlvbiAoZSwgdCwgbikgeyByZXR1cm4gITEgPT09IHQgPyB3LnJlbW92ZUF0dHIoZSwgbikgOiBlLnNldEF0dHJpYnV0ZShuLCBuKSwgbiB9IH0sIHcuZWFjaCh3LmV4cHIubWF0Y2guYm9vbC5zb3VyY2UubWF0Y2goL1xcdysvZyksIGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gbnRbdF0gfHwgdy5maW5kLmF0dHI7IG50W3RdID0gZnVuY3Rpb24gKGUsIHQsIHIpIHsgdmFyIGksIG8sIGEgPSB0LnRvTG93ZXJDYXNlKCk7IHJldHVybiByIHx8IChvID0gbnRbYV0sIG50W2FdID0gaSwgaSA9IG51bGwgIT0gbihlLCB0LCByKSA/IGEgOiBudWxsLCBudFthXSA9IG8pLCBpIH0gfSk7IHZhciBydCA9IC9eKD86aW5wdXR8c2VsZWN0fHRleHRhcmVhfGJ1dHRvbikkL2ksIGl0ID0gL14oPzphfGFyZWEpJC9pOyB3LmZuLmV4dGVuZCh7IHByb3A6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiBfKHRoaXMsIHcucHJvcCwgZSwgdCwgYXJndW1lbnRzLmxlbmd0aCA+IDEpIH0sIHJlbW92ZVByb3A6IGZ1bmN0aW9uIChlKSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBkZWxldGUgdGhpc1t3LnByb3BGaXhbZV0gfHwgZV0gfSkgfSB9KSwgdy5leHRlbmQoeyBwcm9wOiBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgciwgaSwgbyA9IGUubm9kZVR5cGU7IGlmICgzICE9PSBvICYmIDggIT09IG8gJiYgMiAhPT0gbykgcmV0dXJuIDEgPT09IG8gJiYgdy5pc1hNTERvYyhlKSB8fCAodCA9IHcucHJvcEZpeFt0XSB8fCB0LCBpID0gdy5wcm9wSG9va3NbdF0pLCB2b2lkIDAgIT09IG4gPyBpICYmIFwic2V0XCIgaW4gaSAmJiB2b2lkIDAgIT09IChyID0gaS5zZXQoZSwgbiwgdCkpID8gciA6IGVbdF0gPSBuIDogaSAmJiBcImdldFwiIGluIGkgJiYgbnVsbCAhPT0gKHIgPSBpLmdldChlLCB0KSkgPyByIDogZVt0XSB9LCBwcm9wSG9va3M6IHsgdGFiSW5kZXg6IHsgZ2V0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IHcuZmluZC5hdHRyKGUsIFwidGFiaW5kZXhcIik7IHJldHVybiB0ID8gcGFyc2VJbnQodCwgMTApIDogcnQudGVzdChlLm5vZGVOYW1lKSB8fCBpdC50ZXN0KGUubm9kZU5hbWUpICYmIGUuaHJlZiA/IDAgOiAtMSB9IH0gfSwgcHJvcEZpeDogeyBcImZvclwiOiBcImh0bWxGb3JcIiwgXCJjbGFzc1wiOiBcImNsYXNzTmFtZVwiIH0gfSksIGgub3B0U2VsZWN0ZWQgfHwgKHcucHJvcEhvb2tzLnNlbGVjdGVkID0geyBnZXQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gZS5wYXJlbnROb2RlOyByZXR1cm4gdCAmJiB0LnBhcmVudE5vZGUgJiYgdC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgsIG51bGwgfSwgc2V0OiBmdW5jdGlvbiAoZSkgeyB2YXIgdCA9IGUucGFyZW50Tm9kZTsgdCAmJiAodC5zZWxlY3RlZEluZGV4LCB0LnBhcmVudE5vZGUgJiYgdC5wYXJlbnROb2RlLnNlbGVjdGVkSW5kZXgpIH0gfSksIHcuZWFjaChbXCJ0YWJJbmRleFwiLCBcInJlYWRPbmx5XCIsIFwibWF4TGVuZ3RoXCIsIFwiY2VsbFNwYWNpbmdcIiwgXCJjZWxsUGFkZGluZ1wiLCBcInJvd1NwYW5cIiwgXCJjb2xTcGFuXCIsIFwidXNlTWFwXCIsIFwiZnJhbWVCb3JkZXJcIiwgXCJjb250ZW50RWRpdGFibGVcIl0sIGZ1bmN0aW9uICgpIHsgdy5wcm9wRml4W3RoaXMudG9Mb3dlckNhc2UoKV0gPSB0aGlzIH0pOyBmdW5jdGlvbiBvdChlKSB7IHJldHVybiAoZS5tYXRjaChJKSB8fCBbXSkuam9pbihcIiBcIikgfSBmdW5jdGlvbiBhdChlKSB7IHJldHVybiBlLmdldEF0dHJpYnV0ZSAmJiBlLmdldEF0dHJpYnV0ZShcImNsYXNzXCIpIHx8IFwiXCIgfSBmdW5jdGlvbiB1dChlKSB7IHJldHVybiBBcnJheS5pc0FycmF5KGUpID8gZSA6IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgPyBlLm1hdGNoKEkpIHx8IFtdIDogW10gfSB3LmZuLmV4dGVuZCh7IGFkZENsYXNzOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbiwgciwgaSwgbywgYSwgdSwgcyA9IDA7IGlmIChnKGUpKSByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICh0KSB7IHcodGhpcykuYWRkQ2xhc3MoZS5jYWxsKHRoaXMsIHQsIGF0KHRoaXMpKSkgfSk7IGlmICgodCA9IHV0KGUpKS5sZW5ndGgpIHdoaWxlIChuID0gdGhpc1tzKytdKSBpZiAoaSA9IGF0KG4pLCByID0gMSA9PT0gbi5ub2RlVHlwZSAmJiBcIiBcIiArIG90KGkpICsgXCIgXCIpIHsgYSA9IDA7IHdoaWxlIChvID0gdFthKytdKSByLmluZGV4T2YoXCIgXCIgKyBvICsgXCIgXCIpIDwgMCAmJiAociArPSBvICsgXCIgXCIpOyBpICE9PSAodSA9IG90KHIpKSAmJiBuLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIHUpIH0gcmV0dXJuIHRoaXMgfSwgcmVtb3ZlQ2xhc3M6IGZ1bmN0aW9uIChlKSB7IHZhciB0LCBuLCByLCBpLCBvLCBhLCB1LCBzID0gMDsgaWYgKGcoZSkpIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKHQpIHsgdyh0aGlzKS5yZW1vdmVDbGFzcyhlLmNhbGwodGhpcywgdCwgYXQodGhpcykpKSB9KTsgaWYgKCFhcmd1bWVudHMubGVuZ3RoKSByZXR1cm4gdGhpcy5hdHRyKFwiY2xhc3NcIiwgXCJcIik7IGlmICgodCA9IHV0KGUpKS5sZW5ndGgpIHdoaWxlIChuID0gdGhpc1tzKytdKSBpZiAoaSA9IGF0KG4pLCByID0gMSA9PT0gbi5ub2RlVHlwZSAmJiBcIiBcIiArIG90KGkpICsgXCIgXCIpIHsgYSA9IDA7IHdoaWxlIChvID0gdFthKytdKSB3aGlsZSAoci5pbmRleE9mKFwiIFwiICsgbyArIFwiIFwiKSA+IC0xKSByID0gci5yZXBsYWNlKFwiIFwiICsgbyArIFwiIFwiLCBcIiBcIik7IGkgIT09ICh1ID0gb3QocikpICYmIG4uc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgdSkgfSByZXR1cm4gdGhpcyB9LCB0b2dnbGVDbGFzczogZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4gPSB0eXBlb2YgZSwgciA9IFwic3RyaW5nXCIgPT09IG4gfHwgQXJyYXkuaXNBcnJheShlKTsgcmV0dXJuIFwiYm9vbGVhblwiID09IHR5cGVvZiB0ICYmIHIgPyB0ID8gdGhpcy5hZGRDbGFzcyhlKSA6IHRoaXMucmVtb3ZlQ2xhc3MoZSkgOiBnKGUpID8gdGhpcy5lYWNoKGZ1bmN0aW9uIChuKSB7IHcodGhpcykudG9nZ2xlQ2xhc3MoZS5jYWxsKHRoaXMsIG4sIGF0KHRoaXMpLCB0KSwgdCkgfSkgOiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB2YXIgdCwgaSwgbywgYTsgaWYgKHIpIHsgaSA9IDAsIG8gPSB3KHRoaXMpLCBhID0gdXQoZSk7IHdoaWxlICh0ID0gYVtpKytdKSBvLmhhc0NsYXNzKHQpID8gby5yZW1vdmVDbGFzcyh0KSA6IG8uYWRkQ2xhc3ModCkgfSBlbHNlIHZvaWQgMCAhPT0gZSAmJiBcImJvb2xlYW5cIiAhPT0gbiB8fCAoKHQgPSBhdCh0aGlzKSkgJiYgSy5zZXQodGhpcywgXCJfX2NsYXNzTmFtZV9fXCIsIHQpLCB0aGlzLnNldEF0dHJpYnV0ZSAmJiB0aGlzLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsIHQgfHwgITEgPT09IGUgPyBcIlwiIDogSy5nZXQodGhpcywgXCJfX2NsYXNzTmFtZV9fXCIpIHx8IFwiXCIpKSB9KSB9LCBoYXNDbGFzczogZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4sIHIgPSAwOyB0ID0gXCIgXCIgKyBlICsgXCIgXCI7IHdoaWxlIChuID0gdGhpc1tyKytdKSBpZiAoMSA9PT0gbi5ub2RlVHlwZSAmJiAoXCIgXCIgKyBvdChhdChuKSkgKyBcIiBcIikuaW5kZXhPZih0KSA+IC0xKSByZXR1cm4gITA7IHJldHVybiAhMSB9IH0pOyB2YXIgc3QgPSAvXFxyL2c7IHcuZm4uZXh0ZW5kKHsgdmFsOiBmdW5jdGlvbiAoZSkgeyB2YXIgdCwgbiwgciwgaSA9IHRoaXNbMF07IHsgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiByID0gZyhlKSwgdGhpcy5lYWNoKGZ1bmN0aW9uIChuKSB7IHZhciBpOyAxID09PSB0aGlzLm5vZGVUeXBlICYmIChudWxsID09IChpID0gciA/IGUuY2FsbCh0aGlzLCBuLCB3KHRoaXMpLnZhbCgpKSA6IGUpID8gaSA9IFwiXCIgOiBcIm51bWJlclwiID09IHR5cGVvZiBpID8gaSArPSBcIlwiIDogQXJyYXkuaXNBcnJheShpKSAmJiAoaSA9IHcubWFwKGksIGZ1bmN0aW9uIChlKSB7IHJldHVybiBudWxsID09IGUgPyBcIlwiIDogZSArIFwiXCIgfSkpLCAodCA9IHcudmFsSG9va3NbdGhpcy50eXBlXSB8fCB3LnZhbEhvb2tzW3RoaXMubm9kZU5hbWUudG9Mb3dlckNhc2UoKV0pICYmIFwic2V0XCIgaW4gdCAmJiB2b2lkIDAgIT09IHQuc2V0KHRoaXMsIGksIFwidmFsdWVcIikgfHwgKHRoaXMudmFsdWUgPSBpKSkgfSk7IGlmIChpKSByZXR1cm4gKHQgPSB3LnZhbEhvb2tzW2kudHlwZV0gfHwgdy52YWxIb29rc1tpLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCldKSAmJiBcImdldFwiIGluIHQgJiYgdm9pZCAwICE9PSAobiA9IHQuZ2V0KGksIFwidmFsdWVcIikpID8gbiA6IFwic3RyaW5nXCIgPT0gdHlwZW9mIChuID0gaS52YWx1ZSkgPyBuLnJlcGxhY2Uoc3QsIFwiXCIpIDogbnVsbCA9PSBuID8gXCJcIiA6IG4gfSB9IH0pLCB3LmV4dGVuZCh7IHZhbEhvb2tzOiB7IG9wdGlvbjogeyBnZXQ6IGZ1bmN0aW9uIChlKSB7IHZhciB0ID0gdy5maW5kLmF0dHIoZSwgXCJ2YWx1ZVwiKTsgcmV0dXJuIG51bGwgIT0gdCA/IHQgOiBvdCh3LnRleHQoZSkpIH0gfSwgc2VsZWN0OiB7IGdldDogZnVuY3Rpb24gKGUpIHsgdmFyIHQsIG4sIHIsIGkgPSBlLm9wdGlvbnMsIG8gPSBlLnNlbGVjdGVkSW5kZXgsIGEgPSBcInNlbGVjdC1vbmVcIiA9PT0gZS50eXBlLCB1ID0gYSA/IG51bGwgOiBbXSwgcyA9IGEgPyBvICsgMSA6IGkubGVuZ3RoOyBmb3IgKHIgPSBvIDwgMCA/IHMgOiBhID8gbyA6IDA7IHIgPCBzOyByKyspaWYgKCgobiA9IGlbcl0pLnNlbGVjdGVkIHx8IHIgPT09IG8pICYmICFuLmRpc2FibGVkICYmICghbi5wYXJlbnROb2RlLmRpc2FibGVkIHx8ICFEKG4ucGFyZW50Tm9kZSwgXCJvcHRncm91cFwiKSkpIHsgaWYgKHQgPSB3KG4pLnZhbCgpLCBhKSByZXR1cm4gdDsgdS5wdXNoKHQpIH0gcmV0dXJuIHUgfSwgc2V0OiBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciwgaSA9IGUub3B0aW9ucywgbyA9IHcubWFrZUFycmF5KHQpLCBhID0gaS5sZW5ndGg7IHdoaWxlIChhLS0pICgociA9IGlbYV0pLnNlbGVjdGVkID0gdy5pbkFycmF5KHcudmFsSG9va3Mub3B0aW9uLmdldChyKSwgbykgPiAtMSkgJiYgKG4gPSAhMCk7IHJldHVybiBuIHx8IChlLnNlbGVjdGVkSW5kZXggPSAtMSksIG8gfSB9IH0gfSksIHcuZWFjaChbXCJyYWRpb1wiLCBcImNoZWNrYm94XCJdLCBmdW5jdGlvbiAoKSB7IHcudmFsSG9va3NbdGhpc10gPSB7IHNldDogZnVuY3Rpb24gKGUsIHQpIHsgaWYgKEFycmF5LmlzQXJyYXkodCkpIHJldHVybiBlLmNoZWNrZWQgPSB3LmluQXJyYXkodyhlKS52YWwoKSwgdCkgPiAtMSB9IH0sIGguY2hlY2tPbiB8fCAody52YWxIb29rc1t0aGlzXS5nZXQgPSBmdW5jdGlvbiAoZSkgeyByZXR1cm4gbnVsbCA9PT0gZS5nZXRBdHRyaWJ1dGUoXCJ2YWx1ZVwiKSA/IFwib25cIiA6IGUudmFsdWUgfSkgfSksIGguZm9jdXNpbiA9IFwib25mb2N1c2luXCIgaW4gZTsgdmFyIGx0ID0gL14oPzpmb2N1c2luZm9jdXN8Zm9jdXNvdXRibHVyKSQvLCBjdCA9IGZ1bmN0aW9uIChlKSB7IGUuc3RvcFByb3BhZ2F0aW9uKCkgfTsgdy5leHRlbmQody5ldmVudCwgeyB0cmlnZ2VyOiBmdW5jdGlvbiAodCwgbiwgaSwgbykgeyB2YXIgYSwgdSwgcywgbCwgYywgZCwgcCwgaCwgeSA9IFtpIHx8IHJdLCBtID0gZi5jYWxsKHQsIFwidHlwZVwiKSA/IHQudHlwZSA6IHQsIGIgPSBmLmNhbGwodCwgXCJuYW1lc3BhY2VcIikgPyB0Lm5hbWVzcGFjZS5zcGxpdChcIi5cIikgOiBbXTsgaWYgKHUgPSBoID0gcyA9IGkgPSBpIHx8IHIsIDMgIT09IGkubm9kZVR5cGUgJiYgOCAhPT0gaS5ub2RlVHlwZSAmJiAhbHQudGVzdChtICsgdy5ldmVudC50cmlnZ2VyZWQpICYmIChtLmluZGV4T2YoXCIuXCIpID4gLTEgJiYgKG0gPSAoYiA9IG0uc3BsaXQoXCIuXCIpKS5zaGlmdCgpLCBiLnNvcnQoKSksIGMgPSBtLmluZGV4T2YoXCI6XCIpIDwgMCAmJiBcIm9uXCIgKyBtLCB0ID0gdFt3LmV4cGFuZG9dID8gdCA6IG5ldyB3LkV2ZW50KG0sIFwib2JqZWN0XCIgPT0gdHlwZW9mIHQgJiYgdCksIHQuaXNUcmlnZ2VyID0gbyA/IDIgOiAzLCB0Lm5hbWVzcGFjZSA9IGIuam9pbihcIi5cIiksIHQucm5hbWVzcGFjZSA9IHQubmFtZXNwYWNlID8gbmV3IFJlZ0V4cChcIihefFxcXFwuKVwiICsgYi5qb2luKFwiXFxcXC4oPzouKlxcXFwufClcIikgKyBcIihcXFxcLnwkKVwiKSA6IG51bGwsIHQucmVzdWx0ID0gdm9pZCAwLCB0LnRhcmdldCB8fCAodC50YXJnZXQgPSBpKSwgbiA9IG51bGwgPT0gbiA/IFt0XSA6IHcubWFrZUFycmF5KG4sIFt0XSksIHAgPSB3LmV2ZW50LnNwZWNpYWxbbV0gfHwge30sIG8gfHwgIXAudHJpZ2dlciB8fCAhMSAhPT0gcC50cmlnZ2VyLmFwcGx5KGksIG4pKSkgeyBpZiAoIW8gJiYgIXAubm9CdWJibGUgJiYgIXYoaSkpIHsgZm9yIChsID0gcC5kZWxlZ2F0ZVR5cGUgfHwgbSwgbHQudGVzdChsICsgbSkgfHwgKHUgPSB1LnBhcmVudE5vZGUpOyB1OyB1ID0gdS5wYXJlbnROb2RlKXkucHVzaCh1KSwgcyA9IHU7IHMgPT09IChpLm93bmVyRG9jdW1lbnQgfHwgcikgJiYgeS5wdXNoKHMuZGVmYXVsdFZpZXcgfHwgcy5wYXJlbnRXaW5kb3cgfHwgZSkgfSBhID0gMDsgd2hpbGUgKCh1ID0geVthKytdKSAmJiAhdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpKSBoID0gdSwgdC50eXBlID0gYSA+IDEgPyBsIDogcC5iaW5kVHlwZSB8fCBtLCAoZCA9IChLLmdldCh1LCBcImV2ZW50c1wiKSB8fCB7fSlbdC50eXBlXSAmJiBLLmdldCh1LCBcImhhbmRsZVwiKSkgJiYgZC5hcHBseSh1LCBuKSwgKGQgPSBjICYmIHVbY10pICYmIGQuYXBwbHkgJiYgWSh1KSAmJiAodC5yZXN1bHQgPSBkLmFwcGx5KHUsIG4pLCAhMSA9PT0gdC5yZXN1bHQgJiYgdC5wcmV2ZW50RGVmYXVsdCgpKTsgcmV0dXJuIHQudHlwZSA9IG0sIG8gfHwgdC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSB8fCBwLl9kZWZhdWx0ICYmICExICE9PSBwLl9kZWZhdWx0LmFwcGx5KHkucG9wKCksIG4pIHx8ICFZKGkpIHx8IGMgJiYgZyhpW21dKSAmJiAhdihpKSAmJiAoKHMgPSBpW2NdKSAmJiAoaVtjXSA9IG51bGwpLCB3LmV2ZW50LnRyaWdnZXJlZCA9IG0sIHQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSAmJiBoLmFkZEV2ZW50TGlzdGVuZXIobSwgY3QpLCBpW21dKCksIHQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSAmJiBoLnJlbW92ZUV2ZW50TGlzdGVuZXIobSwgY3QpLCB3LmV2ZW50LnRyaWdnZXJlZCA9IHZvaWQgMCwgcyAmJiAoaVtjXSA9IHMpKSwgdC5yZXN1bHQgfSB9LCBzaW11bGF0ZTogZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIgPSB3LmV4dGVuZChuZXcgdy5FdmVudCwgbiwgeyB0eXBlOiBlLCBpc1NpbXVsYXRlZDogITAgfSk7IHcuZXZlbnQudHJpZ2dlcihyLCBudWxsLCB0KSB9IH0pLCB3LmZuLmV4dGVuZCh7IHRyaWdnZXI6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB3LmV2ZW50LnRyaWdnZXIoZSwgdCwgdGhpcykgfSkgfSwgdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uIChlLCB0KSB7IHZhciBuID0gdGhpc1swXTsgaWYgKG4pIHJldHVybiB3LmV2ZW50LnRyaWdnZXIoZSwgdCwgbiwgITApIH0gfSksIGguZm9jdXNpbiB8fCB3LmVhY2goeyBmb2N1czogXCJmb2N1c2luXCIsIGJsdXI6IFwiZm9jdXNvdXRcIiB9LCBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IGZ1bmN0aW9uIChlKSB7IHcuZXZlbnQuc2ltdWxhdGUodCwgZS50YXJnZXQsIHcuZXZlbnQuZml4KGUpKSB9OyB3LmV2ZW50LnNwZWNpYWxbdF0gPSB7IHNldHVwOiBmdW5jdGlvbiAoKSB7IHZhciByID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsIGkgPSBLLmFjY2VzcyhyLCB0KTsgaSB8fCByLmFkZEV2ZW50TGlzdGVuZXIoZSwgbiwgITApLCBLLmFjY2VzcyhyLCB0LCAoaSB8fCAwKSArIDEpIH0sIHRlYXJkb3duOiBmdW5jdGlvbiAoKSB7IHZhciByID0gdGhpcy5vd25lckRvY3VtZW50IHx8IHRoaXMsIGkgPSBLLmFjY2VzcyhyLCB0KSAtIDE7IGkgPyBLLmFjY2VzcyhyLCB0LCBpKSA6IChyLnJlbW92ZUV2ZW50TGlzdGVuZXIoZSwgbiwgITApLCBLLnJlbW92ZShyLCB0KSkgfSB9IH0pOyB2YXIgZnQgPSAvXFxbXFxdJC8sIGR0ID0gL1xccj9cXG4vZywgcHQgPSAvXig/OnN1Ym1pdHxidXR0b258aW1hZ2V8cmVzZXR8ZmlsZSkkL2ksIGh0ID0gL14oPzppbnB1dHxzZWxlY3R8dGV4dGFyZWF8a2V5Z2VuKS9pOyBmdW5jdGlvbiBndChlLCB0LCBuLCByKSB7IHZhciBpOyBpZiAoQXJyYXkuaXNBcnJheSh0KSkgdy5lYWNoKHQsIGZ1bmN0aW9uICh0LCBpKSB7IG4gfHwgZnQudGVzdChlKSA/IHIoZSwgaSkgOiBndChlICsgXCJbXCIgKyAoXCJvYmplY3RcIiA9PSB0eXBlb2YgaSAmJiBudWxsICE9IGkgPyB0IDogXCJcIikgKyBcIl1cIiwgaSwgbiwgcikgfSk7IGVsc2UgaWYgKG4gfHwgXCJvYmplY3RcIiAhPT0gYih0KSkgcihlLCB0KTsgZWxzZSBmb3IgKGkgaW4gdCkgZ3QoZSArIFwiW1wiICsgaSArIFwiXVwiLCB0W2ldLCBuLCByKSB9IHcucGFyYW0gPSBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiwgciA9IFtdLCBpID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4gPSBnKHQpID8gdCgpIDogdDsgcltyLmxlbmd0aF0gPSBlbmNvZGVVUklDb21wb25lbnQoZSkgKyBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChudWxsID09IG4gPyBcIlwiIDogbikgfTsgaWYgKEFycmF5LmlzQXJyYXkoZSkgfHwgZS5qcXVlcnkgJiYgIXcuaXNQbGFpbk9iamVjdChlKSkgdy5lYWNoKGUsIGZ1bmN0aW9uICgpIHsgaSh0aGlzLm5hbWUsIHRoaXMudmFsdWUpIH0pOyBlbHNlIGZvciAobiBpbiBlKSBndChuLCBlW25dLCB0LCBpKTsgcmV0dXJuIHIuam9pbihcIiZcIikgfSwgdy5mbi5leHRlbmQoeyBzZXJpYWxpemU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHcucGFyYW0odGhpcy5zZXJpYWxpemVBcnJheSgpKSB9LCBzZXJpYWxpemVBcnJheTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5tYXAoZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHcucHJvcCh0aGlzLCBcImVsZW1lbnRzXCIpOyByZXR1cm4gZSA/IHcubWFrZUFycmF5KGUpIDogdGhpcyB9KS5maWx0ZXIoZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHRoaXMudHlwZTsgcmV0dXJuIHRoaXMubmFtZSAmJiAhdyh0aGlzKS5pcyhcIjpkaXNhYmxlZFwiKSAmJiBodC50ZXN0KHRoaXMubm9kZU5hbWUpICYmICFwdC50ZXN0KGUpICYmICh0aGlzLmNoZWNrZWQgfHwgIWRlLnRlc3QoZSkpIH0pLm1hcChmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IHcodGhpcykudmFsKCk7IHJldHVybiBudWxsID09IG4gPyBudWxsIDogQXJyYXkuaXNBcnJheShuKSA/IHcubWFwKG4sIGZ1bmN0aW9uIChlKSB7IHJldHVybiB7IG5hbWU6IHQubmFtZSwgdmFsdWU6IGUucmVwbGFjZShkdCwgXCJcXHJcXG5cIikgfSB9KSA6IHsgbmFtZTogdC5uYW1lLCB2YWx1ZTogbi5yZXBsYWNlKGR0LCBcIlxcclxcblwiKSB9IH0pLmdldCgpIH0gfSksIHcuZm4uZXh0ZW5kKHsgd3JhcEFsbDogZnVuY3Rpb24gKGUpIHsgdmFyIHQ7IHJldHVybiB0aGlzWzBdICYmIChnKGUpICYmIChlID0gZS5jYWxsKHRoaXNbMF0pKSwgdCA9IHcoZSwgdGhpc1swXS5vd25lckRvY3VtZW50KS5lcSgwKS5jbG9uZSghMCksIHRoaXNbMF0ucGFyZW50Tm9kZSAmJiB0Lmluc2VydEJlZm9yZSh0aGlzWzBdKSwgdC5tYXAoZnVuY3Rpb24gKCkgeyB2YXIgZSA9IHRoaXM7IHdoaWxlIChlLmZpcnN0RWxlbWVudENoaWxkKSBlID0gZS5maXJzdEVsZW1lbnRDaGlsZDsgcmV0dXJuIGUgfSkuYXBwZW5kKHRoaXMpKSwgdGhpcyB9LCB3cmFwSW5uZXI6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBnKGUpID8gdGhpcy5lYWNoKGZ1bmN0aW9uICh0KSB7IHcodGhpcykud3JhcElubmVyKGUuY2FsbCh0aGlzLCB0KSkgfSkgOiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB2YXIgdCA9IHcodGhpcyksIG4gPSB0LmNvbnRlbnRzKCk7IG4ubGVuZ3RoID8gbi53cmFwQWxsKGUpIDogdC5hcHBlbmQoZSkgfSkgfSwgd3JhcDogZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSBnKGUpOyByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uIChuKSB7IHcodGhpcykud3JhcEFsbCh0ID8gZS5jYWxsKHRoaXMsIG4pIDogZSkgfSkgfSwgdW53cmFwOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gdGhpcy5wYXJlbnQoZSkubm90KFwiYm9keVwiKS5lYWNoKGZ1bmN0aW9uICgpIHsgdyh0aGlzKS5yZXBsYWNlV2l0aCh0aGlzLmNoaWxkTm9kZXMpIH0pLCB0aGlzIH0gfSksIHcuZXhwci5wc2V1ZG9zLmhpZGRlbiA9IGZ1bmN0aW9uIChlKSB7IHJldHVybiAhdy5leHByLnBzZXVkb3MudmlzaWJsZShlKSB9LCB3LmV4cHIucHNldWRvcy52aXNpYmxlID0gZnVuY3Rpb24gKGUpIHsgcmV0dXJuICEhKGUub2Zmc2V0V2lkdGggfHwgZS5vZmZzZXRIZWlnaHQgfHwgZS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCkgfSwgaC5jcmVhdGVIVE1MRG9jdW1lbnQgPSBmdW5jdGlvbiAoKSB7IHZhciBlID0gci5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoXCJcIikuYm9keTsgcmV0dXJuIGUuaW5uZXJIVE1MID0gXCI8Zm9ybT48L2Zvcm0+PGZvcm0+PC9mb3JtPlwiLCAyID09PSBlLmNoaWxkTm9kZXMubGVuZ3RoIH0oKSwgdy5wYXJzZUhUTUwgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyBpZiAoXCJzdHJpbmdcIiAhPSB0eXBlb2YgZSkgcmV0dXJuIFtdOyBcImJvb2xlYW5cIiA9PSB0eXBlb2YgdCAmJiAobiA9IHQsIHQgPSAhMSk7IHZhciBpLCBvLCBhOyByZXR1cm4gdCB8fCAoaC5jcmVhdGVIVE1MRG9jdW1lbnQgPyAoKGkgPSAodCA9IHIuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KFwiXCIpKS5jcmVhdGVFbGVtZW50KFwiYmFzZVwiKSkuaHJlZiA9IHIubG9jYXRpb24uaHJlZiwgdC5oZWFkLmFwcGVuZENoaWxkKGkpKSA6IHQgPSByKSwgbyA9IFMuZXhlYyhlKSwgYSA9ICFuICYmIFtdLCBvID8gW3QuY3JlYXRlRWxlbWVudChvWzFdKV0gOiAobyA9IGJlKFtlXSwgdCwgYSksIGEgJiYgYS5sZW5ndGggJiYgdyhhKS5yZW1vdmUoKSwgdy5tZXJnZShbXSwgby5jaGlsZE5vZGVzKSkgfSwgdy5vZmZzZXQgPSB7IHNldE9mZnNldDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgdmFyIHIsIGksIG8sIGEsIHUsIHMsIGwsIGMgPSB3LmNzcyhlLCBcInBvc2l0aW9uXCIpLCBmID0gdyhlKSwgZCA9IHt9OyBcInN0YXRpY1wiID09PSBjICYmIChlLnN0eWxlLnBvc2l0aW9uID0gXCJyZWxhdGl2ZVwiKSwgdSA9IGYub2Zmc2V0KCksIG8gPSB3LmNzcyhlLCBcInRvcFwiKSwgcyA9IHcuY3NzKGUsIFwibGVmdFwiKSwgKGwgPSAoXCJhYnNvbHV0ZVwiID09PSBjIHx8IFwiZml4ZWRcIiA9PT0gYykgJiYgKG8gKyBzKS5pbmRleE9mKFwiYXV0b1wiKSA+IC0xKSA/IChhID0gKHIgPSBmLnBvc2l0aW9uKCkpLnRvcCwgaSA9IHIubGVmdCkgOiAoYSA9IHBhcnNlRmxvYXQobykgfHwgMCwgaSA9IHBhcnNlRmxvYXQocykgfHwgMCksIGcodCkgJiYgKHQgPSB0LmNhbGwoZSwgbiwgdy5leHRlbmQoe30sIHUpKSksIG51bGwgIT0gdC50b3AgJiYgKGQudG9wID0gdC50b3AgLSB1LnRvcCArIGEpLCBudWxsICE9IHQubGVmdCAmJiAoZC5sZWZ0ID0gdC5sZWZ0IC0gdS5sZWZ0ICsgaSksIFwidXNpbmdcIiBpbiB0ID8gdC51c2luZy5jYWxsKGUsIGQpIDogZi5jc3MoZCkgfSB9LCB3LmZuLmV4dGVuZCh7IG9mZnNldDogZnVuY3Rpb24gKGUpIHsgaWYgKGFyZ3VtZW50cy5sZW5ndGgpIHJldHVybiB2b2lkIDAgPT09IGUgPyB0aGlzIDogdGhpcy5lYWNoKGZ1bmN0aW9uICh0KSB7IHcub2Zmc2V0LnNldE9mZnNldCh0aGlzLCBlLCB0KSB9KTsgdmFyIHQsIG4sIHIgPSB0aGlzWzBdOyBpZiAocikgcmV0dXJuIHIuZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggPyAodCA9IHIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksIG4gPSByLm93bmVyRG9jdW1lbnQuZGVmYXVsdFZpZXcsIHsgdG9wOiB0LnRvcCArIG4ucGFnZVlPZmZzZXQsIGxlZnQ6IHQubGVmdCArIG4ucGFnZVhPZmZzZXQgfSkgOiB7IHRvcDogMCwgbGVmdDogMCB9IH0sIHBvc2l0aW9uOiBmdW5jdGlvbiAoKSB7IGlmICh0aGlzWzBdKSB7IHZhciBlLCB0LCBuLCByID0gdGhpc1swXSwgaSA9IHsgdG9wOiAwLCBsZWZ0OiAwIH07IGlmIChcImZpeGVkXCIgPT09IHcuY3NzKHIsIFwicG9zaXRpb25cIikpIHQgPSByLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyBlbHNlIHsgdCA9IHRoaXMub2Zmc2V0KCksIG4gPSByLm93bmVyRG9jdW1lbnQsIGUgPSByLm9mZnNldFBhcmVudCB8fCBuLmRvY3VtZW50RWxlbWVudDsgd2hpbGUgKGUgJiYgKGUgPT09IG4uYm9keSB8fCBlID09PSBuLmRvY3VtZW50RWxlbWVudCkgJiYgXCJzdGF0aWNcIiA9PT0gdy5jc3MoZSwgXCJwb3NpdGlvblwiKSkgZSA9IGUucGFyZW50Tm9kZTsgZSAmJiBlICE9PSByICYmIDEgPT09IGUubm9kZVR5cGUgJiYgKChpID0gdyhlKS5vZmZzZXQoKSkudG9wICs9IHcuY3NzKGUsIFwiYm9yZGVyVG9wV2lkdGhcIiwgITApLCBpLmxlZnQgKz0gdy5jc3MoZSwgXCJib3JkZXJMZWZ0V2lkdGhcIiwgITApKSB9IHJldHVybiB7IHRvcDogdC50b3AgLSBpLnRvcCAtIHcuY3NzKHIsIFwibWFyZ2luVG9wXCIsICEwKSwgbGVmdDogdC5sZWZ0IC0gaS5sZWZ0IC0gdy5jc3MociwgXCJtYXJnaW5MZWZ0XCIsICEwKSB9IH0gfSwgb2Zmc2V0UGFyZW50OiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLm1hcChmdW5jdGlvbiAoKSB7IHZhciBlID0gdGhpcy5vZmZzZXRQYXJlbnQ7IHdoaWxlIChlICYmIFwic3RhdGljXCIgPT09IHcuY3NzKGUsIFwicG9zaXRpb25cIikpIGUgPSBlLm9mZnNldFBhcmVudDsgcmV0dXJuIGUgfHwgeGUgfSkgfSB9KSwgdy5lYWNoKHsgc2Nyb2xsTGVmdDogXCJwYWdlWE9mZnNldFwiLCBzY3JvbGxUb3A6IFwicGFnZVlPZmZzZXRcIiB9LCBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IFwicGFnZVlPZmZzZXRcIiA9PT0gdDsgdy5mbltlXSA9IGZ1bmN0aW9uIChyKSB7IHJldHVybiBfKHRoaXMsIGZ1bmN0aW9uIChlLCByLCBpKSB7IHZhciBvOyBpZiAodihlKSA/IG8gPSBlIDogOSA9PT0gZS5ub2RlVHlwZSAmJiAobyA9IGUuZGVmYXVsdFZpZXcpLCB2b2lkIDAgPT09IGkpIHJldHVybiBvID8gb1t0XSA6IGVbcl07IG8gPyBvLnNjcm9sbFRvKG4gPyBvLnBhZ2VYT2Zmc2V0IDogaSwgbiA/IGkgOiBvLnBhZ2VZT2Zmc2V0KSA6IGVbcl0gPSBpIH0sIGUsIHIsIGFyZ3VtZW50cy5sZW5ndGgpIH0gfSksIHcuZWFjaChbXCJ0b3BcIiwgXCJsZWZ0XCJdLCBmdW5jdGlvbiAoZSwgdCkgeyB3LmNzc0hvb2tzW3RdID0gemUoaC5waXhlbFBvc2l0aW9uLCBmdW5jdGlvbiAoZSwgbikgeyBpZiAobikgcmV0dXJuIG4gPSBGZShlLCB0KSwgTWUudGVzdChuKSA/IHcoZSkucG9zaXRpb24oKVt0XSArIFwicHhcIiA6IG4gfSkgfSksIHcuZWFjaCh7IEhlaWdodDogXCJoZWlnaHRcIiwgV2lkdGg6IFwid2lkdGhcIiB9LCBmdW5jdGlvbiAoZSwgdCkgeyB3LmVhY2goeyBwYWRkaW5nOiBcImlubmVyXCIgKyBlLCBjb250ZW50OiB0LCBcIlwiOiBcIm91dGVyXCIgKyBlIH0sIGZ1bmN0aW9uIChuLCByKSB7IHcuZm5bcl0gPSBmdW5jdGlvbiAoaSwgbykgeyB2YXIgYSA9IGFyZ3VtZW50cy5sZW5ndGggJiYgKG4gfHwgXCJib29sZWFuXCIgIT0gdHlwZW9mIGkpLCB1ID0gbiB8fCAoITAgPT09IGkgfHwgITAgPT09IG8gPyBcIm1hcmdpblwiIDogXCJib3JkZXJcIik7IHJldHVybiBfKHRoaXMsIGZ1bmN0aW9uICh0LCBuLCBpKSB7IHZhciBvOyByZXR1cm4gdih0KSA/IDAgPT09IHIuaW5kZXhPZihcIm91dGVyXCIpID8gdFtcImlubmVyXCIgKyBlXSA6IHQuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50W1wiY2xpZW50XCIgKyBlXSA6IDkgPT09IHQubm9kZVR5cGUgPyAobyA9IHQuZG9jdW1lbnRFbGVtZW50LCBNYXRoLm1heCh0LmJvZHlbXCJzY3JvbGxcIiArIGVdLCBvW1wic2Nyb2xsXCIgKyBlXSwgdC5ib2R5W1wib2Zmc2V0XCIgKyBlXSwgb1tcIm9mZnNldFwiICsgZV0sIG9bXCJjbGllbnRcIiArIGVdKSkgOiB2b2lkIDAgPT09IGkgPyB3LmNzcyh0LCBuLCB1KSA6IHcuc3R5bGUodCwgbiwgaSwgdSkgfSwgdCwgYSA/IGkgOiB2b2lkIDAsIGEpIH0gfSkgfSksIHcuZWFjaChcImJsdXIgZm9jdXMgZm9jdXNpbiBmb2N1c291dCByZXNpemUgc2Nyb2xsIGNsaWNrIGRibGNsaWNrIG1vdXNlZG93biBtb3VzZXVwIG1vdXNlbW92ZSBtb3VzZW92ZXIgbW91c2VvdXQgbW91c2VlbnRlciBtb3VzZWxlYXZlIGNoYW5nZSBzZWxlY3Qgc3VibWl0IGtleWRvd24ga2V5cHJlc3Mga2V5dXAgY29udGV4dG1lbnVcIi5zcGxpdChcIiBcIiksIGZ1bmN0aW9uIChlLCB0KSB7IHcuZm5bdF0gPSBmdW5jdGlvbiAoZSwgbikgeyByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA+IDAgPyB0aGlzLm9uKHQsIG51bGwsIGUsIG4pIDogdGhpcy50cmlnZ2VyKHQpIH0gfSksIHcuZm4uZXh0ZW5kKHsgaG92ZXI6IGZ1bmN0aW9uIChlLCB0KSB7IHJldHVybiB0aGlzLm1vdXNlZW50ZXIoZSkubW91c2VsZWF2ZSh0IHx8IGUpIH0gfSksIHcuZm4uZXh0ZW5kKHsgYmluZDogZnVuY3Rpb24gKGUsIHQsIG4pIHsgcmV0dXJuIHRoaXMub24oZSwgbnVsbCwgdCwgbikgfSwgdW5iaW5kOiBmdW5jdGlvbiAoZSwgdCkgeyByZXR1cm4gdGhpcy5vZmYoZSwgbnVsbCwgdCkgfSwgZGVsZWdhdGU6IGZ1bmN0aW9uIChlLCB0LCBuLCByKSB7IHJldHVybiB0aGlzLm9uKHQsIGUsIG4sIHIpIH0sIHVuZGVsZWdhdGU6IGZ1bmN0aW9uIChlLCB0LCBuKSB7IHJldHVybiAxID09PSBhcmd1bWVudHMubGVuZ3RoID8gdGhpcy5vZmYoZSwgXCIqKlwiKSA6IHRoaXMub2ZmKHQsIGUgfHwgXCIqKlwiLCBuKSB9IH0pLCB3LnByb3h5ID0gZnVuY3Rpb24gKGUsIHQpIHsgdmFyIG4sIHIsIGk7IGlmIChcInN0cmluZ1wiID09IHR5cGVvZiB0ICYmIChuID0gZVt0XSwgdCA9IGUsIGUgPSBuKSwgZyhlKSkgcmV0dXJuIHIgPSBvLmNhbGwoYXJndW1lbnRzLCAyKSwgaSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGUuYXBwbHkodCB8fCB0aGlzLCByLmNvbmNhdChvLmNhbGwoYXJndW1lbnRzKSkpIH0sIGkuZ3VpZCA9IGUuZ3VpZCA9IGUuZ3VpZCB8fCB3Lmd1aWQrKyAsIGkgfSwgdy5ob2xkUmVhZHkgPSBmdW5jdGlvbiAoZSkgeyBlID8gdy5yZWFkeVdhaXQrKyA6IHcucmVhZHkoITApIH0sIHcuaXNBcnJheSA9IEFycmF5LmlzQXJyYXksIHcucGFyc2VKU09OID0gSlNPTi5wYXJzZSwgdy5ub2RlTmFtZSA9IEQsIHcuaXNGdW5jdGlvbiA9IGcsIHcuaXNXaW5kb3cgPSB2LCB3LmNhbWVsQ2FzZSA9IFEsIHcudHlwZSA9IGIsIHcubm93ID0gRGF0ZS5ub3csIHcuaXNOdW1lcmljID0gZnVuY3Rpb24gKGUpIHsgdmFyIHQgPSB3LnR5cGUoZSk7IHJldHVybiAoXCJudW1iZXJcIiA9PT0gdCB8fCBcInN0cmluZ1wiID09PSB0KSAmJiAhaXNOYU4oZSAtIHBhcnNlRmxvYXQoZSkpIH0sIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZGVmaW5lICYmIGRlZmluZS5hbWQgJiYgZGVmaW5lKFwianF1ZXJ5XCIsIFtdLCBmdW5jdGlvbiAoKSB7IHJldHVybiB3IH0pOyB2YXIgdnQgPSBlLmpRdWVyeSwgeXQgPSBlLiQ7IHJldHVybiB3Lm5vQ29uZmxpY3QgPSBmdW5jdGlvbiAodCkgeyByZXR1cm4gZS4kID09PSB3ICYmIChlLiQgPSB5dCksIHQgJiYgZS5qUXVlcnkgPT09IHcgJiYgKGUualF1ZXJ5ID0gdnQpLCB3IH0sIHQgfHwgKGUualF1ZXJ5ID0gZS4kID0gdyksIHcgfSk7IiwialF1ZXJ5LmZuLmV4dGVuZCh7XHJcbiAgICBmYWRlSW46IGZ1bmN0aW9uKG1zKSB7XHJcbiAgICAgICAgbGV0IGVsZW0gPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGVsZW0uY3NzKHtcclxuICAgICAgICAgICAgICAgICdvcGFjaXR5JzogMCxcclxuICAgICAgICAgICAgICAgICdmaWx0ZXInOiAnYWxwaGEob3BhY2l0eT0wKScsXHJcbiAgICAgICAgICAgICAgICAnZGlzcGxheSc6ICdibG9jaycsXHJcbiAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICd2aXNpYmxlJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWYgKG1zKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgb3BhY2l0eSA9IDA7XHJcbiAgICAgICAgICAgICAgICB2YXIgdGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgb3BhY2l0eSArPSA1MCAvIG1zO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcGFjaXR5ID49IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aW1lcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHkgPSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW0uY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ29wYWNpdHknOiBvcGFjaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZmlsdGVyJzogJ2FscGhhKG9wYWNpdHk9JyArIG9wYWNpdHkgKiAxMDAgKyAnKSdcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0sIDUwKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGVsZW0uY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAnb3BhY2l0eSc6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2ZpbHRlcic6ICdhbHBoYShvcGFjaXR5PTEpJ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KVxyXG4gICAgfSxcclxuICAgIGZhZGVPdXQ6IGZ1bmN0aW9uKG1zKSB7XHJcbiAgICAgICAgbGV0IGVsZW0gPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgICAgIGlmIChtcykge1xyXG4gICAgICAgICAgICAgICAgdmFyIG9wYWNpdHkgPSAxO1xyXG4gICAgICAgICAgICAgICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHkgLT0gNTAgLyBtcztcclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BhY2l0eSA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwodGltZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBvcGFjaXR5ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2Rpc3BsYXknOiAnbm9uZScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICdoaWRkZW4nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsZW0uY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ29wYWNpdHknOiBvcGFjaXR5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAnZmlsdGVyJzogJ2FscGhhKG9wYWNpdHk9JyArIG9wYWNpdHkgKiAxMDAgKyAnKSdcclxuICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgfSwgNTApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZWxlbS5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICdvcGFjaXR5JzogMCxcclxuICAgICAgICAgICAgICAgICAgICAnZmlsdGVyJzogJ2FscGhhKG9wYWNpdHk9MCknLFxyXG4gICAgICAgICAgICAgICAgICAgICdkaXNwbGF5JzogJ25vbmUnLFxyXG4gICAgICAgICAgICAgICAgICAgICd2aXNpYmlsaXR5JzogJ2hpZGRlbidcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSlcclxuICAgIH1cclxufSk7XHJcbiIsIi8qISBqUXVlcnkgVmFsaWRhdGlvbiBQbHVnaW4gLSB2MS4xNy4wIC0gNy8yOS8yMDE3XHJcbiAqIGh0dHBzOi8vanF1ZXJ5dmFsaWRhdGlvbi5vcmcvXHJcbiAqIENvcHlyaWdodCAoYykgMjAxNyBKw7ZybiBaYWVmZmVyZXI7IExpY2Vuc2VkIE1JVCAqL1xyXG4hZnVuY3Rpb24gKGEpIHsgXCJmdW5jdGlvblwiID09IHR5cGVvZiBkZWZpbmUgJiYgZGVmaW5lLmFtZCA/IGRlZmluZShbXCJqcXVlcnlcIl0sIGEpIDogXCJvYmplY3RcIiA9PSB0eXBlb2YgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzID8gbW9kdWxlLmV4cG9ydHMgPSBhKHJlcXVpcmUoXCJqcXVlcnlcIikpIDogYShqUXVlcnkpIH0oZnVuY3Rpb24gKGEpIHsgYS5leHRlbmQoYS5mbiwgeyB2YWxpZGF0ZTogZnVuY3Rpb24gKGIpIHsgaWYgKCF0aGlzLmxlbmd0aCkgcmV0dXJuIHZvaWQgKGIgJiYgYi5kZWJ1ZyAmJiB3aW5kb3cuY29uc29sZSAmJiBjb25zb2xlLndhcm4oXCJOb3RoaW5nIHNlbGVjdGVkLCBjYW4ndCB2YWxpZGF0ZSwgcmV0dXJuaW5nIG5vdGhpbmcuXCIpKTsgdmFyIGMgPSBhLmRhdGEodGhpc1swXSwgXCJ2YWxpZGF0b3JcIik7IHJldHVybiBjID8gYyA6ICh0aGlzLmF0dHIoXCJub3ZhbGlkYXRlXCIsIFwibm92YWxpZGF0ZVwiKSwgYyA9IG5ldyBhLnZhbGlkYXRvcihiLCB0aGlzWzBdKSwgYS5kYXRhKHRoaXNbMF0sIFwidmFsaWRhdG9yXCIsIGMpLCBjLnNldHRpbmdzLm9uc3VibWl0ICYmICh0aGlzLm9uKFwiY2xpY2sudmFsaWRhdGVcIiwgXCI6c3VibWl0XCIsIGZ1bmN0aW9uIChiKSB7IGMuc3VibWl0QnV0dG9uID0gYi5jdXJyZW50VGFyZ2V0LCBhKHRoaXMpLmhhc0NsYXNzKFwiY2FuY2VsXCIpICYmIChjLmNhbmNlbFN1Ym1pdCA9ICEwKSwgdm9pZCAwICE9PSBhKHRoaXMpLmF0dHIoXCJmb3Jtbm92YWxpZGF0ZVwiKSAmJiAoYy5jYW5jZWxTdWJtaXQgPSAhMCkgfSksIHRoaXMub24oXCJzdWJtaXQudmFsaWRhdGVcIiwgZnVuY3Rpb24gKGIpIHsgZnVuY3Rpb24gZCgpIHsgdmFyIGQsIGU7IHJldHVybiBjLnN1Ym1pdEJ1dHRvbiAmJiAoYy5zZXR0aW5ncy5zdWJtaXRIYW5kbGVyIHx8IGMuZm9ybVN1Ym1pdHRlZCkgJiYgKGQgPSBhKFwiPGlucHV0IHR5cGU9J2hpZGRlbicvPlwiKS5hdHRyKFwibmFtZVwiLCBjLnN1Ym1pdEJ1dHRvbi5uYW1lKS52YWwoYShjLnN1Ym1pdEJ1dHRvbikudmFsKCkpLmFwcGVuZFRvKGMuY3VycmVudEZvcm0pKSwgIWMuc2V0dGluZ3Muc3VibWl0SGFuZGxlciB8fCAoZSA9IGMuc2V0dGluZ3Muc3VibWl0SGFuZGxlci5jYWxsKGMsIGMuY3VycmVudEZvcm0sIGIpLCBkICYmIGQucmVtb3ZlKCksIHZvaWQgMCAhPT0gZSAmJiBlKSB9IHJldHVybiBjLnNldHRpbmdzLmRlYnVnICYmIGIucHJldmVudERlZmF1bHQoKSwgYy5jYW5jZWxTdWJtaXQgPyAoYy5jYW5jZWxTdWJtaXQgPSAhMSwgZCgpKSA6IGMuZm9ybSgpID8gYy5wZW5kaW5nUmVxdWVzdCA/IChjLmZvcm1TdWJtaXR0ZWQgPSAhMCwgITEpIDogZCgpIDogKGMuZm9jdXNJbnZhbGlkKCksICExKSB9KSksIGMpIH0sIHZhbGlkOiBmdW5jdGlvbiAoKSB7IHZhciBiLCBjLCBkOyByZXR1cm4gYSh0aGlzWzBdKS5pcyhcImZvcm1cIikgPyBiID0gdGhpcy52YWxpZGF0ZSgpLmZvcm0oKSA6IChkID0gW10sIGIgPSAhMCwgYyA9IGEodGhpc1swXS5mb3JtKS52YWxpZGF0ZSgpLCB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyBiID0gYy5lbGVtZW50KHRoaXMpICYmIGIsIGIgfHwgKGQgPSBkLmNvbmNhdChjLmVycm9yTGlzdCkpIH0pLCBjLmVycm9yTGlzdCA9IGQpLCBiIH0sIHJ1bGVzOiBmdW5jdGlvbiAoYiwgYykgeyB2YXIgZCwgZSwgZiwgZywgaCwgaSwgaiA9IHRoaXNbMF07IGlmIChudWxsICE9IGogJiYgKCFqLmZvcm0gJiYgai5oYXNBdHRyaWJ1dGUoXCJjb250ZW50ZWRpdGFibGVcIikgJiYgKGouZm9ybSA9IHRoaXMuY2xvc2VzdChcImZvcm1cIilbMF0sIGoubmFtZSA9IHRoaXMuYXR0cihcIm5hbWVcIikpLCBudWxsICE9IGouZm9ybSkpIHsgaWYgKGIpIHN3aXRjaCAoZCA9IGEuZGF0YShqLmZvcm0sIFwidmFsaWRhdG9yXCIpLnNldHRpbmdzLCBlID0gZC5ydWxlcywgZiA9IGEudmFsaWRhdG9yLnN0YXRpY1J1bGVzKGopLCBiKSB7IGNhc2UgXCJhZGRcIjogYS5leHRlbmQoZiwgYS52YWxpZGF0b3Iubm9ybWFsaXplUnVsZShjKSksIGRlbGV0ZSBmLm1lc3NhZ2VzLCBlW2oubmFtZV0gPSBmLCBjLm1lc3NhZ2VzICYmIChkLm1lc3NhZ2VzW2oubmFtZV0gPSBhLmV4dGVuZChkLm1lc3NhZ2VzW2oubmFtZV0sIGMubWVzc2FnZXMpKTsgYnJlYWs7IGNhc2UgXCJyZW1vdmVcIjogcmV0dXJuIGMgPyAoaSA9IHt9LCBhLmVhY2goYy5zcGxpdCgvXFxzLyksIGZ1bmN0aW9uIChhLCBiKSB7IGlbYl0gPSBmW2JdLCBkZWxldGUgZltiXSB9KSwgaSkgOiAoZGVsZXRlIGVbai5uYW1lXSwgZikgfXJldHVybiBnID0gYS52YWxpZGF0b3Iubm9ybWFsaXplUnVsZXMoYS5leHRlbmQoe30sIGEudmFsaWRhdG9yLmNsYXNzUnVsZXMoaiksIGEudmFsaWRhdG9yLmF0dHJpYnV0ZVJ1bGVzKGopLCBhLnZhbGlkYXRvci5kYXRhUnVsZXMoaiksIGEudmFsaWRhdG9yLnN0YXRpY1J1bGVzKGopKSwgaiksIGcucmVxdWlyZWQgJiYgKGggPSBnLnJlcXVpcmVkLCBkZWxldGUgZy5yZXF1aXJlZCwgZyA9IGEuZXh0ZW5kKHsgcmVxdWlyZWQ6IGggfSwgZykpLCBnLnJlbW90ZSAmJiAoaCA9IGcucmVtb3RlLCBkZWxldGUgZy5yZW1vdGUsIGcgPSBhLmV4dGVuZChnLCB7IHJlbW90ZTogaCB9KSksIGcgfSB9IH0pLCBhLmV4dGVuZChhLmV4cHIucHNldWRvcyB8fCBhLmV4cHJbXCI6XCJdLCB7IGJsYW5rOiBmdW5jdGlvbiAoYikgeyByZXR1cm4gIWEudHJpbShcIlwiICsgYShiKS52YWwoKSkgfSwgZmlsbGVkOiBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IGEoYikudmFsKCk7IHJldHVybiBudWxsICE9PSBjICYmICEhYS50cmltKFwiXCIgKyBjKSB9LCB1bmNoZWNrZWQ6IGZ1bmN0aW9uIChiKSB7IHJldHVybiAhYShiKS5wcm9wKFwiY2hlY2tlZFwiKSB9IH0pLCBhLnZhbGlkYXRvciA9IGZ1bmN0aW9uIChiLCBjKSB7IHRoaXMuc2V0dGluZ3MgPSBhLmV4dGVuZCghMCwge30sIGEudmFsaWRhdG9yLmRlZmF1bHRzLCBiKSwgdGhpcy5jdXJyZW50Rm9ybSA9IGMsIHRoaXMuaW5pdCgpIH0sIGEudmFsaWRhdG9yLmZvcm1hdCA9IGZ1bmN0aW9uIChiLCBjKSB7IHJldHVybiAxID09PSBhcmd1bWVudHMubGVuZ3RoID8gZnVuY3Rpb24gKCkgeyB2YXIgYyA9IGEubWFrZUFycmF5KGFyZ3VtZW50cyk7IHJldHVybiBjLnVuc2hpZnQoYiksIGEudmFsaWRhdG9yLmZvcm1hdC5hcHBseSh0aGlzLCBjKSB9IDogdm9pZCAwID09PSBjID8gYiA6IChhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBjLmNvbnN0cnVjdG9yICE9PSBBcnJheSAmJiAoYyA9IGEubWFrZUFycmF5KGFyZ3VtZW50cykuc2xpY2UoMSkpLCBjLmNvbnN0cnVjdG9yICE9PSBBcnJheSAmJiAoYyA9IFtjXSksIGEuZWFjaChjLCBmdW5jdGlvbiAoYSwgYykgeyBiID0gYi5yZXBsYWNlKG5ldyBSZWdFeHAoXCJcXFxce1wiICsgYSArIFwiXFxcXH1cIiwgXCJnXCIpLCBmdW5jdGlvbiAoKSB7IHJldHVybiBjIH0pIH0pLCBiKSB9LCBhLmV4dGVuZChhLnZhbGlkYXRvciwgeyBkZWZhdWx0czogeyBtZXNzYWdlczoge30sIGdyb3Vwczoge30sIHJ1bGVzOiB7fSwgZXJyb3JDbGFzczogXCJlcnJvclwiLCBwZW5kaW5nQ2xhc3M6IFwicGVuZGluZ1wiLCB2YWxpZENsYXNzOiBcInZhbGlkXCIsIGVycm9yRWxlbWVudDogXCJsYWJlbFwiLCBmb2N1c0NsZWFudXA6ICExLCBmb2N1c0ludmFsaWQ6ICEwLCBlcnJvckNvbnRhaW5lcjogYShbXSksIGVycm9yTGFiZWxDb250YWluZXI6IGEoW10pLCBvbnN1Ym1pdDogITAsIGlnbm9yZTogXCI6aGlkZGVuXCIsIGlnbm9yZVRpdGxlOiAhMSwgb25mb2N1c2luOiBmdW5jdGlvbiAoYSkgeyB0aGlzLmxhc3RBY3RpdmUgPSBhLCB0aGlzLnNldHRpbmdzLmZvY3VzQ2xlYW51cCAmJiAodGhpcy5zZXR0aW5ncy51bmhpZ2hsaWdodCAmJiB0aGlzLnNldHRpbmdzLnVuaGlnaGxpZ2h0LmNhbGwodGhpcywgYSwgdGhpcy5zZXR0aW5ncy5lcnJvckNsYXNzLCB0aGlzLnNldHRpbmdzLnZhbGlkQ2xhc3MpLCB0aGlzLmhpZGVUaGVzZSh0aGlzLmVycm9yc0ZvcihhKSkpIH0sIG9uZm9jdXNvdXQ6IGZ1bmN0aW9uIChhKSB7IHRoaXMuY2hlY2thYmxlKGEpIHx8ICEoYS5uYW1lIGluIHRoaXMuc3VibWl0dGVkKSAmJiB0aGlzLm9wdGlvbmFsKGEpIHx8IHRoaXMuZWxlbWVudChhKSB9LCBvbmtleXVwOiBmdW5jdGlvbiAoYiwgYykgeyB2YXIgZCA9IFsxNiwgMTcsIDE4LCAyMCwgMzUsIDM2LCAzNywgMzgsIDM5LCA0MCwgNDUsIDE0NCwgMjI1XTsgOSA9PT0gYy53aGljaCAmJiBcIlwiID09PSB0aGlzLmVsZW1lbnRWYWx1ZShiKSB8fCBhLmluQXJyYXkoYy5rZXlDb2RlLCBkKSAhPT0gLTEgfHwgKGIubmFtZSBpbiB0aGlzLnN1Ym1pdHRlZCB8fCBiLm5hbWUgaW4gdGhpcy5pbnZhbGlkKSAmJiB0aGlzLmVsZW1lbnQoYikgfSwgb25jbGljazogZnVuY3Rpb24gKGEpIHsgYS5uYW1lIGluIHRoaXMuc3VibWl0dGVkID8gdGhpcy5lbGVtZW50KGEpIDogYS5wYXJlbnROb2RlLm5hbWUgaW4gdGhpcy5zdWJtaXR0ZWQgJiYgdGhpcy5lbGVtZW50KGEucGFyZW50Tm9kZSkgfSwgaGlnaGxpZ2h0OiBmdW5jdGlvbiAoYiwgYywgZCkgeyBcInJhZGlvXCIgPT09IGIudHlwZSA/IHRoaXMuZmluZEJ5TmFtZShiLm5hbWUpLmFkZENsYXNzKGMpLnJlbW92ZUNsYXNzKGQpIDogYShiKS5hZGRDbGFzcyhjKS5yZW1vdmVDbGFzcyhkKSB9LCB1bmhpZ2hsaWdodDogZnVuY3Rpb24gKGIsIGMsIGQpIHsgXCJyYWRpb1wiID09PSBiLnR5cGUgPyB0aGlzLmZpbmRCeU5hbWUoYi5uYW1lKS5yZW1vdmVDbGFzcyhjKS5hZGRDbGFzcyhkKSA6IGEoYikucmVtb3ZlQ2xhc3MoYykuYWRkQ2xhc3MoZCkgfSB9LCBzZXREZWZhdWx0czogZnVuY3Rpb24gKGIpIHsgYS5leHRlbmQoYS52YWxpZGF0b3IuZGVmYXVsdHMsIGIpIH0sIG1lc3NhZ2VzOiB7IHJlcXVpcmVkOiBcIlRoaXMgZmllbGQgaXMgcmVxdWlyZWQuXCIsIHJlbW90ZTogXCJQbGVhc2UgZml4IHRoaXMgZmllbGQuXCIsIGVtYWlsOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3MuXCIsIHVybDogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBVUkwuXCIsIGRhdGU6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgZGF0ZS5cIiwgZGF0ZUlTTzogXCJQbGVhc2UgZW50ZXIgYSB2YWxpZCBkYXRlIChJU08pLlwiLCBudW1iZXI6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgbnVtYmVyLlwiLCBkaWdpdHM6IFwiUGxlYXNlIGVudGVyIG9ubHkgZGlnaXRzLlwiLCBlcXVhbFRvOiBcIlBsZWFzZSBlbnRlciB0aGUgc2FtZSB2YWx1ZSBhZ2Fpbi5cIiwgbWF4bGVuZ3RoOiBhLnZhbGlkYXRvci5mb3JtYXQoXCJQbGVhc2UgZW50ZXIgbm8gbW9yZSB0aGFuIHswfSBjaGFyYWN0ZXJzLlwiKSwgbWlubGVuZ3RoOiBhLnZhbGlkYXRvci5mb3JtYXQoXCJQbGVhc2UgZW50ZXIgYXQgbGVhc3QgezB9IGNoYXJhY3RlcnMuXCIpLCByYW5nZWxlbmd0aDogYS52YWxpZGF0b3IuZm9ybWF0KFwiUGxlYXNlIGVudGVyIGEgdmFsdWUgYmV0d2VlbiB7MH0gYW5kIHsxfSBjaGFyYWN0ZXJzIGxvbmcuXCIpLCByYW5nZTogYS52YWxpZGF0b3IuZm9ybWF0KFwiUGxlYXNlIGVudGVyIGEgdmFsdWUgYmV0d2VlbiB7MH0gYW5kIHsxfS5cIiksIG1heDogYS52YWxpZGF0b3IuZm9ybWF0KFwiUGxlYXNlIGVudGVyIGEgdmFsdWUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvIHswfS5cIiksIG1pbjogYS52YWxpZGF0b3IuZm9ybWF0KFwiUGxlYXNlIGVudGVyIGEgdmFsdWUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvIHswfS5cIiksIHN0ZXA6IGEudmFsaWRhdG9yLmZvcm1hdChcIlBsZWFzZSBlbnRlciBhIG11bHRpcGxlIG9mIHswfS5cIikgfSwgYXV0b0NyZWF0ZVJhbmdlczogITEsIHByb3RvdHlwZTogeyBpbml0OiBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGIoYikgeyAhdGhpcy5mb3JtICYmIHRoaXMuaGFzQXR0cmlidXRlKFwiY29udGVudGVkaXRhYmxlXCIpICYmICh0aGlzLmZvcm0gPSBhKHRoaXMpLmNsb3Nlc3QoXCJmb3JtXCIpWzBdLCB0aGlzLm5hbWUgPSBhKHRoaXMpLmF0dHIoXCJuYW1lXCIpKTsgdmFyIGMgPSBhLmRhdGEodGhpcy5mb3JtLCBcInZhbGlkYXRvclwiKSwgZCA9IFwib25cIiArIGIudHlwZS5yZXBsYWNlKC9edmFsaWRhdGUvLCBcIlwiKSwgZSA9IGMuc2V0dGluZ3M7IGVbZF0gJiYgIWEodGhpcykuaXMoZS5pZ25vcmUpICYmIGVbZF0uY2FsbChjLCB0aGlzLCBiKSB9IHRoaXMubGFiZWxDb250YWluZXIgPSBhKHRoaXMuc2V0dGluZ3MuZXJyb3JMYWJlbENvbnRhaW5lciksIHRoaXMuZXJyb3JDb250ZXh0ID0gdGhpcy5sYWJlbENvbnRhaW5lci5sZW5ndGggJiYgdGhpcy5sYWJlbENvbnRhaW5lciB8fCBhKHRoaXMuY3VycmVudEZvcm0pLCB0aGlzLmNvbnRhaW5lcnMgPSBhKHRoaXMuc2V0dGluZ3MuZXJyb3JDb250YWluZXIpLmFkZCh0aGlzLnNldHRpbmdzLmVycm9yTGFiZWxDb250YWluZXIpLCB0aGlzLnN1Ym1pdHRlZCA9IHt9LCB0aGlzLnZhbHVlQ2FjaGUgPSB7fSwgdGhpcy5wZW5kaW5nUmVxdWVzdCA9IDAsIHRoaXMucGVuZGluZyA9IHt9LCB0aGlzLmludmFsaWQgPSB7fSwgdGhpcy5yZXNldCgpOyB2YXIgYywgZCA9IHRoaXMuZ3JvdXBzID0ge307IGEuZWFjaCh0aGlzLnNldHRpbmdzLmdyb3VwcywgZnVuY3Rpb24gKGIsIGMpIHsgXCJzdHJpbmdcIiA9PSB0eXBlb2YgYyAmJiAoYyA9IGMuc3BsaXQoL1xccy8pKSwgYS5lYWNoKGMsIGZ1bmN0aW9uIChhLCBjKSB7IGRbY10gPSBiIH0pIH0pLCBjID0gdGhpcy5zZXR0aW5ncy5ydWxlcywgYS5lYWNoKGMsIGZ1bmN0aW9uIChiLCBkKSB7IGNbYl0gPSBhLnZhbGlkYXRvci5ub3JtYWxpemVSdWxlKGQpIH0pLCBhKHRoaXMuY3VycmVudEZvcm0pLm9uKFwiZm9jdXNpbi52YWxpZGF0ZSBmb2N1c291dC52YWxpZGF0ZSBrZXl1cC52YWxpZGF0ZVwiLCBcIjp0ZXh0LCBbdHlwZT0ncGFzc3dvcmQnXSwgW3R5cGU9J2ZpbGUnXSwgc2VsZWN0LCB0ZXh0YXJlYSwgW3R5cGU9J251bWJlciddLCBbdHlwZT0nc2VhcmNoJ10sIFt0eXBlPSd0ZWwnXSwgW3R5cGU9J3VybCddLCBbdHlwZT0nZW1haWwnXSwgW3R5cGU9J2RhdGV0aW1lJ10sIFt0eXBlPSdkYXRlJ10sIFt0eXBlPSdtb250aCddLCBbdHlwZT0nd2VlayddLCBbdHlwZT0ndGltZSddLCBbdHlwZT0nZGF0ZXRpbWUtbG9jYWwnXSwgW3R5cGU9J3JhbmdlJ10sIFt0eXBlPSdjb2xvciddLCBbdHlwZT0ncmFkaW8nXSwgW3R5cGU9J2NoZWNrYm94J10sIFtjb250ZW50ZWRpdGFibGVdLCBbdHlwZT0nYnV0dG9uJ11cIiwgYikub24oXCJjbGljay52YWxpZGF0ZVwiLCBcInNlbGVjdCwgb3B0aW9uLCBbdHlwZT0ncmFkaW8nXSwgW3R5cGU9J2NoZWNrYm94J11cIiwgYiksIHRoaXMuc2V0dGluZ3MuaW52YWxpZEhhbmRsZXIgJiYgYSh0aGlzLmN1cnJlbnRGb3JtKS5vbihcImludmFsaWQtZm9ybS52YWxpZGF0ZVwiLCB0aGlzLnNldHRpbmdzLmludmFsaWRIYW5kbGVyKSB9LCBmb3JtOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLmNoZWNrRm9ybSgpLCBhLmV4dGVuZCh0aGlzLnN1Ym1pdHRlZCwgdGhpcy5lcnJvck1hcCksIHRoaXMuaW52YWxpZCA9IGEuZXh0ZW5kKHt9LCB0aGlzLmVycm9yTWFwKSwgdGhpcy52YWxpZCgpIHx8IGEodGhpcy5jdXJyZW50Rm9ybSkudHJpZ2dlckhhbmRsZXIoXCJpbnZhbGlkLWZvcm1cIiwgW3RoaXNdKSwgdGhpcy5zaG93RXJyb3JzKCksIHRoaXMudmFsaWQoKSB9LCBjaGVja0Zvcm06IGZ1bmN0aW9uICgpIHsgdGhpcy5wcmVwYXJlRm9ybSgpOyBmb3IgKHZhciBhID0gMCwgYiA9IHRoaXMuY3VycmVudEVsZW1lbnRzID0gdGhpcy5lbGVtZW50cygpOyBiW2FdOyBhKyspdGhpcy5jaGVjayhiW2FdKTsgcmV0dXJuIHRoaXMudmFsaWQoKSB9LCBlbGVtZW50OiBmdW5jdGlvbiAoYikgeyB2YXIgYywgZCwgZSA9IHRoaXMuY2xlYW4oYiksIGYgPSB0aGlzLnZhbGlkYXRpb25UYXJnZXRGb3IoZSksIGcgPSB0aGlzLCBoID0gITA7IHJldHVybiB2b2lkIDAgPT09IGYgPyBkZWxldGUgdGhpcy5pbnZhbGlkW2UubmFtZV0gOiAodGhpcy5wcmVwYXJlRWxlbWVudChmKSwgdGhpcy5jdXJyZW50RWxlbWVudHMgPSBhKGYpLCBkID0gdGhpcy5ncm91cHNbZi5uYW1lXSwgZCAmJiBhLmVhY2godGhpcy5ncm91cHMsIGZ1bmN0aW9uIChhLCBiKSB7IGIgPT09IGQgJiYgYSAhPT0gZi5uYW1lICYmIChlID0gZy52YWxpZGF0aW9uVGFyZ2V0Rm9yKGcuY2xlYW4oZy5maW5kQnlOYW1lKGEpKSksIGUgJiYgZS5uYW1lIGluIGcuaW52YWxpZCAmJiAoZy5jdXJyZW50RWxlbWVudHMucHVzaChlKSwgaCA9IGcuY2hlY2soZSkgJiYgaCkpIH0pLCBjID0gdGhpcy5jaGVjayhmKSAhPT0gITEsIGggPSBoICYmIGMsIGMgPyB0aGlzLmludmFsaWRbZi5uYW1lXSA9ICExIDogdGhpcy5pbnZhbGlkW2YubmFtZV0gPSAhMCwgdGhpcy5udW1iZXJPZkludmFsaWRzKCkgfHwgKHRoaXMudG9IaWRlID0gdGhpcy50b0hpZGUuYWRkKHRoaXMuY29udGFpbmVycykpLCB0aGlzLnNob3dFcnJvcnMoKSwgYShiKS5hdHRyKFwiYXJpYS1pbnZhbGlkXCIsICFjKSksIGggfSwgc2hvd0Vycm9yczogZnVuY3Rpb24gKGIpIHsgaWYgKGIpIHsgdmFyIGMgPSB0aGlzOyBhLmV4dGVuZCh0aGlzLmVycm9yTWFwLCBiKSwgdGhpcy5lcnJvckxpc3QgPSBhLm1hcCh0aGlzLmVycm9yTWFwLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4geyBtZXNzYWdlOiBhLCBlbGVtZW50OiBjLmZpbmRCeU5hbWUoYilbMF0gfSB9KSwgdGhpcy5zdWNjZXNzTGlzdCA9IGEuZ3JlcCh0aGlzLnN1Y2Nlc3NMaXN0LCBmdW5jdGlvbiAoYSkgeyByZXR1cm4gIShhLm5hbWUgaW4gYikgfSkgfSB0aGlzLnNldHRpbmdzLnNob3dFcnJvcnMgPyB0aGlzLnNldHRpbmdzLnNob3dFcnJvcnMuY2FsbCh0aGlzLCB0aGlzLmVycm9yTWFwLCB0aGlzLmVycm9yTGlzdCkgOiB0aGlzLmRlZmF1bHRTaG93RXJyb3JzKCkgfSwgcmVzZXRGb3JtOiBmdW5jdGlvbiAoKSB7IGEuZm4ucmVzZXRGb3JtICYmIGEodGhpcy5jdXJyZW50Rm9ybSkucmVzZXRGb3JtKCksIHRoaXMuaW52YWxpZCA9IHt9LCB0aGlzLnN1Ym1pdHRlZCA9IHt9LCB0aGlzLnByZXBhcmVGb3JtKCksIHRoaXMuaGlkZUVycm9ycygpOyB2YXIgYiA9IHRoaXMuZWxlbWVudHMoKS5yZW1vdmVEYXRhKFwicHJldmlvdXNWYWx1ZVwiKS5yZW1vdmVBdHRyKFwiYXJpYS1pbnZhbGlkXCIpOyB0aGlzLnJlc2V0RWxlbWVudHMoYikgfSwgcmVzZXRFbGVtZW50czogZnVuY3Rpb24gKGEpIHsgdmFyIGI7IGlmICh0aGlzLnNldHRpbmdzLnVuaGlnaGxpZ2h0KSBmb3IgKGIgPSAwOyBhW2JdOyBiKyspdGhpcy5zZXR0aW5ncy51bmhpZ2hsaWdodC5jYWxsKHRoaXMsIGFbYl0sIHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcywgXCJcIiksIHRoaXMuZmluZEJ5TmFtZShhW2JdLm5hbWUpLnJlbW92ZUNsYXNzKHRoaXMuc2V0dGluZ3MudmFsaWRDbGFzcyk7IGVsc2UgYS5yZW1vdmVDbGFzcyh0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MpLnJlbW92ZUNsYXNzKHRoaXMuc2V0dGluZ3MudmFsaWRDbGFzcykgfSwgbnVtYmVyT2ZJbnZhbGlkczogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5vYmplY3RMZW5ndGgodGhpcy5pbnZhbGlkKSB9LCBvYmplY3RMZW5ndGg6IGZ1bmN0aW9uIChhKSB7IHZhciBiLCBjID0gMDsgZm9yIChiIGluIGEpIHZvaWQgMCAhPT0gYVtiXSAmJiBudWxsICE9PSBhW2JdICYmIGFbYl0gIT09ICExICYmIGMrKzsgcmV0dXJuIGMgfSwgaGlkZUVycm9yczogZnVuY3Rpb24gKCkgeyB0aGlzLmhpZGVUaGVzZSh0aGlzLnRvSGlkZSkgfSwgaGlkZVRoZXNlOiBmdW5jdGlvbiAoYSkgeyBhLm5vdCh0aGlzLmNvbnRhaW5lcnMpLnRleHQoXCJcIiksIHRoaXMuYWRkV3JhcHBlcihhKS5oaWRlKCkgfSwgdmFsaWQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIDAgPT09IHRoaXMuc2l6ZSgpIH0sIHNpemU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZXJyb3JMaXN0Lmxlbmd0aCB9LCBmb2N1c0ludmFsaWQ6IGZ1bmN0aW9uICgpIHsgaWYgKHRoaXMuc2V0dGluZ3MuZm9jdXNJbnZhbGlkKSB0cnkgeyBhKHRoaXMuZmluZExhc3RBY3RpdmUoKSB8fCB0aGlzLmVycm9yTGlzdC5sZW5ndGggJiYgdGhpcy5lcnJvckxpc3RbMF0uZWxlbWVudCB8fCBbXSkuZmlsdGVyKFwiOnZpc2libGVcIikuZm9jdXMoKS50cmlnZ2VyKFwiZm9jdXNpblwiKSB9IGNhdGNoIChiKSB7IH0gfSwgZmluZExhc3RBY3RpdmU6IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSB0aGlzLmxhc3RBY3RpdmU7IHJldHVybiBiICYmIDEgPT09IGEuZ3JlcCh0aGlzLmVycm9yTGlzdCwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGEuZWxlbWVudC5uYW1lID09PSBiLm5hbWUgfSkubGVuZ3RoICYmIGIgfSwgZWxlbWVudHM6IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSB0aGlzLCBjID0ge307IHJldHVybiBhKHRoaXMuY3VycmVudEZvcm0pLmZpbmQoXCJpbnB1dCwgc2VsZWN0LCB0ZXh0YXJlYSwgW2NvbnRlbnRlZGl0YWJsZV1cIikubm90KFwiOnN1Ym1pdCwgOnJlc2V0LCA6aW1hZ2UsIDpkaXNhYmxlZFwiKS5ub3QodGhpcy5zZXR0aW5ncy5pZ25vcmUpLmZpbHRlcihmdW5jdGlvbiAoKSB7IHZhciBkID0gdGhpcy5uYW1lIHx8IGEodGhpcykuYXR0cihcIm5hbWVcIik7IHJldHVybiAhZCAmJiBiLnNldHRpbmdzLmRlYnVnICYmIHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUuZXJyb3IoXCIlbyBoYXMgbm8gbmFtZSBhc3NpZ25lZFwiLCB0aGlzKSwgdGhpcy5oYXNBdHRyaWJ1dGUoXCJjb250ZW50ZWRpdGFibGVcIikgJiYgKHRoaXMuZm9ybSA9IGEodGhpcykuY2xvc2VzdChcImZvcm1cIilbMF0sIHRoaXMubmFtZSA9IGQpLCAhKGQgaW4gYyB8fCAhYi5vYmplY3RMZW5ndGgoYSh0aGlzKS5ydWxlcygpKSkgJiYgKGNbZF0gPSAhMCwgITApIH0pIH0sIGNsZWFuOiBmdW5jdGlvbiAoYikgeyByZXR1cm4gYShiKVswXSB9LCBlcnJvcnM6IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3Muc3BsaXQoXCIgXCIpLmpvaW4oXCIuXCIpOyByZXR1cm4gYSh0aGlzLnNldHRpbmdzLmVycm9yRWxlbWVudCArIFwiLlwiICsgYiwgdGhpcy5lcnJvckNvbnRleHQpIH0sIHJlc2V0SW50ZXJuYWxzOiBmdW5jdGlvbiAoKSB7IHRoaXMuc3VjY2Vzc0xpc3QgPSBbXSwgdGhpcy5lcnJvckxpc3QgPSBbXSwgdGhpcy5lcnJvck1hcCA9IHt9LCB0aGlzLnRvU2hvdyA9IGEoW10pLCB0aGlzLnRvSGlkZSA9IGEoW10pIH0sIHJlc2V0OiBmdW5jdGlvbiAoKSB7IHRoaXMucmVzZXRJbnRlcm5hbHMoKSwgdGhpcy5jdXJyZW50RWxlbWVudHMgPSBhKFtdKSB9LCBwcmVwYXJlRm9ybTogZnVuY3Rpb24gKCkgeyB0aGlzLnJlc2V0KCksIHRoaXMudG9IaWRlID0gdGhpcy5lcnJvcnMoKS5hZGQodGhpcy5jb250YWluZXJzKSB9LCBwcmVwYXJlRWxlbWVudDogZnVuY3Rpb24gKGEpIHsgdGhpcy5yZXNldCgpLCB0aGlzLnRvSGlkZSA9IHRoaXMuZXJyb3JzRm9yKGEpIH0sIGVsZW1lbnRWYWx1ZTogZnVuY3Rpb24gKGIpIHsgdmFyIGMsIGQsIGUgPSBhKGIpLCBmID0gYi50eXBlOyByZXR1cm4gXCJyYWRpb1wiID09PSBmIHx8IFwiY2hlY2tib3hcIiA9PT0gZiA/IHRoaXMuZmluZEJ5TmFtZShiLm5hbWUpLmZpbHRlcihcIjpjaGVja2VkXCIpLnZhbCgpIDogXCJudW1iZXJcIiA9PT0gZiAmJiBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBiLnZhbGlkaXR5ID8gYi52YWxpZGl0eS5iYWRJbnB1dCA/IFwiTmFOXCIgOiBlLnZhbCgpIDogKGMgPSBiLmhhc0F0dHJpYnV0ZShcImNvbnRlbnRlZGl0YWJsZVwiKSA/IGUudGV4dCgpIDogZS52YWwoKSwgXCJmaWxlXCIgPT09IGYgPyBcIkM6XFxcXGZha2VwYXRoXFxcXFwiID09PSBjLnN1YnN0cigwLCAxMikgPyBjLnN1YnN0cigxMikgOiAoZCA9IGMubGFzdEluZGV4T2YoXCIvXCIpLCBkID49IDAgPyBjLnN1YnN0cihkICsgMSkgOiAoZCA9IGMubGFzdEluZGV4T2YoXCJcXFxcXCIpLCBkID49IDAgPyBjLnN1YnN0cihkICsgMSkgOiBjKSkgOiBcInN0cmluZ1wiID09IHR5cGVvZiBjID8gYy5yZXBsYWNlKC9cXHIvZywgXCJcIikgOiBjKSB9LCBjaGVjazogZnVuY3Rpb24gKGIpIHsgYiA9IHRoaXMudmFsaWRhdGlvblRhcmdldEZvcih0aGlzLmNsZWFuKGIpKTsgdmFyIGMsIGQsIGUsIGYsIGcgPSBhKGIpLnJ1bGVzKCksIGggPSBhLm1hcChnLCBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gYiB9KS5sZW5ndGgsIGkgPSAhMSwgaiA9IHRoaXMuZWxlbWVudFZhbHVlKGIpOyBpZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBnLm5vcm1hbGl6ZXIgPyBmID0gZy5ub3JtYWxpemVyIDogXCJmdW5jdGlvblwiID09IHR5cGVvZiB0aGlzLnNldHRpbmdzLm5vcm1hbGl6ZXIgJiYgKGYgPSB0aGlzLnNldHRpbmdzLm5vcm1hbGl6ZXIpLCBmKSB7IGlmIChqID0gZi5jYWxsKGIsIGopLCBcInN0cmluZ1wiICE9IHR5cGVvZiBqKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiVGhlIG5vcm1hbGl6ZXIgc2hvdWxkIHJldHVybiBhIHN0cmluZyB2YWx1ZS5cIik7IGRlbGV0ZSBnLm5vcm1hbGl6ZXIgfSBmb3IgKGQgaW4gZykgeyBlID0geyBtZXRob2Q6IGQsIHBhcmFtZXRlcnM6IGdbZF0gfTsgdHJ5IHsgaWYgKGMgPSBhLnZhbGlkYXRvci5tZXRob2RzW2RdLmNhbGwodGhpcywgaiwgYiwgZS5wYXJhbWV0ZXJzKSwgXCJkZXBlbmRlbmN5LW1pc21hdGNoXCIgPT09IGMgJiYgMSA9PT0gaCkgeyBpID0gITA7IGNvbnRpbnVlIH0gaWYgKGkgPSAhMSwgXCJwZW5kaW5nXCIgPT09IGMpIHJldHVybiB2b2lkICh0aGlzLnRvSGlkZSA9IHRoaXMudG9IaWRlLm5vdCh0aGlzLmVycm9yc0ZvcihiKSkpOyBpZiAoIWMpIHJldHVybiB0aGlzLmZvcm1hdEFuZEFkZChiLCBlKSwgITEgfSBjYXRjaCAoaykgeyB0aHJvdyB0aGlzLnNldHRpbmdzLmRlYnVnICYmIHdpbmRvdy5jb25zb2xlICYmIGNvbnNvbGUubG9nKFwiRXhjZXB0aW9uIG9jY3VycmVkIHdoZW4gY2hlY2tpbmcgZWxlbWVudCBcIiArIGIuaWQgKyBcIiwgY2hlY2sgdGhlICdcIiArIGUubWV0aG9kICsgXCInIG1ldGhvZC5cIiwgayksIGsgaW5zdGFuY2VvZiBUeXBlRXJyb3IgJiYgKGsubWVzc2FnZSArPSBcIi4gIEV4Y2VwdGlvbiBvY2N1cnJlZCB3aGVuIGNoZWNraW5nIGVsZW1lbnQgXCIgKyBiLmlkICsgXCIsIGNoZWNrIHRoZSAnXCIgKyBlLm1ldGhvZCArIFwiJyBtZXRob2QuXCIpLCBrIH0gfSBpZiAoIWkpIHJldHVybiB0aGlzLm9iamVjdExlbmd0aChnKSAmJiB0aGlzLnN1Y2Nlc3NMaXN0LnB1c2goYiksICEwIH0sIGN1c3RvbURhdGFNZXNzYWdlOiBmdW5jdGlvbiAoYiwgYykgeyByZXR1cm4gYShiKS5kYXRhKFwibXNnXCIgKyBjLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgYy5zdWJzdHJpbmcoMSkudG9Mb3dlckNhc2UoKSkgfHwgYShiKS5kYXRhKFwibXNnXCIpIH0sIGN1c3RvbU1lc3NhZ2U6IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdGhpcy5zZXR0aW5ncy5tZXNzYWdlc1thXTsgcmV0dXJuIGMgJiYgKGMuY29uc3RydWN0b3IgPT09IFN0cmluZyA/IGMgOiBjW2JdKSB9LCBmaW5kRGVmaW5lZDogZnVuY3Rpb24gKCkgeyBmb3IgKHZhciBhID0gMDsgYSA8IGFyZ3VtZW50cy5sZW5ndGg7IGErKylpZiAodm9pZCAwICE9PSBhcmd1bWVudHNbYV0pIHJldHVybiBhcmd1bWVudHNbYV0gfSwgZGVmYXVsdE1lc3NhZ2U6IGZ1bmN0aW9uIChiLCBjKSB7IFwic3RyaW5nXCIgPT0gdHlwZW9mIGMgJiYgKGMgPSB7IG1ldGhvZDogYyB9KTsgdmFyIGQgPSB0aGlzLmZpbmREZWZpbmVkKHRoaXMuY3VzdG9tTWVzc2FnZShiLm5hbWUsIGMubWV0aG9kKSwgdGhpcy5jdXN0b21EYXRhTWVzc2FnZShiLCBjLm1ldGhvZCksICF0aGlzLnNldHRpbmdzLmlnbm9yZVRpdGxlICYmIGIudGl0bGUgfHwgdm9pZCAwLCBhLnZhbGlkYXRvci5tZXNzYWdlc1tjLm1ldGhvZF0sIFwiPHN0cm9uZz5XYXJuaW5nOiBObyBtZXNzYWdlIGRlZmluZWQgZm9yIFwiICsgYi5uYW1lICsgXCI8L3N0cm9uZz5cIiksIGUgPSAvXFwkP1xceyhcXGQrKVxcfS9nOyByZXR1cm4gXCJmdW5jdGlvblwiID09IHR5cGVvZiBkID8gZCA9IGQuY2FsbCh0aGlzLCBjLnBhcmFtZXRlcnMsIGIpIDogZS50ZXN0KGQpICYmIChkID0gYS52YWxpZGF0b3IuZm9ybWF0KGQucmVwbGFjZShlLCBcInskMX1cIiksIGMucGFyYW1ldGVycykpLCBkIH0sIGZvcm1hdEFuZEFkZDogZnVuY3Rpb24gKGEsIGIpIHsgdmFyIGMgPSB0aGlzLmRlZmF1bHRNZXNzYWdlKGEsIGIpOyB0aGlzLmVycm9yTGlzdC5wdXNoKHsgbWVzc2FnZTogYywgZWxlbWVudDogYSwgbWV0aG9kOiBiLm1ldGhvZCB9KSwgdGhpcy5lcnJvck1hcFthLm5hbWVdID0gYywgdGhpcy5zdWJtaXR0ZWRbYS5uYW1lXSA9IGMgfSwgYWRkV3JhcHBlcjogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuc2V0dGluZ3Mud3JhcHBlciAmJiAoYSA9IGEuYWRkKGEucGFyZW50KHRoaXMuc2V0dGluZ3Mud3JhcHBlcikpKSwgYSB9LCBkZWZhdWx0U2hvd0Vycm9yczogZnVuY3Rpb24gKCkgeyB2YXIgYSwgYiwgYzsgZm9yIChhID0gMDsgdGhpcy5lcnJvckxpc3RbYV07IGErKyljID0gdGhpcy5lcnJvckxpc3RbYV0sIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0ICYmIHRoaXMuc2V0dGluZ3MuaGlnaGxpZ2h0LmNhbGwodGhpcywgYy5lbGVtZW50LCB0aGlzLnNldHRpbmdzLmVycm9yQ2xhc3MsIHRoaXMuc2V0dGluZ3MudmFsaWRDbGFzcyksIHRoaXMuc2hvd0xhYmVsKGMuZWxlbWVudCwgYy5tZXNzYWdlKTsgaWYgKHRoaXMuZXJyb3JMaXN0Lmxlbmd0aCAmJiAodGhpcy50b1Nob3cgPSB0aGlzLnRvU2hvdy5hZGQodGhpcy5jb250YWluZXJzKSksIHRoaXMuc2V0dGluZ3Muc3VjY2VzcykgZm9yIChhID0gMDsgdGhpcy5zdWNjZXNzTGlzdFthXTsgYSsrKXRoaXMuc2hvd0xhYmVsKHRoaXMuc3VjY2Vzc0xpc3RbYV0pOyBpZiAodGhpcy5zZXR0aW5ncy51bmhpZ2hsaWdodCkgZm9yIChhID0gMCwgYiA9IHRoaXMudmFsaWRFbGVtZW50cygpOyBiW2FdOyBhKyspdGhpcy5zZXR0aW5ncy51bmhpZ2hsaWdodC5jYWxsKHRoaXMsIGJbYV0sIHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcywgdGhpcy5zZXR0aW5ncy52YWxpZENsYXNzKTsgdGhpcy50b0hpZGUgPSB0aGlzLnRvSGlkZS5ub3QodGhpcy50b1Nob3cpLCB0aGlzLmhpZGVFcnJvcnMoKSwgdGhpcy5hZGRXcmFwcGVyKHRoaXMudG9TaG93KS5zaG93KCkgfSwgdmFsaWRFbGVtZW50czogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5jdXJyZW50RWxlbWVudHMubm90KHRoaXMuaW52YWxpZEVsZW1lbnRzKCkpIH0sIGludmFsaWRFbGVtZW50czogZnVuY3Rpb24gKCkgeyByZXR1cm4gYSh0aGlzLmVycm9yTGlzdCkubWFwKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuZWxlbWVudCB9KSB9LCBzaG93TGFiZWw6IGZ1bmN0aW9uIChiLCBjKSB7IHZhciBkLCBlLCBmLCBnLCBoID0gdGhpcy5lcnJvcnNGb3IoYiksIGkgPSB0aGlzLmlkT3JOYW1lKGIpLCBqID0gYShiKS5hdHRyKFwiYXJpYS1kZXNjcmliZWRieVwiKTsgaC5sZW5ndGggPyAoaC5yZW1vdmVDbGFzcyh0aGlzLnNldHRpbmdzLnZhbGlkQ2xhc3MpLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcyksIGguaHRtbChjKSkgOiAoaCA9IGEoXCI8XCIgKyB0aGlzLnNldHRpbmdzLmVycm9yRWxlbWVudCArIFwiPlwiKS5hdHRyKFwiaWRcIiwgaSArIFwiLWVycm9yXCIpLmFkZENsYXNzKHRoaXMuc2V0dGluZ3MuZXJyb3JDbGFzcykuaHRtbChjIHx8IFwiXCIpLCBkID0gaCwgdGhpcy5zZXR0aW5ncy53cmFwcGVyICYmIChkID0gaC5oaWRlKCkuc2hvdygpLndyYXAoXCI8XCIgKyB0aGlzLnNldHRpbmdzLndyYXBwZXIgKyBcIi8+XCIpLnBhcmVudCgpKSwgdGhpcy5sYWJlbENvbnRhaW5lci5sZW5ndGggPyB0aGlzLmxhYmVsQ29udGFpbmVyLmFwcGVuZChkKSA6IHRoaXMuc2V0dGluZ3MuZXJyb3JQbGFjZW1lbnQgPyB0aGlzLnNldHRpbmdzLmVycm9yUGxhY2VtZW50LmNhbGwodGhpcywgZCwgYShiKSkgOiBkLmluc2VydEFmdGVyKGIpLCBoLmlzKFwibGFiZWxcIikgPyBoLmF0dHIoXCJmb3JcIiwgaSkgOiAwID09PSBoLnBhcmVudHMoXCJsYWJlbFtmb3I9J1wiICsgdGhpcy5lc2NhcGVDc3NNZXRhKGkpICsgXCInXVwiKS5sZW5ndGggJiYgKGYgPSBoLmF0dHIoXCJpZFwiKSwgaiA/IGoubWF0Y2gobmV3IFJlZ0V4cChcIlxcXFxiXCIgKyB0aGlzLmVzY2FwZUNzc01ldGEoZikgKyBcIlxcXFxiXCIpKSB8fCAoaiArPSBcIiBcIiArIGYpIDogaiA9IGYsIGEoYikuYXR0cihcImFyaWEtZGVzY3JpYmVkYnlcIiwgaiksIGUgPSB0aGlzLmdyb3Vwc1tiLm5hbWVdLCBlICYmIChnID0gdGhpcywgYS5lYWNoKGcuZ3JvdXBzLCBmdW5jdGlvbiAoYiwgYykgeyBjID09PSBlICYmIGEoXCJbbmFtZT0nXCIgKyBnLmVzY2FwZUNzc01ldGEoYikgKyBcIiddXCIsIGcuY3VycmVudEZvcm0pLmF0dHIoXCJhcmlhLWRlc2NyaWJlZGJ5XCIsIGguYXR0cihcImlkXCIpKSB9KSkpKSwgIWMgJiYgdGhpcy5zZXR0aW5ncy5zdWNjZXNzICYmIChoLnRleHQoXCJcIiksIFwic3RyaW5nXCIgPT0gdHlwZW9mIHRoaXMuc2V0dGluZ3Muc3VjY2VzcyA/IGguYWRkQ2xhc3ModGhpcy5zZXR0aW5ncy5zdWNjZXNzKSA6IHRoaXMuc2V0dGluZ3Muc3VjY2VzcyhoLCBiKSksIHRoaXMudG9TaG93ID0gdGhpcy50b1Nob3cuYWRkKGgpIH0sIGVycm9yc0ZvcjogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSB0aGlzLmVzY2FwZUNzc01ldGEodGhpcy5pZE9yTmFtZShiKSksIGQgPSBhKGIpLmF0dHIoXCJhcmlhLWRlc2NyaWJlZGJ5XCIpLCBlID0gXCJsYWJlbFtmb3I9J1wiICsgYyArIFwiJ10sIGxhYmVsW2Zvcj0nXCIgKyBjICsgXCInXSAqXCI7IHJldHVybiBkICYmIChlID0gZSArIFwiLCAjXCIgKyB0aGlzLmVzY2FwZUNzc01ldGEoZCkucmVwbGFjZSgvXFxzKy9nLCBcIiwgI1wiKSksIHRoaXMuZXJyb3JzKCkuZmlsdGVyKGUpIH0sIGVzY2FwZUNzc01ldGE6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhLnJlcGxhY2UoLyhbXFxcXCFcIiMkJSYnKCkqKywuXFwvOjs8PT4/QFxcW1xcXV5ge3x9fl0pL2csIFwiXFxcXCQxXCIpIH0sIGlkT3JOYW1lOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5ncm91cHNbYS5uYW1lXSB8fCAodGhpcy5jaGVja2FibGUoYSkgPyBhLm5hbWUgOiBhLmlkIHx8IGEubmFtZSkgfSwgdmFsaWRhdGlvblRhcmdldEZvcjogZnVuY3Rpb24gKGIpIHsgcmV0dXJuIHRoaXMuY2hlY2thYmxlKGIpICYmIChiID0gdGhpcy5maW5kQnlOYW1lKGIubmFtZSkpLCBhKGIpLm5vdCh0aGlzLnNldHRpbmdzLmlnbm9yZSlbMF0gfSwgY2hlY2thYmxlOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gL3JhZGlvfGNoZWNrYm94L2kudGVzdChhLnR5cGUpIH0sIGZpbmRCeU5hbWU6IGZ1bmN0aW9uIChiKSB7IHJldHVybiBhKHRoaXMuY3VycmVudEZvcm0pLmZpbmQoXCJbbmFtZT0nXCIgKyB0aGlzLmVzY2FwZUNzc01ldGEoYikgKyBcIiddXCIpIH0sIGdldExlbmd0aDogZnVuY3Rpb24gKGIsIGMpIHsgc3dpdGNoIChjLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkpIHsgY2FzZSBcInNlbGVjdFwiOiByZXR1cm4gYShcIm9wdGlvbjpzZWxlY3RlZFwiLCBjKS5sZW5ndGg7IGNhc2UgXCJpbnB1dFwiOiBpZiAodGhpcy5jaGVja2FibGUoYykpIHJldHVybiB0aGlzLmZpbmRCeU5hbWUoYy5uYW1lKS5maWx0ZXIoXCI6Y2hlY2tlZFwiKS5sZW5ndGggfXJldHVybiBiLmxlbmd0aCB9LCBkZXBlbmQ6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiAhdGhpcy5kZXBlbmRUeXBlc1t0eXBlb2YgYV0gfHwgdGhpcy5kZXBlbmRUeXBlc1t0eXBlb2YgYV0oYSwgYikgfSwgZGVwZW5kVHlwZXM6IHsgXCJib29sZWFuXCI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBhIH0sIHN0cmluZzogZnVuY3Rpb24gKGIsIGMpIHsgcmV0dXJuICEhYShiLCBjLmZvcm0pLmxlbmd0aCB9LCBcImZ1bmN0aW9uXCI6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhKGIpIH0gfSwgb3B0aW9uYWw6IGZ1bmN0aW9uIChiKSB7IHZhciBjID0gdGhpcy5lbGVtZW50VmFsdWUoYik7IHJldHVybiAhYS52YWxpZGF0b3IubWV0aG9kcy5yZXF1aXJlZC5jYWxsKHRoaXMsIGMsIGIpICYmIFwiZGVwZW5kZW5jeS1taXNtYXRjaFwiIH0sIHN0YXJ0UmVxdWVzdDogZnVuY3Rpb24gKGIpIHsgdGhpcy5wZW5kaW5nW2IubmFtZV0gfHwgKHRoaXMucGVuZGluZ1JlcXVlc3QrKyAsIGEoYikuYWRkQ2xhc3ModGhpcy5zZXR0aW5ncy5wZW5kaW5nQ2xhc3MpLCB0aGlzLnBlbmRpbmdbYi5uYW1lXSA9ICEwKSB9LCBzdG9wUmVxdWVzdDogZnVuY3Rpb24gKGIsIGMpIHsgdGhpcy5wZW5kaW5nUmVxdWVzdC0tICwgdGhpcy5wZW5kaW5nUmVxdWVzdCA8IDAgJiYgKHRoaXMucGVuZGluZ1JlcXVlc3QgPSAwKSwgZGVsZXRlIHRoaXMucGVuZGluZ1tiLm5hbWVdLCBhKGIpLnJlbW92ZUNsYXNzKHRoaXMuc2V0dGluZ3MucGVuZGluZ0NsYXNzKSwgYyAmJiAwID09PSB0aGlzLnBlbmRpbmdSZXF1ZXN0ICYmIHRoaXMuZm9ybVN1Ym1pdHRlZCAmJiB0aGlzLmZvcm0oKSA/IChhKHRoaXMuY3VycmVudEZvcm0pLnN1Ym1pdCgpLCB0aGlzLnN1Ym1pdEJ1dHRvbiAmJiBhKFwiaW5wdXQ6aGlkZGVuW25hbWU9J1wiICsgdGhpcy5zdWJtaXRCdXR0b24ubmFtZSArIFwiJ11cIiwgdGhpcy5jdXJyZW50Rm9ybSkucmVtb3ZlKCksIHRoaXMuZm9ybVN1Ym1pdHRlZCA9ICExKSA6ICFjICYmIDAgPT09IHRoaXMucGVuZGluZ1JlcXVlc3QgJiYgdGhpcy5mb3JtU3VibWl0dGVkICYmIChhKHRoaXMuY3VycmVudEZvcm0pLnRyaWdnZXJIYW5kbGVyKFwiaW52YWxpZC1mb3JtXCIsIFt0aGlzXSksIHRoaXMuZm9ybVN1Ym1pdHRlZCA9ICExKSB9LCBwcmV2aW91c1ZhbHVlOiBmdW5jdGlvbiAoYiwgYykgeyByZXR1cm4gYyA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIGMgJiYgYyB8fCBcInJlbW90ZVwiLCBhLmRhdGEoYiwgXCJwcmV2aW91c1ZhbHVlXCIpIHx8IGEuZGF0YShiLCBcInByZXZpb3VzVmFsdWVcIiwgeyBvbGQ6IG51bGwsIHZhbGlkOiAhMCwgbWVzc2FnZTogdGhpcy5kZWZhdWx0TWVzc2FnZShiLCB7IG1ldGhvZDogYyB9KSB9KSB9LCBkZXN0cm95OiBmdW5jdGlvbiAoKSB7IHRoaXMucmVzZXRGb3JtKCksIGEodGhpcy5jdXJyZW50Rm9ybSkub2ZmKFwiLnZhbGlkYXRlXCIpLnJlbW92ZURhdGEoXCJ2YWxpZGF0b3JcIikuZmluZChcIi52YWxpZGF0ZS1lcXVhbFRvLWJsdXJcIikub2ZmKFwiLnZhbGlkYXRlLWVxdWFsVG9cIikucmVtb3ZlQ2xhc3MoXCJ2YWxpZGF0ZS1lcXVhbFRvLWJsdXJcIikgfSB9LCBjbGFzc1J1bGVTZXR0aW5nczogeyByZXF1aXJlZDogeyByZXF1aXJlZDogITAgfSwgZW1haWw6IHsgZW1haWw6ICEwIH0sIHVybDogeyB1cmw6ICEwIH0sIGRhdGU6IHsgZGF0ZTogITAgfSwgZGF0ZUlTTzogeyBkYXRlSVNPOiAhMCB9LCBudW1iZXI6IHsgbnVtYmVyOiAhMCB9LCBkaWdpdHM6IHsgZGlnaXRzOiAhMCB9LCBjcmVkaXRjYXJkOiB7IGNyZWRpdGNhcmQ6ICEwIH0gfSwgYWRkQ2xhc3NSdWxlczogZnVuY3Rpb24gKGIsIGMpIHsgYi5jb25zdHJ1Y3RvciA9PT0gU3RyaW5nID8gdGhpcy5jbGFzc1J1bGVTZXR0aW5nc1tiXSA9IGMgOiBhLmV4dGVuZCh0aGlzLmNsYXNzUnVsZVNldHRpbmdzLCBiKSB9LCBjbGFzc1J1bGVzOiBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IHt9LCBkID0gYShiKS5hdHRyKFwiY2xhc3NcIik7IHJldHVybiBkICYmIGEuZWFjaChkLnNwbGl0KFwiIFwiKSwgZnVuY3Rpb24gKCkgeyB0aGlzIGluIGEudmFsaWRhdG9yLmNsYXNzUnVsZVNldHRpbmdzICYmIGEuZXh0ZW5kKGMsIGEudmFsaWRhdG9yLmNsYXNzUnVsZVNldHRpbmdzW3RoaXNdKSB9KSwgYyB9LCBub3JtYWxpemVBdHRyaWJ1dGVSdWxlOiBmdW5jdGlvbiAoYSwgYiwgYywgZCkgeyAvbWlufG1heHxzdGVwLy50ZXN0KGMpICYmIChudWxsID09PSBiIHx8IC9udW1iZXJ8cmFuZ2V8dGV4dC8udGVzdChiKSkgJiYgKGQgPSBOdW1iZXIoZCksIGlzTmFOKGQpICYmIChkID0gdm9pZCAwKSksIGQgfHwgMCA9PT0gZCA/IGFbY10gPSBkIDogYiA9PT0gYyAmJiBcInJhbmdlXCIgIT09IGIgJiYgKGFbY10gPSAhMCkgfSwgYXR0cmlidXRlUnVsZXM6IGZ1bmN0aW9uIChiKSB7IHZhciBjLCBkLCBlID0ge30sIGYgPSBhKGIpLCBnID0gYi5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpOyBmb3IgKGMgaW4gYS52YWxpZGF0b3IubWV0aG9kcykgXCJyZXF1aXJlZFwiID09PSBjID8gKGQgPSBiLmdldEF0dHJpYnV0ZShjKSwgXCJcIiA9PT0gZCAmJiAoZCA9ICEwKSwgZCA9ICEhZCkgOiBkID0gZi5hdHRyKGMpLCB0aGlzLm5vcm1hbGl6ZUF0dHJpYnV0ZVJ1bGUoZSwgZywgYywgZCk7IHJldHVybiBlLm1heGxlbmd0aCAmJiAvLTF8MjE0NzQ4MzY0N3w1MjQyODgvLnRlc3QoZS5tYXhsZW5ndGgpICYmIGRlbGV0ZSBlLm1heGxlbmd0aCwgZSB9LCBkYXRhUnVsZXM6IGZ1bmN0aW9uIChiKSB7IHZhciBjLCBkLCBlID0ge30sIGYgPSBhKGIpLCBnID0gYi5nZXRBdHRyaWJ1dGUoXCJ0eXBlXCIpOyBmb3IgKGMgaW4gYS52YWxpZGF0b3IubWV0aG9kcykgZCA9IGYuZGF0YShcInJ1bGVcIiArIGMuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBjLnN1YnN0cmluZygxKS50b0xvd2VyQ2FzZSgpKSwgdGhpcy5ub3JtYWxpemVBdHRyaWJ1dGVSdWxlKGUsIGcsIGMsIGQpOyByZXR1cm4gZSB9LCBzdGF0aWNSdWxlczogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSB7fSwgZCA9IGEuZGF0YShiLmZvcm0sIFwidmFsaWRhdG9yXCIpOyByZXR1cm4gZC5zZXR0aW5ncy5ydWxlcyAmJiAoYyA9IGEudmFsaWRhdG9yLm5vcm1hbGl6ZVJ1bGUoZC5zZXR0aW5ncy5ydWxlc1tiLm5hbWVdKSB8fCB7fSksIGMgfSwgbm9ybWFsaXplUnVsZXM6IGZ1bmN0aW9uIChiLCBjKSB7IHJldHVybiBhLmVhY2goYiwgZnVuY3Rpb24gKGQsIGUpIHsgaWYgKGUgPT09ICExKSByZXR1cm4gdm9pZCBkZWxldGUgYltkXTsgaWYgKGUucGFyYW0gfHwgZS5kZXBlbmRzKSB7IHZhciBmID0gITA7IHN3aXRjaCAodHlwZW9mIGUuZGVwZW5kcykgeyBjYXNlIFwic3RyaW5nXCI6IGYgPSAhIWEoZS5kZXBlbmRzLCBjLmZvcm0pLmxlbmd0aDsgYnJlYWs7IGNhc2UgXCJmdW5jdGlvblwiOiBmID0gZS5kZXBlbmRzLmNhbGwoYywgYykgfWYgPyBiW2RdID0gdm9pZCAwID09PSBlLnBhcmFtIHx8IGUucGFyYW0gOiAoYS5kYXRhKGMuZm9ybSwgXCJ2YWxpZGF0b3JcIikucmVzZXRFbGVtZW50cyhhKGMpKSwgZGVsZXRlIGJbZF0pIH0gfSksIGEuZWFjaChiLCBmdW5jdGlvbiAoZCwgZSkgeyBiW2RdID0gYS5pc0Z1bmN0aW9uKGUpICYmIFwibm9ybWFsaXplclwiICE9PSBkID8gZShjKSA6IGUgfSksIGEuZWFjaChbXCJtaW5sZW5ndGhcIiwgXCJtYXhsZW5ndGhcIl0sIGZ1bmN0aW9uICgpIHsgYlt0aGlzXSAmJiAoYlt0aGlzXSA9IE51bWJlcihiW3RoaXNdKSkgfSksIGEuZWFjaChbXCJyYW5nZWxlbmd0aFwiLCBcInJhbmdlXCJdLCBmdW5jdGlvbiAoKSB7IHZhciBjOyBiW3RoaXNdICYmIChhLmlzQXJyYXkoYlt0aGlzXSkgPyBiW3RoaXNdID0gW051bWJlcihiW3RoaXNdWzBdKSwgTnVtYmVyKGJbdGhpc11bMV0pXSA6IFwic3RyaW5nXCIgPT0gdHlwZW9mIGJbdGhpc10gJiYgKGMgPSBiW3RoaXNdLnJlcGxhY2UoL1tcXFtcXF1dL2csIFwiXCIpLnNwbGl0KC9bXFxzLF0rLyksIGJbdGhpc10gPSBbTnVtYmVyKGNbMF0pLCBOdW1iZXIoY1sxXSldKSkgfSksIGEudmFsaWRhdG9yLmF1dG9DcmVhdGVSYW5nZXMgJiYgKG51bGwgIT0gYi5taW4gJiYgbnVsbCAhPSBiLm1heCAmJiAoYi5yYW5nZSA9IFtiLm1pbiwgYi5tYXhdLCBkZWxldGUgYi5taW4sIGRlbGV0ZSBiLm1heCksIG51bGwgIT0gYi5taW5sZW5ndGggJiYgbnVsbCAhPSBiLm1heGxlbmd0aCAmJiAoYi5yYW5nZWxlbmd0aCA9IFtiLm1pbmxlbmd0aCwgYi5tYXhsZW5ndGhdLCBkZWxldGUgYi5taW5sZW5ndGgsIGRlbGV0ZSBiLm1heGxlbmd0aCkpLCBiIH0sIG5vcm1hbGl6ZVJ1bGU6IGZ1bmN0aW9uIChiKSB7IGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBiKSB7IHZhciBjID0ge307IGEuZWFjaChiLnNwbGl0KC9cXHMvKSwgZnVuY3Rpb24gKCkgeyBjW3RoaXNdID0gITAgfSksIGIgPSBjIH0gcmV0dXJuIGIgfSwgYWRkTWV0aG9kOiBmdW5jdGlvbiAoYiwgYywgZCkgeyBhLnZhbGlkYXRvci5tZXRob2RzW2JdID0gYywgYS52YWxpZGF0b3IubWVzc2FnZXNbYl0gPSB2b2lkIDAgIT09IGQgPyBkIDogYS52YWxpZGF0b3IubWVzc2FnZXNbYl0sIGMubGVuZ3RoIDwgMyAmJiBhLnZhbGlkYXRvci5hZGRDbGFzc1J1bGVzKGIsIGEudmFsaWRhdG9yLm5vcm1hbGl6ZVJ1bGUoYikpIH0sIG1ldGhvZHM6IHsgcmVxdWlyZWQ6IGZ1bmN0aW9uIChiLCBjLCBkKSB7IGlmICghdGhpcy5kZXBlbmQoZCwgYykpIHJldHVybiBcImRlcGVuZGVuY3ktbWlzbWF0Y2hcIjsgaWYgKFwic2VsZWN0XCIgPT09IGMubm9kZU5hbWUudG9Mb3dlckNhc2UoKSkgeyB2YXIgZSA9IGEoYykudmFsKCk7IHJldHVybiBlICYmIGUubGVuZ3RoID4gMCB9IHJldHVybiB0aGlzLmNoZWNrYWJsZShjKSA/IHRoaXMuZ2V0TGVuZ3RoKGIsIGMpID4gMCA6IGIubGVuZ3RoID4gMCB9LCBlbWFpbDogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMub3B0aW9uYWwoYikgfHwgL15bYS16QS1aMC05LiEjJCUmJyorXFwvPT9eX2B7fH1+LV0rQFthLXpBLVowLTldKD86W2EtekEtWjAtOS1dezAsNjF9W2EtekEtWjAtOV0pPyg/OlxcLlthLXpBLVowLTldKD86W2EtekEtWjAtOS1dezAsNjF9W2EtekEtWjAtOV0pPykqJC8udGVzdChhKSB9LCB1cmw6IGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiB0aGlzLm9wdGlvbmFsKGIpIHx8IC9eKD86KD86KD86aHR0cHM/fGZ0cCk6KT9cXC9cXC8pKD86XFxTKyg/OjpcXFMqKT9AKT8oPzooPyEoPzoxMHwxMjcpKD86XFwuXFxkezEsM30pezN9KSg/ISg/OjE2OVxcLjI1NHwxOTJcXC4xNjgpKD86XFwuXFxkezEsM30pezJ9KSg/ITE3MlxcLig/OjFbNi05XXwyXFxkfDNbMC0xXSkoPzpcXC5cXGR7MSwzfSl7Mn0pKD86WzEtOV1cXGQ/fDFcXGRcXGR8MlswMV1cXGR8MjJbMC0zXSkoPzpcXC4oPzoxP1xcZHsxLDJ9fDJbMC00XVxcZHwyNVswLTVdKSl7Mn0oPzpcXC4oPzpbMS05XVxcZD98MVxcZFxcZHwyWzAtNF1cXGR8MjVbMC00XSkpfCg/Oig/OlthLXpcXHUwMGExLVxcdWZmZmYwLTldLSopKlthLXpcXHUwMGExLVxcdWZmZmYwLTldKykoPzpcXC4oPzpbYS16XFx1MDBhMS1cXHVmZmZmMC05XS0qKSpbYS16XFx1MDBhMS1cXHVmZmZmMC05XSspKig/OlxcLig/OlthLXpcXHUwMGExLVxcdWZmZmZdezIsfSkpLj8pKD86OlxcZHsyLDV9KT8oPzpbXFwvPyNdXFxTKik/JC9pLnRlc3QoYSkgfSwgZGF0ZTogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMub3B0aW9uYWwoYikgfHwgIS9JbnZhbGlkfE5hTi8udGVzdChuZXcgRGF0ZShhKS50b1N0cmluZygpKSB9LCBkYXRlSVNPOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gdGhpcy5vcHRpb25hbChiKSB8fCAvXlxcZHs0fVtcXC9cXC1dKDA/WzEtOV18MVswMTJdKVtcXC9cXC1dKDA/WzEtOV18WzEyXVswLTldfDNbMDFdKSQvLnRlc3QoYSkgfSwgbnVtYmVyOiBmdW5jdGlvbiAoYSwgYikgeyByZXR1cm4gdGhpcy5vcHRpb25hbChiKSB8fCAvXig/Oi0/XFxkK3wtP1xcZHsxLDN9KD86LFxcZHszfSkrKT8oPzpcXC5cXGQrKT8kLy50ZXN0KGEpIH0sIGRpZ2l0czogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMub3B0aW9uYWwoYikgfHwgL15cXGQrJC8udGVzdChhKSB9LCBtaW5sZW5ndGg6IGZ1bmN0aW9uIChiLCBjLCBkKSB7IHZhciBlID0gYS5pc0FycmF5KGIpID8gYi5sZW5ndGggOiB0aGlzLmdldExlbmd0aChiLCBjKTsgcmV0dXJuIHRoaXMub3B0aW9uYWwoYykgfHwgZSA+PSBkIH0sIG1heGxlbmd0aDogZnVuY3Rpb24gKGIsIGMsIGQpIHsgdmFyIGUgPSBhLmlzQXJyYXkoYikgPyBiLmxlbmd0aCA6IHRoaXMuZ2V0TGVuZ3RoKGIsIGMpOyByZXR1cm4gdGhpcy5vcHRpb25hbChjKSB8fCBlIDw9IGQgfSwgcmFuZ2VsZW5ndGg6IGZ1bmN0aW9uIChiLCBjLCBkKSB7IHZhciBlID0gYS5pc0FycmF5KGIpID8gYi5sZW5ndGggOiB0aGlzLmdldExlbmd0aChiLCBjKTsgcmV0dXJuIHRoaXMub3B0aW9uYWwoYykgfHwgZSA+PSBkWzBdICYmIGUgPD0gZFsxXSB9LCBtaW46IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiB0aGlzLm9wdGlvbmFsKGIpIHx8IGEgPj0gYyB9LCBtYXg6IGZ1bmN0aW9uIChhLCBiLCBjKSB7IHJldHVybiB0aGlzLm9wdGlvbmFsKGIpIHx8IGEgPD0gYyB9LCByYW5nZTogZnVuY3Rpb24gKGEsIGIsIGMpIHsgcmV0dXJuIHRoaXMub3B0aW9uYWwoYikgfHwgYSA+PSBjWzBdICYmIGEgPD0gY1sxXSB9LCBzdGVwOiBmdW5jdGlvbiAoYiwgYywgZCkgeyB2YXIgZSwgZiA9IGEoYykuYXR0cihcInR5cGVcIiksIGcgPSBcIlN0ZXAgYXR0cmlidXRlIG9uIGlucHV0IHR5cGUgXCIgKyBmICsgXCIgaXMgbm90IHN1cHBvcnRlZC5cIiwgaCA9IFtcInRleHRcIiwgXCJudW1iZXJcIiwgXCJyYW5nZVwiXSwgaSA9IG5ldyBSZWdFeHAoXCJcXFxcYlwiICsgZiArIFwiXFxcXGJcIiksIGogPSBmICYmICFpLnRlc3QoaC5qb2luKCkpLCBrID0gZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSAoXCJcIiArIGEpLm1hdGNoKC8oPzpcXC4oXFxkKykpPyQvKTsgcmV0dXJuIGIgJiYgYlsxXSA/IGJbMV0ubGVuZ3RoIDogMCB9LCBsID0gZnVuY3Rpb24gKGEpIHsgcmV0dXJuIE1hdGgucm91bmQoYSAqIE1hdGgucG93KDEwLCBlKSkgfSwgbSA9ICEwOyBpZiAoaikgdGhyb3cgbmV3IEVycm9yKGcpOyByZXR1cm4gZSA9IGsoZCksIChrKGIpID4gZSB8fCBsKGIpICUgbChkKSAhPT0gMCkgJiYgKG0gPSAhMSksIHRoaXMub3B0aW9uYWwoYykgfHwgbSB9LCBlcXVhbFRvOiBmdW5jdGlvbiAoYiwgYywgZCkgeyB2YXIgZSA9IGEoZCk7IHJldHVybiB0aGlzLnNldHRpbmdzLm9uZm9jdXNvdXQgJiYgZS5ub3QoXCIudmFsaWRhdGUtZXF1YWxUby1ibHVyXCIpLmxlbmd0aCAmJiBlLmFkZENsYXNzKFwidmFsaWRhdGUtZXF1YWxUby1ibHVyXCIpLm9uKFwiYmx1ci52YWxpZGF0ZS1lcXVhbFRvXCIsIGZ1bmN0aW9uICgpIHsgYShjKS52YWxpZCgpIH0pLCBiID09PSBlLnZhbCgpIH0sIHJlbW90ZTogZnVuY3Rpb24gKGIsIGMsIGQsIGUpIHsgaWYgKHRoaXMub3B0aW9uYWwoYykpIHJldHVybiBcImRlcGVuZGVuY3ktbWlzbWF0Y2hcIjsgZSA9IFwic3RyaW5nXCIgPT0gdHlwZW9mIGUgJiYgZSB8fCBcInJlbW90ZVwiOyB2YXIgZiwgZywgaCwgaSA9IHRoaXMucHJldmlvdXNWYWx1ZShjLCBlKTsgcmV0dXJuIHRoaXMuc2V0dGluZ3MubWVzc2FnZXNbYy5uYW1lXSB8fCAodGhpcy5zZXR0aW5ncy5tZXNzYWdlc1tjLm5hbWVdID0ge30pLCBpLm9yaWdpbmFsTWVzc2FnZSA9IGkub3JpZ2luYWxNZXNzYWdlIHx8IHRoaXMuc2V0dGluZ3MubWVzc2FnZXNbYy5uYW1lXVtlXSwgdGhpcy5zZXR0aW5ncy5tZXNzYWdlc1tjLm5hbWVdW2VdID0gaS5tZXNzYWdlLCBkID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgZCAmJiB7IHVybDogZCB9IHx8IGQsIGggPSBhLnBhcmFtKGEuZXh0ZW5kKHsgZGF0YTogYiB9LCBkLmRhdGEpKSwgaS5vbGQgPT09IGggPyBpLnZhbGlkIDogKGkub2xkID0gaCwgZiA9IHRoaXMsIHRoaXMuc3RhcnRSZXF1ZXN0KGMpLCBnID0ge30sIGdbYy5uYW1lXSA9IGIsIGEuYWpheChhLmV4dGVuZCghMCwgeyBtb2RlOiBcImFib3J0XCIsIHBvcnQ6IFwidmFsaWRhdGVcIiArIGMubmFtZSwgZGF0YVR5cGU6IFwianNvblwiLCBkYXRhOiBnLCBjb250ZXh0OiBmLmN1cnJlbnRGb3JtLCBzdWNjZXNzOiBmdW5jdGlvbiAoYSkgeyB2YXIgZCwgZywgaCwgaiA9IGEgPT09ICEwIHx8IFwidHJ1ZVwiID09PSBhOyBmLnNldHRpbmdzLm1lc3NhZ2VzW2MubmFtZV1bZV0gPSBpLm9yaWdpbmFsTWVzc2FnZSwgaiA/IChoID0gZi5mb3JtU3VibWl0dGVkLCBmLnJlc2V0SW50ZXJuYWxzKCksIGYudG9IaWRlID0gZi5lcnJvcnNGb3IoYyksIGYuZm9ybVN1Ym1pdHRlZCA9IGgsIGYuc3VjY2Vzc0xpc3QucHVzaChjKSwgZi5pbnZhbGlkW2MubmFtZV0gPSAhMSwgZi5zaG93RXJyb3JzKCkpIDogKGQgPSB7fSwgZyA9IGEgfHwgZi5kZWZhdWx0TWVzc2FnZShjLCB7IG1ldGhvZDogZSwgcGFyYW1ldGVyczogYiB9KSwgZFtjLm5hbWVdID0gaS5tZXNzYWdlID0gZywgZi5pbnZhbGlkW2MubmFtZV0gPSAhMCwgZi5zaG93RXJyb3JzKGQpKSwgaS52YWxpZCA9IGosIGYuc3RvcFJlcXVlc3QoYywgaikgfSB9LCBkKSksIFwicGVuZGluZ1wiKSB9IH0gfSk7IHZhciBiLCBjID0ge307IHJldHVybiBhLmFqYXhQcmVmaWx0ZXIgPyBhLmFqYXhQcmVmaWx0ZXIoZnVuY3Rpb24gKGEsIGIsIGQpIHsgdmFyIGUgPSBhLnBvcnQ7IFwiYWJvcnRcIiA9PT0gYS5tb2RlICYmIChjW2VdICYmIGNbZV0uYWJvcnQoKSwgY1tlXSA9IGQpIH0pIDogKGIgPSBhLmFqYXgsIGEuYWpheCA9IGZ1bmN0aW9uIChkKSB7IHZhciBlID0gKFwibW9kZVwiIGluIGQgPyBkIDogYS5hamF4U2V0dGluZ3MpLm1vZGUsIGYgPSAoXCJwb3J0XCIgaW4gZCA/IGQgOiBhLmFqYXhTZXR0aW5ncykucG9ydDsgcmV0dXJuIFwiYWJvcnRcIiA9PT0gZSA/IChjW2ZdICYmIGNbZl0uYWJvcnQoKSwgY1tmXSA9IGIuYXBwbHkodGhpcywgYXJndW1lbnRzKSwgY1tmXSkgOiBiLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfSksIGEgfSk7IiwiLyohIGpRdWVyeSAmIFplcHRvIExhenkgdjEuNy42IC0gaHR0cDovL2pxdWVyeS5laXNiZWhyLmRlL2xhenkgLSBNSVQmR1BMLTIuMCBsaWNlbnNlIC0gQ29weXJpZ2h0IDIwMTItMjAxNyBEYW5pZWwgJ0Vpc2JlaHInIEtlcm4gKi9cclxuIWZ1bmN0aW9uICh0LCBlKSB7IFwidXNlIHN0cmljdFwiOyBmdW5jdGlvbiByKHIsIGEsIGksIHUsIGwpIHsgZnVuY3Rpb24gZigpIHsgTCA9IHQuZGV2aWNlUGl4ZWxSYXRpbyA+IDEsIGkgPSBjKGkpLCBhLmRlbGF5ID49IDAgJiYgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHMoITApIH0sIGEuZGVsYXkpLCAoYS5kZWxheSA8IDAgfHwgYS5jb21iaW5lZCkgJiYgKHUuZSA9IHYoYS50aHJvdHRsZSwgZnVuY3Rpb24gKHQpIHsgXCJyZXNpemVcIiA9PT0gdC50eXBlICYmICh3ID0gQiA9IC0xKSwgcyh0LmFsbCkgfSksIHUuYSA9IGZ1bmN0aW9uICh0KSB7IHQgPSBjKHQpLCBpLnB1c2guYXBwbHkoaSwgdCkgfSwgdS5nID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gaSA9IG4oaSkuZmlsdGVyKGZ1bmN0aW9uICgpIHsgcmV0dXJuICFuKHRoaXMpLmRhdGEoYS5sb2FkZWROYW1lKSB9KSB9LCB1LmYgPSBmdW5jdGlvbiAodCkgeyBmb3IgKHZhciBlID0gMDsgZSA8IHQubGVuZ3RoOyBlKyspIHsgdmFyIHIgPSBpLmZpbHRlcihmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzID09PSB0W2VdIH0pOyByLmxlbmd0aCAmJiBzKCExLCByKSB9IH0sIHMoKSwgbihhLmFwcGVuZFNjcm9sbCkub24oXCJzY3JvbGwuXCIgKyBsICsgXCIgcmVzaXplLlwiICsgbCwgdS5lKSkgfSBmdW5jdGlvbiBjKHQpIHsgdmFyIGkgPSBhLmRlZmF1bHRJbWFnZSwgbyA9IGEucGxhY2Vob2xkZXIsIHUgPSBhLmltYWdlQmFzZSwgbCA9IGEuc3Jjc2V0QXR0cmlidXRlLCBmID0gYS5sb2FkZXJBdHRyaWJ1dGUsIGMgPSBhLl9mIHx8IHt9OyB0ID0gbih0KS5maWx0ZXIoZnVuY3Rpb24gKCkgeyB2YXIgdCA9IG4odGhpcyksIHIgPSBtKHRoaXMpOyByZXR1cm4gIXQuZGF0YShhLmhhbmRsZWROYW1lKSAmJiAodC5hdHRyKGEuYXR0cmlidXRlKSB8fCB0LmF0dHIobCkgfHwgdC5hdHRyKGYpIHx8IGNbcl0gIT09IGUpIH0pLmRhdGEoXCJwbHVnaW5fXCIgKyBhLm5hbWUsIHIpOyBmb3IgKHZhciBzID0gMCwgZCA9IHQubGVuZ3RoOyBzIDwgZDsgcysrKSB7IHZhciBBID0gbih0W3NdKSwgZyA9IG0odFtzXSksIGggPSBBLmF0dHIoYS5pbWFnZUJhc2VBdHRyaWJ1dGUpIHx8IHU7IGcgPT09IE4gJiYgaCAmJiBBLmF0dHIobCkgJiYgQS5hdHRyKGwsIGIoQS5hdHRyKGwpLCBoKSksIGNbZ10gPT09IGUgfHwgQS5hdHRyKGYpIHx8IEEuYXR0cihmLCBjW2ddKSwgZyA9PT0gTiAmJiBpICYmICFBLmF0dHIoRSkgPyBBLmF0dHIoRSwgaSkgOiBnID09PSBOIHx8ICFvIHx8IEEuY3NzKE8pICYmIFwibm9uZVwiICE9PSBBLmNzcyhPKSB8fCBBLmNzcyhPLCBcInVybCgnXCIgKyBvICsgXCInKVwiKSB9IHJldHVybiB0IH0gZnVuY3Rpb24gcyh0LCBlKSB7IGlmICghaS5sZW5ndGgpIHJldHVybiB2b2lkIChhLmF1dG9EZXN0cm95ICYmIHIuZGVzdHJveSgpKTsgZm9yICh2YXIgbyA9IGUgfHwgaSwgdSA9ICExLCBsID0gYS5pbWFnZUJhc2UgfHwgXCJcIiwgZiA9IGEuc3Jjc2V0QXR0cmlidXRlLCBjID0gYS5oYW5kbGVkTmFtZSwgcyA9IDA7IHMgPCBvLmxlbmd0aDsgcysrKWlmICh0IHx8IGUgfHwgQShvW3NdKSkgeyB2YXIgZyA9IG4ob1tzXSksIGggPSBtKG9bc10pLCBiID0gZy5hdHRyKGEuYXR0cmlidXRlKSwgdiA9IGcuYXR0cihhLmltYWdlQmFzZUF0dHJpYnV0ZSkgfHwgbCwgcCA9IGcuYXR0cihhLmxvYWRlckF0dHJpYnV0ZSk7IGcuZGF0YShjKSB8fCBhLnZpc2libGVPbmx5ICYmICFnLmlzKFwiOnZpc2libGVcIikgfHwgISgoYiB8fCBnLmF0dHIoZikpICYmIChoID09PSBOICYmICh2ICsgYiAhPT0gZy5hdHRyKEUpIHx8IGcuYXR0cihmKSAhPT0gZy5hdHRyKEYpKSB8fCBoICE9PSBOICYmIHYgKyBiICE9PSBnLmNzcyhPKSkgfHwgcCkgfHwgKHUgPSAhMCwgZy5kYXRhKGMsICEwKSwgZChnLCBoLCB2LCBwKSkgfSB1ICYmIChpID0gbihpKS5maWx0ZXIoZnVuY3Rpb24gKCkgeyByZXR1cm4gIW4odGhpcykuZGF0YShjKSB9KSkgfSBmdW5jdGlvbiBkKHQsIGUsIHIsIGkpIHsgKyt6OyB2YXIgbyA9IGZ1bmN0aW9uICgpIHsgeShcIm9uRXJyb3JcIiwgdCksIHAoKSwgbyA9IG4ubm9vcCB9OyB5KFwiYmVmb3JlTG9hZFwiLCB0KTsgdmFyIHUgPSBhLmF0dHJpYnV0ZSwgbCA9IGEuc3Jjc2V0QXR0cmlidXRlLCBmID0gYS5zaXplc0F0dHJpYnV0ZSwgYyA9IGEucmV0aW5hQXR0cmlidXRlLCBzID0gYS5yZW1vdmVBdHRyaWJ1dGUsIGQgPSBhLmxvYWRlZE5hbWUsIEEgPSB0LmF0dHIoYyk7IGlmIChpKSB7IHZhciBnID0gZnVuY3Rpb24gKCkgeyBzICYmIHQucmVtb3ZlQXR0cihhLmxvYWRlckF0dHJpYnV0ZSksIHQuZGF0YShkLCAhMCksIHkoVCwgdCksIHNldFRpbWVvdXQocCwgMSksIGcgPSBuLm5vb3AgfTsgdC5vZmYoSSkub25lKEksIG8pLm9uZShELCBnKSwgeShpLCB0LCBmdW5jdGlvbiAoZSkgeyBlID8gKHQub2ZmKEQpLCBnKCkpIDogKHQub2ZmKEkpLCBvKCkpIH0pIHx8IHQudHJpZ2dlcihJKSB9IGVsc2UgeyB2YXIgaCA9IG4obmV3IEltYWdlKTsgaC5vbmUoSSwgbykub25lKEQsIGZ1bmN0aW9uICgpIHsgdC5oaWRlKCksIGUgPT09IE4gPyB0LmF0dHIoQywgaC5hdHRyKEMpKS5hdHRyKEYsIGguYXR0cihGKSkuYXR0cihFLCBoLmF0dHIoRSkpIDogdC5jc3MoTywgXCJ1cmwoJ1wiICsgaC5hdHRyKEUpICsgXCInKVwiKSwgdFthLmVmZmVjdF0oYS5lZmZlY3RUaW1lKSwgcyAmJiAodC5yZW1vdmVBdHRyKHUgKyBcIiBcIiArIGwgKyBcIiBcIiArIGMgKyBcIiBcIiArIGEuaW1hZ2VCYXNlQXR0cmlidXRlKSwgZiAhPT0gQyAmJiB0LnJlbW92ZUF0dHIoZikpLCB0LmRhdGEoZCwgITApLCB5KFQsIHQpLCBoLnJlbW92ZSgpLCBwKCkgfSk7IHZhciBtID0gKEwgJiYgQSA/IEEgOiB0LmF0dHIodSkpIHx8IFwiXCI7IGguYXR0cihDLCB0LmF0dHIoZikpLmF0dHIoRiwgdC5hdHRyKGwpKS5hdHRyKEUsIG0gPyByICsgbSA6IG51bGwpLCBoLmNvbXBsZXRlICYmIGgudHJpZ2dlcihEKSB9IH0gZnVuY3Rpb24gQSh0KSB7IHZhciBlID0gdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgciA9IGEuc2Nyb2xsRGlyZWN0aW9uLCBuID0gYS50aHJlc2hvbGQsIGkgPSBoKCkgKyBuID4gZS50b3AgJiYgLW4gPCBlLmJvdHRvbSwgbyA9IGcoKSArIG4gPiBlLmxlZnQgJiYgLW4gPCBlLnJpZ2h0OyByZXR1cm4gXCJ2ZXJ0aWNhbFwiID09PSByID8gaSA6IFwiaG9yaXpvbnRhbFwiID09PSByID8gbyA6IGkgJiYgbyB9IGZ1bmN0aW9uIGcoKSB7IHJldHVybiB3ID49IDAgPyB3IDogdyA9IG4odCkud2lkdGgoKSB9IGZ1bmN0aW9uIGgoKSB7IHJldHVybiBCID49IDAgPyBCIDogQiA9IG4odCkuaGVpZ2h0KCkgfSBmdW5jdGlvbiBtKHQpIHsgcmV0dXJuIHQudGFnTmFtZS50b0xvd2VyQ2FzZSgpIH0gZnVuY3Rpb24gYih0LCBlKSB7IGlmIChlKSB7IHZhciByID0gdC5zcGxpdChcIixcIik7IHQgPSBcIlwiOyBmb3IgKHZhciBhID0gMCwgbiA9IHIubGVuZ3RoOyBhIDwgbjsgYSsrKXQgKz0gZSArIHJbYV0udHJpbSgpICsgKGEgIT09IG4gLSAxID8gXCIsXCIgOiBcIlwiKSB9IHJldHVybiB0IH0gZnVuY3Rpb24gdih0LCBlKSB7IHZhciBuLCBpID0gMDsgcmV0dXJuIGZ1bmN0aW9uIChvLCB1KSB7IGZ1bmN0aW9uIGwoKSB7IGkgPSArbmV3IERhdGUsIGUuY2FsbChyLCBvKSB9IHZhciBmID0gK25ldyBEYXRlIC0gaTsgbiAmJiBjbGVhclRpbWVvdXQobiksIGYgPiB0IHx8ICFhLmVuYWJsZVRocm90dGxlIHx8IHUgPyBsKCkgOiBuID0gc2V0VGltZW91dChsLCB0IC0gZikgfSB9IGZ1bmN0aW9uIHAoKSB7IC0teiwgaS5sZW5ndGggfHwgeiB8fCB5KFwib25GaW5pc2hlZEFsbFwiKSB9IGZ1bmN0aW9uIHkodCwgZSwgbikgeyByZXR1cm4gISEodCA9IGFbdF0pICYmICh0LmFwcGx5KHIsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKSksICEwKSB9IHZhciB6ID0gMCwgdyA9IC0xLCBCID0gLTEsIEwgPSAhMSwgVCA9IFwiYWZ0ZXJMb2FkXCIsIEQgPSBcImxvYWRcIiwgSSA9IFwiZXJyb3JcIiwgTiA9IFwiaW1nXCIsIEUgPSBcInNyY1wiLCBGID0gXCJzcmNzZXRcIiwgQyA9IFwic2l6ZXNcIiwgTyA9IFwiYmFja2dyb3VuZC1pbWFnZVwiOyBcImV2ZW50XCIgPT09IGEuYmluZCB8fCBvID8gZigpIDogbih0KS5vbihEICsgXCIuXCIgKyBsLCBmKSB9IGZ1bmN0aW9uIGEoYSwgbykgeyB2YXIgdSA9IHRoaXMsIGwgPSBuLmV4dGVuZCh7fSwgdS5jb25maWcsIG8pLCBmID0ge30sIGMgPSBsLm5hbWUgKyBcIi1cIiArICsraTsgcmV0dXJuIHUuY29uZmlnID0gZnVuY3Rpb24gKHQsIHIpIHsgcmV0dXJuIHIgPT09IGUgPyBsW3RdIDogKGxbdF0gPSByLCB1KSB9LCB1LmFkZEl0ZW1zID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIGYuYSAmJiBmLmEoXCJzdHJpbmdcIiA9PT0gbi50eXBlKHQpID8gbih0KSA6IHQpLCB1IH0sIHUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBmLmcgPyBmLmcoKSA6IHt9IH0sIHUudXBkYXRlID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIGYuZSAmJiBmLmUoe30sICF0KSwgdSB9LCB1LmZvcmNlID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIGYuZiAmJiBmLmYoXCJzdHJpbmdcIiA9PT0gbi50eXBlKHQpID8gbih0KSA6IHQpLCB1IH0sIHUubG9hZEFsbCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGYuZSAmJiBmLmUoeyBhbGw6ICEwIH0sICEwKSwgdSB9LCB1LmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7IHJldHVybiBuKGwuYXBwZW5kU2Nyb2xsKS5vZmYoXCIuXCIgKyBjLCBmLmUpLCBuKHQpLm9mZihcIi5cIiArIGMpLCBmID0ge30sIGUgfSwgcih1LCBsLCBhLCBmLCBjKSwgbC5jaGFpbmFibGUgPyBhIDogdSB9IHZhciBuID0gdC5qUXVlcnkgfHwgdC5aZXB0bywgaSA9IDAsIG8gPSAhMTsgbi5mbi5MYXp5ID0gbi5mbi5sYXp5ID0gZnVuY3Rpb24gKHQpIHsgcmV0dXJuIG5ldyBhKHRoaXMsIHQpIH0sIG4uTGF6eSA9IG4ubGF6eSA9IGZ1bmN0aW9uICh0LCByLCBpKSB7IGlmIChuLmlzRnVuY3Rpb24ocikgJiYgKGkgPSByLCByID0gW10pLCBuLmlzRnVuY3Rpb24oaSkpIHsgdCA9IG4uaXNBcnJheSh0KSA/IHQgOiBbdF0sIHIgPSBuLmlzQXJyYXkocikgPyByIDogW3JdOyBmb3IgKHZhciBvID0gYS5wcm90b3R5cGUuY29uZmlnLCB1ID0gby5fZiB8fCAoby5fZiA9IHt9KSwgbCA9IDAsIGYgPSB0Lmxlbmd0aDsgbCA8IGY7IGwrKykob1t0W2xdXSA9PT0gZSB8fCBuLmlzRnVuY3Rpb24ob1t0W2xdXSkpICYmIChvW3RbbF1dID0gaSk7IGZvciAodmFyIGMgPSAwLCBzID0gci5sZW5ndGg7IGMgPCBzOyBjKyspdVtyW2NdXSA9IHRbMF0gfSB9LCBhLnByb3RvdHlwZS5jb25maWcgPSB7IG5hbWU6IFwibGF6eVwiLCBjaGFpbmFibGU6ICEwLCBhdXRvRGVzdHJveTogITAsIGJpbmQ6IFwibG9hZFwiLCB0aHJlc2hvbGQ6IDUwMCwgdmlzaWJsZU9ubHk6ICExLCBhcHBlbmRTY3JvbGw6IHQsIHNjcm9sbERpcmVjdGlvbjogXCJib3RoXCIsIGltYWdlQmFzZTogbnVsbCwgZGVmYXVsdEltYWdlOiBcImRhdGE6aW1hZ2UvZ2lmO2Jhc2U2NCxSMGxHT0RsaEFRQUJBSUFBQVAvLy93QUFBQ0g1QkFFQUFBQUFMQUFBQUFBQkFBRUFBQUlDUkFFQU93PT1cIiwgcGxhY2Vob2xkZXI6IG51bGwsIGRlbGF5OiAtMSwgY29tYmluZWQ6ICExLCBhdHRyaWJ1dGU6IFwiZGF0YS1zcmNcIiwgc3Jjc2V0QXR0cmlidXRlOiBcImRhdGEtc3Jjc2V0XCIsIHNpemVzQXR0cmlidXRlOiBcImRhdGEtc2l6ZXNcIiwgcmV0aW5hQXR0cmlidXRlOiBcImRhdGEtcmV0aW5hXCIsIGxvYWRlckF0dHJpYnV0ZTogXCJkYXRhLWxvYWRlclwiLCBpbWFnZUJhc2VBdHRyaWJ1dGU6IFwiZGF0YS1pbWFnZWJhc2VcIiwgcmVtb3ZlQXR0cmlidXRlOiAhMCwgaGFuZGxlZE5hbWU6IFwiaGFuZGxlZFwiLCBsb2FkZWROYW1lOiBcImxvYWRlZFwiLCBlZmZlY3Q6IFwic2hvd1wiLCBlZmZlY3RUaW1lOiAwLCBlbmFibGVUaHJvdHRsZTogITAsIHRocm90dGxlOiAyNTAsIGJlZm9yZUxvYWQ6IGUsIGFmdGVyTG9hZDogZSwgb25FcnJvcjogZSwgb25GaW5pc2hlZEFsbDogZSB9LCBuKHQpLm9uKFwibG9hZFwiLCBmdW5jdGlvbiAoKSB7IG8gPSAhMCB9KSB9KHdpbmRvdyk7IiwiLyohIHRvb2x0aXBzdGVyIHY0LjIuNSAqLyFmdW5jdGlvbiAoYSwgYikgeyBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIGRlZmluZSAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFtcImpxdWVyeVwiXSwgZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGIoYSkgfSkgOiBcIm9iamVjdFwiID09IHR5cGVvZiBleHBvcnRzID8gbW9kdWxlLmV4cG9ydHMgPSBiKHJlcXVpcmUoXCJqcXVlcnlcIikpIDogYihqUXVlcnkpIH0odGhpcywgZnVuY3Rpb24gKGEpIHtcclxuICAgIGZ1bmN0aW9uIGIoYSkgeyB0aGlzLiRjb250YWluZXIsIHRoaXMuY29uc3RyYWludHMgPSBudWxsLCB0aGlzLl9fJHRvb2x0aXAsIHRoaXMuX19pbml0KGEpIH0gZnVuY3Rpb24gYyhiLCBjKSB7IHZhciBkID0gITA7IHJldHVybiBhLmVhY2goYiwgZnVuY3Rpb24gKGEsIGUpIHsgcmV0dXJuIHZvaWQgMCA9PT0gY1thXSB8fCBiW2FdICE9PSBjW2FdID8gKGQgPSAhMSwgITEpIDogdm9pZCAwIH0pLCBkIH0gZnVuY3Rpb24gZChiKSB7IHZhciBjID0gYi5hdHRyKFwiaWRcIiksIGQgPSBjID8gaC53aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYykgOiBudWxsOyByZXR1cm4gZCA/IGQgPT09IGJbMF0gOiBhLmNvbnRhaW5zKGgud2luZG93LmRvY3VtZW50LmJvZHksIGJbMF0pIH0gZnVuY3Rpb24gZSgpIHsgaWYgKCFnKSByZXR1cm4gITE7IHZhciBhID0gZy5kb2N1bWVudC5ib2R5IHx8IGcuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LCBiID0gYS5zdHlsZSwgYyA9IFwidHJhbnNpdGlvblwiLCBkID0gW1wiTW96XCIsIFwiV2Via2l0XCIsIFwiS2h0bWxcIiwgXCJPXCIsIFwibXNcIl07IGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBiW2NdKSByZXR1cm4gITA7IGMgPSBjLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgYy5zdWJzdHIoMSk7IGZvciAodmFyIGUgPSAwOyBlIDwgZC5sZW5ndGg7IGUrKylpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgYltkW2VdICsgY10pIHJldHVybiAhMDsgcmV0dXJuICExIH0gdmFyIGYgPSB7IGFuaW1hdGlvbjogXCJmYWRlXCIsIGFuaW1hdGlvbkR1cmF0aW9uOiAzNTAsIGNvbnRlbnQ6IG51bGwsIGNvbnRlbnRBc0hUTUw6ICExLCBjb250ZW50Q2xvbmluZzogITEsIGRlYnVnOiAhMCwgZGVsYXk6IDMwMCwgZGVsYXlUb3VjaDogWzMwMCwgNTAwXSwgZnVuY3Rpb25Jbml0OiBudWxsLCBmdW5jdGlvbkJlZm9yZTogbnVsbCwgZnVuY3Rpb25SZWFkeTogbnVsbCwgZnVuY3Rpb25BZnRlcjogbnVsbCwgZnVuY3Rpb25Gb3JtYXQ6IG51bGwsIElFbWluOiA2LCBpbnRlcmFjdGl2ZTogITEsIG11bHRpcGxlOiAhMSwgcGFyZW50OiBudWxsLCBwbHVnaW5zOiBbXCJzaWRlVGlwXCJdLCByZXBvc2l0aW9uT25TY3JvbGw6ICExLCByZXN0b3JhdGlvbjogXCJub25lXCIsIHNlbGZEZXN0cnVjdGlvbjogITAsIHRoZW1lOiBbXSwgdGltZXI6IDAsIHRyYWNrZXJJbnRlcnZhbDogNTAwLCB0cmFja09yaWdpbjogITEsIHRyYWNrVG9vbHRpcDogITEsIHRyaWdnZXI6IFwiaG92ZXJcIiwgdHJpZ2dlckNsb3NlOiB7IGNsaWNrOiAhMSwgbW91c2VsZWF2ZTogITEsIG9yaWdpbkNsaWNrOiAhMSwgc2Nyb2xsOiAhMSwgdGFwOiAhMSwgdG91Y2hsZWF2ZTogITEgfSwgdHJpZ2dlck9wZW46IHsgY2xpY2s6ICExLCBtb3VzZWVudGVyOiAhMSwgdGFwOiAhMSwgdG91Y2hzdGFydDogITEgfSwgdXBkYXRlQW5pbWF0aW9uOiBcInJvdGF0ZVwiLCB6SW5kZXg6IDk5OTk5OTkgfSwgZyA9IFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIHdpbmRvdyA/IHdpbmRvdyA6IG51bGwsIGggPSB7IGhhc1RvdWNoQ2FwYWJpbGl0eTogISghZyB8fCAhKFwib250b3VjaHN0YXJ0XCIgaW4gZyB8fCBnLkRvY3VtZW50VG91Y2ggJiYgZy5kb2N1bWVudCBpbnN0YW5jZW9mIGcuRG9jdW1lbnRUb3VjaCB8fCBnLm5hdmlnYXRvci5tYXhUb3VjaFBvaW50cykpLCBoYXNUcmFuc2l0aW9uczogZSgpLCBJRTogITEsIHNlbVZlcjogXCI0LjIuNVwiLCB3aW5kb3c6IGcgfSwgaSA9IGZ1bmN0aW9uICgpIHsgdGhpcy5fXyRlbWl0dGVyUHJpdmF0ZSA9IGEoe30pLCB0aGlzLl9fJGVtaXR0ZXJQdWJsaWMgPSBhKHt9KSwgdGhpcy5fX2luc3RhbmNlc0xhdGVzdEFyciA9IFtdLCB0aGlzLl9fcGx1Z2lucyA9IHt9LCB0aGlzLl9lbnYgPSBoIH07IGkucHJvdG90eXBlID0geyBfX2JyaWRnZTogZnVuY3Rpb24gKGIsIGMsIGQpIHsgaWYgKCFjW2RdKSB7IHZhciBlID0gZnVuY3Rpb24gKCkgeyB9OyBlLnByb3RvdHlwZSA9IGI7IHZhciBnID0gbmV3IGU7IGcuX19pbml0ICYmIGcuX19pbml0KGMpLCBhLmVhY2goYiwgZnVuY3Rpb24gKGEsIGIpIHsgMCAhPSBhLmluZGV4T2YoXCJfX1wiKSAmJiAoY1thXSA/IGYuZGVidWcgJiYgY29uc29sZS5sb2coXCJUaGUgXCIgKyBhICsgXCIgbWV0aG9kIG9mIHRoZSBcIiArIGQgKyBcIiBwbHVnaW4gY29uZmxpY3RzIHdpdGggYW5vdGhlciBwbHVnaW4gb3IgbmF0aXZlIG1ldGhvZHNcIikgOiAoY1thXSA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGdbYV0uYXBwbHkoZywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGFyZ3VtZW50cykpIH0sIGNbYV0uYnJpZGdlZCA9IGcpKSB9KSwgY1tkXSA9IGcgfSByZXR1cm4gdGhpcyB9LCBfX3NldFdpbmRvdzogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIGgud2luZG93ID0gYSwgdGhpcyB9LCBfZ2V0UnVsZXI6IGZ1bmN0aW9uIChhKSB7IHJldHVybiBuZXcgYihhKSB9LCBfb2ZmOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLm9mZi5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSksIHRoaXMgfSwgX29uOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLm9uLmFwcGx5KHRoaXMuX18kZW1pdHRlclByaXZhdGUsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9LCBfb25lOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLm9uZS5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSksIHRoaXMgfSwgX3BsdWdpbjogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSB0aGlzOyBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgYikgeyB2YXIgZCA9IGIsIGUgPSBudWxsOyByZXR1cm4gZC5pbmRleE9mKFwiLlwiKSA+IDAgPyBlID0gYy5fX3BsdWdpbnNbZF0gOiBhLmVhY2goYy5fX3BsdWdpbnMsIGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBiLm5hbWUuc3Vic3RyaW5nKGIubmFtZS5sZW5ndGggLSBkLmxlbmd0aCAtIDEpID09IFwiLlwiICsgZCA/IChlID0gYiwgITEpIDogdm9pZCAwIH0pLCBlIH0gaWYgKGIubmFtZS5pbmRleE9mKFwiLlwiKSA8IDApIHRocm93IG5ldyBFcnJvcihcIlBsdWdpbnMgbXVzdCBiZSBuYW1lc3BhY2VkXCIpOyByZXR1cm4gYy5fX3BsdWdpbnNbYi5uYW1lXSA9IGIsIGIuY29yZSAmJiBjLl9fYnJpZGdlKGIuY29yZSwgYywgYi5uYW1lKSwgdGhpcyB9LCBfdHJpZ2dlcjogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpOyByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgYVswXSAmJiAoYVswXSA9IHsgdHlwZTogYVswXSB9KSwgdGhpcy5fXyRlbWl0dGVyUHJpdmF0ZS50cmlnZ2VyLmFwcGx5KHRoaXMuX18kZW1pdHRlclByaXZhdGUsIGEpLCB0aGlzLl9fJGVtaXR0ZXJQdWJsaWMudHJpZ2dlci5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIGEpLCB0aGlzIH0sIGluc3RhbmNlczogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSBbXSwgZCA9IGIgfHwgXCIudG9vbHRpcHN0ZXJlZFwiOyByZXR1cm4gYShkKS5lYWNoKGZ1bmN0aW9uICgpIHsgdmFyIGIgPSBhKHRoaXMpLCBkID0gYi5kYXRhKFwidG9vbHRpcHN0ZXItbnNcIik7IGQgJiYgYS5lYWNoKGQsIGZ1bmN0aW9uIChhLCBkKSB7IGMucHVzaChiLmRhdGEoZCkpIH0pIH0pLCBjIH0sIGluc3RhbmNlc0xhdGVzdDogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fX2luc3RhbmNlc0xhdGVzdEFyciB9LCBvZmY6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX18kZW1pdHRlclB1YmxpYy5vZmYuYXBwbHkodGhpcy5fXyRlbWl0dGVyUHVibGljLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSksIHRoaXMgfSwgb246IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX18kZW1pdHRlclB1YmxpYy5vbi5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9LCBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX18kZW1pdHRlclB1YmxpYy5vbmUuYXBwbHkodGhpcy5fXyRlbWl0dGVyUHVibGljLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSksIHRoaXMgfSwgb3JpZ2luczogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSBiID8gYiArIFwiIFwiIDogXCJcIjsgcmV0dXJuIGEoYyArIFwiLnRvb2x0aXBzdGVyZWRcIikudG9BcnJheSgpIH0sIHNldERlZmF1bHRzOiBmdW5jdGlvbiAoYikgeyByZXR1cm4gYS5leHRlbmQoZiwgYiksIHRoaXMgfSwgdHJpZ2dlckhhbmRsZXI6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX18kZW1pdHRlclB1YmxpYy50cmlnZ2VySGFuZGxlci5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9IH0sIGEudG9vbHRpcHN0ZXIgPSBuZXcgaSwgYS5Ub29sdGlwc3RlciA9IGZ1bmN0aW9uIChiLCBjKSB7IHRoaXMuX19jYWxsYmFja3MgPSB7IGNsb3NlOiBbXSwgb3BlbjogW10gfSwgdGhpcy5fX2Nsb3NpbmdUaW1lLCB0aGlzLl9fQ29udGVudCwgdGhpcy5fX2NvbnRlbnRCY3IsIHRoaXMuX19kZXN0cm95ZWQgPSAhMSwgdGhpcy5fXyRlbWl0dGVyUHJpdmF0ZSA9IGEoe30pLCB0aGlzLl9fJGVtaXR0ZXJQdWJsaWMgPSBhKHt9KSwgdGhpcy5fX2VuYWJsZWQgPSAhMCwgdGhpcy5fX2dhcmJhZ2VDb2xsZWN0b3IsIHRoaXMuX19HZW9tZXRyeSwgdGhpcy5fX2xhc3RQb3NpdGlvbiwgdGhpcy5fX25hbWVzcGFjZSA9IFwidG9vbHRpcHN0ZXItXCIgKyBNYXRoLnJvdW5kKDFlNiAqIE1hdGgucmFuZG9tKCkpLCB0aGlzLl9fb3B0aW9ucywgdGhpcy5fXyRvcmlnaW5QYXJlbnRzLCB0aGlzLl9fcG9pbnRlcklzT3Zlck9yaWdpbiA9ICExLCB0aGlzLl9fcHJldmlvdXNUaGVtZXMgPSBbXSwgdGhpcy5fX3N0YXRlID0gXCJjbG9zZWRcIiwgdGhpcy5fX3RpbWVvdXRzID0geyBjbG9zZTogW10sIG9wZW46IG51bGwgfSwgdGhpcy5fX3RvdWNoRXZlbnRzID0gW10sIHRoaXMuX190cmFja2VyID0gbnVsbCwgdGhpcy5fJG9yaWdpbiwgdGhpcy5fJHRvb2x0aXAsIHRoaXMuX19pbml0KGIsIGMpIH0sIGEuVG9vbHRpcHN0ZXIucHJvdG90eXBlID0geyBfX2luaXQ6IGZ1bmN0aW9uIChiLCBjKSB7IHZhciBkID0gdGhpczsgaWYgKGQuXyRvcmlnaW4gPSBhKGIpLCBkLl9fb3B0aW9ucyA9IGEuZXh0ZW5kKCEwLCB7fSwgZiwgYyksIGQuX19vcHRpb25zRm9ybWF0KCksICFoLklFIHx8IGguSUUgPj0gZC5fX29wdGlvbnMuSUVtaW4pIHsgdmFyIGUgPSBudWxsOyBpZiAodm9pZCAwID09PSBkLl8kb3JpZ2luLmRhdGEoXCJ0b29sdGlwc3Rlci1pbml0aWFsVGl0bGVcIikgJiYgKGUgPSBkLl8kb3JpZ2luLmF0dHIoXCJ0aXRsZVwiKSwgdm9pZCAwID09PSBlICYmIChlID0gbnVsbCksIGQuXyRvcmlnaW4uZGF0YShcInRvb2x0aXBzdGVyLWluaXRpYWxUaXRsZVwiLCBlKSksIG51bGwgIT09IGQuX19vcHRpb25zLmNvbnRlbnQpIGQuX19jb250ZW50U2V0KGQuX19vcHRpb25zLmNvbnRlbnQpOyBlbHNlIHsgdmFyIGcsIGkgPSBkLl8kb3JpZ2luLmF0dHIoXCJkYXRhLXRvb2x0aXAtY29udGVudFwiKTsgaSAmJiAoZyA9IGEoaSkpLCBnICYmIGdbMF0gPyBkLl9fY29udGVudFNldChnLmZpcnN0KCkpIDogZC5fX2NvbnRlbnRTZXQoZSkgfSBkLl8kb3JpZ2luLnJlbW92ZUF0dHIoXCJ0aXRsZVwiKS5hZGRDbGFzcyhcInRvb2x0aXBzdGVyZWRcIiksIGQuX19wcmVwYXJlT3JpZ2luKCksIGQuX19wcmVwYXJlR0MoKSwgYS5lYWNoKGQuX19vcHRpb25zLnBsdWdpbnMsIGZ1bmN0aW9uIChhLCBiKSB7IGQuX3BsdWcoYikgfSksIGguaGFzVG91Y2hDYXBhYmlsaXR5ICYmIGEoaC53aW5kb3cuZG9jdW1lbnQuYm9keSkub24oXCJ0b3VjaG1vdmUuXCIgKyBkLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW5cIiwgZnVuY3Rpb24gKGEpIHsgZC5fdG91Y2hSZWNvcmRFdmVudChhKSB9KSwgZC5fb24oXCJjcmVhdGVkXCIsIGZ1bmN0aW9uICgpIHsgZC5fX3ByZXBhcmVUb29sdGlwKCkgfSkuX29uKFwicmVwb3NpdGlvbmVkXCIsIGZ1bmN0aW9uIChhKSB7IGQuX19sYXN0UG9zaXRpb24gPSBhLnBvc2l0aW9uIH0pIH0gZWxzZSBkLl9fb3B0aW9ucy5kaXNhYmxlZCA9ICEwIH0sIF9fY29udGVudEluc2VydDogZnVuY3Rpb24gKCkgeyB2YXIgYSA9IHRoaXMsIGIgPSBhLl8kdG9vbHRpcC5maW5kKFwiLnRvb2x0aXBzdGVyLWNvbnRlbnRcIiksIGMgPSBhLl9fQ29udGVudCwgZCA9IGZ1bmN0aW9uIChhKSB7IGMgPSBhIH07IHJldHVybiBhLl90cmlnZ2VyKHsgdHlwZTogXCJmb3JtYXRcIiwgY29udGVudDogYS5fX0NvbnRlbnQsIGZvcm1hdDogZCB9KSwgYS5fX29wdGlvbnMuZnVuY3Rpb25Gb3JtYXQgJiYgKGMgPSBhLl9fb3B0aW9ucy5mdW5jdGlvbkZvcm1hdC5jYWxsKGEsIGEsIHsgb3JpZ2luOiBhLl8kb3JpZ2luWzBdIH0sIGEuX19Db250ZW50KSksIFwic3RyaW5nXCIgIT0gdHlwZW9mIGMgfHwgYS5fX29wdGlvbnMuY29udGVudEFzSFRNTCA/IGIuZW1wdHkoKS5hcHBlbmQoYykgOiBiLnRleHQoYyksIGEgfSwgX19jb250ZW50U2V0OiBmdW5jdGlvbiAoYikgeyByZXR1cm4gYiBpbnN0YW5jZW9mIGEgJiYgdGhpcy5fX29wdGlvbnMuY29udGVudENsb25pbmcgJiYgKGIgPSBiLmNsb25lKCEwKSksIHRoaXMuX19Db250ZW50ID0gYiwgdGhpcy5fdHJpZ2dlcih7IHR5cGU6IFwidXBkYXRlZFwiLCBjb250ZW50OiBiIH0pLCB0aGlzIH0sIF9fZGVzdHJveUVycm9yOiBmdW5jdGlvbiAoKSB7IHRocm93IG5ldyBFcnJvcihcIlRoaXMgdG9vbHRpcCBoYXMgYmVlbiBkZXN0cm95ZWQgYW5kIGNhbm5vdCBleGVjdXRlIHlvdXIgbWV0aG9kIGNhbGwuXCIpIH0sIF9fZ2VvbWV0cnk6IGZ1bmN0aW9uICgpIHsgdmFyIGIgPSB0aGlzLCBjID0gYi5fJG9yaWdpbiwgZCA9IGIuXyRvcmlnaW4uaXMoXCJhcmVhXCIpOyBpZiAoZCkgeyB2YXIgZSA9IGIuXyRvcmlnaW4ucGFyZW50KCkuYXR0cihcIm5hbWVcIik7IGMgPSBhKCdpbWdbdXNlbWFwPVwiIycgKyBlICsgJ1wiXScpIH0gdmFyIGYgPSBjWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBnID0gYShoLndpbmRvdy5kb2N1bWVudCksIGkgPSBhKGgud2luZG93KSwgaiA9IGMsIGsgPSB7IGF2YWlsYWJsZTogeyBkb2N1bWVudDogbnVsbCwgd2luZG93OiBudWxsIH0sIGRvY3VtZW50OiB7IHNpemU6IHsgaGVpZ2h0OiBnLmhlaWdodCgpLCB3aWR0aDogZy53aWR0aCgpIH0gfSwgd2luZG93OiB7IHNjcm9sbDogeyBsZWZ0OiBoLndpbmRvdy5zY3JvbGxYIHx8IGgud2luZG93LmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxMZWZ0LCB0b3A6IGgud2luZG93LnNjcm9sbFkgfHwgaC53aW5kb3cuZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB9LCBzaXplOiB7IGhlaWdodDogaS5oZWlnaHQoKSwgd2lkdGg6IGkud2lkdGgoKSB9IH0sIG9yaWdpbjogeyBmaXhlZExpbmVhZ2U6ICExLCBvZmZzZXQ6IHt9LCBzaXplOiB7IGhlaWdodDogZi5ib3R0b20gLSBmLnRvcCwgd2lkdGg6IGYucmlnaHQgLSBmLmxlZnQgfSwgdXNlbWFwSW1hZ2U6IGQgPyBjWzBdIDogbnVsbCwgd2luZG93T2Zmc2V0OiB7IGJvdHRvbTogZi5ib3R0b20sIGxlZnQ6IGYubGVmdCwgcmlnaHQ6IGYucmlnaHQsIHRvcDogZi50b3AgfSB9IH07IGlmIChkKSB7IHZhciBsID0gYi5fJG9yaWdpbi5hdHRyKFwic2hhcGVcIiksIG0gPSBiLl8kb3JpZ2luLmF0dHIoXCJjb29yZHNcIik7IGlmIChtICYmIChtID0gbS5zcGxpdChcIixcIiksIGEubWFwKG0sIGZ1bmN0aW9uIChhLCBiKSB7IG1bYl0gPSBwYXJzZUludChhKSB9KSksIFwiZGVmYXVsdFwiICE9IGwpIHN3aXRjaCAobCkgeyBjYXNlIFwiY2lyY2xlXCI6IHZhciBuID0gbVswXSwgbyA9IG1bMV0sIHAgPSBtWzJdLCBxID0gbyAtIHAsIHIgPSBuIC0gcDsgay5vcmlnaW4uc2l6ZS5oZWlnaHQgPSAyICogcCwgay5vcmlnaW4uc2l6ZS53aWR0aCA9IGsub3JpZ2luLnNpemUuaGVpZ2h0LCBrLm9yaWdpbi53aW5kb3dPZmZzZXQubGVmdCArPSByLCBrLm9yaWdpbi53aW5kb3dPZmZzZXQudG9wICs9IHE7IGJyZWFrOyBjYXNlIFwicmVjdFwiOiB2YXIgcyA9IG1bMF0sIHQgPSBtWzFdLCB1ID0gbVsyXSwgdiA9IG1bM107IGsub3JpZ2luLnNpemUuaGVpZ2h0ID0gdiAtIHQsIGsub3JpZ2luLnNpemUud2lkdGggPSB1IC0gcywgay5vcmlnaW4ud2luZG93T2Zmc2V0LmxlZnQgKz0gcywgay5vcmlnaW4ud2luZG93T2Zmc2V0LnRvcCArPSB0OyBicmVhazsgY2FzZSBcInBvbHlcIjogZm9yICh2YXIgdyA9IDAsIHggPSAwLCB5ID0gMCwgeiA9IDAsIEEgPSBcImV2ZW5cIiwgQiA9IDA7IEIgPCBtLmxlbmd0aDsgQisrKSB7IHZhciBDID0gbVtCXTsgXCJldmVuXCIgPT0gQSA/IChDID4geSAmJiAoeSA9IEMsIDAgPT09IEIgJiYgKHcgPSB5KSksIHcgPiBDICYmICh3ID0gQyksIEEgPSBcIm9kZFwiKSA6IChDID4geiAmJiAoeiA9IEMsIDEgPT0gQiAmJiAoeCA9IHopKSwgeCA+IEMgJiYgKHggPSBDKSwgQSA9IFwiZXZlblwiKSB9IGsub3JpZ2luLnNpemUuaGVpZ2h0ID0geiAtIHgsIGsub3JpZ2luLnNpemUud2lkdGggPSB5IC0gdywgay5vcmlnaW4ud2luZG93T2Zmc2V0LmxlZnQgKz0gdywgay5vcmlnaW4ud2luZG93T2Zmc2V0LnRvcCArPSB4IH0gfSB2YXIgRCA9IGZ1bmN0aW9uIChhKSB7IGsub3JpZ2luLnNpemUuaGVpZ2h0ID0gYS5oZWlnaHQsIGsub3JpZ2luLndpbmRvd09mZnNldC5sZWZ0ID0gYS5sZWZ0LCBrLm9yaWdpbi53aW5kb3dPZmZzZXQudG9wID0gYS50b3AsIGsub3JpZ2luLnNpemUud2lkdGggPSBhLndpZHRoIH07IGZvciAoYi5fdHJpZ2dlcih7IHR5cGU6IFwiZ2VvbWV0cnlcIiwgZWRpdDogRCwgZ2VvbWV0cnk6IHsgaGVpZ2h0OiBrLm9yaWdpbi5zaXplLmhlaWdodCwgbGVmdDogay5vcmlnaW4ud2luZG93T2Zmc2V0LmxlZnQsIHRvcDogay5vcmlnaW4ud2luZG93T2Zmc2V0LnRvcCwgd2lkdGg6IGsub3JpZ2luLnNpemUud2lkdGggfSB9KSwgay5vcmlnaW4ud2luZG93T2Zmc2V0LnJpZ2h0ID0gay5vcmlnaW4ud2luZG93T2Zmc2V0LmxlZnQgKyBrLm9yaWdpbi5zaXplLndpZHRoLCBrLm9yaWdpbi53aW5kb3dPZmZzZXQuYm90dG9tID0gay5vcmlnaW4ud2luZG93T2Zmc2V0LnRvcCArIGsub3JpZ2luLnNpemUuaGVpZ2h0LCBrLm9yaWdpbi5vZmZzZXQubGVmdCA9IGsub3JpZ2luLndpbmRvd09mZnNldC5sZWZ0ICsgay53aW5kb3cuc2Nyb2xsLmxlZnQsIGsub3JpZ2luLm9mZnNldC50b3AgPSBrLm9yaWdpbi53aW5kb3dPZmZzZXQudG9wICsgay53aW5kb3cuc2Nyb2xsLnRvcCwgay5vcmlnaW4ub2Zmc2V0LmJvdHRvbSA9IGsub3JpZ2luLm9mZnNldC50b3AgKyBrLm9yaWdpbi5zaXplLmhlaWdodCwgay5vcmlnaW4ub2Zmc2V0LnJpZ2h0ID0gay5vcmlnaW4ub2Zmc2V0LmxlZnQgKyBrLm9yaWdpbi5zaXplLndpZHRoLCBrLmF2YWlsYWJsZS5kb2N1bWVudCA9IHsgYm90dG9tOiB7IGhlaWdodDogay5kb2N1bWVudC5zaXplLmhlaWdodCAtIGsub3JpZ2luLm9mZnNldC5ib3R0b20sIHdpZHRoOiBrLmRvY3VtZW50LnNpemUud2lkdGggfSwgbGVmdDogeyBoZWlnaHQ6IGsuZG9jdW1lbnQuc2l6ZS5oZWlnaHQsIHdpZHRoOiBrLm9yaWdpbi5vZmZzZXQubGVmdCB9LCByaWdodDogeyBoZWlnaHQ6IGsuZG9jdW1lbnQuc2l6ZS5oZWlnaHQsIHdpZHRoOiBrLmRvY3VtZW50LnNpemUud2lkdGggLSBrLm9yaWdpbi5vZmZzZXQucmlnaHQgfSwgdG9wOiB7IGhlaWdodDogay5vcmlnaW4ub2Zmc2V0LnRvcCwgd2lkdGg6IGsuZG9jdW1lbnQuc2l6ZS53aWR0aCB9IH0sIGsuYXZhaWxhYmxlLndpbmRvdyA9IHsgYm90dG9tOiB7IGhlaWdodDogTWF0aC5tYXgoay53aW5kb3cuc2l6ZS5oZWlnaHQgLSBNYXRoLm1heChrLm9yaWdpbi53aW5kb3dPZmZzZXQuYm90dG9tLCAwKSwgMCksIHdpZHRoOiBrLndpbmRvdy5zaXplLndpZHRoIH0sIGxlZnQ6IHsgaGVpZ2h0OiBrLndpbmRvdy5zaXplLmhlaWdodCwgd2lkdGg6IE1hdGgubWF4KGsub3JpZ2luLndpbmRvd09mZnNldC5sZWZ0LCAwKSB9LCByaWdodDogeyBoZWlnaHQ6IGsud2luZG93LnNpemUuaGVpZ2h0LCB3aWR0aDogTWF0aC5tYXgoay53aW5kb3cuc2l6ZS53aWR0aCAtIE1hdGgubWF4KGsub3JpZ2luLndpbmRvd09mZnNldC5yaWdodCwgMCksIDApIH0sIHRvcDogeyBoZWlnaHQ6IE1hdGgubWF4KGsub3JpZ2luLndpbmRvd09mZnNldC50b3AsIDApLCB3aWR0aDogay53aW5kb3cuc2l6ZS53aWR0aCB9IH07IFwiaHRtbFwiICE9IGpbMF0udGFnTmFtZS50b0xvd2VyQ2FzZSgpOykgeyBpZiAoXCJmaXhlZFwiID09IGouY3NzKFwicG9zaXRpb25cIikpIHsgay5vcmlnaW4uZml4ZWRMaW5lYWdlID0gITA7IGJyZWFrIH0gaiA9IGoucGFyZW50KCkgfSByZXR1cm4gayB9LCBfX29wdGlvbnNGb3JtYXQ6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIFwibnVtYmVyXCIgPT0gdHlwZW9mIHRoaXMuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uICYmICh0aGlzLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvbiA9IFt0aGlzLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvbiwgdGhpcy5fX29wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb25dKSwgXCJudW1iZXJcIiA9PSB0eXBlb2YgdGhpcy5fX29wdGlvbnMuZGVsYXkgJiYgKHRoaXMuX19vcHRpb25zLmRlbGF5ID0gW3RoaXMuX19vcHRpb25zLmRlbGF5LCB0aGlzLl9fb3B0aW9ucy5kZWxheV0pLCBcIm51bWJlclwiID09IHR5cGVvZiB0aGlzLl9fb3B0aW9ucy5kZWxheVRvdWNoICYmICh0aGlzLl9fb3B0aW9ucy5kZWxheVRvdWNoID0gW3RoaXMuX19vcHRpb25zLmRlbGF5VG91Y2gsIHRoaXMuX19vcHRpb25zLmRlbGF5VG91Y2hdKSwgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdGhpcy5fX29wdGlvbnMudGhlbWUgJiYgKHRoaXMuX19vcHRpb25zLnRoZW1lID0gW3RoaXMuX19vcHRpb25zLnRoZW1lXSksIG51bGwgPT09IHRoaXMuX19vcHRpb25zLnBhcmVudCA/IHRoaXMuX19vcHRpb25zLnBhcmVudCA9IGEoaC53aW5kb3cuZG9jdW1lbnQuYm9keSkgOiBcInN0cmluZ1wiID09IHR5cGVvZiB0aGlzLl9fb3B0aW9ucy5wYXJlbnQgJiYgKHRoaXMuX19vcHRpb25zLnBhcmVudCA9IGEodGhpcy5fX29wdGlvbnMucGFyZW50KSksIFwiaG92ZXJcIiA9PSB0aGlzLl9fb3B0aW9ucy50cmlnZ2VyID8gKHRoaXMuX19vcHRpb25zLnRyaWdnZXJPcGVuID0geyBtb3VzZWVudGVyOiAhMCwgdG91Y2hzdGFydDogITAgfSwgdGhpcy5fX29wdGlvbnMudHJpZ2dlckNsb3NlID0geyBtb3VzZWxlYXZlOiAhMCwgb3JpZ2luQ2xpY2s6ICEwLCB0b3VjaGxlYXZlOiAhMCB9KSA6IFwiY2xpY2tcIiA9PSB0aGlzLl9fb3B0aW9ucy50cmlnZ2VyICYmICh0aGlzLl9fb3B0aW9ucy50cmlnZ2VyT3BlbiA9IHsgY2xpY2s6ICEwLCB0YXA6ICEwIH0sIHRoaXMuX19vcHRpb25zLnRyaWdnZXJDbG9zZSA9IHsgY2xpY2s6ICEwLCB0YXA6ICEwIH0pLCB0aGlzLl90cmlnZ2VyKFwib3B0aW9uc1wiKSwgdGhpcyB9LCBfX3ByZXBhcmVHQzogZnVuY3Rpb24gKCkgeyB2YXIgYiA9IHRoaXM7IHJldHVybiBiLl9fb3B0aW9ucy5zZWxmRGVzdHJ1Y3Rpb24gPyBiLl9fZ2FyYmFnZUNvbGxlY3RvciA9IHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsgdmFyIGMgPSAobmV3IERhdGUpLmdldFRpbWUoKTsgYi5fX3RvdWNoRXZlbnRzID0gYS5ncmVwKGIuX190b3VjaEV2ZW50cywgZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIGMgLSBhLnRpbWUgPiA2ZTQgfSksIGQoYi5fJG9yaWdpbikgfHwgYi5jbG9zZShmdW5jdGlvbiAoKSB7IGIuZGVzdHJveSgpIH0pIH0sIDJlNCkgOiBjbGVhckludGVydmFsKGIuX19nYXJiYWdlQ29sbGVjdG9yKSwgYiB9LCBfX3ByZXBhcmVPcmlnaW46IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzOyBpZiAoYS5fJG9yaWdpbi5vZmYoXCIuXCIgKyBhLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW5cIiksIGguaGFzVG91Y2hDYXBhYmlsaXR5ICYmIGEuXyRvcmlnaW4ub24oXCJ0b3VjaHN0YXJ0LlwiICsgYS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJPcGVuIHRvdWNoZW5kLlwiICsgYS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJPcGVuIHRvdWNoY2FuY2VsLlwiICsgYS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJPcGVuXCIsIGZ1bmN0aW9uIChiKSB7IGEuX3RvdWNoUmVjb3JkRXZlbnQoYikgfSksIGEuX19vcHRpb25zLnRyaWdnZXJPcGVuLmNsaWNrIHx8IGEuX19vcHRpb25zLnRyaWdnZXJPcGVuLnRhcCAmJiBoLmhhc1RvdWNoQ2FwYWJpbGl0eSkgeyB2YXIgYiA9IFwiXCI7IGEuX19vcHRpb25zLnRyaWdnZXJPcGVuLmNsaWNrICYmIChiICs9IFwiY2xpY2suXCIgKyBhLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW4gXCIpLCBhLl9fb3B0aW9ucy50cmlnZ2VyT3Blbi50YXAgJiYgaC5oYXNUb3VjaENhcGFiaWxpdHkgJiYgKGIgKz0gXCJ0b3VjaGVuZC5cIiArIGEuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyT3BlblwiKSwgYS5fJG9yaWdpbi5vbihiLCBmdW5jdGlvbiAoYikgeyBhLl90b3VjaElzTWVhbmluZ2Z1bEV2ZW50KGIpICYmIGEuX29wZW4oYikgfSkgfSBpZiAoYS5fX29wdGlvbnMudHJpZ2dlck9wZW4ubW91c2VlbnRlciB8fCBhLl9fb3B0aW9ucy50cmlnZ2VyT3Blbi50b3VjaHN0YXJ0ICYmIGguaGFzVG91Y2hDYXBhYmlsaXR5KSB7IHZhciBiID0gXCJcIjsgYS5fX29wdGlvbnMudHJpZ2dlck9wZW4ubW91c2VlbnRlciAmJiAoYiArPSBcIm1vdXNlZW50ZXIuXCIgKyBhLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW4gXCIpLCBhLl9fb3B0aW9ucy50cmlnZ2VyT3Blbi50b3VjaHN0YXJ0ICYmIGguaGFzVG91Y2hDYXBhYmlsaXR5ICYmIChiICs9IFwidG91Y2hzdGFydC5cIiArIGEuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyT3BlblwiKSwgYS5fJG9yaWdpbi5vbihiLCBmdW5jdGlvbiAoYikgeyAhYS5fdG91Y2hJc1RvdWNoRXZlbnQoYikgJiYgYS5fdG91Y2hJc0VtdWxhdGVkRXZlbnQoYikgfHwgKGEuX19wb2ludGVySXNPdmVyT3JpZ2luID0gITAsIGEuX29wZW5TaG9ydGx5KGIpKSB9KSB9IGlmIChhLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2UubW91c2VsZWF2ZSB8fCBhLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2UudG91Y2hsZWF2ZSAmJiBoLmhhc1RvdWNoQ2FwYWJpbGl0eSkgeyB2YXIgYiA9IFwiXCI7IGEuX19vcHRpb25zLnRyaWdnZXJDbG9zZS5tb3VzZWxlYXZlICYmIChiICs9IFwibW91c2VsZWF2ZS5cIiArIGEuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyT3BlbiBcIiksIGEuX19vcHRpb25zLnRyaWdnZXJDbG9zZS50b3VjaGxlYXZlICYmIGguaGFzVG91Y2hDYXBhYmlsaXR5ICYmIChiICs9IFwidG91Y2hlbmQuXCIgKyBhLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW4gdG91Y2hjYW5jZWwuXCIgKyBhLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW5cIiksIGEuXyRvcmlnaW4ub24oYiwgZnVuY3Rpb24gKGIpIHsgYS5fdG91Y2hJc01lYW5pbmdmdWxFdmVudChiKSAmJiAoYS5fX3BvaW50ZXJJc092ZXJPcmlnaW4gPSAhMSkgfSkgfSByZXR1cm4gYSB9LCBfX3ByZXBhcmVUb29sdGlwOiBmdW5jdGlvbiAoKSB7IHZhciBiID0gdGhpcywgYyA9IGIuX19vcHRpb25zLmludGVyYWN0aXZlID8gXCJhdXRvXCIgOiBcIlwiOyByZXR1cm4gYi5fJHRvb2x0aXAuYXR0cihcImlkXCIsIGIuX19uYW1lc3BhY2UpLmNzcyh7IFwicG9pbnRlci1ldmVudHNcIjogYywgekluZGV4OiBiLl9fb3B0aW9ucy56SW5kZXggfSksIGEuZWFjaChiLl9fcHJldmlvdXNUaGVtZXMsIGZ1bmN0aW9uIChhLCBjKSB7IGIuXyR0b29sdGlwLnJlbW92ZUNsYXNzKGMpIH0pLCBhLmVhY2goYi5fX29wdGlvbnMudGhlbWUsIGZ1bmN0aW9uIChhLCBjKSB7IGIuXyR0b29sdGlwLmFkZENsYXNzKGMpIH0pLCBiLl9fcHJldmlvdXNUaGVtZXMgPSBhLm1lcmdlKFtdLCBiLl9fb3B0aW9ucy50aGVtZSksIGIgfSwgX19zY3JvbGxIYW5kbGVyOiBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IHRoaXM7IGlmIChjLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2Uuc2Nyb2xsKSBjLl9jbG9zZShiKTsgZWxzZSBpZiAoZChjLl8kb3JpZ2luKSAmJiBkKGMuXyR0b29sdGlwKSkgeyB2YXIgZSA9IG51bGw7IGlmIChiLnRhcmdldCA9PT0gaC53aW5kb3cuZG9jdW1lbnQpIGMuX19HZW9tZXRyeS5vcmlnaW4uZml4ZWRMaW5lYWdlIHx8IGMuX19vcHRpb25zLnJlcG9zaXRpb25PblNjcm9sbCAmJiBjLnJlcG9zaXRpb24oYik7IGVsc2UgeyBlID0gYy5fX2dlb21ldHJ5KCk7IHZhciBmID0gITE7IGlmIChcImZpeGVkXCIgIT0gYy5fJG9yaWdpbi5jc3MoXCJwb3NpdGlvblwiKSAmJiBjLl9fJG9yaWdpblBhcmVudHMuZWFjaChmdW5jdGlvbiAoYiwgYykgeyB2YXIgZCA9IGEoYyksIGcgPSBkLmNzcyhcIm92ZXJmbG93LXhcIiksIGggPSBkLmNzcyhcIm92ZXJmbG93LXlcIik7IGlmIChcInZpc2libGVcIiAhPSBnIHx8IFwidmlzaWJsZVwiICE9IGgpIHsgdmFyIGkgPSBjLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyBpZiAoXCJ2aXNpYmxlXCIgIT0gZyAmJiAoZS5vcmlnaW4ud2luZG93T2Zmc2V0LmxlZnQgPCBpLmxlZnQgfHwgZS5vcmlnaW4ud2luZG93T2Zmc2V0LnJpZ2h0ID4gaS5yaWdodCkpIHJldHVybiBmID0gITAsICExOyBpZiAoXCJ2aXNpYmxlXCIgIT0gaCAmJiAoZS5vcmlnaW4ud2luZG93T2Zmc2V0LnRvcCA8IGkudG9wIHx8IGUub3JpZ2luLndpbmRvd09mZnNldC5ib3R0b20gPiBpLmJvdHRvbSkpIHJldHVybiBmID0gITAsICExIH0gcmV0dXJuIFwiZml4ZWRcIiA9PSBkLmNzcyhcInBvc2l0aW9uXCIpID8gITEgOiB2b2lkIDAgfSksIGYpIGMuXyR0b29sdGlwLmNzcyhcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7IGVsc2UgaWYgKGMuXyR0b29sdGlwLmNzcyhcInZpc2liaWxpdHlcIiwgXCJ2aXNpYmxlXCIpLCBjLl9fb3B0aW9ucy5yZXBvc2l0aW9uT25TY3JvbGwpIGMucmVwb3NpdGlvbihiKTsgZWxzZSB7IHZhciBnID0gZS5vcmlnaW4ub2Zmc2V0LmxlZnQgLSBjLl9fR2VvbWV0cnkub3JpZ2luLm9mZnNldC5sZWZ0LCBpID0gZS5vcmlnaW4ub2Zmc2V0LnRvcCAtIGMuX19HZW9tZXRyeS5vcmlnaW4ub2Zmc2V0LnRvcDsgYy5fJHRvb2x0aXAuY3NzKHsgbGVmdDogYy5fX2xhc3RQb3NpdGlvbi5jb29yZC5sZWZ0ICsgZywgdG9wOiBjLl9fbGFzdFBvc2l0aW9uLmNvb3JkLnRvcCArIGkgfSkgfSB9IGMuX3RyaWdnZXIoeyB0eXBlOiBcInNjcm9sbFwiLCBldmVudDogYiwgZ2VvOiBlIH0pIH0gcmV0dXJuIGMgfSwgX19zdGF0ZVNldDogZnVuY3Rpb24gKGEpIHsgcmV0dXJuIHRoaXMuX19zdGF0ZSA9IGEsIHRoaXMuX3RyaWdnZXIoeyB0eXBlOiBcInN0YXRlXCIsIHN0YXRlOiBhIH0pLCB0aGlzIH0sIF9fdGltZW91dHNDbGVhcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gY2xlYXJUaW1lb3V0KHRoaXMuX190aW1lb3V0cy5vcGVuKSwgdGhpcy5fX3RpbWVvdXRzLm9wZW4gPSBudWxsLCBhLmVhY2godGhpcy5fX3RpbWVvdXRzLmNsb3NlLCBmdW5jdGlvbiAoYSwgYikgeyBjbGVhclRpbWVvdXQoYikgfSksIHRoaXMuX190aW1lb3V0cy5jbG9zZSA9IFtdLCB0aGlzIH0sIF9fdHJhY2tlclN0YXJ0OiBmdW5jdGlvbiAoKSB7IHZhciBhID0gdGhpcywgYiA9IGEuXyR0b29sdGlwLmZpbmQoXCIudG9vbHRpcHN0ZXItY29udGVudFwiKTsgcmV0dXJuIGEuX19vcHRpb25zLnRyYWNrVG9vbHRpcCAmJiAoYS5fX2NvbnRlbnRCY3IgPSBiWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpKSwgYS5fX3RyYWNrZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7IGlmIChkKGEuXyRvcmlnaW4pICYmIGQoYS5fJHRvb2x0aXApKSB7IGlmIChhLl9fb3B0aW9ucy50cmFja09yaWdpbikgeyB2YXIgZSA9IGEuX19nZW9tZXRyeSgpLCBmID0gITE7IGMoZS5vcmlnaW4uc2l6ZSwgYS5fX0dlb21ldHJ5Lm9yaWdpbi5zaXplKSAmJiAoYS5fX0dlb21ldHJ5Lm9yaWdpbi5maXhlZExpbmVhZ2UgPyBjKGUub3JpZ2luLndpbmRvd09mZnNldCwgYS5fX0dlb21ldHJ5Lm9yaWdpbi53aW5kb3dPZmZzZXQpICYmIChmID0gITApIDogYyhlLm9yaWdpbi5vZmZzZXQsIGEuX19HZW9tZXRyeS5vcmlnaW4ub2Zmc2V0KSAmJiAoZiA9ICEwKSksIGYgfHwgKGEuX19vcHRpb25zLnRyaWdnZXJDbG9zZS5tb3VzZWxlYXZlID8gYS5fY2xvc2UoKSA6IGEucmVwb3NpdGlvbigpKSB9IGlmIChhLl9fb3B0aW9ucy50cmFja1Rvb2x0aXApIHsgdmFyIGcgPSBiWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOyBnLmhlaWdodCA9PT0gYS5fX2NvbnRlbnRCY3IuaGVpZ2h0ICYmIGcud2lkdGggPT09IGEuX19jb250ZW50QmNyLndpZHRoIHx8IChhLnJlcG9zaXRpb24oKSwgYS5fX2NvbnRlbnRCY3IgPSBnKSB9IH0gZWxzZSBhLl9jbG9zZSgpIH0sIGEuX19vcHRpb25zLnRyYWNrZXJJbnRlcnZhbCksIGEgfSwgX2Nsb3NlOiBmdW5jdGlvbiAoYiwgYywgZCkgeyB2YXIgZSA9IHRoaXMsIGYgPSAhMDsgaWYgKGUuX3RyaWdnZXIoeyB0eXBlOiBcImNsb3NlXCIsIGV2ZW50OiBiLCBzdG9wOiBmdW5jdGlvbiAoKSB7IGYgPSAhMSB9IH0pLCBmIHx8IGQpIHsgYyAmJiBlLl9fY2FsbGJhY2tzLmNsb3NlLnB1c2goYyksIGUuX19jYWxsYmFja3Mub3BlbiA9IFtdLCBlLl9fdGltZW91dHNDbGVhcigpOyB2YXIgZyA9IGZ1bmN0aW9uICgpIHsgYS5lYWNoKGUuX19jYWxsYmFja3MuY2xvc2UsIGZ1bmN0aW9uIChhLCBjKSB7IGMuY2FsbChlLCBlLCB7IGV2ZW50OiBiLCBvcmlnaW46IGUuXyRvcmlnaW5bMF0gfSkgfSksIGUuX19jYWxsYmFja3MuY2xvc2UgPSBbXSB9OyBpZiAoXCJjbG9zZWRcIiAhPSBlLl9fc3RhdGUpIHsgdmFyIGkgPSAhMCwgaiA9IG5ldyBEYXRlLCBrID0gai5nZXRUaW1lKCksIGwgPSBrICsgZS5fX29wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb25bMV07IGlmIChcImRpc2FwcGVhcmluZ1wiID09IGUuX19zdGF0ZSAmJiBsID4gZS5fX2Nsb3NpbmdUaW1lICYmIGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdID4gMCAmJiAoaSA9ICExKSwgaSkgeyBlLl9fY2xvc2luZ1RpbWUgPSBsLCBcImRpc2FwcGVhcmluZ1wiICE9IGUuX19zdGF0ZSAmJiBlLl9fc3RhdGVTZXQoXCJkaXNhcHBlYXJpbmdcIik7IHZhciBtID0gZnVuY3Rpb24gKCkgeyBjbGVhckludGVydmFsKGUuX190cmFja2VyKSwgZS5fdHJpZ2dlcih7IHR5cGU6IFwiY2xvc2luZ1wiLCBldmVudDogYiB9KSwgZS5fJHRvb2x0aXAub2ZmKFwiLlwiICsgZS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJDbG9zZVwiKS5yZW1vdmVDbGFzcyhcInRvb2x0aXBzdGVyLWR5aW5nXCIpLCBhKGgud2luZG93KS5vZmYoXCIuXCIgKyBlLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlckNsb3NlXCIpLCBlLl9fJG9yaWdpblBhcmVudHMuZWFjaChmdW5jdGlvbiAoYiwgYykgeyBhKGMpLm9mZihcInNjcm9sbC5cIiArIGUuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyQ2xvc2VcIikgfSksIGUuX18kb3JpZ2luUGFyZW50cyA9IG51bGwsIGEoaC53aW5kb3cuZG9jdW1lbnQuYm9keSkub2ZmKFwiLlwiICsgZS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJDbG9zZVwiKSwgZS5fJG9yaWdpbi5vZmYoXCIuXCIgKyBlLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlckNsb3NlXCIpLCBlLl9vZmYoXCJkaXNtaXNzYWJsZVwiKSwgZS5fX3N0YXRlU2V0KFwiY2xvc2VkXCIpLCBlLl90cmlnZ2VyKHsgdHlwZTogXCJhZnRlclwiLCBldmVudDogYiB9KSwgZS5fX29wdGlvbnMuZnVuY3Rpb25BZnRlciAmJiBlLl9fb3B0aW9ucy5mdW5jdGlvbkFmdGVyLmNhbGwoZSwgZSwgeyBldmVudDogYiwgb3JpZ2luOiBlLl8kb3JpZ2luWzBdIH0pLCBnKCkgfTsgaC5oYXNUcmFuc2l0aW9ucyA/IChlLl8kdG9vbHRpcC5jc3MoeyBcIi1tb3otYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdICsgXCJtc1wiLCBcIi1tcy1hbmltYXRpb24tZHVyYXRpb25cIjogZS5fX29wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb25bMV0gKyBcIm1zXCIsIFwiLW8tYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdICsgXCJtc1wiLCBcIi13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdICsgXCJtc1wiLCBcImFuaW1hdGlvbi1kdXJhdGlvblwiOiBlLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvblsxXSArIFwibXNcIiwgXCJ0cmFuc2l0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdICsgXCJtc1wiIH0pLCBlLl8kdG9vbHRpcC5jbGVhclF1ZXVlKCkucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci1zaG93XCIpLmFkZENsYXNzKFwidG9vbHRpcHN0ZXItZHlpbmdcIiksIGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdID4gMCAmJiBlLl8kdG9vbHRpcC5kZWxheShlLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvblsxXSksIGUuXyR0b29sdGlwLnF1ZXVlKG0pKSA6IGUuXyR0b29sdGlwLnN0b3AoKS5mYWRlT3V0KGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzFdLCBtKSB9IH0gZWxzZSBnKCkgfSByZXR1cm4gZSB9LCBfb2ZmOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLm9mZi5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSksIHRoaXMgfSwgX29uOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLm9uLmFwcGx5KHRoaXMuX18kZW1pdHRlclByaXZhdGUsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9LCBfb25lOiBmdW5jdGlvbiAoKSB7IHJldHVybiB0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLm9uZS5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQcml2YXRlLCBBcnJheS5wcm90b3R5cGUuc2xpY2UuYXBwbHkoYXJndW1lbnRzKSksIHRoaXMgfSwgX29wZW46IGZ1bmN0aW9uIChiLCBjKSB7IHZhciBlID0gdGhpczsgaWYgKCFlLl9fZGVzdHJveWluZyAmJiBkKGUuXyRvcmlnaW4pICYmIGUuX19lbmFibGVkKSB7IHZhciBmID0gITA7IGlmIChcImNsb3NlZFwiID09IGUuX19zdGF0ZSAmJiAoZS5fdHJpZ2dlcih7IHR5cGU6IFwiYmVmb3JlXCIsIGV2ZW50OiBiLCBzdG9wOiBmdW5jdGlvbiAoKSB7IGYgPSAhMSB9IH0pLCBmICYmIGUuX19vcHRpb25zLmZ1bmN0aW9uQmVmb3JlICYmIChmID0gZS5fX29wdGlvbnMuZnVuY3Rpb25CZWZvcmUuY2FsbChlLCBlLCB7IGV2ZW50OiBiLCBvcmlnaW46IGUuXyRvcmlnaW5bMF0gfSkpKSwgZiAhPT0gITEgJiYgbnVsbCAhPT0gZS5fX0NvbnRlbnQpIHsgYyAmJiBlLl9fY2FsbGJhY2tzLm9wZW4ucHVzaChjKSwgZS5fX2NhbGxiYWNrcy5jbG9zZSA9IFtdLCBlLl9fdGltZW91dHNDbGVhcigpOyB2YXIgZywgaSA9IGZ1bmN0aW9uICgpIHsgXCJzdGFibGVcIiAhPSBlLl9fc3RhdGUgJiYgZS5fX3N0YXRlU2V0KFwic3RhYmxlXCIpLCBhLmVhY2goZS5fX2NhbGxiYWNrcy5vcGVuLCBmdW5jdGlvbiAoYSwgYikgeyBiLmNhbGwoZSwgZSwgeyBvcmlnaW46IGUuXyRvcmlnaW5bMF0sIHRvb2x0aXA6IGUuXyR0b29sdGlwWzBdIH0pIH0pLCBlLl9fY2FsbGJhY2tzLm9wZW4gPSBbXSB9OyBpZiAoXCJjbG9zZWRcIiAhPT0gZS5fX3N0YXRlKSBnID0gMCwgXCJkaXNhcHBlYXJpbmdcIiA9PT0gZS5fX3N0YXRlID8gKGUuX19zdGF0ZVNldChcImFwcGVhcmluZ1wiKSwgaC5oYXNUcmFuc2l0aW9ucyA/IChlLl8kdG9vbHRpcC5jbGVhclF1ZXVlKCkucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci1keWluZ1wiKS5hZGRDbGFzcyhcInRvb2x0aXBzdGVyLXNob3dcIiksIGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdID4gMCAmJiBlLl8kdG9vbHRpcC5kZWxheShlLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvblswXSksIGUuXyR0b29sdGlwLnF1ZXVlKGkpKSA6IGUuXyR0b29sdGlwLnN0b3AoKS5mYWRlSW4oaSkpIDogXCJzdGFibGVcIiA9PSBlLl9fc3RhdGUgJiYgaSgpOyBlbHNlIHsgaWYgKGUuX19zdGF0ZVNldChcImFwcGVhcmluZ1wiKSwgZyA9IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdLCBlLl9fY29udGVudEluc2VydCgpLCBlLnJlcG9zaXRpb24oYiwgITApLCBoLmhhc1RyYW5zaXRpb25zID8gKGUuXyR0b29sdGlwLmFkZENsYXNzKFwidG9vbHRpcHN0ZXItXCIgKyBlLl9fb3B0aW9ucy5hbmltYXRpb24pLmFkZENsYXNzKFwidG9vbHRpcHN0ZXItaW5pdGlhbFwiKS5jc3MoeyBcIi1tb3otYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdICsgXCJtc1wiLCBcIi1tcy1hbmltYXRpb24tZHVyYXRpb25cIjogZS5fX29wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb25bMF0gKyBcIm1zXCIsIFwiLW8tYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdICsgXCJtc1wiLCBcIi13ZWJraXQtYW5pbWF0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdICsgXCJtc1wiLCBcImFuaW1hdGlvbi1kdXJhdGlvblwiOiBlLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvblswXSArIFwibXNcIiwgXCJ0cmFuc2l0aW9uLWR1cmF0aW9uXCI6IGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdICsgXCJtc1wiIH0pLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgXCJjbG9zZWRcIiAhPSBlLl9fc3RhdGUgJiYgKGUuXyR0b29sdGlwLmFkZENsYXNzKFwidG9vbHRpcHN0ZXItc2hvd1wiKS5yZW1vdmVDbGFzcyhcInRvb2x0aXBzdGVyLWluaXRpYWxcIiksIGUuX19vcHRpb25zLmFuaW1hdGlvbkR1cmF0aW9uWzBdID4gMCAmJiBlLl8kdG9vbHRpcC5kZWxheShlLl9fb3B0aW9ucy5hbmltYXRpb25EdXJhdGlvblswXSksIGUuXyR0b29sdGlwLnF1ZXVlKGkpKSB9LCAwKSkgOiBlLl8kdG9vbHRpcC5jc3MoXCJkaXNwbGF5XCIsIFwibm9uZVwiKS5mYWRlSW4oZS5fX29wdGlvbnMuYW5pbWF0aW9uRHVyYXRpb25bMF0sIGkpLCBlLl9fdHJhY2tlclN0YXJ0KCksIGEoaC53aW5kb3cpLm9uKFwicmVzaXplLlwiICsgZS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJDbG9zZVwiLCBmdW5jdGlvbiAoYikgeyB2YXIgYyA9IGEoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCk7IChjLmlzKFwiaW5wdXRcIikgfHwgYy5pcyhcInRleHRhcmVhXCIpKSAmJiBhLmNvbnRhaW5zKGUuXyR0b29sdGlwWzBdLCBjWzBdKSB8fCBlLnJlcG9zaXRpb24oYikgfSkub24oXCJzY3JvbGwuXCIgKyBlLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlckNsb3NlXCIsIGZ1bmN0aW9uIChhKSB7IGUuX19zY3JvbGxIYW5kbGVyKGEpIH0pLCBlLl9fJG9yaWdpblBhcmVudHMgPSBlLl8kb3JpZ2luLnBhcmVudHMoKSwgZS5fXyRvcmlnaW5QYXJlbnRzLmVhY2goZnVuY3Rpb24gKGIsIGMpIHsgYShjKS5vbihcInNjcm9sbC5cIiArIGUuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyQ2xvc2VcIiwgZnVuY3Rpb24gKGEpIHsgZS5fX3Njcm9sbEhhbmRsZXIoYSkgfSkgfSksIGUuX19vcHRpb25zLnRyaWdnZXJDbG9zZS5tb3VzZWxlYXZlIHx8IGUuX19vcHRpb25zLnRyaWdnZXJDbG9zZS50b3VjaGxlYXZlICYmIGguaGFzVG91Y2hDYXBhYmlsaXR5KSB7IGUuX29uKFwiZGlzbWlzc2FibGVcIiwgZnVuY3Rpb24gKGEpIHsgYS5kaXNtaXNzYWJsZSA/IGEuZGVsYXkgPyAobSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBlLl9jbG9zZShhLmV2ZW50KSB9LCBhLmRlbGF5KSwgZS5fX3RpbWVvdXRzLmNsb3NlLnB1c2gobSkpIDogZS5fY2xvc2UoYSkgOiBjbGVhclRpbWVvdXQobSkgfSk7IHZhciBqID0gZS5fJG9yaWdpbiwgayA9IFwiXCIsIGwgPSBcIlwiLCBtID0gbnVsbDsgZS5fX29wdGlvbnMuaW50ZXJhY3RpdmUgJiYgKGogPSBqLmFkZChlLl8kdG9vbHRpcCkpLCBlLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2UubW91c2VsZWF2ZSAmJiAoayArPSBcIm1vdXNlZW50ZXIuXCIgKyBlLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlckNsb3NlIFwiLCBsICs9IFwibW91c2VsZWF2ZS5cIiArIGUuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyQ2xvc2UgXCIpLCBlLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2UudG91Y2hsZWF2ZSAmJiBoLmhhc1RvdWNoQ2FwYWJpbGl0eSAmJiAoayArPSBcInRvdWNoc3RhcnQuXCIgKyBlLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlckNsb3NlXCIsIGwgKz0gXCJ0b3VjaGVuZC5cIiArIGUuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyQ2xvc2UgdG91Y2hjYW5jZWwuXCIgKyBlLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlckNsb3NlXCIpLCBqLm9uKGwsIGZ1bmN0aW9uIChhKSB7IGlmIChlLl90b3VjaElzVG91Y2hFdmVudChhKSB8fCAhZS5fdG91Y2hJc0VtdWxhdGVkRXZlbnQoYSkpIHsgdmFyIGIgPSBcIm1vdXNlbGVhdmVcIiA9PSBhLnR5cGUgPyBlLl9fb3B0aW9ucy5kZWxheSA6IGUuX19vcHRpb25zLmRlbGF5VG91Y2g7IGUuX3RyaWdnZXIoeyBkZWxheTogYlsxXSwgZGlzbWlzc2FibGU6ICEwLCBldmVudDogYSwgdHlwZTogXCJkaXNtaXNzYWJsZVwiIH0pIH0gfSkub24oaywgZnVuY3Rpb24gKGEpIHsgIWUuX3RvdWNoSXNUb3VjaEV2ZW50KGEpICYmIGUuX3RvdWNoSXNFbXVsYXRlZEV2ZW50KGEpIHx8IGUuX3RyaWdnZXIoeyBkaXNtaXNzYWJsZTogITEsIGV2ZW50OiBhLCB0eXBlOiBcImRpc21pc3NhYmxlXCIgfSkgfSkgfSBlLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2Uub3JpZ2luQ2xpY2sgJiYgZS5fJG9yaWdpbi5vbihcImNsaWNrLlwiICsgZS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJDbG9zZVwiLCBmdW5jdGlvbiAoYSkgeyBlLl90b3VjaElzVG91Y2hFdmVudChhKSB8fCBlLl90b3VjaElzRW11bGF0ZWRFdmVudChhKSB8fCBlLl9jbG9zZShhKSB9KSwgKGUuX19vcHRpb25zLnRyaWdnZXJDbG9zZS5jbGljayB8fCBlLl9fb3B0aW9ucy50cmlnZ2VyQ2xvc2UudGFwICYmIGguaGFzVG91Y2hDYXBhYmlsaXR5KSAmJiBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgaWYgKFwiY2xvc2VkXCIgIT0gZS5fX3N0YXRlKSB7IHZhciBiID0gXCJcIiwgYyA9IGEoaC53aW5kb3cuZG9jdW1lbnQuYm9keSk7IGUuX19vcHRpb25zLnRyaWdnZXJDbG9zZS5jbGljayAmJiAoYiArPSBcImNsaWNrLlwiICsgZS5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJDbG9zZSBcIiksIGUuX19vcHRpb25zLnRyaWdnZXJDbG9zZS50YXAgJiYgaC5oYXNUb3VjaENhcGFiaWxpdHkgJiYgKGIgKz0gXCJ0b3VjaGVuZC5cIiArIGUuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyQ2xvc2VcIiksIGMub24oYiwgZnVuY3Rpb24gKGIpIHsgZS5fdG91Y2hJc01lYW5pbmdmdWxFdmVudChiKSAmJiAoZS5fdG91Y2hSZWNvcmRFdmVudChiKSwgZS5fX29wdGlvbnMuaW50ZXJhY3RpdmUgJiYgYS5jb250YWlucyhlLl8kdG9vbHRpcFswXSwgYi50YXJnZXQpIHx8IGUuX2Nsb3NlKGIpKSB9KSwgZS5fX29wdGlvbnMudHJpZ2dlckNsb3NlLnRhcCAmJiBoLmhhc1RvdWNoQ2FwYWJpbGl0eSAmJiBjLm9uKFwidG91Y2hzdGFydC5cIiArIGUuX19uYW1lc3BhY2UgKyBcIi10cmlnZ2VyQ2xvc2VcIiwgZnVuY3Rpb24gKGEpIHsgZS5fdG91Y2hSZWNvcmRFdmVudChhKSB9KSB9IH0sIDApLCBlLl90cmlnZ2VyKFwicmVhZHlcIiksIGUuX19vcHRpb25zLmZ1bmN0aW9uUmVhZHkgJiYgZS5fX29wdGlvbnMuZnVuY3Rpb25SZWFkeS5jYWxsKGUsIGUsIHsgb3JpZ2luOiBlLl8kb3JpZ2luWzBdLCB0b29sdGlwOiBlLl8kdG9vbHRpcFswXSB9KSB9IGlmIChlLl9fb3B0aW9ucy50aW1lciA+IDApIHsgdmFyIG0gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgZS5fY2xvc2UoKSB9LCBlLl9fb3B0aW9ucy50aW1lciArIGcpOyBlLl9fdGltZW91dHMuY2xvc2UucHVzaChtKSB9IH0gfSByZXR1cm4gZSB9LCBfb3BlblNob3J0bHk6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gdGhpcywgYyA9ICEwOyBpZiAoXCJzdGFibGVcIiAhPSBiLl9fc3RhdGUgJiYgXCJhcHBlYXJpbmdcIiAhPSBiLl9fc3RhdGUgJiYgIWIuX190aW1lb3V0cy5vcGVuICYmIChiLl90cmlnZ2VyKHsgdHlwZTogXCJzdGFydFwiLCBldmVudDogYSwgc3RvcDogZnVuY3Rpb24gKCkgeyBjID0gITEgfSB9KSwgYykpIHsgdmFyIGQgPSAwID09IGEudHlwZS5pbmRleE9mKFwidG91Y2hcIikgPyBiLl9fb3B0aW9ucy5kZWxheVRvdWNoIDogYi5fX29wdGlvbnMuZGVsYXk7IGRbMF0gPyBiLl9fdGltZW91dHMub3BlbiA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyBiLl9fdGltZW91dHMub3BlbiA9IG51bGwsIGIuX19wb2ludGVySXNPdmVyT3JpZ2luICYmIGIuX3RvdWNoSXNNZWFuaW5nZnVsRXZlbnQoYSkgPyAoYi5fdHJpZ2dlcihcInN0YXJ0ZW5kXCIpLCBiLl9vcGVuKGEpKSA6IGIuX3RyaWdnZXIoXCJzdGFydGNhbmNlbFwiKSB9LCBkWzBdKSA6IChiLl90cmlnZ2VyKFwic3RhcnRlbmRcIiksIGIuX29wZW4oYSkpIH0gcmV0dXJuIGIgfSwgX29wdGlvbnNFeHRyYWN0OiBmdW5jdGlvbiAoYiwgYykgeyB2YXIgZCA9IHRoaXMsIGUgPSBhLmV4dGVuZCghMCwge30sIGMpLCBmID0gZC5fX29wdGlvbnNbYl07IHJldHVybiBmIHx8IChmID0ge30sIGEuZWFjaChjLCBmdW5jdGlvbiAoYSwgYikgeyB2YXIgYyA9IGQuX19vcHRpb25zW2FdOyB2b2lkIDAgIT09IGMgJiYgKGZbYV0gPSBjKSB9KSksIGEuZWFjaChlLCBmdW5jdGlvbiAoYiwgYykgeyB2b2lkIDAgIT09IGZbYl0gJiYgKFwib2JqZWN0XCIgIT0gdHlwZW9mIGMgfHwgYyBpbnN0YW5jZW9mIEFycmF5IHx8IG51bGwgPT0gYyB8fCBcIm9iamVjdFwiICE9IHR5cGVvZiBmW2JdIHx8IGZbYl0gaW5zdGFuY2VvZiBBcnJheSB8fCBudWxsID09IGZbYl0gPyBlW2JdID0gZltiXSA6IGEuZXh0ZW5kKGVbYl0sIGZbYl0pKSB9KSwgZSB9LCBfcGx1ZzogZnVuY3Rpb24gKGIpIHsgdmFyIGMgPSBhLnRvb2x0aXBzdGVyLl9wbHVnaW4oYik7IGlmICghYykgdGhyb3cgbmV3IEVycm9yKCdUaGUgXCInICsgYiArICdcIiBwbHVnaW4gaXMgbm90IGRlZmluZWQnKTsgcmV0dXJuIGMuaW5zdGFuY2UgJiYgYS50b29sdGlwc3Rlci5fX2JyaWRnZShjLmluc3RhbmNlLCB0aGlzLCBjLm5hbWUpLCB0aGlzIH0sIF90b3VjaElzRW11bGF0ZWRFdmVudDogZnVuY3Rpb24gKGEpIHsgZm9yICh2YXIgYiA9ICExLCBjID0gKG5ldyBEYXRlKS5nZXRUaW1lKCksIGQgPSB0aGlzLl9fdG91Y2hFdmVudHMubGVuZ3RoIC0gMTsgZCA+PSAwOyBkLS0pIHsgdmFyIGUgPSB0aGlzLl9fdG91Y2hFdmVudHNbZF07IGlmICghKGMgLSBlLnRpbWUgPCA1MDApKSBicmVhazsgZS50YXJnZXQgPT09IGEudGFyZ2V0ICYmIChiID0gITApIH0gcmV0dXJuIGIgfSwgX3RvdWNoSXNNZWFuaW5nZnVsRXZlbnQ6IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0aGlzLl90b3VjaElzVG91Y2hFdmVudChhKSAmJiAhdGhpcy5fdG91Y2hTd2lwZWQoYS50YXJnZXQpIHx8ICF0aGlzLl90b3VjaElzVG91Y2hFdmVudChhKSAmJiAhdGhpcy5fdG91Y2hJc0VtdWxhdGVkRXZlbnQoYSkgfSwgX3RvdWNoSXNUb3VjaEV2ZW50OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gMCA9PSBhLnR5cGUuaW5kZXhPZihcInRvdWNoXCIpIH0sIF90b3VjaFJlY29yZEV2ZW50OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5fdG91Y2hJc1RvdWNoRXZlbnQoYSkgJiYgKGEudGltZSA9IChuZXcgRGF0ZSkuZ2V0VGltZSgpLCB0aGlzLl9fdG91Y2hFdmVudHMucHVzaChhKSksIHRoaXMgfSwgX3RvdWNoU3dpcGVkOiBmdW5jdGlvbiAoYSkgeyBmb3IgKHZhciBiID0gITEsIGMgPSB0aGlzLl9fdG91Y2hFdmVudHMubGVuZ3RoIC0gMTsgYyA+PSAwOyBjLS0pIHsgdmFyIGQgPSB0aGlzLl9fdG91Y2hFdmVudHNbY107IGlmIChcInRvdWNobW92ZVwiID09IGQudHlwZSkgeyBiID0gITA7IGJyZWFrIH0gaWYgKFwidG91Y2hzdGFydFwiID09IGQudHlwZSAmJiBhID09PSBkLnRhcmdldCkgYnJlYWsgfSByZXR1cm4gYiB9LCBfdHJpZ2dlcjogZnVuY3Rpb24gKCkgeyB2YXIgYiA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpOyByZXR1cm4gXCJzdHJpbmdcIiA9PSB0eXBlb2YgYlswXSAmJiAoYlswXSA9IHsgdHlwZTogYlswXSB9KSwgYlswXS5pbnN0YW5jZSA9IHRoaXMsIGJbMF0ub3JpZ2luID0gdGhpcy5fJG9yaWdpbiA/IHRoaXMuXyRvcmlnaW5bMF0gOiBudWxsLCBiWzBdLnRvb2x0aXAgPSB0aGlzLl8kdG9vbHRpcCA/IHRoaXMuXyR0b29sdGlwWzBdIDogbnVsbCwgdGhpcy5fXyRlbWl0dGVyUHJpdmF0ZS50cmlnZ2VyLmFwcGx5KHRoaXMuX18kZW1pdHRlclByaXZhdGUsIGIpLCBhLnRvb2x0aXBzdGVyLl90cmlnZ2VyLmFwcGx5KGEudG9vbHRpcHN0ZXIsIGIpLCB0aGlzLl9fJGVtaXR0ZXJQdWJsaWMudHJpZ2dlci5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIGIpLCB0aGlzIH0sIF91bnBsdWc6IGZ1bmN0aW9uIChiKSB7IHZhciBjID0gdGhpczsgaWYgKGNbYl0pIHsgdmFyIGQgPSBhLnRvb2x0aXBzdGVyLl9wbHVnaW4oYik7IGQuaW5zdGFuY2UgJiYgYS5lYWNoKGQuaW5zdGFuY2UsIGZ1bmN0aW9uIChhLCBkKSB7IGNbYV0gJiYgY1thXS5icmlkZ2VkID09PSBjW2JdICYmIGRlbGV0ZSBjW2FdIH0pLCBjW2JdLl9fZGVzdHJveSAmJiBjW2JdLl9fZGVzdHJveSgpLCBkZWxldGUgY1tiXSB9IHJldHVybiBjIH0sIGNsb3NlOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5fX2Rlc3Ryb3llZCA/IHRoaXMuX19kZXN0cm95RXJyb3IoKSA6IHRoaXMuX2Nsb3NlKG51bGwsIGEpLCB0aGlzIH0sIGNvbnRlbnQ6IGZ1bmN0aW9uIChhKSB7IHZhciBiID0gdGhpczsgaWYgKHZvaWQgMCA9PT0gYSkgcmV0dXJuIGIuX19Db250ZW50OyBpZiAoYi5fX2Rlc3Ryb3llZCkgYi5fX2Rlc3Ryb3lFcnJvcigpOyBlbHNlIGlmIChiLl9fY29udGVudFNldChhKSwgbnVsbCAhPT0gYi5fX0NvbnRlbnQpIHsgaWYgKFwiY2xvc2VkXCIgIT09IGIuX19zdGF0ZSAmJiAoYi5fX2NvbnRlbnRJbnNlcnQoKSwgYi5yZXBvc2l0aW9uKCksIGIuX19vcHRpb25zLnVwZGF0ZUFuaW1hdGlvbikpIGlmIChoLmhhc1RyYW5zaXRpb25zKSB7IHZhciBjID0gYi5fX29wdGlvbnMudXBkYXRlQW5pbWF0aW9uOyBiLl8kdG9vbHRpcC5hZGRDbGFzcyhcInRvb2x0aXBzdGVyLXVwZGF0ZS1cIiArIGMpLCBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgXCJjbG9zZWRcIiAhPSBiLl9fc3RhdGUgJiYgYi5fJHRvb2x0aXAucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci11cGRhdGUtXCIgKyBjKSB9LCAxZTMpIH0gZWxzZSBiLl8kdG9vbHRpcC5mYWRlVG8oMjAwLCAuNSwgZnVuY3Rpb24gKCkgeyBcImNsb3NlZFwiICE9IGIuX19zdGF0ZSAmJiBiLl8kdG9vbHRpcC5mYWRlVG8oMjAwLCAxKSB9KSB9IGVsc2UgYi5fY2xvc2UoKTsgcmV0dXJuIGIgfSwgZGVzdHJveTogZnVuY3Rpb24gKCkgeyB2YXIgYiA9IHRoaXM7IGlmIChiLl9fZGVzdHJveWVkKSBiLl9fZGVzdHJveUVycm9yKCk7IGVsc2UgeyBcImNsb3NlZFwiICE9IGIuX19zdGF0ZSA/IGIub3B0aW9uKFwiYW5pbWF0aW9uRHVyYXRpb25cIiwgMCkuX2Nsb3NlKG51bGwsIG51bGwsICEwKSA6IGIuX190aW1lb3V0c0NsZWFyKCksIGIuX3RyaWdnZXIoXCJkZXN0cm95XCIpLCBiLl9fZGVzdHJveWVkID0gITAsIGIuXyRvcmlnaW4ucmVtb3ZlRGF0YShiLl9fbmFtZXNwYWNlKS5vZmYoXCIuXCIgKyBiLl9fbmFtZXNwYWNlICsgXCItdHJpZ2dlck9wZW5cIiksIGEoaC53aW5kb3cuZG9jdW1lbnQuYm9keSkub2ZmKFwiLlwiICsgYi5fX25hbWVzcGFjZSArIFwiLXRyaWdnZXJPcGVuXCIpOyB2YXIgYyA9IGIuXyRvcmlnaW4uZGF0YShcInRvb2x0aXBzdGVyLW5zXCIpOyBpZiAoYykgaWYgKDEgPT09IGMubGVuZ3RoKSB7IHZhciBkID0gbnVsbDsgXCJwcmV2aW91c1wiID09IGIuX19vcHRpb25zLnJlc3RvcmF0aW9uID8gZCA9IGIuXyRvcmlnaW4uZGF0YShcInRvb2x0aXBzdGVyLWluaXRpYWxUaXRsZVwiKSA6IFwiY3VycmVudFwiID09IGIuX19vcHRpb25zLnJlc3RvcmF0aW9uICYmIChkID0gXCJzdHJpbmdcIiA9PSB0eXBlb2YgYi5fX0NvbnRlbnQgPyBiLl9fQ29udGVudCA6IGEoXCI8ZGl2PjwvZGl2PlwiKS5hcHBlbmQoYi5fX0NvbnRlbnQpLmh0bWwoKSksIGQgJiYgYi5fJG9yaWdpbi5hdHRyKFwidGl0bGVcIiwgZCksIGIuXyRvcmlnaW4ucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3RlcmVkXCIpLCBiLl8kb3JpZ2luLnJlbW92ZURhdGEoXCJ0b29sdGlwc3Rlci1uc1wiKS5yZW1vdmVEYXRhKFwidG9vbHRpcHN0ZXItaW5pdGlhbFRpdGxlXCIpIH0gZWxzZSBjID0gYS5ncmVwKGMsIGZ1bmN0aW9uIChhLCBjKSB7IHJldHVybiBhICE9PSBiLl9fbmFtZXNwYWNlIH0pLCBiLl8kb3JpZ2luLmRhdGEoXCJ0b29sdGlwc3Rlci1uc1wiLCBjKTsgYi5fdHJpZ2dlcihcImRlc3Ryb3llZFwiKSwgYi5fb2ZmKCksIGIub2ZmKCksIGIuX19Db250ZW50ID0gbnVsbCwgYi5fXyRlbWl0dGVyUHJpdmF0ZSA9IG51bGwsIGIuX18kZW1pdHRlclB1YmxpYyA9IG51bGwsIGIuX19vcHRpb25zLnBhcmVudCA9IG51bGwsIGIuXyRvcmlnaW4gPSBudWxsLCBiLl8kdG9vbHRpcCA9IG51bGwsIGEudG9vbHRpcHN0ZXIuX19pbnN0YW5jZXNMYXRlc3RBcnIgPSBhLmdyZXAoYS50b29sdGlwc3Rlci5fX2luc3RhbmNlc0xhdGVzdEFyciwgZnVuY3Rpb24gKGEsIGMpIHsgcmV0dXJuIGIgIT09IGEgfSksIGNsZWFySW50ZXJ2YWwoYi5fX2dhcmJhZ2VDb2xsZWN0b3IpIH0gcmV0dXJuIGIgfSwgZGlzYWJsZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fX2Rlc3Ryb3llZCA/ICh0aGlzLl9fZGVzdHJveUVycm9yKCksIHRoaXMpIDogKHRoaXMuX2Nsb3NlKCksIHRoaXMuX19lbmFibGVkID0gITEsIHRoaXMpIH0sIGVsZW1lbnRPcmlnaW46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX19kZXN0cm95ZWQgPyB2b2lkIHRoaXMuX19kZXN0cm95RXJyb3IoKSA6IHRoaXMuXyRvcmlnaW5bMF0gfSwgZWxlbWVudFRvb2x0aXA6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuXyR0b29sdGlwID8gdGhpcy5fJHRvb2x0aXBbMF0gOiBudWxsIH0sIGVuYWJsZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fX2VuYWJsZWQgPSAhMCwgdGhpcyB9LCBoaWRlOiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5jbG9zZShhKSB9LCBpbnN0YW5jZTogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcyB9LCBvZmY6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX19kZXN0cm95ZWQgfHwgdGhpcy5fXyRlbWl0dGVyUHVibGljLm9mZi5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9LCBvbjogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fX2Rlc3Ryb3llZCA/IHRoaXMuX19kZXN0cm95RXJyb3IoKSA6IHRoaXMuX18kZW1pdHRlclB1YmxpYy5vbi5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9LCBvbmU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuX19kZXN0cm95ZWQgPyB0aGlzLl9fZGVzdHJveUVycm9yKCkgOiB0aGlzLl9fJGVtaXR0ZXJQdWJsaWMub25lLmFwcGx5KHRoaXMuX18kZW1pdHRlclB1YmxpYywgQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGFyZ3VtZW50cykpLCB0aGlzIH0sIG9wZW46IGZ1bmN0aW9uIChhKSB7IHJldHVybiB0aGlzLl9fZGVzdHJveWVkID8gdGhpcy5fX2Rlc3Ryb3lFcnJvcigpIDogdGhpcy5fb3BlbihudWxsLCBhKSwgdGhpcyB9LCBvcHRpb246IGZ1bmN0aW9uIChiLCBjKSB7IHJldHVybiB2b2lkIDAgPT09IGMgPyB0aGlzLl9fb3B0aW9uc1tiXSA6ICh0aGlzLl9fZGVzdHJveWVkID8gdGhpcy5fX2Rlc3Ryb3lFcnJvcigpIDogKHRoaXMuX19vcHRpb25zW2JdID0gYywgdGhpcy5fX29wdGlvbnNGb3JtYXQoKSwgYS5pbkFycmF5KGIsIFtcInRyaWdnZXJcIiwgXCJ0cmlnZ2VyQ2xvc2VcIiwgXCJ0cmlnZ2VyT3BlblwiXSkgPj0gMCAmJiB0aGlzLl9fcHJlcGFyZU9yaWdpbigpLCBcInNlbGZEZXN0cnVjdGlvblwiID09PSBiICYmIHRoaXMuX19wcmVwYXJlR0MoKSksIHRoaXMpIH0sIHJlcG9zaXRpb246IGZ1bmN0aW9uIChhLCBiKSB7IHZhciBjID0gdGhpczsgcmV0dXJuIGMuX19kZXN0cm95ZWQgPyBjLl9fZGVzdHJveUVycm9yKCkgOiBcImNsb3NlZFwiICE9IGMuX19zdGF0ZSAmJiBkKGMuXyRvcmlnaW4pICYmIChiIHx8IGQoYy5fJHRvb2x0aXApKSAmJiAoYiB8fCBjLl8kdG9vbHRpcC5kZXRhY2goKSwgYy5fX0dlb21ldHJ5ID0gYy5fX2dlb21ldHJ5KCksIGMuX3RyaWdnZXIoeyB0eXBlOiBcInJlcG9zaXRpb25cIiwgZXZlbnQ6IGEsIGhlbHBlcjogeyBnZW86IGMuX19HZW9tZXRyeSB9IH0pKSwgYyB9LCBzaG93OiBmdW5jdGlvbiAoYSkgeyByZXR1cm4gdGhpcy5vcGVuKGEpIH0sIHN0YXR1czogZnVuY3Rpb24gKCkgeyByZXR1cm4geyBkZXN0cm95ZWQ6IHRoaXMuX19kZXN0cm95ZWQsIGVuYWJsZWQ6IHRoaXMuX19lbmFibGVkLCBvcGVuOiBcImNsb3NlZFwiICE9PSB0aGlzLl9fc3RhdGUsIHN0YXRlOiB0aGlzLl9fc3RhdGUgfSB9LCB0cmlnZ2VySGFuZGxlcjogZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy5fX2Rlc3Ryb3llZCA/IHRoaXMuX19kZXN0cm95RXJyb3IoKSA6IHRoaXMuX18kZW1pdHRlclB1YmxpYy50cmlnZ2VySGFuZGxlci5hcHBseSh0aGlzLl9fJGVtaXR0ZXJQdWJsaWMsIEFycmF5LnByb3RvdHlwZS5zbGljZS5hcHBseShhcmd1bWVudHMpKSwgdGhpcyB9IH0sIGEuZm4udG9vbHRpcHN0ZXIgPSBmdW5jdGlvbiAoKSB7IHZhciBiID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmFwcGx5KGFyZ3VtZW50cyksIGMgPSBcIllvdSBhcmUgdXNpbmcgYSBzaW5nbGUgSFRNTCBlbGVtZW50IGFzIGNvbnRlbnQgZm9yIHNldmVyYWwgdG9vbHRpcHMuIFlvdSBwcm9iYWJseSB3YW50IHRvIHNldCB0aGUgY29udGVudENsb25pbmcgb3B0aW9uIHRvIFRSVUUuXCI7IGlmICgwID09PSB0aGlzLmxlbmd0aCkgcmV0dXJuIHRoaXM7IGlmIChcInN0cmluZ1wiID09IHR5cGVvZiBiWzBdKSB7IHZhciBkID0gXCIjKiR+JlwiOyByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsgdmFyIGUgPSBhKHRoaXMpLmRhdGEoXCJ0b29sdGlwc3Rlci1uc1wiKSwgZiA9IGUgPyBhKHRoaXMpLmRhdGEoZVswXSkgOiBudWxsOyBpZiAoIWYpIHRocm93IG5ldyBFcnJvcihcIllvdSBjYWxsZWQgVG9vbHRpcHN0ZXIncyBcXFwiXCIgKyBiWzBdICsgJ1wiIG1ldGhvZCBvbiBhbiB1bmluaXRpYWxpemVkIGVsZW1lbnQnKTsgaWYgKFwiZnVuY3Rpb25cIiAhPSB0eXBlb2YgZltiWzBdXSkgdGhyb3cgbmV3IEVycm9yKCdVbmtub3duIG1ldGhvZCBcIicgKyBiWzBdICsgJ1wiJyk7IHRoaXMubGVuZ3RoID4gMSAmJiBcImNvbnRlbnRcIiA9PSBiWzBdICYmIChiWzFdIGluc3RhbmNlb2YgYSB8fCBcIm9iamVjdFwiID09IHR5cGVvZiBiWzFdICYmIG51bGwgIT0gYlsxXSAmJiBiWzFdLnRhZ05hbWUpICYmICFmLl9fb3B0aW9ucy5jb250ZW50Q2xvbmluZyAmJiBmLl9fb3B0aW9ucy5kZWJ1ZyAmJiBjb25zb2xlLmxvZyhjKTsgdmFyIGcgPSBmW2JbMF1dKGJbMV0sIGJbMl0pOyByZXR1cm4gZyAhPT0gZiB8fCBcImluc3RhbmNlXCIgPT09IGJbMF0gPyAoZCA9IGcsICExKSA6IHZvaWQgMCB9KSwgXCIjKiR+JlwiICE9PSBkID8gZCA6IHRoaXMgfSBhLnRvb2x0aXBzdGVyLl9faW5zdGFuY2VzTGF0ZXN0QXJyID0gW107IHZhciBlID0gYlswXSAmJiB2b2lkIDAgIT09IGJbMF0ubXVsdGlwbGUsIGcgPSBlICYmIGJbMF0ubXVsdGlwbGUgfHwgIWUgJiYgZi5tdWx0aXBsZSwgaCA9IGJbMF0gJiYgdm9pZCAwICE9PSBiWzBdLmNvbnRlbnQsIGkgPSBoICYmIGJbMF0uY29udGVudCB8fCAhaCAmJiBmLmNvbnRlbnQsIGogPSBiWzBdICYmIHZvaWQgMCAhPT0gYlswXS5jb250ZW50Q2xvbmluZywgayA9IGogJiYgYlswXS5jb250ZW50Q2xvbmluZyB8fCAhaiAmJiBmLmNvbnRlbnRDbG9uaW5nLCBsID0gYlswXSAmJiB2b2lkIDAgIT09IGJbMF0uZGVidWcsIG0gPSBsICYmIGJbMF0uZGVidWcgfHwgIWwgJiYgZi5kZWJ1ZzsgcmV0dXJuIHRoaXMubGVuZ3RoID4gMSAmJiAoaSBpbnN0YW5jZW9mIGEgfHwgXCJvYmplY3RcIiA9PSB0eXBlb2YgaSAmJiBudWxsICE9IGkgJiYgaS50YWdOYW1lKSAmJiAhayAmJiBtICYmIGNvbnNvbGUubG9nKGMpLCB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB2YXIgYyA9ICExLCBkID0gYSh0aGlzKSwgZSA9IGQuZGF0YShcInRvb2x0aXBzdGVyLW5zXCIpLCBmID0gbnVsbDsgZSA/IGcgPyBjID0gITAgOiBtICYmIChjb25zb2xlLmxvZyhcIlRvb2x0aXBzdGVyOiBvbmUgb3IgbW9yZSB0b29sdGlwcyBhcmUgYWxyZWFkeSBhdHRhY2hlZCB0byB0aGUgZWxlbWVudCBiZWxvdy4gSWdub3JpbmcuXCIpLCBjb25zb2xlLmxvZyh0aGlzKSkgOiBjID0gITAsIGMgJiYgKGYgPSBuZXcgYS5Ub29sdGlwc3Rlcih0aGlzLCBiWzBdKSwgZSB8fCAoZSA9IFtdKSwgZS5wdXNoKGYuX19uYW1lc3BhY2UpLCBkLmRhdGEoXCJ0b29sdGlwc3Rlci1uc1wiLCBlKSwgZC5kYXRhKGYuX19uYW1lc3BhY2UsIGYpLCBmLl9fb3B0aW9ucy5mdW5jdGlvbkluaXQgJiYgZi5fX29wdGlvbnMuZnVuY3Rpb25Jbml0LmNhbGwoZiwgZiwgeyBvcmlnaW46IHRoaXMgfSksIGYuX3RyaWdnZXIoXCJpbml0XCIpKSwgYS50b29sdGlwc3Rlci5fX2luc3RhbmNlc0xhdGVzdEFyci5wdXNoKGYpIH0pLCB0aGlzIH0sIGIucHJvdG90eXBlID0geyBfX2luaXQ6IGZ1bmN0aW9uIChiKSB7IHRoaXMuX18kdG9vbHRpcCA9IGIsIHRoaXMuX18kdG9vbHRpcC5jc3MoeyBsZWZ0OiAwLCBvdmVyZmxvdzogXCJoaWRkZW5cIiwgcG9zaXRpb246IFwiYWJzb2x1dGVcIiwgdG9wOiAwIH0pLmZpbmQoXCIudG9vbHRpcHN0ZXItY29udGVudFwiKS5jc3MoXCJvdmVyZmxvd1wiLCBcImF1dG9cIiksIHRoaXMuJGNvbnRhaW5lciA9IGEoJzxkaXYgY2xhc3M9XCJ0b29sdGlwc3Rlci1ydWxlclwiPjwvZGl2PicpLmFwcGVuZCh0aGlzLl9fJHRvb2x0aXApLmFwcGVuZFRvKGgud2luZG93LmRvY3VtZW50LmJvZHkpIH0sIF9fZm9yY2VSZWRyYXc6IGZ1bmN0aW9uICgpIHsgdmFyIGEgPSB0aGlzLl9fJHRvb2x0aXAucGFyZW50KCk7IHRoaXMuX18kdG9vbHRpcC5kZXRhY2goKSwgdGhpcy5fXyR0b29sdGlwLmFwcGVuZFRvKGEpIH0sIGNvbnN0cmFpbjogZnVuY3Rpb24gKGEsIGIpIHsgcmV0dXJuIHRoaXMuY29uc3RyYWludHMgPSB7IHdpZHRoOiBhLCBoZWlnaHQ6IGIgfSwgdGhpcy5fXyR0b29sdGlwLmNzcyh7IGRpc3BsYXk6IFwiYmxvY2tcIiwgaGVpZ2h0OiBcIlwiLCBvdmVyZmxvdzogXCJhdXRvXCIsIHdpZHRoOiBhIH0pLCB0aGlzIH0sIGRlc3Ryb3k6IGZ1bmN0aW9uICgpIHsgdGhpcy5fXyR0b29sdGlwLmRldGFjaCgpLmZpbmQoXCIudG9vbHRpcHN0ZXItY29udGVudFwiKS5jc3MoeyBkaXNwbGF5OiBcIlwiLCBvdmVyZmxvdzogXCJcIiB9KSwgdGhpcy4kY29udGFpbmVyLnJlbW92ZSgpIH0sIGZyZWU6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMuY29uc3RyYWludHMgPSBudWxsLCB0aGlzLl9fJHRvb2x0aXAuY3NzKHsgZGlzcGxheTogXCJcIiwgaGVpZ2h0OiBcIlwiLCBvdmVyZmxvdzogXCJ2aXNpYmxlXCIsIHdpZHRoOiBcIlwiIH0pLCB0aGlzIH0sIG1lYXN1cmU6IGZ1bmN0aW9uICgpIHsgdGhpcy5fX2ZvcmNlUmVkcmF3KCk7IHZhciBhID0gdGhpcy5fXyR0b29sdGlwWzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLCBiID0geyBzaXplOiB7IGhlaWdodDogYS5oZWlnaHQgfHwgYS5ib3R0b20gLSBhLnRvcCwgd2lkdGg6IGEud2lkdGggfHwgYS5yaWdodCAtIGEubGVmdCB9IH07IGlmICh0aGlzLmNvbnN0cmFpbnRzKSB7IHZhciBjID0gdGhpcy5fXyR0b29sdGlwLmZpbmQoXCIudG9vbHRpcHN0ZXItY29udGVudFwiKSwgZCA9IHRoaXMuX18kdG9vbHRpcC5vdXRlckhlaWdodCgpLCBlID0gY1swXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKSwgZiA9IHsgaGVpZ2h0OiBkIDw9IHRoaXMuY29uc3RyYWludHMuaGVpZ2h0LCB3aWR0aDogYS53aWR0aCA8PSB0aGlzLmNvbnN0cmFpbnRzLndpZHRoICYmIGUud2lkdGggPj0gY1swXS5zY3JvbGxXaWR0aCAtIDEgfTsgYi5maXRzID0gZi5oZWlnaHQgJiYgZi53aWR0aCB9IHJldHVybiBoLklFICYmIGguSUUgPD0gMTEgJiYgYi5zaXplLndpZHRoICE9PSBoLndpbmRvdy5kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggJiYgKGIuc2l6ZS53aWR0aCA9IE1hdGguY2VpbChiLnNpemUud2lkdGgpICsgMSksIGIgfSB9OyB2YXIgaiA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKTsgLTEgIT0gai5pbmRleE9mKFwibXNpZVwiKSA/IGguSUUgPSBwYXJzZUludChqLnNwbGl0KFwibXNpZVwiKVsxXSkgOiAtMSAhPT0gai50b0xvd2VyQ2FzZSgpLmluZGV4T2YoXCJ0cmlkZW50XCIpICYmIC0xICE9PSBqLmluZGV4T2YoXCIgcnY6MTFcIikgPyBoLklFID0gMTEgOiAtMSAhPSBqLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihcImVkZ2UvXCIpICYmIChoLklFID0gcGFyc2VJbnQoai50b0xvd2VyQ2FzZSgpLnNwbGl0KFwiZWRnZS9cIilbMV0pKTsgdmFyIGsgPSBcInRvb2x0aXBzdGVyLnNpZGVUaXBcIjsgcmV0dXJuIGEudG9vbHRpcHN0ZXIuX3BsdWdpbih7XHJcbiAgICAgICAgbmFtZTogaywgaW5zdGFuY2U6IHtcclxuICAgICAgICAgICAgX19kZWZhdWx0czogZnVuY3Rpb24gKCkgeyByZXR1cm4geyBhcnJvdzogITAsIGRpc3RhbmNlOiA2LCBmdW5jdGlvblBvc2l0aW9uOiBudWxsLCBtYXhXaWR0aDogbnVsbCwgbWluSW50ZXJzZWN0aW9uOiAxNiwgbWluV2lkdGg6IDAsIHBvc2l0aW9uOiBudWxsLCBzaWRlOiBcInRvcFwiLCB2aWV3cG9ydEF3YXJlOiAhMCB9IH0sIF9faW5pdDogZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSB0aGlzOyBiLl9faW5zdGFuY2UgPSBhLCBiLl9fbmFtZXNwYWNlID0gXCJ0b29sdGlwc3Rlci1zaWRlVGlwLVwiICsgTWF0aC5yb3VuZCgxZTYgKiBNYXRoLnJhbmRvbSgpKSwgYi5fX3ByZXZpb3VzU3RhdGUgPSBcImNsb3NlZFwiLCBiLl9fb3B0aW9ucywgYi5fX29wdGlvbnNGb3JtYXQoKSwgYi5fX2luc3RhbmNlLl9vbihcInN0YXRlLlwiICsgYi5fX25hbWVzcGFjZSwgZnVuY3Rpb24gKGEpIHsgXCJjbG9zZWRcIiA9PSBhLnN0YXRlID8gYi5fX2Nsb3NlKCkgOiBcImFwcGVhcmluZ1wiID09IGEuc3RhdGUgJiYgXCJjbG9zZWRcIiA9PSBiLl9fcHJldmlvdXNTdGF0ZSAmJiBiLl9fY3JlYXRlKCksIGIuX19wcmV2aW91c1N0YXRlID0gYS5zdGF0ZSB9KSwgYi5fX2luc3RhbmNlLl9vbihcIm9wdGlvbnMuXCIgKyBiLl9fbmFtZXNwYWNlLCBmdW5jdGlvbiAoKSB7IGIuX19vcHRpb25zRm9ybWF0KCkgfSksIGIuX19pbnN0YW5jZS5fb24oXCJyZXBvc2l0aW9uLlwiICsgYi5fX25hbWVzcGFjZSwgZnVuY3Rpb24gKGEpIHsgYi5fX3JlcG9zaXRpb24oYS5ldmVudCwgYS5oZWxwZXIpIH0pIH0sIF9fY2xvc2U6IGZ1bmN0aW9uICgpIHsgdGhpcy5fX2luc3RhbmNlLmNvbnRlbnQoKSBpbnN0YW5jZW9mIGEgJiYgdGhpcy5fX2luc3RhbmNlLmNvbnRlbnQoKS5kZXRhY2goKSwgdGhpcy5fX2luc3RhbmNlLl8kdG9vbHRpcC5yZW1vdmUoKSwgdGhpcy5fX2luc3RhbmNlLl8kdG9vbHRpcCA9IG51bGwgfSwgX19jcmVhdGU6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZhciBiID0gYSgnPGRpdiBjbGFzcz1cInRvb2x0aXBzdGVyLWJhc2UgdG9vbHRpcHN0ZXItc2lkZXRpcFwiPjxkaXYgY2xhc3M9XCJ0b29sdGlwc3Rlci1ib3hcIj48ZGl2IGNsYXNzPVwidG9vbHRpcHN0ZXItY29udGVudFwiPjwvZGl2PjwvZGl2PjxkaXYgY2xhc3M9XCJ0b29sdGlwc3Rlci1hcnJvd1wiPjxkaXYgY2xhc3M9XCJ0b29sdGlwc3Rlci1hcnJvdy11bmNyb3BwZWRcIj48ZGl2IGNsYXNzPVwidG9vbHRpcHN0ZXItYXJyb3ctYm9yZGVyXCI+PC9kaXY+PGRpdiBjbGFzcz1cInRvb2x0aXBzdGVyLWFycm93LWJhY2tncm91bmRcIj48L2Rpdj48L2Rpdj48L2Rpdj48L2Rpdj4nKTsgdGhpcy5fX29wdGlvbnMuYXJyb3cgfHwgYi5maW5kKFwiLnRvb2x0aXBzdGVyLWJveFwiKS5jc3MoXCJtYXJnaW5cIiwgMCkuZW5kKCkuZmluZChcIi50b29sdGlwc3Rlci1hcnJvd1wiKS5oaWRlKCksIHRoaXMuX19vcHRpb25zLm1pbldpZHRoICYmIGIuY3NzKFwibWluLXdpZHRoXCIsIHRoaXMuX19vcHRpb25zLm1pbldpZHRoICsgXCJweFwiKSwgdGhpcy5fX29wdGlvbnMubWF4V2lkdGggJiYgYi5jc3MoXCJtYXgtd2lkdGhcIiwgdGhpcy5fX29wdGlvbnMubWF4V2lkdGggKyBcInB4XCIpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX19pbnN0YW5jZS5fJHRvb2x0aXAgPSBiLCB0aGlzLl9faW5zdGFuY2UuX3RyaWdnZXIoXCJjcmVhdGVkXCIpXHJcbiAgICAgICAgICAgIH0sIF9fZGVzdHJveTogZnVuY3Rpb24gKCkgeyB0aGlzLl9faW5zdGFuY2UuX29mZihcIi5cIiArIHNlbGYuX19uYW1lc3BhY2UpIH0sIF9fb3B0aW9uc0Zvcm1hdDogZnVuY3Rpb24gKCkgeyB2YXIgYiA9IHRoaXM7IGlmIChiLl9fb3B0aW9ucyA9IGIuX19pbnN0YW5jZS5fb3B0aW9uc0V4dHJhY3QoaywgYi5fX2RlZmF1bHRzKCkpLCBiLl9fb3B0aW9ucy5wb3NpdGlvbiAmJiAoYi5fX29wdGlvbnMuc2lkZSA9IGIuX19vcHRpb25zLnBvc2l0aW9uKSwgXCJvYmplY3RcIiAhPSB0eXBlb2YgYi5fX29wdGlvbnMuZGlzdGFuY2UgJiYgKGIuX19vcHRpb25zLmRpc3RhbmNlID0gW2IuX19vcHRpb25zLmRpc3RhbmNlXSksIGIuX19vcHRpb25zLmRpc3RhbmNlLmxlbmd0aCA8IDQgJiYgKHZvaWQgMCA9PT0gYi5fX29wdGlvbnMuZGlzdGFuY2VbMV0gJiYgKGIuX19vcHRpb25zLmRpc3RhbmNlWzFdID0gYi5fX29wdGlvbnMuZGlzdGFuY2VbMF0pLCB2b2lkIDAgPT09IGIuX19vcHRpb25zLmRpc3RhbmNlWzJdICYmIChiLl9fb3B0aW9ucy5kaXN0YW5jZVsyXSA9IGIuX19vcHRpb25zLmRpc3RhbmNlWzBdKSwgdm9pZCAwID09PSBiLl9fb3B0aW9ucy5kaXN0YW5jZVszXSAmJiAoYi5fX29wdGlvbnMuZGlzdGFuY2VbM10gPSBiLl9fb3B0aW9ucy5kaXN0YW5jZVsxXSksIGIuX19vcHRpb25zLmRpc3RhbmNlID0geyB0b3A6IGIuX19vcHRpb25zLmRpc3RhbmNlWzBdLCByaWdodDogYi5fX29wdGlvbnMuZGlzdGFuY2VbMV0sIGJvdHRvbTogYi5fX29wdGlvbnMuZGlzdGFuY2VbMl0sIGxlZnQ6IGIuX19vcHRpb25zLmRpc3RhbmNlWzNdIH0pLCBcInN0cmluZ1wiID09IHR5cGVvZiBiLl9fb3B0aW9ucy5zaWRlKSB7IHZhciBjID0geyB0b3A6IFwiYm90dG9tXCIsIHJpZ2h0OiBcImxlZnRcIiwgYm90dG9tOiBcInRvcFwiLCBsZWZ0OiBcInJpZ2h0XCIgfTsgYi5fX29wdGlvbnMuc2lkZSA9IFtiLl9fb3B0aW9ucy5zaWRlLCBjW2IuX19vcHRpb25zLnNpZGVdXSwgXCJsZWZ0XCIgPT0gYi5fX29wdGlvbnMuc2lkZVswXSB8fCBcInJpZ2h0XCIgPT0gYi5fX29wdGlvbnMuc2lkZVswXSA/IGIuX19vcHRpb25zLnNpZGUucHVzaChcInRvcFwiLCBcImJvdHRvbVwiKSA6IGIuX19vcHRpb25zLnNpZGUucHVzaChcInJpZ2h0XCIsIFwibGVmdFwiKSB9IDYgPT09IGEudG9vbHRpcHN0ZXIuX2Vudi5JRSAmJiBiLl9fb3B0aW9ucy5hcnJvdyAhPT0gITAgJiYgKGIuX19vcHRpb25zLmFycm93ID0gITEpIH0sIF9fcmVwb3NpdGlvbjogZnVuY3Rpb24gKGIsIGMpIHsgdmFyIGQsIGUgPSB0aGlzLCBmID0gZS5fX3RhcmdldEZpbmQoYyksIGcgPSBbXTsgZS5fX2luc3RhbmNlLl8kdG9vbHRpcC5kZXRhY2goKTsgdmFyIGggPSBlLl9faW5zdGFuY2UuXyR0b29sdGlwLmNsb25lKCksIGkgPSBhLnRvb2x0aXBzdGVyLl9nZXRSdWxlcihoKSwgaiA9ICExLCBrID0gZS5fX2luc3RhbmNlLm9wdGlvbihcImFuaW1hdGlvblwiKTsgc3dpdGNoIChrICYmIGgucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci1cIiArIGspLCBhLmVhY2goW1wid2luZG93XCIsIFwiZG9jdW1lbnRcIl0sIGZ1bmN0aW9uIChkLCBrKSB7IHZhciBsID0gbnVsbDsgaWYgKGUuX19pbnN0YW5jZS5fdHJpZ2dlcih7IGNvbnRhaW5lcjogaywgaGVscGVyOiBjLCBzYXRpc2ZpZWQ6IGosIHRha2VUZXN0OiBmdW5jdGlvbiAoYSkgeyBsID0gYSB9LCByZXN1bHRzOiBnLCB0eXBlOiBcInBvc2l0aW9uVGVzdFwiIH0pLCAxID09IGwgfHwgMCAhPSBsICYmIDAgPT0gaiAmJiAoXCJ3aW5kb3dcIiAhPSBrIHx8IGUuX19vcHRpb25zLnZpZXdwb3J0QXdhcmUpKSBmb3IgKHZhciBkID0gMDsgZCA8IGUuX19vcHRpb25zLnNpZGUubGVuZ3RoOyBkKyspIHsgdmFyIG0gPSB7IGhvcml6b250YWw6IDAsIHZlcnRpY2FsOiAwIH0sIG4gPSBlLl9fb3B0aW9ucy5zaWRlW2RdOyBcInRvcFwiID09IG4gfHwgXCJib3R0b21cIiA9PSBuID8gbS52ZXJ0aWNhbCA9IGUuX19vcHRpb25zLmRpc3RhbmNlW25dIDogbS5ob3Jpem9udGFsID0gZS5fX29wdGlvbnMuZGlzdGFuY2Vbbl0sIGUuX19zaWRlQ2hhbmdlKGgsIG4pLCBhLmVhY2goW1wibmF0dXJhbFwiLCBcImNvbnN0cmFpbmVkXCJdLCBmdW5jdGlvbiAoYSwgZCkgeyBpZiAobCA9IG51bGwsIGUuX19pbnN0YW5jZS5fdHJpZ2dlcih7IGNvbnRhaW5lcjogaywgZXZlbnQ6IGIsIGhlbHBlcjogYywgbW9kZTogZCwgcmVzdWx0czogZywgc2F0aXNmaWVkOiBqLCBzaWRlOiBuLCB0YWtlVGVzdDogZnVuY3Rpb24gKGEpIHsgbCA9IGEgfSwgdHlwZTogXCJwb3NpdGlvblRlc3RcIiB9KSwgMSA9PSBsIHx8IDAgIT0gbCAmJiAwID09IGopIHsgdmFyIGggPSB7IGNvbnRhaW5lcjogaywgZGlzdGFuY2U6IG0sIGZpdHM6IG51bGwsIG1vZGU6IGQsIG91dGVyU2l6ZTogbnVsbCwgc2lkZTogbiwgc2l6ZTogbnVsbCwgdGFyZ2V0OiBmW25dLCB3aG9sZTogbnVsbCB9LCBvID0gXCJuYXR1cmFsXCIgPT0gZCA/IGkuZnJlZSgpIDogaS5jb25zdHJhaW4oYy5nZW8uYXZhaWxhYmxlW2tdW25dLndpZHRoIC0gbS5ob3Jpem9udGFsLCBjLmdlby5hdmFpbGFibGVba11bbl0uaGVpZ2h0IC0gbS52ZXJ0aWNhbCksIHAgPSBvLm1lYXN1cmUoKTsgaWYgKGguc2l6ZSA9IHAuc2l6ZSwgaC5vdXRlclNpemUgPSB7IGhlaWdodDogcC5zaXplLmhlaWdodCArIG0udmVydGljYWwsIHdpZHRoOiBwLnNpemUud2lkdGggKyBtLmhvcml6b250YWwgfSwgXCJuYXR1cmFsXCIgPT0gZCA/IGMuZ2VvLmF2YWlsYWJsZVtrXVtuXS53aWR0aCA+PSBoLm91dGVyU2l6ZS53aWR0aCAmJiBjLmdlby5hdmFpbGFibGVba11bbl0uaGVpZ2h0ID49IGgub3V0ZXJTaXplLmhlaWdodCA/IGguZml0cyA9ICEwIDogaC5maXRzID0gITEgOiBoLmZpdHMgPSBwLmZpdHMsIFwid2luZG93XCIgPT0gayAmJiAoaC5maXRzID8gXCJ0b3BcIiA9PSBuIHx8IFwiYm90dG9tXCIgPT0gbiA/IGgud2hvbGUgPSBjLmdlby5vcmlnaW4ud2luZG93T2Zmc2V0LnJpZ2h0ID49IGUuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiAmJiBjLmdlby53aW5kb3cuc2l6ZS53aWR0aCAtIGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQubGVmdCA+PSBlLl9fb3B0aW9ucy5taW5JbnRlcnNlY3Rpb24gOiBoLndob2xlID0gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC5ib3R0b20gPj0gZS5fX29wdGlvbnMubWluSW50ZXJzZWN0aW9uICYmIGMuZ2VvLndpbmRvdy5zaXplLmhlaWdodCAtIGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQudG9wID49IGUuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiA6IGgud2hvbGUgPSAhMSksIGcucHVzaChoKSwgaC53aG9sZSkgaiA9ICEwOyBlbHNlIGlmIChcIm5hdHVyYWxcIiA9PSBoLm1vZGUgJiYgKGguZml0cyB8fCBoLnNpemUud2lkdGggPD0gYy5nZW8uYXZhaWxhYmxlW2tdW25dLndpZHRoKSkgcmV0dXJuICExIH0gfSkgfSB9KSwgZS5fX2luc3RhbmNlLl90cmlnZ2VyKHsgZWRpdDogZnVuY3Rpb24gKGEpIHsgZyA9IGEgfSwgZXZlbnQ6IGIsIGhlbHBlcjogYywgcmVzdWx0czogZywgdHlwZTogXCJwb3NpdGlvblRlc3RlZFwiIH0pLCBnLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsgaWYgKGEud2hvbGUgJiYgIWIud2hvbGUpIHJldHVybiAtMTsgaWYgKCFhLndob2xlICYmIGIud2hvbGUpIHJldHVybiAxOyBpZiAoYS53aG9sZSAmJiBiLndob2xlKSB7IHZhciBjID0gZS5fX29wdGlvbnMuc2lkZS5pbmRleE9mKGEuc2lkZSksIGQgPSBlLl9fb3B0aW9ucy5zaWRlLmluZGV4T2YoYi5zaWRlKTsgcmV0dXJuIGQgPiBjID8gLTEgOiBjID4gZCA/IDEgOiBcIm5hdHVyYWxcIiA9PSBhLm1vZGUgPyAtMSA6IDEgfSBpZiAoYS5maXRzICYmICFiLmZpdHMpIHJldHVybiAtMTsgaWYgKCFhLmZpdHMgJiYgYi5maXRzKSByZXR1cm4gMTsgaWYgKGEuZml0cyAmJiBiLmZpdHMpIHsgdmFyIGMgPSBlLl9fb3B0aW9ucy5zaWRlLmluZGV4T2YoYS5zaWRlKSwgZCA9IGUuX19vcHRpb25zLnNpZGUuaW5kZXhPZihiLnNpZGUpOyByZXR1cm4gZCA+IGMgPyAtMSA6IGMgPiBkID8gMSA6IFwibmF0dXJhbFwiID09IGEubW9kZSA/IC0xIDogMSB9IHJldHVybiBcImRvY3VtZW50XCIgPT0gYS5jb250YWluZXIgJiYgXCJib3R0b21cIiA9PSBhLnNpZGUgJiYgXCJuYXR1cmFsXCIgPT0gYS5tb2RlID8gLTEgOiAxIH0pLCBkID0gZ1swXSwgZC5jb29yZCA9IHt9LCBkLnNpZGUpIHsgY2FzZSBcImxlZnRcIjogY2FzZSBcInJpZ2h0XCI6IGQuY29vcmQudG9wID0gTWF0aC5mbG9vcihkLnRhcmdldCAtIGQuc2l6ZS5oZWlnaHQgLyAyKTsgYnJlYWs7IGNhc2UgXCJib3R0b21cIjogY2FzZSBcInRvcFwiOiBkLmNvb3JkLmxlZnQgPSBNYXRoLmZsb29yKGQudGFyZ2V0IC0gZC5zaXplLndpZHRoIC8gMikgfXN3aXRjaCAoZC5zaWRlKSB7IGNhc2UgXCJsZWZ0XCI6IGQuY29vcmQubGVmdCA9IGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQubGVmdCAtIGQub3V0ZXJTaXplLndpZHRoOyBicmVhazsgY2FzZSBcInJpZ2h0XCI6IGQuY29vcmQubGVmdCA9IGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQucmlnaHQgKyBkLmRpc3RhbmNlLmhvcml6b250YWw7IGJyZWFrOyBjYXNlIFwidG9wXCI6IGQuY29vcmQudG9wID0gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC50b3AgLSBkLm91dGVyU2l6ZS5oZWlnaHQ7IGJyZWFrOyBjYXNlIFwiYm90dG9tXCI6IGQuY29vcmQudG9wID0gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC5ib3R0b20gKyBkLmRpc3RhbmNlLnZlcnRpY2FsIH1cIndpbmRvd1wiID09IGQuY29udGFpbmVyID8gXCJ0b3BcIiA9PSBkLnNpZGUgfHwgXCJib3R0b21cIiA9PSBkLnNpZGUgPyBkLmNvb3JkLmxlZnQgPCAwID8gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC5yaWdodCAtIHRoaXMuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiA+PSAwID8gZC5jb29yZC5sZWZ0ID0gMCA6IGQuY29vcmQubGVmdCA9IGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQucmlnaHQgLSB0aGlzLl9fb3B0aW9ucy5taW5JbnRlcnNlY3Rpb24gLSAxIDogZC5jb29yZC5sZWZ0ID4gYy5nZW8ud2luZG93LnNpemUud2lkdGggLSBkLnNpemUud2lkdGggJiYgKGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQubGVmdCArIHRoaXMuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiA8PSBjLmdlby53aW5kb3cuc2l6ZS53aWR0aCA/IGQuY29vcmQubGVmdCA9IGMuZ2VvLndpbmRvdy5zaXplLndpZHRoIC0gZC5zaXplLndpZHRoIDogZC5jb29yZC5sZWZ0ID0gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC5sZWZ0ICsgdGhpcy5fX29wdGlvbnMubWluSW50ZXJzZWN0aW9uICsgMSAtIGQuc2l6ZS53aWR0aCkgOiBkLmNvb3JkLnRvcCA8IDAgPyBjLmdlby5vcmlnaW4ud2luZG93T2Zmc2V0LmJvdHRvbSAtIHRoaXMuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiA+PSAwID8gZC5jb29yZC50b3AgPSAwIDogZC5jb29yZC50b3AgPSBjLmdlby5vcmlnaW4ud2luZG93T2Zmc2V0LmJvdHRvbSAtIHRoaXMuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiAtIDEgOiBkLmNvb3JkLnRvcCA+IGMuZ2VvLndpbmRvdy5zaXplLmhlaWdodCAtIGQuc2l6ZS5oZWlnaHQgJiYgKGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQudG9wICsgdGhpcy5fX29wdGlvbnMubWluSW50ZXJzZWN0aW9uIDw9IGMuZ2VvLndpbmRvdy5zaXplLmhlaWdodCA/IGQuY29vcmQudG9wID0gYy5nZW8ud2luZG93LnNpemUuaGVpZ2h0IC0gZC5zaXplLmhlaWdodCA6IGQuY29vcmQudG9wID0gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC50b3AgKyB0aGlzLl9fb3B0aW9ucy5taW5JbnRlcnNlY3Rpb24gKyAxIC0gZC5zaXplLmhlaWdodCkgOiAoZC5jb29yZC5sZWZ0ID4gYy5nZW8ud2luZG93LnNpemUud2lkdGggLSBkLnNpemUud2lkdGggJiYgKGQuY29vcmQubGVmdCA9IGMuZ2VvLndpbmRvdy5zaXplLndpZHRoIC0gZC5zaXplLndpZHRoKSwgZC5jb29yZC5sZWZ0IDwgMCAmJiAoZC5jb29yZC5sZWZ0ID0gMCkpLCBlLl9fc2lkZUNoYW5nZShoLCBkLnNpZGUpLCBjLnRvb2x0aXBDbG9uZSA9IGhbMF0sIGMudG9vbHRpcFBhcmVudCA9IGUuX19pbnN0YW5jZS5vcHRpb24oXCJwYXJlbnRcIikucGFyZW50WzBdLCBjLm1vZGUgPSBkLm1vZGUsIGMud2hvbGUgPSBkLndob2xlLCBjLm9yaWdpbiA9IGUuX19pbnN0YW5jZS5fJG9yaWdpblswXSwgYy50b29sdGlwID0gZS5fX2luc3RhbmNlLl8kdG9vbHRpcFswXSwgZGVsZXRlIGQuY29udGFpbmVyLCBkZWxldGUgZC5maXRzLCBkZWxldGUgZC5tb2RlLCBkZWxldGUgZC5vdXRlclNpemUsIGRlbGV0ZSBkLndob2xlLCBkLmRpc3RhbmNlID0gZC5kaXN0YW5jZS5ob3Jpem9udGFsIHx8IGQuZGlzdGFuY2UudmVydGljYWw7IHZhciBsID0gYS5leHRlbmQoITAsIHt9LCBkKTsgaWYgKGUuX19pbnN0YW5jZS5fdHJpZ2dlcih7IGVkaXQ6IGZ1bmN0aW9uIChhKSB7IGQgPSBhIH0sIGV2ZW50OiBiLCBoZWxwZXI6IGMsIHBvc2l0aW9uOiBsLCB0eXBlOiBcInBvc2l0aW9uXCIgfSksIGUuX19vcHRpb25zLmZ1bmN0aW9uUG9zaXRpb24pIHsgdmFyIG0gPSBlLl9fb3B0aW9ucy5mdW5jdGlvblBvc2l0aW9uLmNhbGwoZSwgZS5fX2luc3RhbmNlLCBjLCBsKTsgbSAmJiAoZCA9IG0pIH0gaS5kZXN0cm95KCk7IHZhciBuLCBvOyBcInRvcFwiID09IGQuc2lkZSB8fCBcImJvdHRvbVwiID09IGQuc2lkZSA/IChuID0geyBwcm9wOiBcImxlZnRcIiwgdmFsOiBkLnRhcmdldCAtIGQuY29vcmQubGVmdCB9LCBvID0gZC5zaXplLndpZHRoIC0gdGhpcy5fX29wdGlvbnMubWluSW50ZXJzZWN0aW9uKSA6IChuID0geyBwcm9wOiBcInRvcFwiLCB2YWw6IGQudGFyZ2V0IC0gZC5jb29yZC50b3AgfSwgbyA9IGQuc2l6ZS5oZWlnaHQgLSB0aGlzLl9fb3B0aW9ucy5taW5JbnRlcnNlY3Rpb24pLCBuLnZhbCA8IHRoaXMuX19vcHRpb25zLm1pbkludGVyc2VjdGlvbiA/IG4udmFsID0gdGhpcy5fX29wdGlvbnMubWluSW50ZXJzZWN0aW9uIDogbi52YWwgPiBvICYmIChuLnZhbCA9IG8pOyB2YXIgcDsgcCA9IGMuZ2VvLm9yaWdpbi5maXhlZExpbmVhZ2UgPyBjLmdlby5vcmlnaW4ud2luZG93T2Zmc2V0IDogeyBsZWZ0OiBjLmdlby5vcmlnaW4ud2luZG93T2Zmc2V0LmxlZnQgKyBjLmdlby53aW5kb3cuc2Nyb2xsLmxlZnQsIHRvcDogYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC50b3AgKyBjLmdlby53aW5kb3cuc2Nyb2xsLnRvcCB9LCBkLmNvb3JkID0geyBsZWZ0OiBwLmxlZnQgKyAoZC5jb29yZC5sZWZ0IC0gYy5nZW8ub3JpZ2luLndpbmRvd09mZnNldC5sZWZ0KSwgdG9wOiBwLnRvcCArIChkLmNvb3JkLnRvcCAtIGMuZ2VvLm9yaWdpbi53aW5kb3dPZmZzZXQudG9wKSB9LCBlLl9fc2lkZUNoYW5nZShlLl9faW5zdGFuY2UuXyR0b29sdGlwLCBkLnNpZGUpLCBjLmdlby5vcmlnaW4uZml4ZWRMaW5lYWdlID8gZS5fX2luc3RhbmNlLl8kdG9vbHRpcC5jc3MoXCJwb3NpdGlvblwiLCBcImZpeGVkXCIpIDogZS5fX2luc3RhbmNlLl8kdG9vbHRpcC5jc3MoXCJwb3NpdGlvblwiLCBcIlwiKSwgZS5fX2luc3RhbmNlLl8kdG9vbHRpcC5jc3MoeyBsZWZ0OiBkLmNvb3JkLmxlZnQsIHRvcDogZC5jb29yZC50b3AsIGhlaWdodDogZC5zaXplLmhlaWdodCwgd2lkdGg6IGQuc2l6ZS53aWR0aCB9KS5maW5kKFwiLnRvb2x0aXBzdGVyLWFycm93XCIpLmNzcyh7IGxlZnQ6IFwiXCIsIHRvcDogXCJcIiB9KS5jc3Mobi5wcm9wLCBuLnZhbCksIGUuX19pbnN0YW5jZS5fJHRvb2x0aXAuYXBwZW5kVG8oZS5fX2luc3RhbmNlLm9wdGlvbihcInBhcmVudFwiKSksIGUuX19pbnN0YW5jZS5fdHJpZ2dlcih7IHR5cGU6IFwicmVwb3NpdGlvbmVkXCIsIGV2ZW50OiBiLCBwb3NpdGlvbjogZCB9KSB9LCBfX3NpZGVDaGFuZ2U6IGZ1bmN0aW9uIChhLCBiKSB7IGEucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci1ib3R0b21cIikucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci1sZWZ0XCIpLnJlbW92ZUNsYXNzKFwidG9vbHRpcHN0ZXItcmlnaHRcIikucmVtb3ZlQ2xhc3MoXCJ0b29sdGlwc3Rlci10b3BcIikuYWRkQ2xhc3MoXCJ0b29sdGlwc3Rlci1cIiArIGIpIH0sIF9fdGFyZ2V0RmluZDogZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSB7fSwgYyA9IHRoaXMuX19pbnN0YW5jZS5fJG9yaWdpblswXS5nZXRDbGllbnRSZWN0cygpOyBpZiAoYy5sZW5ndGggPiAxKSB7IHZhciBkID0gdGhpcy5fX2luc3RhbmNlLl8kb3JpZ2luLmNzcyhcIm9wYWNpdHlcIik7IDEgPT0gZCAmJiAodGhpcy5fX2luc3RhbmNlLl8kb3JpZ2luLmNzcyhcIm9wYWNpdHlcIiwgLjk5KSwgYyA9IHRoaXMuX19pbnN0YW5jZS5fJG9yaWdpblswXS5nZXRDbGllbnRSZWN0cygpLCB0aGlzLl9faW5zdGFuY2UuXyRvcmlnaW4uY3NzKFwib3BhY2l0eVwiLCAxKSkgfSBpZiAoYy5sZW5ndGggPCAyKSBiLnRvcCA9IE1hdGguZmxvb3IoYS5nZW8ub3JpZ2luLndpbmRvd09mZnNldC5sZWZ0ICsgYS5nZW8ub3JpZ2luLnNpemUud2lkdGggLyAyKSwgYi5ib3R0b20gPSBiLnRvcCwgYi5sZWZ0ID0gTWF0aC5mbG9vcihhLmdlby5vcmlnaW4ud2luZG93T2Zmc2V0LnRvcCArIGEuZ2VvLm9yaWdpbi5zaXplLmhlaWdodCAvIDIpLCBiLnJpZ2h0ID0gYi5sZWZ0OyBlbHNlIHsgdmFyIGUgPSBjWzBdOyBiLnRvcCA9IE1hdGguZmxvb3IoZS5sZWZ0ICsgKGUucmlnaHQgLSBlLmxlZnQpIC8gMiksIGUgPSBjLmxlbmd0aCA+IDIgPyBjW01hdGguY2VpbChjLmxlbmd0aCAvIDIpIC0gMV0gOiBjWzBdLCBiLnJpZ2h0ID0gTWF0aC5mbG9vcihlLnRvcCArIChlLmJvdHRvbSAtIGUudG9wKSAvIDIpLCBlID0gY1tjLmxlbmd0aCAtIDFdLCBiLmJvdHRvbSA9IE1hdGguZmxvb3IoZS5sZWZ0ICsgKGUucmlnaHQgLSBlLmxlZnQpIC8gMiksIGUgPSBjLmxlbmd0aCA+IDIgPyBjW01hdGguY2VpbCgoYy5sZW5ndGggKyAxKSAvIDIpIC0gMV0gOiBjW2MubGVuZ3RoIC0gMV0sIGIubGVmdCA9IE1hdGguZmxvb3IoZS50b3AgKyAoZS5ib3R0b20gLSBlLnRvcCkgLyAyKSB9IHJldHVybiBiIH1cclxuICAgICAgICB9XHJcbiAgICB9KSwgYVxyXG59KTsiLCIvKiFcclxuICogalF1ZXJ5IHRocm90dGxlIC8gZGVib3VuY2UgLSB2MS4xIC0gMy83LzIwMTBcclxuICogaHR0cDovL2JlbmFsbWFuLmNvbS9wcm9qZWN0cy9qcXVlcnktdGhyb3R0bGUtZGVib3VuY2UtcGx1Z2luL1xyXG4gKiBcclxuICogQ29weXJpZ2h0IChjKSAyMDEwIFwiQ293Ym95XCIgQmVuIEFsbWFuXHJcbiAqIER1YWwgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBhbmQgR1BMIGxpY2Vuc2VzLlxyXG4gKiBodHRwOi8vYmVuYWxtYW4uY29tL2Fib3V0L2xpY2Vuc2UvXHJcbiAqL1xyXG5cclxuLy8gU2NyaXB0OiBqUXVlcnkgdGhyb3R0bGUgLyBkZWJvdW5jZTogU29tZXRpbWVzLCBsZXNzIGlzIG1vcmUhXHJcbi8vXHJcbi8vICpWZXJzaW9uOiAxLjEsIExhc3QgdXBkYXRlZDogMy83LzIwMTAqXHJcbi8vIFxyXG4vLyBQcm9qZWN0IEhvbWUgLSBodHRwOi8vYmVuYWxtYW4uY29tL3Byb2plY3RzL2pxdWVyeS10aHJvdHRsZS1kZWJvdW5jZS1wbHVnaW4vXHJcbi8vIEdpdEh1YiAgICAgICAtIGh0dHA6Ly9naXRodWIuY29tL2Nvd2JveS9qcXVlcnktdGhyb3R0bGUtZGVib3VuY2UvXHJcbi8vIFNvdXJjZSAgICAgICAtIGh0dHA6Ly9naXRodWIuY29tL2Nvd2JveS9qcXVlcnktdGhyb3R0bGUtZGVib3VuY2UvcmF3L21hc3Rlci9qcXVlcnkuYmEtdGhyb3R0bGUtZGVib3VuY2UuanNcclxuLy8gKE1pbmlmaWVkKSAgIC0gaHR0cDovL2dpdGh1Yi5jb20vY293Ym95L2pxdWVyeS10aHJvdHRsZS1kZWJvdW5jZS9yYXcvbWFzdGVyL2pxdWVyeS5iYS10aHJvdHRsZS1kZWJvdW5jZS5taW4uanMgKDAuN2tiKVxyXG4vLyBcclxuLy8gQWJvdXQ6IExpY2Vuc2VcclxuLy8gXHJcbi8vIENvcHlyaWdodCAoYykgMjAxMCBcIkNvd2JveVwiIEJlbiBBbG1hbixcclxuLy8gRHVhbCBsaWNlbnNlZCB1bmRlciB0aGUgTUlUIGFuZCBHUEwgbGljZW5zZXMuXHJcbi8vIGh0dHA6Ly9iZW5hbG1hbi5jb20vYWJvdXQvbGljZW5zZS9cclxuLy8gXHJcbi8vIEFib3V0OiBFeGFtcGxlc1xyXG4vLyBcclxuLy8gVGhlc2Ugd29ya2luZyBleGFtcGxlcywgY29tcGxldGUgd2l0aCBmdWxseSBjb21tZW50ZWQgY29kZSwgaWxsdXN0cmF0ZSBhIGZld1xyXG4vLyB3YXlzIGluIHdoaWNoIHRoaXMgcGx1Z2luIGNhbiBiZSB1c2VkLlxyXG4vLyBcclxuLy8gVGhyb3R0bGUgLSBodHRwOi8vYmVuYWxtYW4uY29tL2NvZGUvcHJvamVjdHMvanF1ZXJ5LXRocm90dGxlLWRlYm91bmNlL2V4YW1wbGVzL3Rocm90dGxlL1xyXG4vLyBEZWJvdW5jZSAtIGh0dHA6Ly9iZW5hbG1hbi5jb20vY29kZS9wcm9qZWN0cy9qcXVlcnktdGhyb3R0bGUtZGVib3VuY2UvZXhhbXBsZXMvZGVib3VuY2UvXHJcbi8vIFxyXG4vLyBBYm91dDogU3VwcG9ydCBhbmQgVGVzdGluZ1xyXG4vLyBcclxuLy8gSW5mb3JtYXRpb24gYWJvdXQgd2hhdCB2ZXJzaW9uIG9yIHZlcnNpb25zIG9mIGpRdWVyeSB0aGlzIHBsdWdpbiBoYXMgYmVlblxyXG4vLyB0ZXN0ZWQgd2l0aCwgd2hhdCBicm93c2VycyBpdCBoYXMgYmVlbiB0ZXN0ZWQgaW4sIGFuZCB3aGVyZSB0aGUgdW5pdCB0ZXN0c1xyXG4vLyByZXNpZGUgKHNvIHlvdSBjYW4gdGVzdCBpdCB5b3Vyc2VsZikuXHJcbi8vIFxyXG4vLyBqUXVlcnkgVmVyc2lvbnMgLSBub25lLCAxLjMuMiwgMS40LjJcclxuLy8gQnJvd3NlcnMgVGVzdGVkIC0gSW50ZXJuZXQgRXhwbG9yZXIgNi04LCBGaXJlZm94IDItMy42LCBTYWZhcmkgMy00LCBDaHJvbWUgNC01LCBPcGVyYSA5LjYtMTAuMS5cclxuLy8gVW5pdCBUZXN0cyAgICAgIC0gaHR0cDovL2JlbmFsbWFuLmNvbS9jb2RlL3Byb2plY3RzL2pxdWVyeS10aHJvdHRsZS1kZWJvdW5jZS91bml0L1xyXG4vLyBcclxuLy8gQWJvdXQ6IFJlbGVhc2UgSGlzdG9yeVxyXG4vLyBcclxuLy8gMS4xIC0gKDMvNy8yMDEwKSBGaXhlZCBhIGJ1ZyBpbiA8alF1ZXJ5LnRocm90dGxlPiB3aGVyZSB0cmFpbGluZyBjYWxsYmFja3NcclxuLy8gICAgICAgZXhlY3V0ZWQgbGF0ZXIgdGhhbiB0aGV5IHNob3VsZC4gUmV3b3JrZWQgYSBmYWlyIGFtb3VudCBvZiBpbnRlcm5hbFxyXG4vLyAgICAgICBsb2dpYyBhcyB3ZWxsLlxyXG4vLyAxLjAgLSAoMy82LzIwMTApIEluaXRpYWwgcmVsZWFzZSBhcyBhIHN0YW5kLWFsb25lIHByb2plY3QuIE1pZ3JhdGVkIG92ZXJcclxuLy8gICAgICAgZnJvbSBqcXVlcnktbWlzYyByZXBvIHYwLjQgdG8ganF1ZXJ5LXRocm90dGxlIHJlcG8gdjEuMCwgYWRkZWQgdGhlXHJcbi8vICAgICAgIG5vX3RyYWlsaW5nIHRocm90dGxlIHBhcmFtZXRlciBhbmQgZGVib3VuY2UgZnVuY3Rpb25hbGl0eS5cclxuLy8gXHJcbi8vIFRvcGljOiBOb3RlIGZvciBub24talF1ZXJ5IHVzZXJzXHJcbi8vIFxyXG4vLyBqUXVlcnkgaXNuJ3QgYWN0dWFsbHkgcmVxdWlyZWQgZm9yIHRoaXMgcGx1Z2luLCBiZWNhdXNlIG5vdGhpbmcgaW50ZXJuYWxcclxuLy8gdXNlcyBhbnkgalF1ZXJ5IG1ldGhvZHMgb3IgcHJvcGVydGllcy4galF1ZXJ5IGlzIGp1c3QgdXNlZCBhcyBhIG5hbWVzcGFjZVxyXG4vLyB1bmRlciB3aGljaCB0aGVzZSBtZXRob2RzIGNhbiBleGlzdC5cclxuLy8gXHJcbi8vIFNpbmNlIGpRdWVyeSBpc24ndCBhY3R1YWxseSByZXF1aXJlZCBmb3IgdGhpcyBwbHVnaW4sIGlmIGpRdWVyeSBkb2Vzbid0IGV4aXN0XHJcbi8vIHdoZW4gdGhpcyBwbHVnaW4gaXMgbG9hZGVkLCB0aGUgbWV0aG9kIGRlc2NyaWJlZCBiZWxvdyB3aWxsIGJlIGNyZWF0ZWQgaW5cclxuLy8gdGhlIGBDb3dib3lgIG5hbWVzcGFjZS4gVXNhZ2Ugd2lsbCBiZSBleGFjdGx5IHRoZSBzYW1lLCBidXQgaW5zdGVhZCBvZlxyXG4vLyAkLm1ldGhvZCgpIG9yIGpRdWVyeS5tZXRob2QoKSwgeW91J2xsIG5lZWQgdG8gdXNlIENvd2JveS5tZXRob2QoKS5cclxuXHJcbihmdW5jdGlvbiAod2luZG93LCB1bmRlZmluZWQpIHtcclxuICAgICckOm5vbXVuZ2UnOyAvLyBVc2VkIGJ5IFlVSSBjb21wcmVzc29yLlxyXG5cclxuICAgIC8vIFNpbmNlIGpRdWVyeSByZWFsbHkgaXNuJ3QgcmVxdWlyZWQgZm9yIHRoaXMgcGx1Z2luLCB1c2UgYGpRdWVyeWAgYXMgdGhlXHJcbiAgICAvLyBuYW1lc3BhY2Ugb25seSBpZiBpdCBhbHJlYWR5IGV4aXN0cywgb3RoZXJ3aXNlIHVzZSB0aGUgYENvd2JveWAgbmFtZXNwYWNlLFxyXG4gICAgLy8gY3JlYXRpbmcgaXQgaWYgbmVjZXNzYXJ5LlxyXG4gICAgdmFyICQgPSB3aW5kb3cualF1ZXJ5IHx8IHdpbmRvdy5Db3dib3kgfHwgKHdpbmRvdy5Db3dib3kgPSB7fSksXHJcblxyXG4gICAgICAgIC8vIEludGVybmFsIG1ldGhvZCByZWZlcmVuY2UuXHJcbiAgICAgICAganFfdGhyb3R0bGU7XHJcblxyXG4gICAgLy8gTWV0aG9kOiBqUXVlcnkudGhyb3R0bGVcclxuICAgIC8vIFxyXG4gICAgLy8gVGhyb3R0bGUgZXhlY3V0aW9uIG9mIGEgZnVuY3Rpb24uIEVzcGVjaWFsbHkgdXNlZnVsIGZvciByYXRlIGxpbWl0aW5nXHJcbiAgICAvLyBleGVjdXRpb24gb2YgaGFuZGxlcnMgb24gZXZlbnRzIGxpa2UgcmVzaXplIGFuZCBzY3JvbGwuIElmIHlvdSB3YW50IHRvXHJcbiAgICAvLyByYXRlLWxpbWl0IGV4ZWN1dGlvbiBvZiBhIGZ1bmN0aW9uIHRvIGEgc2luZ2xlIHRpbWUsIHNlZSB0aGVcclxuICAgIC8vIDxqUXVlcnkuZGVib3VuY2U+IG1ldGhvZC5cclxuICAgIC8vIFxyXG4gICAgLy8gSW4gdGhpcyB2aXN1YWxpemF0aW9uLCB8IGlzIGEgdGhyb3R0bGVkLWZ1bmN0aW9uIGNhbGwgYW5kIFggaXMgdGhlIGFjdHVhbFxyXG4gICAgLy8gY2FsbGJhY2sgZXhlY3V0aW9uOlxyXG4gICAgLy8gXHJcbiAgICAvLyA+IFRocm90dGxlZCB3aXRoIGBub190cmFpbGluZ2Agc3BlY2lmaWVkIGFzIGZhbHNlIG9yIHVuc3BlY2lmaWVkOlxyXG4gICAgLy8gPiB8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8IChwYXVzZSkgfHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fFxyXG4gICAgLy8gPiBYICAgIFggICAgWCAgICBYICAgIFggICAgWCAgICAgICAgWCAgICBYICAgIFggICAgWCAgICBYICAgIFhcclxuICAgIC8vID4gXHJcbiAgICAvLyA+IFRocm90dGxlZCB3aXRoIGBub190cmFpbGluZ2Agc3BlY2lmaWVkIGFzIHRydWU6XHJcbiAgICAvLyA+IHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHwgKHBhdXNlKSB8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8XHJcbiAgICAvLyA+IFggICAgWCAgICBYICAgIFggICAgWCAgICAgICAgICAgICBYICAgIFggICAgWCAgICBYICAgIFhcclxuICAgIC8vIFxyXG4gICAgLy8gVXNhZ2U6XHJcbiAgICAvLyBcclxuICAgIC8vID4gdmFyIHRocm90dGxlZCA9IGpRdWVyeS50aHJvdHRsZSggZGVsYXksIFsgbm9fdHJhaWxpbmcsIF0gY2FsbGJhY2sgKTtcclxuICAgIC8vID4gXHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS5iaW5kKCAnc29tZWV2ZW50JywgdGhyb3R0bGVkICk7XHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS51bmJpbmQoICdzb21lZXZlbnQnLCB0aHJvdHRsZWQgKTtcclxuICAgIC8vIFxyXG4gICAgLy8gVGhpcyBhbHNvIHdvcmtzIGluIGpRdWVyeSAxLjQrOlxyXG4gICAgLy8gXHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS5iaW5kKCAnc29tZWV2ZW50JywgalF1ZXJ5LnRocm90dGxlKCBkZWxheSwgWyBub190cmFpbGluZywgXSBjYWxsYmFjayApICk7XHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS51bmJpbmQoICdzb21lZXZlbnQnLCBjYWxsYmFjayApO1xyXG4gICAgLy8gXHJcbiAgICAvLyBBcmd1bWVudHM6XHJcbiAgICAvLyBcclxuICAgIC8vICBkZWxheSAtIChOdW1iZXIpIEEgemVyby1vci1ncmVhdGVyIGRlbGF5IGluIG1pbGxpc2Vjb25kcy4gRm9yIGV2ZW50XHJcbiAgICAvLyAgICBjYWxsYmFja3MsIHZhbHVlcyBhcm91bmQgMTAwIG9yIDI1MCAob3IgZXZlbiBoaWdoZXIpIGFyZSBtb3N0IHVzZWZ1bC5cclxuICAgIC8vICBub190cmFpbGluZyAtIChCb29sZWFuKSBPcHRpb25hbCwgZGVmYXVsdHMgdG8gZmFsc2UuIElmIG5vX3RyYWlsaW5nIGlzXHJcbiAgICAvLyAgICB0cnVlLCBjYWxsYmFjayB3aWxsIG9ubHkgZXhlY3V0ZSBldmVyeSBgZGVsYXlgIG1pbGxpc2Vjb25kcyB3aGlsZSB0aGVcclxuICAgIC8vICAgIHRocm90dGxlZC1mdW5jdGlvbiBpcyBiZWluZyBjYWxsZWQuIElmIG5vX3RyYWlsaW5nIGlzIGZhbHNlIG9yXHJcbiAgICAvLyAgICB1bnNwZWNpZmllZCwgY2FsbGJhY2sgd2lsbCBiZSBleGVjdXRlZCBvbmUgZmluYWwgdGltZSBhZnRlciB0aGUgbGFzdFxyXG4gICAgLy8gICAgdGhyb3R0bGVkLWZ1bmN0aW9uIGNhbGwuIChBZnRlciB0aGUgdGhyb3R0bGVkLWZ1bmN0aW9uIGhhcyBub3QgYmVlblxyXG4gICAgLy8gICAgY2FsbGVkIGZvciBgZGVsYXlgIG1pbGxpc2Vjb25kcywgdGhlIGludGVybmFsIGNvdW50ZXIgaXMgcmVzZXQpXHJcbiAgICAvLyAgY2FsbGJhY2sgLSAoRnVuY3Rpb24pIEEgZnVuY3Rpb24gdG8gYmUgZXhlY3V0ZWQgYWZ0ZXIgZGVsYXkgbWlsbGlzZWNvbmRzLlxyXG4gICAgLy8gICAgVGhlIGB0aGlzYCBjb250ZXh0IGFuZCBhbGwgYXJndW1lbnRzIGFyZSBwYXNzZWQgdGhyb3VnaCwgYXMtaXMsIHRvXHJcbiAgICAvLyAgICBgY2FsbGJhY2tgIHdoZW4gdGhlIHRocm90dGxlZC1mdW5jdGlvbiBpcyBleGVjdXRlZC5cclxuICAgIC8vIFxyXG4gICAgLy8gUmV0dXJuczpcclxuICAgIC8vIFxyXG4gICAgLy8gIChGdW5jdGlvbikgQSBuZXcsIHRocm90dGxlZCwgZnVuY3Rpb24uXHJcblxyXG4gICAgJC50aHJvdHRsZSA9IGpxX3Rocm90dGxlID0gZnVuY3Rpb24gKGRlbGF5LCBub190cmFpbGluZywgY2FsbGJhY2ssIGRlYm91bmNlX21vZGUpIHtcclxuICAgICAgICAvLyBBZnRlciB3cmFwcGVyIGhhcyBzdG9wcGVkIGJlaW5nIGNhbGxlZCwgdGhpcyB0aW1lb3V0IGVuc3VyZXMgdGhhdFxyXG4gICAgICAgIC8vIGBjYWxsYmFja2AgaXMgZXhlY3V0ZWQgYXQgdGhlIHByb3BlciB0aW1lcyBpbiBgdGhyb3R0bGVgIGFuZCBgZW5kYFxyXG4gICAgICAgIC8vIGRlYm91bmNlIG1vZGVzLlxyXG4gICAgICAgIHZhciB0aW1lb3V0X2lkLFxyXG5cclxuICAgICAgICAgICAgLy8gS2VlcCB0cmFjayBvZiB0aGUgbGFzdCB0aW1lIGBjYWxsYmFja2Agd2FzIGV4ZWN1dGVkLlxyXG4gICAgICAgICAgICBsYXN0X2V4ZWMgPSAwO1xyXG5cclxuICAgICAgICAvLyBgbm9fdHJhaWxpbmdgIGRlZmF1bHRzIHRvIGZhbHN5LlxyXG4gICAgICAgIGlmICh0eXBlb2Ygbm9fdHJhaWxpbmcgIT09ICdib29sZWFuJykge1xyXG4gICAgICAgICAgICBkZWJvdW5jZV9tb2RlID0gY2FsbGJhY2s7XHJcbiAgICAgICAgICAgIGNhbGxiYWNrID0gbm9fdHJhaWxpbmc7XHJcbiAgICAgICAgICAgIG5vX3RyYWlsaW5nID0gdW5kZWZpbmVkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVGhlIGB3cmFwcGVyYCBmdW5jdGlvbiBlbmNhcHN1bGF0ZXMgYWxsIG9mIHRoZSB0aHJvdHRsaW5nIC8gZGVib3VuY2luZ1xyXG4gICAgICAgIC8vIGZ1bmN0aW9uYWxpdHkgYW5kIHdoZW4gZXhlY3V0ZWQgd2lsbCBsaW1pdCB0aGUgcmF0ZSBhdCB3aGljaCBgY2FsbGJhY2tgXHJcbiAgICAgICAgLy8gaXMgZXhlY3V0ZWQuXHJcbiAgICAgICAgZnVuY3Rpb24gd3JhcHBlcigpIHtcclxuICAgICAgICAgICAgdmFyIHRoYXQgPSB0aGlzLFxyXG4gICAgICAgICAgICAgICAgZWxhcHNlZCA9ICtuZXcgRGF0ZSgpIC0gbGFzdF9leGVjLFxyXG4gICAgICAgICAgICAgICAgYXJncyA9IGFyZ3VtZW50cztcclxuXHJcbiAgICAgICAgICAgIC8vIEV4ZWN1dGUgYGNhbGxiYWNrYCBhbmQgdXBkYXRlIHRoZSBgbGFzdF9leGVjYCB0aW1lc3RhbXAuXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uIGV4ZWMoKSB7XHJcbiAgICAgICAgICAgICAgICBsYXN0X2V4ZWMgPSArbmV3IERhdGUoKTtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmFwcGx5KHRoYXQsIGFyZ3MpO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gSWYgYGRlYm91bmNlX21vZGVgIGlzIHRydWUgKGF0X2JlZ2luKSB0aGlzIGlzIHVzZWQgdG8gY2xlYXIgdGhlIGZsYWdcclxuICAgICAgICAgICAgLy8gdG8gYWxsb3cgZnV0dXJlIGBjYWxsYmFja2AgZXhlY3V0aW9ucy5cclxuICAgICAgICAgICAgZnVuY3Rpb24gY2xlYXIoKSB7XHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0X2lkID0gdW5kZWZpbmVkO1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgaWYgKGRlYm91bmNlX21vZGUgJiYgIXRpbWVvdXRfaWQpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNpbmNlIGB3cmFwcGVyYCBpcyBiZWluZyBjYWxsZWQgZm9yIHRoZSBmaXJzdCB0aW1lIGFuZFxyXG4gICAgICAgICAgICAgICAgLy8gYGRlYm91bmNlX21vZGVgIGlzIHRydWUgKGF0X2JlZ2luKSwgZXhlY3V0ZSBgY2FsbGJhY2tgLlxyXG4gICAgICAgICAgICAgICAgZXhlYygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDbGVhciBhbnkgZXhpc3RpbmcgdGltZW91dC5cclxuICAgICAgICAgICAgdGltZW91dF9pZCAmJiBjbGVhclRpbWVvdXQodGltZW91dF9pZCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZGVib3VuY2VfbW9kZSA9PT0gdW5kZWZpbmVkICYmIGVsYXBzZWQgPiBkZWxheSkge1xyXG4gICAgICAgICAgICAgICAgLy8gSW4gdGhyb3R0bGUgbW9kZSwgaWYgYGRlbGF5YCB0aW1lIGhhcyBiZWVuIGV4Y2VlZGVkLCBleGVjdXRlXHJcbiAgICAgICAgICAgICAgICAvLyBgY2FsbGJhY2tgLlxyXG4gICAgICAgICAgICAgICAgZXhlYygpO1xyXG5cclxuICAgICAgICAgICAgfSBlbHNlIGlmIChub190cmFpbGluZyAhPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgLy8gSW4gdHJhaWxpbmcgdGhyb3R0bGUgbW9kZSwgc2luY2UgYGRlbGF5YCB0aW1lIGhhcyBub3QgYmVlblxyXG4gICAgICAgICAgICAgICAgLy8gZXhjZWVkZWQsIHNjaGVkdWxlIGBjYWxsYmFja2AgdG8gZXhlY3V0ZSBgZGVsYXlgIG1zIGFmdGVyIG1vc3RcclxuICAgICAgICAgICAgICAgIC8vIHJlY2VudCBleGVjdXRpb24uXHJcbiAgICAgICAgICAgICAgICAvLyBcclxuICAgICAgICAgICAgICAgIC8vIElmIGBkZWJvdW5jZV9tb2RlYCBpcyB0cnVlIChhdF9iZWdpbiksIHNjaGVkdWxlIGBjbGVhcmAgdG8gZXhlY3V0ZVxyXG4gICAgICAgICAgICAgICAgLy8gYWZ0ZXIgYGRlbGF5YCBtcy5cclxuICAgICAgICAgICAgICAgIC8vIFxyXG4gICAgICAgICAgICAgICAgLy8gSWYgYGRlYm91bmNlX21vZGVgIGlzIGZhbHNlIChhdCBlbmQpLCBzY2hlZHVsZSBgY2FsbGJhY2tgIHRvXHJcbiAgICAgICAgICAgICAgICAvLyBleGVjdXRlIGFmdGVyIGBkZWxheWAgbXMuXHJcbiAgICAgICAgICAgICAgICB0aW1lb3V0X2lkID0gc2V0VGltZW91dChkZWJvdW5jZV9tb2RlID8gY2xlYXIgOiBleGVjLCBkZWJvdW5jZV9tb2RlID09PSB1bmRlZmluZWQgPyBkZWxheSAtIGVsYXBzZWQgOiBkZWxheSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvLyBTZXQgdGhlIGd1aWQgb2YgYHdyYXBwZXJgIGZ1bmN0aW9uIHRvIHRoZSBzYW1lIG9mIG9yaWdpbmFsIGNhbGxiYWNrLCBzb1xyXG4gICAgICAgIC8vIGl0IGNhbiBiZSByZW1vdmVkIGluIGpRdWVyeSAxLjQrIC51bmJpbmQgb3IgLmRpZSBieSB1c2luZyB0aGUgb3JpZ2luYWxcclxuICAgICAgICAvLyBjYWxsYmFjayBhcyBhIHJlZmVyZW5jZS5cclxuICAgICAgICBpZiAoJC5ndWlkKSB7XHJcbiAgICAgICAgICAgIHdyYXBwZXIuZ3VpZCA9IGNhbGxiYWNrLmd1aWQgPSBjYWxsYmFjay5ndWlkIHx8ICQuZ3VpZCsrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gUmV0dXJuIHRoZSB3cmFwcGVyIGZ1bmN0aW9uLlxyXG4gICAgICAgIHJldHVybiB3cmFwcGVyO1xyXG4gICAgfTtcclxuXHJcbiAgICAvLyBNZXRob2Q6IGpRdWVyeS5kZWJvdW5jZVxyXG4gICAgLy8gXHJcbiAgICAvLyBEZWJvdW5jZSBleGVjdXRpb24gb2YgYSBmdW5jdGlvbi4gRGVib3VuY2luZywgdW5saWtlIHRocm90dGxpbmcsXHJcbiAgICAvLyBndWFyYW50ZWVzIHRoYXQgYSBmdW5jdGlvbiBpcyBvbmx5IGV4ZWN1dGVkIGEgc2luZ2xlIHRpbWUsIGVpdGhlciBhdCB0aGVcclxuICAgIC8vIHZlcnkgYmVnaW5uaW5nIG9mIGEgc2VyaWVzIG9mIGNhbGxzLCBvciBhdCB0aGUgdmVyeSBlbmQuIElmIHlvdSB3YW50IHRvXHJcbiAgICAvLyBzaW1wbHkgcmF0ZS1saW1pdCBleGVjdXRpb24gb2YgYSBmdW5jdGlvbiwgc2VlIHRoZSA8alF1ZXJ5LnRocm90dGxlPlxyXG4gICAgLy8gbWV0aG9kLlxyXG4gICAgLy8gXHJcbiAgICAvLyBJbiB0aGlzIHZpc3VhbGl6YXRpb24sIHwgaXMgYSBkZWJvdW5jZWQtZnVuY3Rpb24gY2FsbCBhbmQgWCBpcyB0aGUgYWN0dWFsXHJcbiAgICAvLyBjYWxsYmFjayBleGVjdXRpb246XHJcbiAgICAvLyBcclxuICAgIC8vID4gRGVib3VuY2VkIHdpdGggYGF0X2JlZ2luYCBzcGVjaWZpZWQgYXMgZmFsc2Ugb3IgdW5zcGVjaWZpZWQ6XHJcbiAgICAvLyA+IHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHwgKHBhdXNlKSB8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8XHJcbiAgICAvLyA+ICAgICAgICAgICAgICAgICAgICAgICAgICBYICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWFxyXG4gICAgLy8gPiBcclxuICAgIC8vID4gRGVib3VuY2VkIHdpdGggYGF0X2JlZ2luYCBzcGVjaWZpZWQgYXMgdHJ1ZTpcclxuICAgIC8vID4gfHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fCAocGF1c2UpIHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHxcclxuICAgIC8vID4gWCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFhcclxuICAgIC8vIFxyXG4gICAgLy8gVXNhZ2U6XHJcbiAgICAvLyBcclxuICAgIC8vID4gdmFyIGRlYm91bmNlZCA9IGpRdWVyeS5kZWJvdW5jZSggZGVsYXksIFsgYXRfYmVnaW4sIF0gY2FsbGJhY2sgKTtcclxuICAgIC8vID4gXHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS5iaW5kKCAnc29tZWV2ZW50JywgZGVib3VuY2VkICk7XHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS51bmJpbmQoICdzb21lZXZlbnQnLCBkZWJvdW5jZWQgKTtcclxuICAgIC8vIFxyXG4gICAgLy8gVGhpcyBhbHNvIHdvcmtzIGluIGpRdWVyeSAxLjQrOlxyXG4gICAgLy8gXHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS5iaW5kKCAnc29tZWV2ZW50JywgalF1ZXJ5LmRlYm91bmNlKCBkZWxheSwgWyBhdF9iZWdpbiwgXSBjYWxsYmFjayApICk7XHJcbiAgICAvLyA+IGpRdWVyeSgnc2VsZWN0b3InKS51bmJpbmQoICdzb21lZXZlbnQnLCBjYWxsYmFjayApO1xyXG4gICAgLy8gXHJcbiAgICAvLyBBcmd1bWVudHM6XHJcbiAgICAvLyBcclxuICAgIC8vICBkZWxheSAtIChOdW1iZXIpIEEgemVyby1vci1ncmVhdGVyIGRlbGF5IGluIG1pbGxpc2Vjb25kcy4gRm9yIGV2ZW50XHJcbiAgICAvLyAgICBjYWxsYmFja3MsIHZhbHVlcyBhcm91bmQgMTAwIG9yIDI1MCAob3IgZXZlbiBoaWdoZXIpIGFyZSBtb3N0IHVzZWZ1bC5cclxuICAgIC8vICBhdF9iZWdpbiAtIChCb29sZWFuKSBPcHRpb25hbCwgZGVmYXVsdHMgdG8gZmFsc2UuIElmIGF0X2JlZ2luIGlzIGZhbHNlIG9yXHJcbiAgICAvLyAgICB1bnNwZWNpZmllZCwgY2FsbGJhY2sgd2lsbCBvbmx5IGJlIGV4ZWN1dGVkIGBkZWxheWAgbWlsbGlzZWNvbmRzIGFmdGVyXHJcbiAgICAvLyAgICB0aGUgbGFzdCBkZWJvdW5jZWQtZnVuY3Rpb24gY2FsbC4gSWYgYXRfYmVnaW4gaXMgdHJ1ZSwgY2FsbGJhY2sgd2lsbCBiZVxyXG4gICAgLy8gICAgZXhlY3V0ZWQgb25seSBhdCB0aGUgZmlyc3QgZGVib3VuY2VkLWZ1bmN0aW9uIGNhbGwuIChBZnRlciB0aGVcclxuICAgIC8vICAgIHRocm90dGxlZC1mdW5jdGlvbiBoYXMgbm90IGJlZW4gY2FsbGVkIGZvciBgZGVsYXlgIG1pbGxpc2Vjb25kcywgdGhlXHJcbiAgICAvLyAgICBpbnRlcm5hbCBjb3VudGVyIGlzIHJlc2V0KVxyXG4gICAgLy8gIGNhbGxiYWNrIC0gKEZ1bmN0aW9uKSBBIGZ1bmN0aW9uIHRvIGJlIGV4ZWN1dGVkIGFmdGVyIGRlbGF5IG1pbGxpc2Vjb25kcy5cclxuICAgIC8vICAgIFRoZSBgdGhpc2AgY29udGV4dCBhbmQgYWxsIGFyZ3VtZW50cyBhcmUgcGFzc2VkIHRocm91Z2gsIGFzLWlzLCB0b1xyXG4gICAgLy8gICAgYGNhbGxiYWNrYCB3aGVuIHRoZSBkZWJvdW5jZWQtZnVuY3Rpb24gaXMgZXhlY3V0ZWQuXHJcbiAgICAvLyBcclxuICAgIC8vIFJldHVybnM6XHJcbiAgICAvLyBcclxuICAgIC8vICAoRnVuY3Rpb24pIEEgbmV3LCBkZWJvdW5jZWQsIGZ1bmN0aW9uLlxyXG5cclxuICAgICQuZGVib3VuY2UgPSBmdW5jdGlvbiAoZGVsYXksIGF0X2JlZ2luLCBjYWxsYmFjaykge1xyXG4gICAgICAgIHJldHVybiBjYWxsYmFjayA9PT0gdW5kZWZpbmVkXHJcbiAgICAgICAgICAgID8ganFfdGhyb3R0bGUoZGVsYXksIGF0X2JlZ2luLCBmYWxzZSlcclxuICAgICAgICAgICAgOiBqcV90aHJvdHRsZShkZWxheSwgY2FsbGJhY2ssIGF0X2JlZ2luICE9PSBmYWxzZSk7XHJcbiAgICB9O1xyXG5cclxufSkod2luZG93KTsiLCIoZnVuY3Rpb24gKCQpIHtcclxuXHJcbiAgICAkLmZuLnNodWZmbGUgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgIHZhciBhbGxFbGVtcyA9IHRoaXMuZ2V0KCksXHJcbiAgICAgICAgICAgIGdldFJhbmRvbSA9IGZ1bmN0aW9uIChtYXgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBtYXgpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBzaHVmZmxlZCA9ICQubWFwKGFsbEVsZW1zLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgcmFuZG9tID0gZ2V0UmFuZG9tKGFsbEVsZW1zLmxlbmd0aCksXHJcbiAgICAgICAgICAgICAgICAgICAgcmFuZEVsID0gJChhbGxFbGVtc1tyYW5kb21dKS5jbG9uZSh0cnVlKVswXTtcclxuICAgICAgICAgICAgICAgIGFsbEVsZW1zLnNwbGljZShyYW5kb20sIDEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJhbmRFbDtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbiAoaSkge1xyXG4gICAgICAgICAgICAkKHRoaXMpLnJlcGxhY2VXaXRoKCQoc2h1ZmZsZWRbaV0pKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuICQoc2h1ZmZsZWQpO1xyXG5cclxuICAgIH07XHJcblxyXG59KShqUXVlcnkpOyIsIi8qIVxyXG4gKiBCb3dzZXIgLSBhIGJyb3dzZXIgZGV0ZWN0b3JcclxuICogaHR0cHM6Ly9naXRodWIuY29tL2RlZC9ib3dzZXJcclxuICogTUlUIExpY2Vuc2UgfCAoYykgRHVzdGluIERpYXogMjAxNVxyXG4gKi9cclxuICBcclxuIWZ1bmN0aW9uIChyb290LCBuYW1lLCBkZWZpbml0aW9uKSB7XHJcbiAgICBpZiAodHlwZW9mIG1vZHVsZSAhPSAndW5kZWZpbmVkJyAmJiBtb2R1bGUuZXhwb3J0cykgbW9kdWxlLmV4cG9ydHMgPSBkZWZpbml0aW9uKClcclxuICAgIGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSBkZWZpbmUobmFtZSwgZGVmaW5pdGlvbilcclxuICAgIGVsc2Uge1xyXG4gICAgICAgIHdpbmRvd1tuYW1lXSA9IGRlZmluaXRpb24oKVxyXG4gICAgfVxyXG59KHRoaXMsICdib3dzZXInLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAvKipcclxuICAgICAgKiBTZWUgdXNlcmFnZW50cy5qcyBmb3IgZXhhbXBsZXMgb2YgbmF2aWdhdG9yLnVzZXJBZ2VudFxyXG4gICAgICAqL1xyXG5cclxuICAgIHZhciB0ID0gdHJ1ZVxyXG5cclxuICAgIGZ1bmN0aW9uIGRldGVjdCh1YSkge1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRGaXJzdE1hdGNoKHJlZ2V4KSB7XHJcbiAgICAgICAgICAgIHZhciBtYXRjaCA9IHVhLm1hdGNoKHJlZ2V4KTtcclxuICAgICAgICAgICAgcmV0dXJuIChtYXRjaCAmJiBtYXRjaC5sZW5ndGggPiAxICYmIG1hdGNoWzFdKSB8fCAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFNlY29uZE1hdGNoKHJlZ2V4KSB7XHJcbiAgICAgICAgICAgIHZhciBtYXRjaCA9IHVhLm1hdGNoKHJlZ2V4KTtcclxuICAgICAgICAgICAgcmV0dXJuIChtYXRjaCAmJiBtYXRjaC5sZW5ndGggPiAxICYmIG1hdGNoWzJdKSB8fCAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBpb3NkZXZpY2UgPSBnZXRGaXJzdE1hdGNoKC8oaXBvZHxpcGhvbmV8aXBhZCkvaSkudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgICAgICAsIGxpa2VBbmRyb2lkID0gL2xpa2UgYW5kcm9pZC9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgYW5kcm9pZCA9ICFsaWtlQW5kcm9pZCAmJiAvYW5kcm9pZC9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgbmV4dXNNb2JpbGUgPSAvbmV4dXNcXHMqWzAtNl1cXHMqL2kudGVzdCh1YSlcclxuICAgICAgICAgICAgLCBuZXh1c1RhYmxldCA9ICFuZXh1c01vYmlsZSAmJiAvbmV4dXNcXHMqWzAtOV0rL2kudGVzdCh1YSlcclxuICAgICAgICAgICAgLCBjaHJvbWVvcyA9IC9Dck9TLy50ZXN0KHVhKVxyXG4gICAgICAgICAgICAsIHNpbGsgPSAvc2lsay9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgc2FpbGZpc2ggPSAvc2FpbGZpc2gvaS50ZXN0KHVhKVxyXG4gICAgICAgICAgICAsIHRpemVuID0gL3RpemVuL2kudGVzdCh1YSlcclxuICAgICAgICAgICAgLCB3ZWJvcyA9IC8od2VifGhwdykob3wwKXMvaS50ZXN0KHVhKVxyXG4gICAgICAgICAgICAsIHdpbmRvd3NwaG9uZSA9IC93aW5kb3dzIHBob25lL2kudGVzdCh1YSlcclxuICAgICAgICAgICAgLCBzYW1zdW5nQnJvd3NlciA9IC9TYW1zdW5nQnJvd3Nlci9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgd2luZG93cyA9ICF3aW5kb3dzcGhvbmUgJiYgL3dpbmRvd3MvaS50ZXN0KHVhKVxyXG4gICAgICAgICAgICAsIG1hYyA9ICFpb3NkZXZpY2UgJiYgIXNpbGsgJiYgL21hY2ludG9zaC9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgbGludXggPSAhYW5kcm9pZCAmJiAhc2FpbGZpc2ggJiYgIXRpemVuICYmICF3ZWJvcyAmJiAvbGludXgvaS50ZXN0KHVhKVxyXG4gICAgICAgICAgICAsIGVkZ2VWZXJzaW9uID0gZ2V0U2Vjb25kTWF0Y2goL2VkZyhbZWFdfGlvcylcXC8oXFxkKyhcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgICAgICwgdmVyc2lvbklkZW50aWZpZXIgPSBnZXRGaXJzdE1hdGNoKC92ZXJzaW9uXFwvKFxcZCsoXFwuXFxkKyk/KS9pKVxyXG4gICAgICAgICAgICAsIHRhYmxldCA9IC90YWJsZXQvaS50ZXN0KHVhKSAmJiAhL3RhYmxldCBwYy9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgbW9iaWxlID0gIXRhYmxldCAmJiAvW14tXW1vYmkvaS50ZXN0KHVhKVxyXG4gICAgICAgICAgICAsIHhib3ggPSAveGJveC9pLnRlc3QodWEpXHJcbiAgICAgICAgICAgICwgcmVzdWx0XHJcblxyXG4gICAgICAgIGlmICgvb3BlcmEvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICAvLyAgYW4gb2xkIE9wZXJhXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdPcGVyYSdcclxuICAgICAgICAgICAgICAgICwgb3BlcmE6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogdmVyc2lvbklkZW50aWZpZXIgfHwgZ2V0Rmlyc3RNYXRjaCgvKD86b3BlcmF8b3ByfG9waW9zKVtcXHNcXC9dKFxcZCsoXFwuXFxkKyk/KS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmICgvb3ByXFwvfG9waW9zL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgLy8gYSBuZXcgT3BlcmFcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ09wZXJhJ1xyXG4gICAgICAgICAgICAgICAgLCBvcGVyYTogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzpvcHJ8b3Bpb3MpW1xcc1xcL10oXFxkKyhcXC5cXGQrKT8pL2kpIHx8IHZlcnNpb25JZGVudGlmaWVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL1NhbXN1bmdCcm93c2VyL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ1NhbXN1bmcgSW50ZXJuZXQgZm9yIEFuZHJvaWQnXHJcbiAgICAgICAgICAgICAgICAsIHNhbXN1bmdCcm93c2VyOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IHZlcnNpb25JZGVudGlmaWVyIHx8IGdldEZpcnN0TWF0Y2goLyg/OlNhbXN1bmdCcm93c2VyKVtcXHNcXC9dKFxcZCsoXFwuXFxkKyk/KS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9XaGFsZS9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdOQVZFUiBXaGFsZSBicm93c2VyJ1xyXG4gICAgICAgICAgICAgICAgLCB3aGFsZTogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzp3aGFsZSlbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9NWkJyb3dzZXIvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnTVogQnJvd3NlcidcclxuICAgICAgICAgICAgICAgICwgbXpicm93c2VyOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goLyg/Ok1aQnJvd3NlcilbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9jb2FzdC9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdPcGVyYSBDb2FzdCdcclxuICAgICAgICAgICAgICAgICwgY29hc3Q6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogdmVyc2lvbklkZW50aWZpZXIgfHwgZ2V0Rmlyc3RNYXRjaCgvKD86Y29hc3QpW1xcc1xcL10oXFxkKyhcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL2ZvY3VzL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0ZvY3VzJ1xyXG4gICAgICAgICAgICAgICAgLCBmb2N1czogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzpmb2N1cylbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC95YWJyb3dzZXIvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnWWFuZGV4IEJyb3dzZXInXHJcbiAgICAgICAgICAgICAgICAsIHlhbmRleGJyb3dzZXI6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogdmVyc2lvbklkZW50aWZpZXIgfHwgZ2V0Rmlyc3RNYXRjaCgvKD86eWFicm93c2VyKVtcXHNcXC9dKFxcZCsoXFwuXFxkKyk/KS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC91Y2Jyb3dzZXIvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnVUMgQnJvd3NlcidcclxuICAgICAgICAgICAgICAgICwgdWNicm93c2VyOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goLyg/OnVjYnJvd3NlcilbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9teGlvcy9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdNYXh0aG9uJ1xyXG4gICAgICAgICAgICAgICAgLCBtYXh0aG9uOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goLyg/Om14aW9zKVtcXHNcXC9dKFxcZCsoPzpcXC5cXGQrKSspL2kpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL2VwaXBoYW55L2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0VwaXBoYW55J1xyXG4gICAgICAgICAgICAgICAgLCBlcGlwaGFueTogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzplcGlwaGFueSlbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9wdWZmaW4vaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnUHVmZmluJ1xyXG4gICAgICAgICAgICAgICAgLCBwdWZmaW46IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogZ2V0Rmlyc3RNYXRjaCgvKD86cHVmZmluKVtcXHNcXC9dKFxcZCsoPzpcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL3NsZWlwbmlyL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ1NsZWlwbmlyJ1xyXG4gICAgICAgICAgICAgICAgLCBzbGVpcG5pcjogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzpzbGVpcG5pcilbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9rLW1lbGVvbi9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdLLU1lbGVvbidcclxuICAgICAgICAgICAgICAgICwga01lbGVvbjogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzprLW1lbGVvbilbXFxzXFwvXShcXGQrKD86XFwuXFxkKykrKS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHdpbmRvd3NwaG9uZSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnV2luZG93cyBQaG9uZSdcclxuICAgICAgICAgICAgICAgICwgb3NuYW1lOiAnV2luZG93cyBQaG9uZSdcclxuICAgICAgICAgICAgICAgICwgd2luZG93c3Bob25lOiB0XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVkZ2VWZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubXNlZGdlID0gdFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0LnZlcnNpb24gPSBlZGdlVmVyc2lvblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm1zaWUgPSB0XHJcbiAgICAgICAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IGdldEZpcnN0TWF0Y2goL2llbW9iaWxlXFwvKFxcZCsoXFwuXFxkKyk/KS9pKVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9tc2llfHRyaWRlbnQvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnSW50ZXJuZXQgRXhwbG9yZXInXHJcbiAgICAgICAgICAgICAgICAsIG1zaWU6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogZ2V0Rmlyc3RNYXRjaCgvKD86bXNpZSB8cnY6KShcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoY2hyb21lb3MpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0Nocm9tZSdcclxuICAgICAgICAgICAgICAgICwgb3NuYW1lOiAnQ2hyb21lIE9TJ1xyXG4gICAgICAgICAgICAgICAgLCBjaHJvbWVvczogdFxyXG4gICAgICAgICAgICAgICAgLCBjaHJvbWVCb29rOiB0XHJcbiAgICAgICAgICAgICAgICAsIGNocm9tZTogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzpjaHJvbWV8Y3Jpb3N8Y3JtbylcXC8oXFxkKyhcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKC9lZGcoW2VhXXxpb3MpL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ01pY3Jvc29mdCBFZGdlJ1xyXG4gICAgICAgICAgICAgICAgLCBtc2VkZ2U6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogZWRnZVZlcnNpb25cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgvdml2YWxkaS9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdWaXZhbGRpJ1xyXG4gICAgICAgICAgICAgICAgLCB2aXZhbGRpOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goL3ZpdmFsZGlcXC8oXFxkKyhcXC5cXGQrKT8pL2kpIHx8IHZlcnNpb25JZGVudGlmaWVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoc2FpbGZpc2gpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ1NhaWxmaXNoJ1xyXG4gICAgICAgICAgICAgICAgLCBvc25hbWU6ICdTYWlsZmlzaCBPUydcclxuICAgICAgICAgICAgICAgICwgc2FpbGZpc2g6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogZ2V0Rmlyc3RNYXRjaCgvc2FpbGZpc2hcXHM/YnJvd3NlclxcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgvc2VhbW9ua2V5XFwvL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ1NlYU1vbmtleSdcclxuICAgICAgICAgICAgICAgICwgc2VhbW9ua2V5OiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goL3NlYW1vbmtleVxcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgvZmlyZWZveHxpY2V3ZWFzZWx8Znhpb3MvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnRmlyZWZveCdcclxuICAgICAgICAgICAgICAgICwgZmlyZWZveDogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzpmaXJlZm94fGljZXdlYXNlbHxmeGlvcylbIFxcL10oXFxkKyhcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKC9cXCgobW9iaWxlfHRhYmxldCk7W15cXCldKnJ2OltcXGRcXC5dK1xcKS9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQuZmlyZWZveG9zID0gdFxyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm9zbmFtZSA9ICdGaXJlZm94IE9TJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKHNpbGspIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0FtYXpvbiBTaWxrJ1xyXG4gICAgICAgICAgICAgICAgLCBzaWxrOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goL3NpbGtcXC8oXFxkKyhcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL3BoYW50b20vaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnUGhhbnRvbUpTJ1xyXG4gICAgICAgICAgICAgICAgLCBwaGFudG9tOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goL3BoYW50b21qc1xcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgvc2xpbWVyanMvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnU2xpbWVySlMnXHJcbiAgICAgICAgICAgICAgICAsIHNsaW1lcjogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC9zbGltZXJqc1xcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgvYmxhY2tiZXJyeXxcXGJiYlxcZCsvaS50ZXN0KHVhKSB8fCAvcmltXFxzdGFibGV0L2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0JsYWNrQmVycnknXHJcbiAgICAgICAgICAgICAgICAsIG9zbmFtZTogJ0JsYWNrQmVycnkgT1MnXHJcbiAgICAgICAgICAgICAgICAsIGJsYWNrYmVycnk6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogdmVyc2lvbklkZW50aWZpZXIgfHwgZ2V0Rmlyc3RNYXRjaCgvYmxhY2tiZXJyeVtcXGRdK1xcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh3ZWJvcykge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnV2ViT1MnXHJcbiAgICAgICAgICAgICAgICAsIG9zbmFtZTogJ1dlYk9TJ1xyXG4gICAgICAgICAgICAgICAgLCB3ZWJvczogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiB2ZXJzaW9uSWRlbnRpZmllciB8fCBnZXRGaXJzdE1hdGNoKC93KD86ZWIpP29zYnJvd3NlclxcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgL3RvdWNocGFkXFwvL2kudGVzdCh1YSkgJiYgKHJlc3VsdC50b3VjaHBhZCA9IHQpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9iYWRhL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0JhZGEnXHJcbiAgICAgICAgICAgICAgICAsIG9zbmFtZTogJ0JhZGEnXHJcbiAgICAgICAgICAgICAgICAsIGJhZGE6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogZ2V0Rmlyc3RNYXRjaCgvZG9sZmluXFwvKFxcZCsoXFwuXFxkKyk/KS9pKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0aXplbikge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnVGl6ZW4nXHJcbiAgICAgICAgICAgICAgICAsIG9zbmFtZTogJ1RpemVuJ1xyXG4gICAgICAgICAgICAgICAgLCB0aXplbjogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC8oPzp0aXplblxccz8pP2Jyb3dzZXJcXC8oXFxkKyhcXC5cXGQrKT8pL2kpIHx8IHZlcnNpb25JZGVudGlmaWVyXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9xdXB6aWxsYS9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdRdXBaaWxsYSdcclxuICAgICAgICAgICAgICAgICwgcXVwemlsbGE6IHRcclxuICAgICAgICAgICAgICAgICwgdmVyc2lvbjogZ2V0Rmlyc3RNYXRjaCgvKD86cXVwemlsbGEpW1xcc1xcL10oXFxkKyg/OlxcLlxcZCspKykvaSkgfHwgdmVyc2lvbklkZW50aWZpZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICgvY2hyb21pdW0vaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnQ2hyb21pdW0nXHJcbiAgICAgICAgICAgICAgICAsIGNocm9taXVtOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goLyg/OmNocm9taXVtKVtcXHNcXC9dKFxcZCsoPzpcXC5cXGQrKT8pL2kpIHx8IHZlcnNpb25JZGVudGlmaWVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL2Nocm9tZXxjcmlvc3xjcm1vL2kudGVzdCh1YSkpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogJ0Nocm9tZSdcclxuICAgICAgICAgICAgICAgICwgY2hyb21lOiB0XHJcbiAgICAgICAgICAgICAgICAsIHZlcnNpb246IGdldEZpcnN0TWF0Y2goLyg/OmNocm9tZXxjcmlvc3xjcm1vKVxcLyhcXGQrKFxcLlxcZCspPykvaSlcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChhbmRyb2lkKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdBbmRyb2lkJ1xyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiB2ZXJzaW9uSWRlbnRpZmllclxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKC9zYWZhcml8YXBwbGV3ZWJraXQvaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnU2FmYXJpJ1xyXG4gICAgICAgICAgICAgICAgLCBzYWZhcmk6IHRcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodmVyc2lvbklkZW50aWZpZXIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC52ZXJzaW9uID0gdmVyc2lvbklkZW50aWZpZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChpb3NkZXZpY2UpIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogaW9zZGV2aWNlID09ICdpcGhvbmUnID8gJ2lQaG9uZScgOiBpb3NkZXZpY2UgPT0gJ2lwYWQnID8gJ2lQYWQnIDogJ2lQb2QnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLy8gV1RGOiB2ZXJzaW9uIGlzIG5vdCBwYXJ0IG9mIHVzZXIgYWdlbnQgaW4gd2ViIGFwcHNcclxuICAgICAgICAgICAgaWYgKHZlcnNpb25JZGVudGlmaWVyKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQudmVyc2lvbiA9IHZlcnNpb25JZGVudGlmaWVyXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAoL2dvb2dsZWJvdC9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHtcclxuICAgICAgICAgICAgICAgIG5hbWU6ICdHb29nbGVib3QnXHJcbiAgICAgICAgICAgICAgICAsIGdvb2dsZWJvdDogdFxyXG4gICAgICAgICAgICAgICAgLCB2ZXJzaW9uOiBnZXRGaXJzdE1hdGNoKC9nb29nbGVib3RcXC8oXFxkKyhcXC5cXGQrKSkvaSkgfHwgdmVyc2lvbklkZW50aWZpZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgcmVzdWx0ID0ge1xyXG4gICAgICAgICAgICAgICAgbmFtZTogZ2V0Rmlyc3RNYXRjaCgvXiguKilcXC8oLiopIC8pLFxyXG4gICAgICAgICAgICAgICAgdmVyc2lvbjogZ2V0U2Vjb25kTWF0Y2goL14oLiopXFwvKC4qKSAvKVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gc2V0IHdlYmtpdCBvciBnZWNrbyBmbGFnIGZvciBicm93c2VycyBiYXNlZCBvbiB0aGVzZSBlbmdpbmVzXHJcbiAgICAgICAgaWYgKCFyZXN1bHQubXNlZGdlICYmIC8oYXBwbGUpP3dlYmtpdC9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgIGlmICgvKGFwcGxlKT93ZWJraXRcXC81MzdcXC4zNi9pLnRlc3QodWEpKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQubmFtZSA9IHJlc3VsdC5uYW1lIHx8IFwiQmxpbmtcIlxyXG4gICAgICAgICAgICAgICAgcmVzdWx0LmJsaW5rID0gdFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0Lm5hbWUgPSByZXN1bHQubmFtZSB8fCBcIldlYmtpdFwiXHJcbiAgICAgICAgICAgICAgICByZXN1bHQud2Via2l0ID0gdFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICghcmVzdWx0LnZlcnNpb24gJiYgdmVyc2lvbklkZW50aWZpZXIpIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC52ZXJzaW9uID0gdmVyc2lvbklkZW50aWZpZXJcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoIXJlc3VsdC5vcGVyYSAmJiAvZ2Vja29cXC8vaS50ZXN0KHVhKSkge1xyXG4gICAgICAgICAgICByZXN1bHQubmFtZSA9IHJlc3VsdC5uYW1lIHx8IFwiR2Vja29cIlxyXG4gICAgICAgICAgICByZXN1bHQuZ2Vja28gPSB0XHJcbiAgICAgICAgICAgIHJlc3VsdC52ZXJzaW9uID0gcmVzdWx0LnZlcnNpb24gfHwgZ2V0Rmlyc3RNYXRjaCgvZ2Vja29cXC8oXFxkKyhcXC5cXGQrKT8pL2kpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBzZXQgT1MgZmxhZ3MgZm9yIHBsYXRmb3JtcyB0aGF0IGhhdmUgbXVsdGlwbGUgYnJvd3NlcnNcclxuICAgICAgICBpZiAoIXJlc3VsdC53aW5kb3dzcGhvbmUgJiYgKGFuZHJvaWQgfHwgcmVzdWx0LnNpbGspKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5hbmRyb2lkID0gdFxyXG4gICAgICAgICAgICByZXN1bHQub3NuYW1lID0gJ0FuZHJvaWQnXHJcbiAgICAgICAgfSBlbHNlIGlmICghcmVzdWx0LndpbmRvd3NwaG9uZSAmJiBpb3NkZXZpY2UpIHtcclxuICAgICAgICAgICAgcmVzdWx0W2lvc2RldmljZV0gPSB0XHJcbiAgICAgICAgICAgIHJlc3VsdC5pb3MgPSB0XHJcbiAgICAgICAgICAgIHJlc3VsdC5vc25hbWUgPSAnaU9TJ1xyXG4gICAgICAgIH0gZWxzZSBpZiAobWFjKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC5tYWMgPSB0XHJcbiAgICAgICAgICAgIHJlc3VsdC5vc25hbWUgPSAnbWFjT1MnXHJcbiAgICAgICAgfSBlbHNlIGlmICh4Ym94KSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC54Ym94ID0gdFxyXG4gICAgICAgICAgICByZXN1bHQub3NuYW1lID0gJ1hib3gnXHJcbiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3dzKSB7XHJcbiAgICAgICAgICAgIHJlc3VsdC53aW5kb3dzID0gdFxyXG4gICAgICAgICAgICByZXN1bHQub3NuYW1lID0gJ1dpbmRvd3MnXHJcbiAgICAgICAgfSBlbHNlIGlmIChsaW51eCkge1xyXG4gICAgICAgICAgICByZXN1bHQubGludXggPSB0XHJcbiAgICAgICAgICAgIHJlc3VsdC5vc25hbWUgPSAnTGludXgnXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRXaW5kb3dzVmVyc2lvbihzKSB7XHJcbiAgICAgICAgICAgIHN3aXRjaCAocykge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnTlQnOiByZXR1cm4gJ05UJ1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnWFAnOiByZXR1cm4gJ1hQJ1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnTlQgNS4wJzogcmV0dXJuICcyMDAwJ1xyXG4gICAgICAgICAgICAgICAgY2FzZSAnTlQgNS4xJzogcmV0dXJuICdYUCdcclxuICAgICAgICAgICAgICAgIGNhc2UgJ05UIDUuMic6IHJldHVybiAnMjAwMydcclxuICAgICAgICAgICAgICAgIGNhc2UgJ05UIDYuMCc6IHJldHVybiAnVmlzdGEnXHJcbiAgICAgICAgICAgICAgICBjYXNlICdOVCA2LjEnOiByZXR1cm4gJzcnXHJcbiAgICAgICAgICAgICAgICBjYXNlICdOVCA2LjInOiByZXR1cm4gJzgnXHJcbiAgICAgICAgICAgICAgICBjYXNlICdOVCA2LjMnOiByZXR1cm4gJzguMSdcclxuICAgICAgICAgICAgICAgIGNhc2UgJ05UIDEwLjAnOiByZXR1cm4gJzEwJ1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogcmV0dXJuIHVuZGVmaW5lZFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBPUyB2ZXJzaW9uIGV4dHJhY3Rpb25cclxuICAgICAgICB2YXIgb3NWZXJzaW9uID0gJyc7XHJcbiAgICAgICAgaWYgKHJlc3VsdC53aW5kb3dzKSB7XHJcbiAgICAgICAgICAgIG9zVmVyc2lvbiA9IGdldFdpbmRvd3NWZXJzaW9uKGdldEZpcnN0TWF0Y2goL1dpbmRvd3MgKChOVHxYUCkoIFxcZFxcZD8uXFxkKT8pL2kpKVxyXG4gICAgICAgIH0gZWxzZSBpZiAocmVzdWx0LndpbmRvd3NwaG9uZSkge1xyXG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBnZXRGaXJzdE1hdGNoKC93aW5kb3dzIHBob25lICg/Om9zKT9cXHM/KFxcZCsoXFwuXFxkKykqKS9pKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5tYWMpIHtcclxuICAgICAgICAgICAgb3NWZXJzaW9uID0gZ2V0Rmlyc3RNYXRjaCgvTWFjIE9TIFggKFxcZCsoW19cXC5cXHNdXFxkKykqKS9pKTtcclxuICAgICAgICAgICAgb3NWZXJzaW9uID0gb3NWZXJzaW9uLnJlcGxhY2UoL1tfXFxzXS9nLCAnLicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoaW9zZGV2aWNlKSB7XHJcbiAgICAgICAgICAgIG9zVmVyc2lvbiA9IGdldEZpcnN0TWF0Y2goL29zIChcXGQrKFtfXFxzXVxcZCspKikgbGlrZSBtYWMgb3MgeC9pKTtcclxuICAgICAgICAgICAgb3NWZXJzaW9uID0gb3NWZXJzaW9uLnJlcGxhY2UoL1tfXFxzXS9nLCAnLicpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoYW5kcm9pZCkge1xyXG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBnZXRGaXJzdE1hdGNoKC9hbmRyb2lkWyBcXC8tXShcXGQrKFxcLlxcZCspKikvaSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQud2Vib3MpIHtcclxuICAgICAgICAgICAgb3NWZXJzaW9uID0gZ2V0Rmlyc3RNYXRjaCgvKD86d2VifGhwdylvc1xcLyhcXGQrKFxcLlxcZCspKikvaSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuYmxhY2tiZXJyeSkge1xyXG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBnZXRGaXJzdE1hdGNoKC9yaW1cXHN0YWJsZXRcXHNvc1xccyhcXGQrKFxcLlxcZCspKikvaSk7XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuYmFkYSkge1xyXG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBnZXRGaXJzdE1hdGNoKC9iYWRhXFwvKFxcZCsoXFwuXFxkKykqKS9pKTtcclxuICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC50aXplbikge1xyXG4gICAgICAgICAgICBvc1ZlcnNpb24gPSBnZXRGaXJzdE1hdGNoKC90aXplbltcXC9cXHNdKFxcZCsoXFwuXFxkKykqKS9pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKG9zVmVyc2lvbikge1xyXG4gICAgICAgICAgICByZXN1bHQub3N2ZXJzaW9uID0gb3NWZXJzaW9uO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gZGV2aWNlIHR5cGUgZXh0cmFjdGlvblxyXG4gICAgICAgIHZhciBvc01ham9yVmVyc2lvbiA9ICFyZXN1bHQud2luZG93cyAmJiBvc1ZlcnNpb24uc3BsaXQoJy4nKVswXTtcclxuICAgICAgICBpZiAoXHJcbiAgICAgICAgICAgIHRhYmxldFxyXG4gICAgICAgICAgICB8fCBuZXh1c1RhYmxldFxyXG4gICAgICAgICAgICB8fCBpb3NkZXZpY2UgPT0gJ2lwYWQnXHJcbiAgICAgICAgICAgIHx8IChhbmRyb2lkICYmIChvc01ham9yVmVyc2lvbiA9PSAzIHx8IChvc01ham9yVmVyc2lvbiA+PSA0ICYmICFtb2JpbGUpKSlcclxuICAgICAgICAgICAgfHwgcmVzdWx0LnNpbGtcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgcmVzdWx0LnRhYmxldCA9IHRcclxuICAgICAgICB9IGVsc2UgaWYgKFxyXG4gICAgICAgICAgICBtb2JpbGVcclxuICAgICAgICAgICAgfHwgaW9zZGV2aWNlID09ICdpcGhvbmUnXHJcbiAgICAgICAgICAgIHx8IGlvc2RldmljZSA9PSAnaXBvZCdcclxuICAgICAgICAgICAgfHwgYW5kcm9pZFxyXG4gICAgICAgICAgICB8fCBuZXh1c01vYmlsZVxyXG4gICAgICAgICAgICB8fCByZXN1bHQuYmxhY2tiZXJyeVxyXG4gICAgICAgICAgICB8fCByZXN1bHQud2Vib3NcclxuICAgICAgICAgICAgfHwgcmVzdWx0LmJhZGFcclxuICAgICAgICApIHtcclxuICAgICAgICAgICAgcmVzdWx0Lm1vYmlsZSA9IHRcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEdyYWRlZCBCcm93c2VyIFN1cHBvcnRcclxuICAgICAgICAvLyBodHRwOi8vZGV2ZWxvcGVyLnlhaG9vLmNvbS95dWkvYXJ0aWNsZXMvZ2JzXHJcbiAgICAgICAgaWYgKHJlc3VsdC5tc2VkZ2UgfHxcclxuICAgICAgICAgICAgKHJlc3VsdC5tc2llICYmIHJlc3VsdC52ZXJzaW9uID49IDEwKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LnlhbmRleGJyb3dzZXIgJiYgcmVzdWx0LnZlcnNpb24gPj0gMTUpIHx8XHJcbiAgICAgICAgICAgIChyZXN1bHQudml2YWxkaSAmJiByZXN1bHQudmVyc2lvbiA+PSAxLjApIHx8XHJcbiAgICAgICAgICAgIChyZXN1bHQuY2hyb21lICYmIHJlc3VsdC52ZXJzaW9uID49IDIwKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LnNhbXN1bmdCcm93c2VyICYmIHJlc3VsdC52ZXJzaW9uID49IDQpIHx8XHJcbiAgICAgICAgICAgIChyZXN1bHQud2hhbGUgJiYgY29tcGFyZVZlcnNpb25zKFtyZXN1bHQudmVyc2lvbiwgJzEuMCddKSA9PT0gMSkgfHxcclxuICAgICAgICAgICAgKHJlc3VsdC5temJyb3dzZXIgJiYgY29tcGFyZVZlcnNpb25zKFtyZXN1bHQudmVyc2lvbiwgJzYuMCddKSA9PT0gMSkgfHxcclxuICAgICAgICAgICAgKHJlc3VsdC5mb2N1cyAmJiBjb21wYXJlVmVyc2lvbnMoW3Jlc3VsdC52ZXJzaW9uLCAnMS4wJ10pID09PSAxKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LmZpcmVmb3ggJiYgcmVzdWx0LnZlcnNpb24gPj0gMjAuMCkgfHxcclxuICAgICAgICAgICAgKHJlc3VsdC5zYWZhcmkgJiYgcmVzdWx0LnZlcnNpb24gPj0gNikgfHxcclxuICAgICAgICAgICAgKHJlc3VsdC5vcGVyYSAmJiByZXN1bHQudmVyc2lvbiA+PSAxMC4wKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LmlvcyAmJiByZXN1bHQub3N2ZXJzaW9uICYmIHJlc3VsdC5vc3ZlcnNpb24uc3BsaXQoXCIuXCIpWzBdID49IDYpIHx8XHJcbiAgICAgICAgICAgIChyZXN1bHQuYmxhY2tiZXJyeSAmJiByZXN1bHQudmVyc2lvbiA+PSAxMC4xKVxyXG4gICAgICAgICAgICB8fCAocmVzdWx0LmNocm9taXVtICYmIHJlc3VsdC52ZXJzaW9uID49IDIwKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICByZXN1bHQuYSA9IHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2UgaWYgKChyZXN1bHQubXNpZSAmJiByZXN1bHQudmVyc2lvbiA8IDEwKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LmNocm9tZSAmJiByZXN1bHQudmVyc2lvbiA8IDIwKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LmZpcmVmb3ggJiYgcmVzdWx0LnZlcnNpb24gPCAyMC4wKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LnNhZmFyaSAmJiByZXN1bHQudmVyc2lvbiA8IDYpIHx8XHJcbiAgICAgICAgICAgIChyZXN1bHQub3BlcmEgJiYgcmVzdWx0LnZlcnNpb24gPCAxMC4wKSB8fFxyXG4gICAgICAgICAgICAocmVzdWx0LmlvcyAmJiByZXN1bHQub3N2ZXJzaW9uICYmIHJlc3VsdC5vc3ZlcnNpb24uc3BsaXQoXCIuXCIpWzBdIDwgNilcclxuICAgICAgICAgICAgfHwgKHJlc3VsdC5jaHJvbWl1bSAmJiByZXN1bHQudmVyc2lvbiA8IDIwKVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgICByZXN1bHQuYyA9IHRcclxuICAgICAgICB9IGVsc2UgcmVzdWx0LnggPSB0XHJcblxyXG4gICAgICAgIHJldHVybiByZXN1bHRcclxuICAgIH1cclxuXHJcbiAgICB2YXIgYm93c2VyID0gZGV0ZWN0KHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnID8gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCAnJyA6ICcnKVxyXG5cclxuICAgIGJvd3Nlci50ZXN0ID0gZnVuY3Rpb24gKGJyb3dzZXJMaXN0KSB7XHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBicm93c2VyTGlzdC5sZW5ndGg7ICsraSkge1xyXG4gICAgICAgICAgICB2YXIgYnJvd3Nlckl0ZW0gPSBicm93c2VyTGlzdFtpXTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBicm93c2VySXRlbSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIGlmIChicm93c2VySXRlbSBpbiBib3dzZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBHZXQgdmVyc2lvbiBwcmVjaXNpb25zIGNvdW50XHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqICAgZ2V0VmVyc2lvblByZWNpc2lvbihcIjEuMTAuM1wiKSAvLyAzXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtICB7c3RyaW5nfSB2ZXJzaW9uXHJcbiAgICAgKiBAcmV0dXJuIHtudW1iZXJ9XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGdldFZlcnNpb25QcmVjaXNpb24odmVyc2lvbikge1xyXG4gICAgICAgIHJldHVybiB2ZXJzaW9uLnNwbGl0KFwiLlwiKS5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBcnJheTo6bWFwIHBvbHlmaWxsXHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtICB7QXJyYXl9IGFyclxyXG4gICAgICogQHBhcmFtICB7RnVuY3Rpb259IGl0ZXJhdG9yXHJcbiAgICAgKiBAcmV0dXJuIHtBcnJheX1cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbWFwKGFyciwgaXRlcmF0b3IpIHtcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW10sIGk7XHJcbiAgICAgICAgaWYgKEFycmF5LnByb3RvdHlwZS5tYXApIHtcclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LnByb3RvdHlwZS5tYXAuY2FsbChhcnIsIGl0ZXJhdG9yKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaChpdGVyYXRvcihhcnJbaV0pKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENhbGN1bGF0ZSBicm93c2VyIHZlcnNpb24gd2VpZ2h0XHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqICAgY29tcGFyZVZlcnNpb25zKFsnMS4xMC4yLjEnLCAgJzEuOC4yLjEuOTAnXSkgICAgLy8gMVxyXG4gICAgICogICBjb21wYXJlVmVyc2lvbnMoWycxLjAxMC4yLjEnLCAnMS4wOS4yLjEuOTAnXSk7ICAvLyAxXHJcbiAgICAgKiAgIGNvbXBhcmVWZXJzaW9ucyhbJzEuMTAuMi4xJywgICcxLjEwLjIuMSddKTsgICAgIC8vIDBcclxuICAgICAqICAgY29tcGFyZVZlcnNpb25zKFsnMS4xMC4yLjEnLCAgJzEuMDgwMC4yJ10pOyAgICAgLy8gLTFcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gIHtBcnJheTxTdHJpbmc+fSB2ZXJzaW9ucyB2ZXJzaW9ucyB0byBjb21wYXJlXHJcbiAgICAgKiBAcmV0dXJuIHtOdW1iZXJ9IGNvbXBhcmlzb24gcmVzdWx0XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNvbXBhcmVWZXJzaW9ucyh2ZXJzaW9ucykge1xyXG4gICAgICAgIC8vIDEpIGdldCBjb21tb24gcHJlY2lzaW9uIGZvciBib3RoIHZlcnNpb25zLCBmb3IgZXhhbXBsZSBmb3IgXCIxMC4wXCIgYW5kIFwiOVwiIGl0IHNob3VsZCBiZSAyXHJcbiAgICAgICAgdmFyIHByZWNpc2lvbiA9IE1hdGgubWF4KGdldFZlcnNpb25QcmVjaXNpb24odmVyc2lvbnNbMF0pLCBnZXRWZXJzaW9uUHJlY2lzaW9uKHZlcnNpb25zWzFdKSk7XHJcbiAgICAgICAgdmFyIGNodW5rcyA9IG1hcCh2ZXJzaW9ucywgZnVuY3Rpb24gKHZlcnNpb24pIHtcclxuICAgICAgICAgICAgdmFyIGRlbHRhID0gcHJlY2lzaW9uIC0gZ2V0VmVyc2lvblByZWNpc2lvbih2ZXJzaW9uKTtcclxuXHJcbiAgICAgICAgICAgIC8vIDIpIFwiOVwiIC0+IFwiOS4wXCIgKGZvciBwcmVjaXNpb24gPSAyKVxyXG4gICAgICAgICAgICB2ZXJzaW9uID0gdmVyc2lvbiArIG5ldyBBcnJheShkZWx0YSArIDEpLmpvaW4oXCIuMFwiKTtcclxuXHJcbiAgICAgICAgICAgIC8vIDMpIFwiOS4wXCIgLT4gW1wiMDAwMDAwMDAwXCJcIiwgXCIwMDAwMDAwMDlcIl1cclxuICAgICAgICAgICAgcmV0dXJuIG1hcCh2ZXJzaW9uLnNwbGl0KFwiLlwiKSwgZnVuY3Rpb24gKGNodW5rKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IEFycmF5KDIwIC0gY2h1bmsubGVuZ3RoKS5qb2luKFwiMFwiKSArIGNodW5rO1xyXG4gICAgICAgICAgICB9KS5yZXZlcnNlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIGl0ZXJhdGUgaW4gcmV2ZXJzZSBvcmRlciBieSByZXZlcnNlZCBjaHVua3MgYXJyYXlcclxuICAgICAgICB3aGlsZSAoLS1wcmVjaXNpb24gPj0gMCkge1xyXG4gICAgICAgICAgICAvLyA0KSBjb21wYXJlOiBcIjAwMDAwMDAwOVwiID4gXCIwMDAwMDAwMTBcIiA9IGZhbHNlIChidXQgXCI5XCIgPiBcIjEwXCIgPSB0cnVlKVxyXG4gICAgICAgICAgICBpZiAoY2h1bmtzWzBdW3ByZWNpc2lvbl0gPiBjaHVua3NbMV1bcHJlY2lzaW9uXSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoY2h1bmtzWzBdW3ByZWNpc2lvbl0gPT09IGNodW5rc1sxXVtwcmVjaXNpb25dKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAocHJlY2lzaW9uID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gYWxsIHZlcnNpb24gY2h1bmtzIGFyZSBzYW1lXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGVjayBpZiBicm93c2VyIGlzIHVuc3VwcG9ydGVkXHJcbiAgICAgKlxyXG4gICAgICogQGV4YW1wbGVcclxuICAgICAqICAgYm93c2VyLmlzVW5zdXBwb3J0ZWRCcm93c2VyKHtcclxuICAgICAqICAgICBtc2llOiBcIjEwXCIsXHJcbiAgICAgKiAgICAgZmlyZWZveDogXCIyM1wiLFxyXG4gICAgICogICAgIGNocm9tZTogXCIyOVwiLFxyXG4gICAgICogICAgIHNhZmFyaTogXCI1LjFcIixcclxuICAgICAqICAgICBvcGVyYTogXCIxNlwiLFxyXG4gICAgICogICAgIHBoYW50b206IFwiNTM0XCJcclxuICAgICAqICAgfSk7XHJcbiAgICAgKlxyXG4gICAgICogQHBhcmFtICB7T2JqZWN0fSAgbWluVmVyc2lvbnMgbWFwIG9mIG1pbmltYWwgdmVyc2lvbiB0byBicm93c2VyXHJcbiAgICAgKiBAcGFyYW0gIHtCb29sZWFufSBbc3RyaWN0TW9kZSA9IGZhbHNlXSBmbGFnIHRvIHJldHVybiBmYWxzZSBpZiBicm93c2VyIHdhc24ndCBmb3VuZCBpbiBtYXBcclxuICAgICAqIEBwYXJhbSAge1N0cmluZ30gIFt1YV0gdXNlciBhZ2VudCBzdHJpbmdcclxuICAgICAqIEByZXR1cm4ge0Jvb2xlYW59XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGlzVW5zdXBwb3J0ZWRCcm93c2VyKG1pblZlcnNpb25zLCBzdHJpY3RNb2RlLCB1YSkge1xyXG4gICAgICAgIHZhciBfYm93c2VyID0gYm93c2VyO1xyXG5cclxuICAgICAgICAvLyBtYWtlIHN0cmljdE1vZGUgcGFyYW0gb3B0aW9uYWwgd2l0aCB1YSBwYXJhbSB1c2FnZVxyXG4gICAgICAgIGlmICh0eXBlb2Ygc3RyaWN0TW9kZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgdWEgPSBzdHJpY3RNb2RlO1xyXG4gICAgICAgICAgICBzdHJpY3RNb2RlID0gdm9pZCAoMCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoc3RyaWN0TW9kZSA9PT0gdm9pZCAoMCkpIHtcclxuICAgICAgICAgICAgc3RyaWN0TW9kZSA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodWEpIHtcclxuICAgICAgICAgICAgX2Jvd3NlciA9IGRldGVjdCh1YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdmVyc2lvbiA9IFwiXCIgKyBfYm93c2VyLnZlcnNpb247XHJcbiAgICAgICAgZm9yICh2YXIgYnJvd3NlciBpbiBtaW5WZXJzaW9ucykge1xyXG4gICAgICAgICAgICBpZiAobWluVmVyc2lvbnMuaGFzT3duUHJvcGVydHkoYnJvd3NlcikpIHtcclxuICAgICAgICAgICAgICAgIGlmIChfYm93c2VyW2Jyb3dzZXJdKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBtaW5WZXJzaW9uc1ticm93c2VyXSAhPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdCcm93c2VyIHZlcnNpb24gaW4gdGhlIG1pblZlcnNpb24gbWFwIHNob3VsZCBiZSBhIHN0cmluZzogJyArIGJyb3dzZXIgKyAnOiAnICsgU3RyaW5nKG1pblZlcnNpb25zKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBicm93c2VyIHZlcnNpb24gYW5kIG1pbiBzdXBwb3J0ZWQgdmVyc2lvbi5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY29tcGFyZVZlcnNpb25zKFt2ZXJzaW9uLCBtaW5WZXJzaW9uc1ticm93c2VyXV0pIDwgMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHN0cmljdE1vZGU7IC8vIG5vdCBmb3VuZFxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogQ2hlY2sgaWYgYnJvd3NlciBpcyBzdXBwb3J0ZWRcclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9IG1pblZlcnNpb25zIG1hcCBvZiBtaW5pbWFsIHZlcnNpb24gdG8gYnJvd3NlclxyXG4gICAgICogQHBhcmFtICB7Qm9vbGVhbn0gW3N0cmljdE1vZGUgPSBmYWxzZV0gZmxhZyB0byByZXR1cm4gZmFsc2UgaWYgYnJvd3NlciB3YXNuJ3QgZm91bmQgaW4gbWFwXHJcbiAgICAgKiBAcGFyYW0gIHtTdHJpbmd9ICBbdWFdIHVzZXIgYWdlbnQgc3RyaW5nXHJcbiAgICAgKiBAcmV0dXJuIHtCb29sZWFufVxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBjaGVjayhtaW5WZXJzaW9ucywgc3RyaWN0TW9kZSwgdWEpIHtcclxuICAgICAgICByZXR1cm4gIWlzVW5zdXBwb3J0ZWRCcm93c2VyKG1pblZlcnNpb25zLCBzdHJpY3RNb2RlLCB1YSk7XHJcbiAgICB9XHJcblxyXG4gICAgYm93c2VyLmlzVW5zdXBwb3J0ZWRCcm93c2VyID0gaXNVbnN1cHBvcnRlZEJyb3dzZXI7XHJcbiAgICBib3dzZXIuY29tcGFyZVZlcnNpb25zID0gY29tcGFyZVZlcnNpb25zO1xyXG4gICAgYm93c2VyLmNoZWNrID0gY2hlY2s7XHJcblxyXG4gICAgLypcclxuICAgICAqIFNldCBvdXIgZGV0ZWN0IG1ldGhvZCB0byB0aGUgbWFpbiBib3dzZXIgb2JqZWN0IHNvIHdlIGNhblxyXG4gICAgICogcmV1c2UgaXQgdG8gdGVzdCBvdGhlciB1c2VyIGFnZW50cy5cclxuICAgICAqIFRoaXMgaXMgbmVlZGVkIHRvIGltcGxlbWVudCBmdXR1cmUgdGVzdHMuXHJcbiAgICAgKi9cclxuICAgIGJvd3Nlci5fZGV0ZWN0ID0gZGV0ZWN0O1xyXG5cclxuICAgIC8qXHJcbiAgICAgKiBTZXQgb3VyIGRldGVjdCBwdWJsaWMgbWV0aG9kIHRvIHRoZSBtYWluIGJvd3NlciBvYmplY3RcclxuICAgICAqIFRoaXMgaXMgbmVlZGVkIHRvIGltcGxlbWVudCBib3dzZXIgaW4gc2VydmVyIHNpZGVcclxuICAgICAqL1xyXG4gICAgYm93c2VyLmRldGVjdCA9IGRldGVjdDtcclxuICAgIHJldHVybiBib3dzZXJcclxufSk7IiwiaWYgKHR5cGVvZiBTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICBTdHJpbmcucHJvdG90eXBlLmVuZHNXaXRoID0gZnVuY3Rpb24gKHN1ZmZpeCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmluZGV4T2Yoc3VmZml4LCB0aGlzLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGgpICE9PSAtMTtcclxuICAgIH07XHJcbn1cclxuXHJcbmlmICh0eXBlb2YgU3RyaW5nLnByb3RvdHlwZS5yZXBsYWNlQWxsICE9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICBTdHJpbmcucHJvdG90eXBlLnJlcGxhY2VBbGwgPSBmdW5jdGlvbiAoc2VhcmNoLCByZXBsYWNlbWVudCkge1xyXG4gICAgICAgIHZhciB0YXJnZXQgPSB0aGlzO1xyXG4gICAgICAgIHJldHVybiB0YXJnZXQucmVwbGFjZShuZXcgUmVnRXhwKHNlYXJjaCwgJ2cnKSwgcmVwbGFjZW1lbnQpO1xyXG4gICAgfTtcclxufSIsInZhciBsYXlvdXRyID0gd2luZG93LmxheW91dHIgfHwge307XHJcblxyXG57XHJcbiAgICBsYXlvdXRyLnNpdGVOYW1lID0gJ2xheW91dHInO1xyXG5cclxuICAgIGxheW91dHIudGhyb3R0bGVJbnRlcnZhbCA9IDUwO1xyXG4gICAgbGF5b3V0ci5kZWJvdW5jZUludGVydmFsID0gNTA7XHJcblxyXG4gICAgbGF5b3V0ci50cmFuc2l0aW9uVGltZSA9IDQwMDtcclxuICAgIGxheW91dHIuZmFkZU91dFRpbWUgPSA1MDA7XHJcbiAgICBsYXlvdXRyLmh0bWxPdmVyZmxvd0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgbGF5b3V0ci5zbWFsbEJyZWFrcG9pbnQgPSA3MzI7XHJcbiAgICBsYXlvdXRyLnNjcm9sbGJhcldpZHRoID0gMDtcclxuICAgIGxheW91dHIubG9hZGluZ0NvdW50ID0gMDtcclxuICAgIGxheW91dHIuZG9jdW1lbnQgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7XHJcbiAgICBsYXlvdXRyLmZ1bGxzY3JlZW4gPSBmYWxzZTtcclxuICAgIGxheW91dHIuYWpheCA9ICdkaXN0L2FqYXgvJztcclxuXHJcbiAgICBsYXlvdXRyLm5hdmlnYXRpb24gPSBbXTtcclxuICAgIGJvd3Nlci5kZXNrdG9wID0gIWJvd3Nlci5tb2JpbGUgJiYgIWJvd3Nlci50YWJsZXQ7XHJcblxyXG4gICAgdmFyIGwgPSB3aW5kb3cubG9jYXRpb247XHJcblxyXG4gICAgdmFyIHNlZ21lbnRDb3VudCA9IGwub3JpZ2luLmVuZHNXaXRoKCdnaXRodWIuaW8nKSA/IDEgOiAwO1xyXG4gICAgbGF5b3V0ci5ob3N0ID0gbC5wcm90b2NvbCArICcvLycgKyBsLmhvc3RuYW1lICsgKGwucG9ydCA/ICc6JyArIGwucG9ydCA6ICcnKSArIGwucGF0aG5hbWUuc3BsaXQoJy8nKS5zbGljZSgwLCAxICsgc2VnbWVudENvdW50KS5qb2luKCcvJykgKyAnLyc7XHJcblxyXG4gICAgbGF5b3V0ci5hd2FpdEludGVydmFsID0gNTA7XHJcblxyXG4gICAgbGF5b3V0ci5pc0xvY2FsaG9zdCA9IGwuaG9zdG5hbWUgPT09ICdsb2NhbGhvc3QnIHx8IGwuaG9zdG5hbWUgPT09ICcxMjcuMC4wLjEnIHx8IGwuaG9zdG5hbWUgPT09ICcxOTIuMTY4LjQwLjEwMCc7XHJcblxyXG4gICAgbGF5b3V0ci5zZXR0aW5ncyA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJzZXR0aW5nc1wiKSk7XHJcbiAgICBpZiAobGF5b3V0ci5zZXR0aW5ncyA9PT0gbnVsbCkgbGF5b3V0ci5zZXR0aW5ncyA9IFtdO1xyXG4gICAgbGF5b3V0ci50aGVtZSA9ICdsaWdodCc7XHJcbiAgICBsYXlvdXRyLnNldHRpbmdzLmZvckVhY2goKGVudHJ5KSA9PiB7XHJcbiAgICAgICAgaWYgKGVudHJ5Lm5hbWUgPT09ICd0aGVtZScpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci50aGVtZSA9IGVudHJ5LmlkLnN1YnN0cmluZyhlbnRyeS5pZC5pbmRleE9mKFwiLVwiKSArIDEpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG5cclxuICAgICQoKCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIuaHRtbCA9ICQoJ2h0bWwnKTtcclxuICAgICAgICBsYXlvdXRyLmhlYWQgPSAkKCdoZWFkJyk7XHJcbiAgICAgICAgbGF5b3V0ci5ib2R5ID0gJCgnYm9keScpO1xyXG4gICAgICAgIGxheW91dHIubWFpbiA9ICQoJ21haW4nKTtcclxuICAgICAgICBsYXlvdXRyLmNvbnRlbnQgPSAkKCcjY29udGVudCA+IGRpdicpO1xyXG4gICAgICAgIGxheW91dHIuaGVhZGVyID0gJCgnaGVhZGVyJyk7XHJcbiAgICAgICAgbGF5b3V0ci5mb290ZXIgPSAkKCdmb290ZXInKTtcclxuICAgICAgICBsYXlvdXRyLmxlZnQgPSAkKCcjbGVmdCcpO1xyXG4gICAgICAgIGxheW91dHIucmlnaHQgPSAkKCcjcmlnaHQnKTtcclxuICAgICAgICBsYXlvdXRyLmxvYWRpbmcgPSAkKCcjbG9hZGluZycpO1xyXG4gICAgICAgIGxheW91dHIub3ZlcmZsb3cgPSAkKCcjb3ZlcmZsb3cnKTtcclxuICAgICAgICBsYXlvdXRyLm1vZGFsID0gJCgnI21vZGFsJyk7XHJcbiAgICAgICAgbGF5b3V0ci50aXRsZSA9ICQoJyN0aXRsZScpO1xyXG4gICAgICAgIGxheW91dHIuYXV0aGVudGljYXRpb24gPSAkKCcjYXV0aGVudGljYXRpb24nKTtcclxuICAgICAgICBsYXlvdXRyLnVuYXV0aGVudGljYXRlZCA9IGxheW91dHIuYXV0aGVudGljYXRpb24uY2hpbGRyZW4oJy51bmF1dGhlbnRpY2F0ZWQnKTtcclxuICAgICAgICBsYXlvdXRyLmF1dGhlbnRpY2F0ZWQgPSBsYXlvdXRyLmF1dGhlbnRpY2F0aW9uLmNoaWxkcmVuKCcuYXV0aGVudGljYXRlZCcpO1xyXG4gICAgICAgIGxheW91dHIuYXV0aGVudGljYXRlZExpbmtzID0gbGF5b3V0ci5hdXRoZW50aWNhdGlvbi5maW5kKCcubGlua3MnKTtcclxuICAgICAgICBsYXlvdXRyLmNvb2tpZSA9ICQoJyNjb29raWUnKTtcclxuICAgICAgICBsYXlvdXRyLmZvY3VzID0gJCgnI2ZvY3VzJyk7XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgIGxheW91dHIuZ3VpZCA9ICgpID0+IHtcclxuICAgICAgICBsZXQgczQgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIHJldHVybiBNYXRoLmZsb29yKCgxICsgTWF0aC5yYW5kb20oKSkgKiAweDEwMDAwKVxyXG4gICAgICAgICAgICAgICAgLnRvU3RyaW5nKDE2KVxyXG4gICAgICAgICAgICAgICAgLnN1YnN0cmluZygxKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHM0KCkgKyBzNCgpICsgJy0nICsgczQoKSArICctJyArIHM0KCkgKyAnLScgK1xyXG4gICAgICAgICAgICBzNCgpICsgJy0nICsgczQoKSArIHM0KCkgKyBzNCgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmlzU21hbGxCcmVha3BvaW50ID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiAkKHdpbmRvdykub3V0ZXJXaWR0aCgpIDwgNzMyIHx8IGxheW91dHIuaXNBc2lkZUxlZnQoKSAmJiAhbGF5b3V0ci5pc0FzaWRlTGVmdFNocmluaygpIHx8IGxheW91dHIuaXNBc2lkZVJpZ2h0KCkgJiYgIWxheW91dHIuaXNBc2lkZVJpZ2h0U2hyaW5rKCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNBc2lkZSA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmF0dHIoJ2RhdGEtYXNpZGUnKS5sZW5ndGg7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNBc2lkZUxlZnQgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJykgPT09ICdsZWZ0JztcclxuICAgIH07XHJcblxyXG4gICAgbGF5b3V0ci5pc0FzaWRlUmlnaHQgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJykgPT09ICdyaWdodCc7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNBc2lkZUxlZnRTaHJpbmsgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxheW91dHIuaHRtbC5oYXNDbGFzcygnbGVmdC1zaHJpbmsnKSAmJiBsYXlvdXRyLmlzQXNpZGVMZWZ0KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNBc2lkZVJpZ2h0U2hyaW5rID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuaGFzQ2xhc3MoJ3JpZ2h0LXNocmluaycpICYmIGxheW91dHIuaXNBc2lkZVJpZ2h0KCk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNBc2lkZUxlZnRDbG9zZU9uQ2xpY2tPdXRzaWRlID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuaGFzQ2xhc3MoJ2Nsb3NlLWxlZnQtY2xpY2stb3V0c2lkZScpO1xyXG4gICAgfTtcclxuICAgIGxheW91dHIuaXNBc2lkZVJpZ2h0Q2xvc2VPbkNsaWNrT3V0c2lkZSA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmhhc0NsYXNzKCdjbG9zZS1yaWdodC1jbGljay1vdXRzaWRlJyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNNb2RhbCA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmhhc0NsYXNzKCdtb2RhbCcpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmlzTW9kYWxGb3JtID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1tb2RhbCcpID09PSAnZm9ybSc7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNNb2RhbEltYWdlID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1tb2RhbCcpID09PSAnaW1hZ2UnO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmlzRm9jdXMgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxheW91dHIuaHRtbC5oYXNDbGFzcygnZm9jdXMnKSAmJiBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1mb2N1cycpID09PSAndHJ1ZSc7XHJcbiAgICB9XHJcblxyXG4gICAgbGF5b3V0ci5pc1RUUyA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmhhc0NsYXNzKCd0dHMnKTtcclxuICAgIH1cclxuXHJcbiAgICBsYXlvdXRyLmlzVFRTRW5hYmxlZCA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmhhc0NsYXNzKCd0dHMnKSAmJiBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS10dHMnKSA9PT0gJ3RydWUnO1xyXG4gICAgfVxyXG4gICAgbGF5b3V0ci5pc0F1dGhlbnRpY2F0aW9uID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1hdXRoZW50aWNhdGlvbicpICE9PSAnJztcclxuICAgIH07XHJcblxyXG4gICAgbGF5b3V0ci5pc0xvYWRpbmcgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxheW91dHIuaHRtbC5oYXNDbGFzcygnbG9hZGluZycpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmlzU2Nyb2xsRGlzYWJsZWQgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxheW91dHIuaHRtbC5oYXNDbGFzcygnc2Nyb2xsLWRpc2FibGVkJyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNDbG9zZUxlZnRQYWdlQ2hhbmdlID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuaGFzQ2xhc3MoJ2Nsb3NlLWxlZnQtcGFnZS1jaGFuZ2UnKTtcclxuICAgIH07XHJcblxyXG4gICAgbGF5b3V0ci5pc1RyYW5zaXRpb25zID0gKCkgPT4ge1xyXG4gICAgICAgIHJldHVybiBsYXlvdXRyLmh0bWwuaGFzQ2xhc3MoJ3RyYW5zaXRpb25zJyk7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaXNTd2lwZSA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmhhc0NsYXNzKCdzd2lwZScpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmlzU2l0ZUxvYWRlZCA9ICgpID0+IHtcclxuICAgICAgICByZXR1cm4gbGF5b3V0ci5odG1sLmhhc0NsYXNzKCdzaXRlLWxvYWRlZCcpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmNhcGl0YWxpemUgPSAoc3RyaW5nKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIHN0cmluZy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0cmluZy5zbGljZSgxKTtcclxuICAgIH07XHJcblxyXG4gICAgbGF5b3V0ci5zY3JvbGxUb3AgPSAoKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIE1hdGgubWF4KGxheW91dHIuYm9keS5zY3JvbGxUb3AoKSwgbGF5b3V0ci5tYWluLnNjcm9sbFRvcCgpLCBsYXlvdXRyLmh0bWwuc2Nyb2xsVG9wKCkpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLnRyeVBhcnNlSW50ID0gKHN0ciwgZGVmYXVsdFZhbHVlKSA9PiB7XHJcbiAgICAgICAgbGV0IHJldFZhbHVlID0gZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgIGlmIChzdHIgIT09IHVuZGVmaW5lZCAmJiBzdHIgIT09IG51bGwgJiYgc3RyLmxlbmd0aCA+IDAgJiYgIWlzTmFOKHN0cikpIHtcclxuICAgICAgICAgICAgcmV0VmFsdWUgPSBwYXJzZUludChzdHIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmV0VmFsdWU7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIudHJ5UGFyc2VGbG9hdCA9IChzdHIsIGRlZmF1bHRWYWx1ZSkgPT4ge1xyXG4gICAgICAgIGxldCByZXRWYWx1ZSA9IGRlZmF1bHRWYWx1ZTtcclxuICAgICAgICBpZiAoc3RyICE9PSB1bmRlZmluZWQgJiYgc3RyICE9PSBudWxsICYmIHN0ci5sZW5ndGggPiAwICYmICFpc05hTihzdHIpKSB7XHJcbiAgICAgICAgICAgIHJldFZhbHVlID0gcGFyc2VGbG9hdChzdHIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmV0VmFsdWU7XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIudHJ5UGFyc2VKU09OID0gKHN0ciwgZGVmYXVsdFZhbHVlKSA9PiB7XHJcbiAgICAgICAgbGV0IHJldFZhbHVlID0gZGVmYXVsdFZhbHVlO1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldFZhbHVlID0gSlNPTi5wYXJzZShzdHIpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJldFZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmlzVHJ1ZSA9IChzdHIpID0+IHtcclxuICAgICAgICByZXR1cm4gc3RyID09PSAndHJ1ZSc7XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgJCgoKSA9PiB7XHJcbiAgICAgICAgaWYgKGJvd3Nlci5tc2VkZ2UpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCdtc2VkZ2UnKTsgLy8gdXNlZCBieSBsYXlvdXRyLmVuYWJsZVNjcm9sbCgpXHJcbiAgICAgICAgfSBlbHNlIGlmIChib3dzZXIubXNpZSkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ21zaWUnKTsgLy8gbm90IGN1cnJlbnRseSB1c2VkIGZvciBhbnl0aGluZ1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYm93c2VyLm1vYmlsZSkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ21vYmlsZScpOyAvLyBkaXNhYmxlcyBmaXhlZCBmb290ZXJcclxuICAgICAgICB9IGVsc2UgaWYgKGJvd3Nlci50YWJsZXQpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCd0YWJsZXQnKTsgLy8gZG9lcyBub3RoaW5nIGN1cnJlbnRseVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxheW91dHIuaHRtbC5hZGRDbGFzcygnZGVza3RvcCcpOyAvLyBlbmFibGVzIGhvdmVyIGVmZmVjdHNcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChib3dzZXIuYW5kcm9pZCkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ2FuZHJvaWQnKTsgLy8gdXNlZCBieSBtb2RhbFxyXG4gICAgICAgIH0gZWxzZSBpZiAoYm93c2VyLmlvcykge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ2lvcycpOyAvLyB1c2VkIHRvIGFwcGx5IGZvY3VzXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoYm93c2VyLm1zaWUgfHwgYm93c2VyLm1zZWRnZSkge1xyXG4gICAgICAgICAgICAvLyBkaXNhYmxlIHNtb290aCBzY3JvbGxpbmcsIHNpbmNlIGl0IGNhdXNlcyBlbGVtZW50IGp1bXBpbmcvbGFnZ2luZyBvbiBzY3JvbGxcclxuICAgICAgICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjk0MTY0NDgvaG93LXRvLWRpc2FibGUtc21vb3RoLXNjcm9sbGluZy1pbi1pZTExXHJcbiAgICAgICAgICAgIGxheW91dHIuYm9keS5vbihcIm1vdXNld2hlZWxcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCB0YXJnZXQgPSAkKGUudGFyZ2V0KTtcclxuICAgICAgICAgICAgICAgIGlmICghbGF5b3V0ci5pc01vZGFsKCkgJiYgZXZlbnQuY3RybEtleSAhPT0gdHJ1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgYXNpZGUgPSB0YXJnZXQuY2xvc2VzdCgnYXNpZGUgPiAuY29udGVudCcpIHx8IHRhcmdldC5wYXJlbnRzKCdhc2lkZSAuY29udGVudCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aGVlbERlbHRhID0gZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTY3JvbGxQb3NpdGlvbjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXNpZGUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRTY3JvbGxQb3NpdGlvbiA9IGFzaWRlLnNjcm9sbFRvcCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhc2lkZS5zY3JvbGxUb3AoY3VycmVudFNjcm9sbFBvc2l0aW9uIC0gd2hlZWxEZWx0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFNjcm9sbFBvc2l0aW9uID0gd2luZG93LnBhZ2VZT2Zmc2V0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuc2Nyb2xsVG8oMCwgY3VycmVudFNjcm9sbFBvc2l0aW9uIC0gd2hlZWxEZWx0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIGF0IHNvbWUgem9vbSBsZXZlbHMgZWRnZS9pZSBtYWtlcyAkKHdpbmRvdykgaGVpZ2hlciB0aGFuICQoZG9jdW1lbnQpXHJcbiAgICAgICAgICAgIC8vIGl0IGNhdXNlcyBhIGdhcCBiZXR3ZWVuIGZvb3RlciBhbmQgdGhlIGJvdHRvbSBvZiAkKHdpbmRvdykuXHJcbiAgICAgICAgICAgICQod2luZG93KS5zY3JvbGwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNjcm9sbFRvcCA9IHNlbGYucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcDtcclxuICAgICAgICAgICAgICAgIGlmIChzY3JvbGxUb3AgKyAkKHdpbmRvdykuaGVpZ2h0KCkgPj0gJChkb2N1bWVudCkuaGVpZ2h0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ3N1YnBpeGVsJyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5yZW1vdmVDbGFzcygnc3VicGl4ZWwnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0iLCJ7XHJcbiAgICAkKCgpID0+IHtcclxuICAgICAgICAkLnZhbGlkYXRvci5zZXREZWZhdWx0cyh7XHJcbiAgICAgICAgICAgIHN1Ym1pdEhhbmRsZXI6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGFsZXJ0KFwiRmFrZSBzdWJtaXR0ZWQhXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICQudmFsaWRhdG9yLmFkZE1ldGhvZCgncGFzc3dvcmRfcmVnZXgnLCAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIC9eKD89LipbYS16w6bDuMOlXSkoPz0uKltBLVrDhsOYw4VdKSg/PS4qXFxkKS57OCx9JC8udGVzdCh2YWx1ZSk7XHJcbiAgICAgICAgfSwgJ1Bhc3N3b3JkIG11c3QgY29udGFpbiBhdCBsZWFzdCBlaWdodCBjaGFyYWN0ZXJzLCBvbmUgdXBwZXJjYXNlIGxldHRlciwgb25lIGxvd2VyY2FzZSBsZXR0ZXIgYW5kIG9uZSBudW1iZXInKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxheW91dHIuYWRkVmFsaWRhdGlvbiA9IChmb3JtLCBydWxlcywgbWVzc2FnZXMpID0+IHtcclxuICAgICAgICBmb3JtLnZhbGlkYXRlKHtcclxuICAgICAgICAgICAgcnVsZXM6IHJ1bGVzLFxyXG4gICAgICAgICAgICBtZXNzYWdlczogbWVzc2FnZXMsXHJcbiAgICAgICAgICAgIGVycm9yRWxlbWVudDogXCJlbVwiLFxyXG4gICAgICAgICAgICBlcnJvclBsYWNlbWVudDogKGVycm9yLCBlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5wYXJlbnQoKTtcclxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdjaGVja2JveCcpIHx8IGVsZW1lbnQuaGFzQ2xhc3MoJ3JhZGlvJykgfHwgZWxlbWVudC5oYXNDbGFzcygnaW5wdXQtZ3JvdXAnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50LnBhcmVudCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5hcHBlbmQoZXJyb3IpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBoaWdobGlnaHQ6IChlbGVtZW50LCBlcnJvckNsYXNzLCB2YWxpZENsYXNzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnBhcmVudHMoXCIuZm9ybS1ncm91cFwiKS5hZGRDbGFzcyhcInRoZW1lLWRhbmdlclwiKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdW5oaWdobGlnaHQ6IChlbGVtZW50LCBlcnJvckNsYXNzLCB2YWxpZENsYXNzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnBhcmVudHMoXCIuZm9ybS1ncm91cFwiKS5yZW1vdmVDbGFzcyhcInRoZW1lLWRhbmdlclwiKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGZvcm0ub24oJ2NoYW5nZScsICdpbnB1dCwgdGV4dGFyZWEsIHNlbGVjdCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICQoZS5jdXJyZW50VGFyZ2V0KS52YWxpZCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxufSIsIntcclxuICAgIGxheW91dHIubG9hZCA9ICgoKSA9PiB7XHJcbiAgICAgICAgLy8gRnVuY3Rpb24gd2hpY2ggcmV0dXJucyBhIGZ1bmN0aW9uOiBodHRwczovL2Rhdmlkd2Fsc2gubmFtZS9qYXZhc2NyaXB0LWZ1bmN0aW9uc1xyXG4gICAgICAgIGxldCBfbG9hZCA9ICh0YWcpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuICh1cmwpID0+IHtcclxuICAgICAgICAgICAgICAgIC8vIFRoaXMgcHJvbWlzZSB3aWxsIGJlIHVzZWQgYnkgUHJvbWlzZS5hbGwgdG8gZGV0ZXJtaW5lIHN1Y2Nlc3Mgb3IgZmFpbHVyZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodGFnID09PSAnbGluaycgfHwgdGFnID09PSAnc2NyaXB0JyB8fCB0YWcgPT09ICdpbWcnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCh0YWcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gJ2JvZHknO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYXR0ciA9ICdzcmMnO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSW1wb3J0YW50IHN1Y2Nlc3MgYW5kIGVycm9yIGZvciB0aGUgcHJvbWlzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50Lm9ubG9hZCA9ICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5vbmVycm9yID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOZWVkIHRvIHNldCBkaWZmZXJlbnQgYXR0cmlidXRlcyBkZXBlbmRpbmcgb24gdGFnIHR5cGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0YWcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgJ3NjcmlwdCc6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5hc3luYyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdsaW5rJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnR5cGUgPSAndGV4dC9jc3MnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQucmVsID0gJ3N0eWxlc2hlZXQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dHIgPSAnaHJlZic7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50ID0gJ2hlYWQnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBJbmplY3QgaW50byBkb2N1bWVudCB0byBraWNrIG9mZiBsb2FkaW5nXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRbYXR0cl0gPSB1cmw7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGFnID09PSAnbGluaycgfHwgdGFnID09PSAnc2NyaXB0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnRbcGFyZW50XS5hcHBlbmRDaGlsZChlbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFnID09PSAnaHRtbCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmV0Y2godXJsKS50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnRleHQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlLnN0YXR1cyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjc3M6IF9sb2FkKCdsaW5rJyksXHJcbiAgICAgICAgICAgIGpzOiBfbG9hZCgnc2NyaXB0JyksXHJcbiAgICAgICAgICAgIGltZzogX2xvYWQoJ2ltZycpLFxyXG4gICAgICAgICAgICBodG1sOiBfbG9hZCgnaHRtbCcpXHJcbiAgICAgICAgfVxyXG4gICAgfSkoKTtcclxufSIsIntcclxuICAgIC8vIFNldCB0aGlzIHRvIHlvdXIgdHJhY2tpbmcgSURcclxuICAgIHZhciB0cmFja2luZ0lkID0gJ1VBLTk5NjMzNTIxLTInO1xyXG5cclxuICAgIGZ1bmN0aW9uIHNlbmRBbmFseXRpY3NFdmVudChldmVudEFjdGlvbiwgZXZlbnRDYXRlZ29yeSkge1xyXG4gICAgICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAgICAgY29uc29sZS5sb2coJ1NlbmRpbmcgYW5hbHl0aWNzIGV2ZW50OiAnICsgZXZlbnRDYXRlZ29yeSArICcvJyArIGV2ZW50QWN0aW9uKTtcclxuXHJcbiAgICAgICAgaWYgKCF0cmFja2luZ0lkKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1lvdSBuZWVkIHlvdXIgdHJhY2tpbmcgSUQgaW4gYW5hbHl0aWNzLWhlbHBlci5qcycpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdBZGQgdGhpcyBjb2RlOlxcbnZhciB0cmFja2luZ0lkID0gXFwnVUEtWFhYWFhYWFgtWFxcJzsnKTtcclxuICAgICAgICAgICAgLy8gV2Ugd2FudCB0aGlzIHRvIGJlIGEgc2FmZSBtZXRob2QsIHNvIGF2b2lkIHRocm93aW5nIHVubGVzcyBhYnNvbHV0ZWx5IG5lY2Vzc2FyeS5cclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCFldmVudEFjdGlvbiAmJiAhZXZlbnRDYXRlZ29yeSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ3NlbmRBbmFseXRpY3NFdmVudCgpIGNhbGxlZCB3aXRoIG5vIGV2ZW50QWN0aW9uIG9yICcgK1xyXG4gICAgICAgICAgICAgICAgJ2V2ZW50Q2F0ZWdvcnkuJyk7XHJcbiAgICAgICAgICAgIC8vIFdlIHdhbnQgdGhpcyB0byBiZSBhIHNhZmUgbWV0aG9kLCBzbyBhdm9pZCB0aHJvd2luZyB1bmxlc3MgYWJzb2x1dGVseSBuZWNlc3NhcnkuXHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBzZWxmLnJlZ2lzdHJhdGlvbi5wdXNoTWFuYWdlci5nZXRTdWJzY3JpcHRpb24oKVxyXG4gICAgICAgICAgICAudGhlbigoc3Vic2NyaXB0aW9uKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uID09PSBudWxsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBzdWJzY3JpcHRpb24gY3VycmVudGx5IGF2YWlsYWJsZS4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAvLyBDcmVhdGUgaGl0IGRhdGFcclxuICAgICAgICAgICAgICAgIHZhciBwYXlsb2FkRGF0YSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBWZXJzaW9uIE51bWJlclxyXG4gICAgICAgICAgICAgICAgICAgIHY6IDEsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gQ2xpZW50IElEXHJcbiAgICAgICAgICAgICAgICAgICAgY2lkOiBzdWJzY3JpcHRpb24uZW5kcG9pbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gVHJhY2tpbmcgSURcclxuICAgICAgICAgICAgICAgICAgICB0aWQ6IHRyYWNraW5nSWQsXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSGl0IFR5cGVcclxuICAgICAgICAgICAgICAgICAgICB0OiAnZXZlbnQnLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50IENhdGVnb3J5XHJcbiAgICAgICAgICAgICAgICAgICAgZWM6IGV2ZW50Q2F0ZWdvcnksXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gRXZlbnQgQWN0aW9uXHJcbiAgICAgICAgICAgICAgICAgICAgZWE6IGV2ZW50QWN0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50IExhYmVsXHJcbiAgICAgICAgICAgICAgICAgICAgZWw6ICdzZXJ2aWNld29ya2VyJ1xyXG4gICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBGb3JtYXQgaGl0IGRhdGEgaW50byBVUklcclxuICAgICAgICAgICAgICAgIHZhciBwYXlsb2FkU3RyaW5nID0gT2JqZWN0LmtleXMocGF5bG9hZERhdGEpXHJcbiAgICAgICAgICAgICAgICAgICAgLmZpbHRlcigoYW5hbHl0aWNzS2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXlsb2FkRGF0YVthbmFseXRpY3NLZXldO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgoYW5hbHl0aWNzS2V5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBhbmFseXRpY3NLZXkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQocGF5bG9hZERhdGFbYW5hbHl0aWNzS2V5XSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuam9pbignJicpO1xyXG5cclxuICAgICAgICAgICAgICAgIC8vIFBvc3QgdG8gR29vZ2xlIEFuYWx5dGljcyBlbmRwb2ludFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZldGNoKCdodHRwczovL3d3dy5nb29nbGUtYW5hbHl0aWNzLmNvbS9jb2xsZWN0Jywge1xyXG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ3Bvc3QnLFxyXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IHBheWxvYWRTdHJpbmdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UudGV4dCgpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKChyZXNwb25zZVRleHQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnQmFkIHJlc3BvbnNlIGZyb20gR29vZ2xlIEFuYWx5dGljczpcXG4nICsgcmVzcG9uc2Uuc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXZlbnRDYXRlZ29yeSArICcvJyArIGV2ZW50QWN0aW9uICtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJ2hpdCBzZW50LCBjaGVjayB0aGUgQW5hbHl0aWNzIGRhc2hib2FyZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdVbmFibGUgdG8gc2VuZCB0aGUgYW5hbHl0aWNzIGV2ZW50JywgZXJyKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLnByb21pc2VGb250ID0gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgIFdlYkZvbnQubG9hZCh7XHJcbiAgICAgICAgICAgIHR5cGVraXQ6IHtcclxuICAgICAgICAgICAgICAgIGlkOiBbJ2JoejNkeHgnXVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBhY3RpdmU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgaW5hY3RpdmU6ICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHJlamVjdCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgZm9udHMnLCAnZGFuZ2VyJyk7XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgIGxheW91dHIucHJvbWlzZUNTUyA9IGxheW91dHIubG9hZC5jc3MobGF5b3V0ci5ob3N0ICsgXCJkaXN0L2Nzcy90aGVtZS9cIiArIGxheW91dHIudGhlbWUgKyAnLmNzcycpLmNhdGNoKCgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBjc3MnKTtcclxuICAgIH0pO1xyXG4gICAgXHJcbiAgICAkKCgpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmZvb3Rlci5odG1sKCc8cD5cXHUwMEE5ICcgKyBuZXcgRGF0ZSgpLmdldEZ1bGxZZWFyKCkgKyAnIEZyZWRlcmlrIE5pZWxzZW48L3A+Jyk7XHJcblxyXG4gICAgICAgIC8vbGF5b3V0ci5zZXRIdG1sU2Nyb2xsKCk7IC8vIG91dGNvbW1lbnQgaWYgaXQgY2FuIGJlIGRpc2FibGVkIGF0IGZpcnN0IHBhZ2UgbG9hZFxyXG5cclxuICAgICAgICBsYXlvdXRyLmxvYWQuaHRtbChsYXlvdXRyLmhvc3QgKyBsYXlvdXRyLmFqYXggKyAnc3ZnL2Jhc2UuaHRtbCcpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICQocmVzcG9uc2UpLnByZXBlbmRUbyhsYXlvdXRyLmJvZHkpO1xyXG4gICAgICAgIH0pLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgYmFzZSBzdmcgaHRtbCcsICdkYW5nZXInKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgaWYgKGJvd3Nlci5hbmRyb2lkKSB7XHJcbiAgICAgICAgICAgIC8vIGFuZHJvaWQgZG9lc24ndCBoYW5kbGUgdmggY29ycmVjdGx5LCBzbyBpdCBnZXRzIGNvbnZlcnRlZCB0byBweFxyXG4gICAgICAgICAgICAkKHdpbmRvdykucmVzaXplKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzTW9kYWwoKSAmJiBsYXlvdXRyLmlzTW9kYWxJbWFnZSgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5tb2RhbC5maW5kKCcjbW9kYWwtaW1nJykuY3NzKCdtYXgtaGVpZ2h0Jywgd2luZG93LmlubmVySGVpZ2h0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgJCh3aW5kb3cpLmNsaWNrKChlKSA9PiB7XHJcbiAgICAgICAgbGV0IHRhcmdldCA9ICQoZS50YXJnZXQpLFxyXG4gICAgICAgICAgICBtb2RhbCA9IHRhcmdldC5jbG9zZXN0KGxheW91dHIubW9kYWxbMF0pO1xyXG5cclxuICAgICAgICBpZiAoIWxheW91dHIuaXNMb2FkaW5nKCkgJiYgIWxheW91dHIuaXNGb2N1cygpKSB7XHJcbiAgICAgICAgICAgIGlmIChib3dzZXIuaW9zKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBpb3MgYnJvd3NlcnMgZG9lc24ndCBhcHBseSA6Zm9jdXMgdG8gYnV0dG9ucyBpbiBtYW55IGNhc2VzLFxyXG4gICAgICAgICAgICAgICAgLy8gdGhpcyBmb3JjZXMgOmZvY3VzIHRvIGJlIGFwcGxpZWQgY29ycmVjdGx5LlxyXG4gICAgICAgICAgICAgICAgaWYgKHRhcmdldC5wYXJlbnRzKCdidXR0b24nKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQucGFyZW50cygnYnV0dG9uJykuZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0LmNsb3Nlc3QoJ2J1dHRvbicpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobGF5b3V0ci5pc0F1dGhlbnRpY2F0aW9uKCkgJiYgIXRhcmdldC5jbG9zZXN0KCcjYXV0aGVudGljYXRpb24nKS5sZW5ndGggJiYgIXRhcmdldC5jbG9zZXN0KCcjbW9kYWwnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWF1dGhlbnRpY2F0aW9uJywgJycpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGFsLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgbGV0IGltYWdlID0gbGF5b3V0ci5pc01vZGFsSW1hZ2UoKSAmJiAhdGFyZ2V0LmNsb3Nlc3QoJyNtb2RhbC10b2dnbGUnKS5sZW5ndGggJiYgIXRhcmdldC5jbG9zZXN0KCcjbW9kYWwtdGl0bGUnKS5sZW5ndGggJiYgIXRhcmdldC5jbG9zZXN0KCcjbW9kYWwtZGVzY3JpcHRpb24nKS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybSA9IGxheW91dHIuaXNNb2RhbEZvcm0oKSAmJiAhdGFyZ2V0LmNsb3Nlc3QoJyNtb2RhbCA+IGRpdiA+IGRpdiA+IGRpdicpLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGlmIChpbWFnZSB8fCBmb3JtIHx8IHRhcmdldC5jbG9zZXN0KCcjbW9kYWwtY2xvc2UnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmNsb3NlTW9kYWwoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxldCBpc1NtYWxsQnJlYWtwb2ludCA9IGxheW91dHIuaXNTbWFsbEJyZWFrcG9pbnQoKSxcclxuICAgICAgICAgICAgICAgICAgICBsZWZ0ID0gbGF5b3V0ci5pc0FzaWRlTGVmdCgpICYmIChsYXlvdXRyLmlzQXNpZGVMZWZ0Q2xvc2VPbkNsaWNrT3V0c2lkZSgpIHx8IGlzU21hbGxCcmVha3BvaW50KSAmJiAhdGFyZ2V0LmNsb3Nlc3QoXCIjbGVmdFwiKS5sZW5ndGgsXHJcbiAgICAgICAgICAgICAgICAgICAgcmlnaHQgPSBsYXlvdXRyLmlzQXNpZGVSaWdodCgpICYmIChsYXlvdXRyLmlzQXNpZGVSaWdodENsb3NlT25DbGlja091dHNpZGUoKSB8fCBpc1NtYWxsQnJlYWtwb2ludCkgJiYgIXRhcmdldC5jbG9zZXN0KFwiI3JpZ2h0XCIpLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgICAgICBub3RUYXJnZXQgPSAhdGFyZ2V0LmNsb3Nlc3QoXCIuYXNpZGVcIikubGVuZ3RoICYmICF0YXJnZXQuY2xvc2VzdCgnLnBvcHVwJykubGVuZ3RoICYmICF0YXJnZXQuY2xvc2VzdCgnI2Nvb2tpZScpLmxlbmd0aDtcclxuICAgICAgICAgICAgICAgIGlmICgobGVmdCB8fCByaWdodCkgJiYgbm90VGFyZ2V0ICYmICFsYXlvdXRyLmlzTG9hZGluZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5lbmFibGVTY3JvbGwoKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLnRvZ2dsZUFzaWRlKHVuZGVmaW5lZCwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSk7XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmNvbnRlbnRMb2FkZWQgPSAoZWxlbWVudCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIuY2hlY2tSZXNwb25zaXZlQmFja2dyb3VuZChlbGVtZW50LmZpbmQoJy5yYicpKTtcclxuICAgICAgICBsYXlvdXRyLmNoZWNrTGF6eShlbGVtZW50LmZpbmQoJy5sYXp5JykpO1xyXG4gICAgICAgIGxheW91dHIuY2hlY2tBY2NvcmRpb24oZWxlbWVudC5maW5kKCcuYWNjb3JkaW9uJykpO1xyXG4gICAgICAgIGxheW91dHIuY2hlY2tEcm9wZG93bihlbGVtZW50LmZpbmQoJ3NlbGVjdC5kcm9wZG93bicpKTtcclxuICAgICAgICBsYXlvdXRyLmNoZWNrVG9vbHRpcChlbGVtZW50LmZpbmQoJy50b29sdGlwJykpO1xyXG4gICAgICAgIGxheW91dHIuY2hlY2tBc3NpZ25tZW50KGVsZW1lbnQuZmluZCgnLmFzc2lnbm1lbnQnKSk7XHJcbiAgICAgICAgbGF5b3V0ci5jaGVja01hdGgoZWxlbWVudC5maW5kKCcubWF0aCcpKTtcclxuICAgICAgICBsYXlvdXRyLmNoZWNrTWVkaWEoZWxlbWVudC5maW5kKCdhdWRpbywgdmlkZW8nKSk7XHJcbiAgICAgICAgbGF5b3V0ci5jaGVja01hcChlbGVtZW50LmZpbmQoJy5tYXAnKSk7XHJcbiAgICAgICAgbGF5b3V0ci5jaGVja0RhdGF0YWJsZShlbGVtZW50LmZpbmQoJy5kYXRhVGFibGUnKSk7XHJcbiAgICAgICAgbGF5b3V0ci5jaGVja1N3aXBlcihlbGVtZW50LmZpbmQoJy5zd2lwZXInKSk7XHJcbiAgICB9XHJcblxyXG4gICAgbGF5b3V0ci5wYWdlTG9hZGVkID0gKGluaXRpYWwpID0+IHtcclxuICAgICAgICBsZXQgcHJvbWlzZVNjcm9sbFRvcCA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcclxuICAgICAgICAgICAgbGF5b3V0ci5tYWluLmNzcygnb3ZlcmZsb3cnLCAnYXV0bycpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLm1haW4uc2Nyb2xsVG9wKDApO1xyXG4gICAgICAgICAgICBsYXlvdXRyLm1haW4uY3NzKCdvdmVyZmxvdycsICcnKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuc2Nyb2xsVG9wKDApO1xyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWluaXRpYWwgJiYgbGF5b3V0ci5pc0Nsb3NlTGVmdFBhZ2VDaGFuZ2UoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIudG9nZ2xlQXNpZGUodW5kZWZpbmVkLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgMjAwKTtcclxuXHJcbiAgICAgICAgICAgIGlmIChpbml0aWFsKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnByb21pc2VGb250LnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ3NpdGUtbG9hZGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5yZXNwb25zaXZlSGVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5jb250ZW50TG9hZGVkKGxheW91dHIuY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNjcm9sbCA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oXCJzY3JvbGxcIikpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY3JvbGwgIT09IG51bGwgJiYgd2luZG93LmxvY2F0aW9uLmhyZWYgPT09IHNjcm9sbC5ocmVmKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuYm9keS5zY3JvbGxUb3AobGF5b3V0ci5ib2R5WzBdLnNjcm9sbEhlaWdodCA+PSBzY3JvbGwuc2Nyb2xsVG9wID8gc2Nyb2xsLnNjcm9sbFRvcCA6IGxheW91dHIuYm9keVswXS5zY3JvbGxIZWlnaHQpOyAvLyBlZGdlLCBzYWZhcmlcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLnNjcm9sbFRvcChsYXlvdXRyLmh0bWxbMF0uc2Nyb2xsSGVpZ2h0ID49IHNjcm9sbC5zY3JvbGxUb3AgPyBzY3JvbGwuc2Nyb2xsVG9wIDogbGF5b3V0ci5odG1sWzBdLnNjcm9sbEhlaWdodCk7IC8vIGNocm9tZSwgZmlyZWZveCwgaWVcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuY29udGVudExvYWRlZChsYXlvdXRyLmNvbnRlbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgdmFyIGZ1bGxzY3JlZW5TY3JvbGxUb3A7XHJcblxyXG4gICAgbGF5b3V0ci5yZXF1ZXN0RnVsbFNjcmVlbiA9ICgpID0+IHtcclxuICAgICAgICBpZiAoIWxheW91dHIuZnVsbHNjcmVlbiAmJiBib3dzZXIuZGVza3RvcCkge1xyXG4gICAgICAgICAgICBmdWxsc2NyZWVuU2Nyb2xsVG9wID0gbGF5b3V0ci5zY3JvbGxUb3AoKTtcclxuICAgICAgICAgICAgaWYgKGxheW91dHIuZG9jdW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuZG9jdW1lbnQucmVxdWVzdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChsYXlvdXRyLmRvY3VtZW50Lm1zUmVxdWVzdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuZG9jdW1lbnQubXNSZXF1ZXN0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGxheW91dHIuZG9jdW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuZG9jdW1lbnQubW96UmVxdWVzdEZ1bGxTY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChsYXlvdXRyLmRvY3VtZW50LndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmRvY3VtZW50LndlYmtpdFJlcXVlc3RGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3dlYmtpdGZ1bGxzY3JlZW5jaGFuZ2UnLCBmdWxsc2NyZWVuQ2hhbmdlLCBmYWxzZSk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3pmdWxsc2NyZWVuY2hhbmdlJywgZnVsbHNjcmVlbkNoYW5nZSwgZmFsc2UpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZnVsbHNjcmVlbmNoYW5nZScsIGZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ01TRnVsbHNjcmVlbkNoYW5nZScsIGZ1bGxzY3JlZW5DaGFuZ2UsIGZhbHNlKTtcclxuXHJcbiAgICBmdW5jdGlvbiBmdWxsc2NyZWVuQ2hhbmdlKGUpIHtcclxuICAgICAgICBsYXlvdXRyLmZ1bGxzY3JlZW4gPSAhbGF5b3V0ci5mdWxsc2NyZWVuO1xyXG4gICAgICAgIGlmICghbGF5b3V0ci5mdWxsc2NyZWVuICYmIGJvd3Nlci5kZXNrdG9wKSB7XHJcbiAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzTW9kYWwoKSkge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5jbG9zZU1vZGFsKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGF5b3V0ci5ib2R5LnNjcm9sbFRvcChmdWxsc2NyZWVuU2Nyb2xsVG9wKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLnNjcm9sbFRvcChmdWxsc2NyZWVuU2Nyb2xsVG9wKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuZXhpdEZ1bGxTY3JlZW4gPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxheW91dHIuZnVsbHNjcmVlbiAmJiBib3dzZXIuZGVza3RvcCkge1xyXG4gICAgICAgICAgICBpZiAoZG9jdW1lbnQuZXhpdEZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LmV4aXRGdWxsc2NyZWVuKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSBpZiAoZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQubXNFeGl0RnVsbHNjcmVlbigpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50Lm1vekNhbmNlbEZ1bGxTY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChkb2N1bWVudC53ZWJraXRFeGl0RnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQud2Via2l0RXhpdEZ1bGxzY3JlZW4oKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgbGF5b3V0ci50b2dnbGVGdWxsU2NyZWVuID0gKGVsZW1lbnQpID0+IHtcclxuICAgICAgICBpZiAobGF5b3V0ci5mdWxsc2NyZWVuKVxyXG4gICAgICAgICAgICBleGl0RnVsbFNjcmVlbigpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmVxdWVzdEZ1bGxTY3JlZW4oZWxlbWVudCk7XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgdmFyIHNjcm9sbGJhcldpZHRoID0gKCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIuYm9keS5hcHBlbmQoJzxkaXYgaWQ9XCJzY3JvbGxiYXItd2lkdGhcIj48L2Rpdj4nKTtcclxuICAgICAgICBsZXQgZWxlbWVudCA9IGxheW91dHIuYm9keS5jaGlsZHJlbignI3Njcm9sbGJhci13aWR0aCcpO1xyXG4gICAgICAgIGVsZW1lbnQuY3NzKHtcclxuICAgICAgICAgICAgJ292ZXJmbG93JzogXCJzY3JvbGxcIixcclxuICAgICAgICAgICAgJ3Zpc2liaWxpdHknOiBcImhpZGRlblwiLFxyXG4gICAgICAgICAgICAncG9zaXRpb24nOiAnYWJzb2x1dGUnLFxyXG4gICAgICAgICAgICAnd2lkdGgnOiAnMTAwcHgnLFxyXG4gICAgICAgICAgICAnaGVpZ2h0JzogJzEwMHB4J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGxheW91dHIuc2Nyb2xsYmFyV2lkdGggPSBlbGVtZW50WzBdLm9mZnNldFdpZHRoIC0gZWxlbWVudFswXS5jbGllbnRXaWR0aDtcclxuICAgICAgICBlbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmRpc2FibGVTY3JvbGwgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxheW91dHIuaHRtbE92ZXJmbG93RW5hYmxlZCkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWxPdmVyZmxvd0VuYWJsZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgaWYgKGxheW91dHIuaXNNb2RhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmNoZWNrTW9kYWwoKTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIubW9kYWwuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsZXQgc2Nyb2xsVG9wID0gbGF5b3V0ci5zY3JvbGxUb3AoKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCdzY3JvbGwtZGlzYWJsZWQnKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5ib2R5LnNjcm9sbFRvcChzY3JvbGxUb3ApO1xyXG4gICAgICAgICAgICBsYXlvdXRyLm1haW4uc2Nyb2xsVG9wKHNjcm9sbFRvcCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmVuYWJsZVNjcm9sbCA9ICgpID0+IHtcclxuICAgICAgICBpZiAoIWxheW91dHIuaHRtbE92ZXJmbG93RW5hYmxlZCkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWxPdmVyZmxvd0VuYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAobGF5b3V0ci5pc1NpdGVMb2FkZWQoKSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNjcm9sbFRvcCA9IGxheW91dHIuc2Nyb2xsVG9wKCk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwucmVtb3ZlQ2xhc3MoJ3Njcm9sbC1kaXNhYmxlZCBtb2RhbCcpO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5tYWluLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmJvZHkuc2Nyb2xsVG9wKHNjcm9sbFRvcCk7IC8vIGVkZ2UsIHNhZmFyaVxyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLnNjcm9sbFRvcChzY3JvbGxUb3ApOyAvLyBjaHJvbWUsIGZpcmVmb3gsIGllXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwucmVtb3ZlQ2xhc3MoJ3Njcm9sbC1kaXNhYmxlZCBtb2RhbCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLnNldEh0bWxTY3JvbGwgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKCFsYXlvdXRyLmlzTW9kYWwoKSAmJiAhbGF5b3V0ci5pc0xvYWRpbmcoKSAmJiAhbGF5b3V0ci5odG1sT3ZlcmZsb3dFbmFibGVkICYmICghbGF5b3V0ci5pc1NtYWxsQnJlYWtwb2ludCgpIHx8IGxheW91dHIuaXNTbWFsbEJyZWFrcG9pbnQoKSAmJiAhbGF5b3V0ci5pc0FzaWRlTGVmdCgpICYmICFsYXlvdXRyLmlzQXNpZGVSaWdodCgpKSkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmVuYWJsZVNjcm9sbCgpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAobGF5b3V0ci5pc01vZGFsKCkgfHwgbGF5b3V0ci5pc1NtYWxsQnJlYWtwb2ludCgpICYmIGxheW91dHIuaHRtbE92ZXJmbG93RW5hYmxlZCAmJiAobGF5b3V0ci5pc0FzaWRlTGVmdCgpIHx8IGxheW91dHIuaXNBc2lkZVJpZ2h0KCkpKSB7XHJcbiAgICAgICAgICAgIGxheW91dHIuZGlzYWJsZVNjcm9sbCgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJCgoKSA9PiB7XHJcbiAgICAgICAgc2Nyb2xsYmFyV2lkdGgoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQod2luZG93KS5yZXNpemUoJC50aHJvdHRsZShsYXlvdXRyLnRocm90dGxlSW50ZXJ2YWwsIGZhbHNlLCAoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5jaGVja01vZGFsKCk7XHJcbiAgICAgICAgbGF5b3V0ci5zZXRIdG1sU2Nyb2xsKCk7XHJcbiAgICAgICAgc2Nyb2xsYmFyV2lkdGgoKTtcclxuICAgICAgICBzZXRTY3JvbGxUb3AoKTtcclxuICAgIH0pKTtcclxuXHJcbiAgICB2YXIgc2V0U2Nyb2xsVG9wID0gKCkgPT4ge1xyXG4gICAgICAgIGxldCBzY3JvbGxUb3AgPSBsYXlvdXRyLnNjcm9sbFRvcCgpO1xyXG5cclxuICAgICAgICBsZXQgZW50cnkgPSB7XHJcbiAgICAgICAgICAgIGhyZWY6IHdpbmRvdy5sb2NhdGlvbi5ocmVmLFxyXG4gICAgICAgICAgICBzY3JvbGxUb3A6IHNjcm9sbFRvcFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzY3JvbGwnLCBKU09OLnN0cmluZ2lmeShlbnRyeSkpO1xyXG4gICAgfTtcclxuXHJcbiAgICAkKHdpbmRvdykuc2Nyb2xsKCQudGhyb3R0bGUobGF5b3V0ci50aHJvdHRsZUludGVydmFsLCBmYWxzZSwgKCkgPT4ge1xyXG4gICAgICAgIHNldFNjcm9sbFRvcCgpO1xyXG4gICAgfSkpO1xyXG59Iiwie1xyXG4gICAgbGF5b3V0ci5zaG93TG9hZGluZyA9ICgpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmxvYWRpbmdDb3VudCsrO1xyXG4gICAgICAgIGxheW91dHIuZGlzYWJsZVNjcm9sbCgpO1xyXG4gICAgICAgIGxheW91dHIuaHRtbC5hZGRDbGFzcygnbG9hZGluZycpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmhpZGVMb2FkaW5nID0gKCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIubG9hZGluZ0NvdW50LS07XHJcbiAgICAgICAgaWYgKGxheW91dHIubG9hZGluZ0NvdW50IDw9IDApIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5sb2FkaW5nQ291bnQgPSAwO1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcnKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5zZXRIdG1sU2Nyb2xsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSIsIntcclxuICAgIGxldCB0cmFuc2l0aW9uTG9jayA9IGZhbHNlO1xyXG5cclxuICAgIGxheW91dHIuYXNpZGVDaGFuZ2VkID0gKCkgPT4ge1xyXG4gICAgICAgIGxldCB0cmlnZ2VyID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwudHJpZ2dlcignYXNpZGUtY2hhbmdlZC5kYXRhdGFibGVzJyk7XHJcbiAgICAgICAgICAgIGxheW91dHIuaHRtbC50cmlnZ2VyKCdhc2lkZS1jaGFuZ2VkLnJiJyk7XHJcbiAgICAgICAgICAgIGxheW91dHIuaHRtbC50cmlnZ2VyKCdhc2lkZS1jaGFuZ2VkLm1hcCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGxheW91dHIuaXNUcmFuc2l0aW9ucygpKSB7XHJcbiAgICAgICAgICAgIGxldCBhd2FpdEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0cmFuc2l0aW9uTG9jaykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoYXdhaXRJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRyaWdnZXIoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgbGF5b3V0ci5hd2FpdEludGVydmFsKTtcclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0cmFuc2l0aW9uTG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9LCBsYXlvdXRyLnRyYW5zaXRpb25UaW1lKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uTG9jayA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0cmlnZ2VyKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxheW91dHIudG9nZ2xlQXNpZGUgPSAoYXNpZGUsIHBhZ2VDaGFuZ2VkKSA9PiB7XHJcbiAgICAgICAgaWYgKCF0cmFuc2l0aW9uTG9jaykge1xyXG4gICAgICAgICAgICB0cmFuc2l0aW9uTG9jayA9IHRydWU7XHJcbiAgICAgICAgICAgIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWF1dGhlbnRpY2F0aW9uJywgJycpO1xyXG4gICAgICAgICAgICBsZXQgY3VycmVudEFzaWRlID0gbGF5b3V0ci5odG1sLmF0dHIoJ2RhdGEtYXNpZGUnKTtcclxuICAgICAgICAgICAgaWYgKGN1cnJlbnRBc2lkZS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGlmIChhc2lkZSA9PT0gdW5kZWZpbmVkIHx8IGN1cnJlbnRBc2lkZSA9PT0gYXNpZGUpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgc2Nyb2xsVG9wID0gbGF5b3V0ci5zY3JvbGxUb3AoKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1hc2lkZScsICcnKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLm1haW4uZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmJvZHkuc2Nyb2xsVG9wKHNjcm9sbFRvcCk7IC8vIGVkZ2UsIHNhZmFyaVxyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTsgLy8gY2hyb21lLCBmaXJlZm94LCBpZVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1hc2lkZScsIGFzaWRlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJywgYXNpZGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhc2lkZSA9PT0gJ2xlZnQnKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmxlZnQuZm9jdXMoKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChhc2lkZSA9PT0gJ3JpZ2h0Jykge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5yaWdodC5mb2N1cygpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsYXlvdXRyLmFzaWRlQ2hhbmdlZCgpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLnNldEh0bWxTY3JvbGwoKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgICQoKCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIubWFpbi5maW5kKCcuYXNpZGUubGVmdCcpLmNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgbGF5b3V0ci50b2dnbGVBc2lkZSgnbGVmdCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsYXlvdXRyLm1haW4uZmluZCgnLmFzaWRlLnJpZ2h0JykuY2xpY2soKCkgPT4ge1xyXG4gICAgICAgICAgICBsYXlvdXRyLnRvZ2dsZUFzaWRlKCdyaWdodCcpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0iLCJ7XHJcbiAgICAkKCgpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmF1dGhlbnRpY2F0aW9uLm9uKCdjbGljaycsICc+IGRpdiA+IGJ1dHRvbicsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KSxcclxuICAgICAgICAgICAgICAgIHR5cGUgPSAkdGhpcy5hdHRyKCdkYXRhLXR5cGUnKTtcclxuICAgICAgICAgICAgaWYgKGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWF1dGhlbnRpY2F0aW9uJykgPT09IHR5cGUpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWF1dGhlbnRpY2F0aW9uJywgJycpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLmF0dHIoJ2RhdGEtYXV0aGVudGljYXRpb24nLCB0eXBlKTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuYXV0aGVudGljYXRpb24uY2hpbGRyZW4oJzpsYXN0LWNoaWxkJykuZm9jdXMoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsYXlvdXRyLmF1dGhlbnRpY2F0ZWRMaW5rcy5vbignY2xpY2snLCAnPiBhJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsYXlvdXRyLmFkZFZhbGlkYXRpb24oXHJcbiAgICAgICAgICAgIGxheW91dHIuYXV0aGVudGljYXRpb24uZmluZCgnLnJlZ2lzdGVyID4gZm9ybScpLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICByZWdpc3Rlcl91c2VybmFtZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1pbmxlbmd0aDogMlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyX3Bhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmRfcmVnZXg6IHRydWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZWdpc3Rlcl9jb25maXJtX3Bhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZXF1YWxUbzogXCIjcmVnaXN0ZXJfcGFzc3dvcmRcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlZ2lzdGVyX2VtYWlsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJfdXNlcm5hbWU6IHtcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogXCJQbGVhc2UgZW50ZXIgeW91ciB1c2VybmFtZVwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJfcGFzc3dvcmQ6IHtcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogXCJQbGVhc2UgZW50ZXIgeW91ciBwYXNzd29yZFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJfY29uZmlybV9wYXNzd29yZDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBcIlBsZWFzZSBwcm92aWRlIGEgcGFzc3dvcmRcIixcclxuICAgICAgICAgICAgICAgICAgICBlcXVhbFRvOiBcIlBsZWFzZSBlbnRlciB0aGUgc2FtZSBwYXNzd29yZCBhcyBhYm92ZVwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVnaXN0ZXJfZW1haWw6IFwiUGxlYXNlIGVudGVyIGEgdmFsaWQgZW1haWwgYWRkcmVzc1wiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBsYXlvdXRyLmFkZFZhbGlkYXRpb24oXHJcbiAgICAgICAgICAgIGxheW91dHIuYXV0aGVudGljYXRpb24uZmluZCgnLmxvZ2luID4gZm9ybScpLFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHtcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBcIlBsZWFzZSBlbnRlciB5b3VyIHVzZXJuYW1lXCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBcIlBsZWFzZSBlbnRlciB5b3VyIHBhc3N3b3JkXCJcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgICQoKCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIuY29va2llLm9uKCdjbGljaycsICcjY29va2llLWFjY2VwdCcsICgpID0+IHtcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2Nvb2tpZScsICdjb29raWUnKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLnJlbW92ZUNsYXNzKCdjb29raWUnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGNvb2tpZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFwiY29va2llXCIpO1xyXG4gICAgICAgIGlmIChjb29raWUgPT09IG51bGwpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCdjb29raWUnKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgIGxheW91dHIubG9hZFBhZ2UgPSAodXJsLCBwdXNoU3RhdGUsIGluaXRpYWwpID0+IHtcclxuICAgICAgICBsYXlvdXRyLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgbGF5b3V0ci5sb2FkLmh0bWwobGF5b3V0ci5ob3N0ICsgbGF5b3V0ci5hamF4ICsgJ3BhZ2VzJyArICh1cmwgPT09ICcvJyA/ICcvaG9tZScgOiB1cmwpICsgJy5odG1sJykudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgbGF5b3V0ci5jb250ZW50Lmh0bWwocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICBsZXQgcSA9IHVybC5pbmRleE9mKCc/Jyk7XHJcbiAgICAgICAgICAgIHVybCA9IHVybC5zdWJzdHJpbmcoMCwgcSAhPT0gLTEgPyBxIDogdXJsLmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGxheW91dHIubGVmdC5maW5kKCcudHJlZSBhLmxhYmVsLmFjdGl2ZScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5sZWZ0LmZpbmQoJ2EubGFiZWxbaHJlZj1cIicgKyB1cmwgKyAnXCJdJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1zdGF0dXMnLCAnJyk7XHJcbiAgICAgICAgICAgIGxheW91dHIudGl0bGUuaHRtbCgnJyk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gbGF5b3V0ci5zaXRlTmFtZTtcclxuICAgICAgICAgICAgaWYgKHVybCA9PT0gJy8nKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ci5ib2R5LmNoaWxkcmVuKCcjc3ZnLWJyb3dzZXInKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmxvYWQuaHRtbChsYXlvdXRyLmhvc3QgKyBsYXlvdXRyLmFqYXggKyAnc3ZnL2Jyb3dzZXIuaHRtbCcpLnRoZW4oKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQocmVzcG9uc2UpLnByZXBlbmRUbyhsYXlvdXRyLmJvZHkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgYnJvd3NlciBzdmcgaHRtbCcsICdkYW5nZXInKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXRyLmJvZHkuY2hpbGRyZW4oJyNzdmctb3MnKS5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmxvYWQuaHRtbChsYXlvdXRyLmhvc3QgKyBsYXlvdXRyLmFqYXggKyAnc3ZnL29zLmh0bWwnKS50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkKHJlc3BvbnNlKS5wcmVwZW5kVG8obGF5b3V0ci5ib2R5KTtcclxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgb3Mgc3ZnIGh0bWwnLCAnZGFuZ2VyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdGl0bGUgPSBsYXlvdXRyLmNhcGl0YWxpemUodXJsLnJlcGxhY2UoJy8nLCAnJykucmVwbGFjZUFsbCgnLScsICcgJykpO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci50aXRsZS5odG1sKHRpdGxlKTtcclxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnRpdGxlID0gdGl0bGUgKyAnIC0gJyArIGxheW91dHIuc2l0ZU5hbWU7XHJcbiAgICAgICAgICAgICAgICBpZiAodXJsID09PSAnL2Zvcm0nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5wYWdlRm9ybSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxheW91dHIuaHRtbC50cmlnZ2VyKCdoZWFkZXItY2hhbmdlZC5yZXNwb25zaXZlSGVhZGVyJyk7XHJcbiAgICAgICAgICAgIGxheW91dHIucHJvbWlzZUNTUy50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIucGFnZUxvYWRlZChpbml0aWFsKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlKSA9PiB7XHJcbiAgICAgICAgICAgIGxheW91dHIubG9hZC5odG1sKGxheW91dHIuaG9zdCArIGxheW91dHIuYWpheCArICdwYWdlcy9lcnJvci5odG1sJykudGhlbigocmVzcG9uc2UyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmNvbnRlbnQuaHRtbChyZXNwb25zZTIpO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLmF0dHIoJ2RhdGEtc3RhdHVzJywgJ2Vycm9yJyk7XHJcbiAgICAgICAgICAgICAgICBkb2N1bWVudC50aXRsZSA9IHJlc3BvbnNlICsgJyAtICcgKyBsYXlvdXRyLnNpdGVOYW1lO1xyXG4gICAgICAgICAgICAgICAgbGV0IHRpdGxlID0gcmVzcG9uc2UgKyAnIC0gJztcclxuICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSA9PT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgKz0gJ1BhZ2Ugbm90IGZvdW5kJztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGl0bGUgKz0gJ1NlcnZlciBlcnJvcic7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmNvbnRlbnQuZmluZCgnI2Vycm9yLXRpdGxlJykuaHRtbCh0aXRsZSk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwudHJpZ2dlcignaGVhZGVyLWNoYW5nZWQucmVzcG9uc2l2ZUhlYWRlcicpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuc2hvd1BvcHVwQWxlcnQoJ0ZhaWxlZCB0byBsb2FkIGNvbnRlbnQgaHRtbCcsICdkYW5nZXInKTtcclxuICAgICAgICAgICAgfSkuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnByb21pc2VDU1MudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5wYWdlTG9hZGVkKGluaXRpYWwpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgaGlzdG9yeVVybCA9IChsYXlvdXRyLmlzTG9jYWxob3N0ID8gJycgOiAnLycgKyB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUuc3BsaXQoJy8nKVsxXSkgKyB1cmw7XHJcbiAgICAgICAgaWYgKHB1c2hTdGF0ZSkge1xyXG4gICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUobnVsbCwgbnVsbCwgaGlzdG9yeVVybCk7XHJcbiAgICAgICAgICAgIGxvYWRQYWdlID0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGxheW91dHIuaW50ZXJuYWxMaW5rQ2xpY2sgPSAoaHJlZiwgZSkgPT4ge1xyXG4gICAgICAgIGlmICghZS5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5sb2FkUGFnZShocmVmLCB0cnVlLCBmYWxzZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLnNlYXJjaCkge1xyXG4gICAgICAgIGxheW91dHIudXJsID0ge307XHJcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdCgnJicpLmZvckVhY2goKHYpID0+IHtcclxuICAgICAgICAgICAgbGV0IGEgPSB2LnNwbGl0KCc9Jyk7XHJcbiAgICAgICAgICAgIGxheW91dHIudXJsW2FbMF1dID0gYS5zbGljZSgxKS5qb2luKCc9JykucmVwbGFjZSgvfmFuZH4vZywgJyYnKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAobGF5b3V0ci51cmwucCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBudWxsLFxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lLnNsaWNlKDAsIC0xKSArIGxheW91dHIudXJsLnAgK1xyXG4gICAgICAgICAgICAgICAgKGxheW91dHIudXJsLnEgPyAnPycgKyBsYXlvdXRyLnVybC5xIDogJycpICtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGxldCBsb2FkUGFnZSA9IHdpbmRvdy5oaXN0b3J5LnN0YXRlO1xyXG4gICAgd2luZG93Lm9ucG9wc3RhdGUgPSAoZSkgPT4ge1xyXG4gICAgICAgIGlmIChsb2FkUGFnZSkge1xyXG4gICAgICAgICAgICBsZXQgdXJsID0gbG9jYXRpb24ucGF0aG5hbWU7XHJcbiAgICAgICAgICAgIGlmICghbGF5b3V0ci5pc0xvY2FsaG9zdCkge1xyXG4gICAgICAgICAgICAgICAgdXJsID0gdXJsLnN1YnN0cmluZyh1cmwuaW5kZXhPZihcIi9cIiwgdXJsLmluZGV4T2YoXCIvXCIpICsgMSkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxheW91dHIubG9hZFBhZ2UodXJsLCBmYWxzZSwgdHJ1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmFwcGx5TmF2aWdhdGlvbiA9IChpZCwgdmFsdWUsIHNldCkgPT4ge1xyXG4gICAgICAgIGlmIChzZXQpIHtcclxuICAgICAgICAgICAgbGV0IGVudHJ5ID0ge1xyXG4gICAgICAgICAgICAgICAgXCJpZFwiOiBpZCxcclxuICAgICAgICAgICAgICAgIFwidmFsdWVcIjogdmFsdWVcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGV4aXN0cyA9ICQuZ3JlcChsYXlvdXRyLm5hdmlnYXRpb24sIChlKSA9PiB7IHJldHVybiBlLm5hbWUgPT09IG5hbWU7IH0pO1xyXG4gICAgICAgICAgICBpZiAoZXhpc3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbm90IGZvdW5kXHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLm5hdmlnYXRpb24ucHVzaChlbnRyeSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZXhpc3RzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gZm91bmRcclxuICAgICAgICAgICAgICAgIGV4aXN0c1swXS52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCduYXZpZ2F0aW9uJywgSlNPTi5zdHJpbmdpZnkobGF5b3V0ci5uYXZpZ2F0aW9uKSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5sZWZ0LmZpbmQoJyMnICsgaWQpLnByb3AoJ2NoZWNrZWQnLCB2YWx1ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICAkKCgpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmxvYWQuaHRtbChsYXlvdXRyLmhvc3QgKyBsYXlvdXRyLmFqYXggKyAnbGF5b3V0L25hdmlnYXRpb24uaHRtbCcpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIGxheW91dHIubGVmdC5maW5kKCc+IC5jb250ZW50ID4gZGl2JykuaHRtbChyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIGxheW91dHIubmF2aWdhdGlvblRyZWUgPSBsYXlvdXRyLmxlZnQuZmluZCgnLnRyZWUnKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5uYXZpZ2F0aW9uID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIm5hdmlnYXRpb25cIikpO1xyXG4gICAgICAgICAgICBpZiAobGF5b3V0ci5uYXZpZ2F0aW9uID09PSBudWxsKSBsYXlvdXRyLm5hdmlnYXRpb24gPSBbXTtcclxuICAgICAgICAgICAgJC5lYWNoKGxheW91dHIubmF2aWdhdGlvbiwgKGksIGVudHJ5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmFwcGx5TmF2aWdhdGlvbihlbnRyeS5pZCwgZW50cnkudmFsdWUsIGZhbHNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGxheW91dHIubmF2aWdhdGlvblRyZWUub24oJ2NoYW5nZScsICdpbnB1dFt0eXBlPWNoZWNrYm94XScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgY2hlY2tib3ggPSAkKGUuY3VycmVudFRhcmdldCksXHJcbiAgICAgICAgICAgICAgICAgICAgaWQgPSBjaGVja2JveC5hdHRyKCdpZCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gY2hlY2tib3guaXMoJzpjaGVja2VkJyk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmFwcGx5TmF2aWdhdGlvbihpZCwgdmFsdWUsIHRydWUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbGF5b3V0ci5oZWFkZXIuZmluZCgnLmFzaWRlLmxlZnQnKS5hZGRDbGFzcygnbG9hZGVkJyk7XHJcbiAgICAgICAgICAgIGlmIChsYXlvdXRyLnVybCAmJiBsYXlvdXRyLnVybC5wKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLm5hdmlnYXRpb25UcmVlLmZpbmQoJ2EubGFiZWxbaHJlZj1cIicgKyBsYXlvdXRyLnVybC5wLnJlcGxhY2UoL15cXC8rL2csICcnKSArICdcIl0nKS5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLm5hdmlnYXRpb25UcmVlLmZpbmQoJ2EubGFiZWxbaHJlZj1cIlwiXScpLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgbmF2aWdhdGlvbiBodG1sJywgJ2RhbmdlcicpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAobGF5b3V0ci51cmwgJiYgbGF5b3V0ci51cmwucCkge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmxvYWRQYWdlKGxheW91dHIudXJsLnAsIHRydWUsIHRydWUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHZhciBsID0gd2luZG93LmxvY2F0aW9uO1xyXG4gICAgICAgICAgICB2YXIgc2VnbWVudENvdW50ID0gbC5vcmlnaW4uZW5kc1dpdGgoJ2dpdGh1Yi5pbycpID8gMSA6IDA7XHJcbiAgICAgICAgICAgIHZhciB1cmwgPSAnLycgKyBsLnBhdGhuYW1lLnNsaWNlKDEpLnNwbGl0KCcvJykuc2xpY2Uoc2VnbWVudENvdW50KTtcclxuICAgICAgICAgICAgbGF5b3V0ci5sb2FkUGFnZSh1cmwsIHRydWUsIHRydWUpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsYXlvdXRyLmxlZnQub24oJ2NsaWNrJywgJy50cmVlIGEubGFiZWw6bm90KC5hY3RpdmUpJywgKGUpID0+IHtcclxuICAgICAgICAgICAgbGF5b3V0ci5pbnRlcm5hbExpbmtDbGljaygkKGUuY3VycmVudFRhcmdldCkuYXR0cignaHJlZicpLCBlKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGF5b3V0ci5ib2R5Lm9uKCdjbGljaycsICcuaW50ZXJuYWwtbGluaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGxheW91dHIuaW50ZXJuYWxMaW5rQ2xpY2soJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ2hyZWYnKSwgZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxheW91dHIubGVmdC5vbignY2xpY2snLCAnI25hdmlnYXRpb24tZXhwYW5kJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsYXlvdXRyLm5hdmlnYXRpb25UcmVlLmZpbmQoJ2lucHV0W3R5cGU9Y2hlY2tib3hdOm5vdCg6Y2hlY2tlZCknKS5jbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsYXlvdXRyLmxlZnQub24oJ2NsaWNrJywgJyNuYXZpZ2F0aW9uLWNvbGxhcHNlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsYXlvdXRyLm5hdmlnYXRpb25UcmVlLmZpbmQoJ2lucHV0W3R5cGU9Y2hlY2tib3hdOmNoZWNrZWQnKS5jbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmFwcGx5U2V0dGluZ3MgPSAoaWQsIG5hbWUsIHR5cGUsIHZhbHVlLCBzZXQpID0+IHtcclxuICAgICAgICBpZiAoc2V0KSB7XHJcbiAgICAgICAgICAgIGxldCBlbnRyeSA9IHtcclxuICAgICAgICAgICAgICAgIFwiaWRcIjogaWQsXHJcbiAgICAgICAgICAgICAgICBcIm5hbWVcIjogbmFtZSxcclxuICAgICAgICAgICAgICAgIFwidHlwZVwiOiB0eXBlLFxyXG4gICAgICAgICAgICAgICAgXCJ2YWx1ZVwiOiB2YWx1ZVxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXhpc3RzID0gJC5ncmVwKGxheW91dHIuc2V0dGluZ3MsIChlKSA9PiB7IHJldHVybiBlLm5hbWUgPT09IG5hbWU7IH0pO1xyXG4gICAgICAgICAgICBpZiAoZXhpc3RzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgLy8gbm90IGZvdW5kXHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNldHRpbmdzLnB1c2goZW50cnkpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKGV4aXN0cy5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgIC8vIGZvdW5kXHJcbiAgICAgICAgICAgICAgICBleGlzdHNbMF0uaWQgPSBpZDtcclxuICAgICAgICAgICAgICAgIGV4aXN0c1swXS52YWx1ZSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdzZXR0aW5ncycsIEpTT04uc3RyaW5naWZ5KGxheW91dHIuc2V0dGluZ3MpKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAodHlwZSA9PT0gXCJjaGVja2JveFwiIHx8IHR5cGUgPT09IFwicmFkaW9cIikge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5yaWdodC5maW5kKCcjc2V0dGluZ3MtJyArIGlkKS5wcm9wKCdjaGVja2VkJywgdmFsdWUpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09IFwic2xpZGVyXCIpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIucmlnaHQuZmluZCgnI3NldHRpbmdzLScgKyBpZCkuc2xpZGVyKCdzZXRWYWx1ZScsIHZhbHVlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZSA9PT0gJ2NoZWNrYm94JyB8fCB0eXBlID09PSBcInJhZGlvXCIpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGUgPT09ICdyYWRpbycpIHtcclxuICAgICAgICAgICAgICAgICQuZWFjaChsYXlvdXRyLnJpZ2h0LmZpbmQoJ2lucHV0W3R5cGU9cmFkaW9dW25hbWU9XCJzZXR0aW5ncy0nICsgbmFtZSArICdcIl06bm90KCNzZXR0aW5ncy0nICsgaWQgKyAnKScpLCAoaSwgcmFkaW8pID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwucmVtb3ZlQ2xhc3MoJChyYWRpbykuYXR0cignaWQnKS5yZXBsYWNlKCdzZXR0aW5ncy0nLCAnJykpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG5hbWUgPT09ICd0aGVtZScpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIubG9hZFRoZW1lKGlkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAobmFtZSA9PT0gJ2ZvY3VzJyAmJiB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5lbmFibGVGb2N1cygpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICd0dHMnICYmIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmVuYWJsZVRUUygpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKG5hbWUgPT09ICdzd2lwZScgJiYgdmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuZW5hYmxlU3dpcGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hZGRDbGFzcyhpZCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwucmVtb3ZlQ2xhc3MoaWQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpZCA9PT0gJ3R3by1jb2x1bW5zJykge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLnRyaWdnZXIoJ2NvbHVtbnMtY2hhbmdlZC5yYicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpZCA9PT0gJ3NpZ25lZC1pbicgfHwgaWQgPT09ICdmb2N1cycgfHwgaWQgPT09ICd0dHMnKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwudHJpZ2dlcignaGVhZGVyLWNoYW5nZWQucmVzcG9uc2l2ZUhlYWRlcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChuYW1lID09PSAnYXNpZGUtbGVmdCcgfHwgJ2FzaWRlLXJpZ2h0Jykge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5hc2lkZUNoYW5nZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgJCgoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5sb2FkLmh0bWwobGF5b3V0ci5ob3N0ICsgbGF5b3V0ci5hamF4ICsgJ2xheW91dC9zZXR0aW5ncy5odG1sJykudGhlbigocmVzcG9uc2UpID0+IHtcclxuICAgICAgICAgICAgbGV0ICR0aGlzID0gbGF5b3V0ci5yaWdodC5maW5kKCc+IC5jb250ZW50ID4gZGl2Jyk7XHJcbiAgICAgICAgICAgICR0aGlzLmh0bWwocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLnByb21pc2VDU1MudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAkLmVhY2gobGF5b3V0ci5zZXR0aW5ncywgKGksIGVudHJ5KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5hcHBseVNldHRpbmdzKGVudHJ5LmlkLCBlbnRyeS5uYW1lLCBlbnRyeS50eXBlLCBlbnRyeS52YWx1ZSwgZmFsc2UpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmhlYWRlci5maW5kKCcuYXNpZGUucmlnaHQnKS5hZGRDbGFzcygnbG9hZGVkJyk7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5vbignY2hhbmdlJywgJ2lucHV0W3R5cGU9Y2hlY2tib3hdLCBpbnB1dFt0eXBlPXJhZGlvXScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGlucHV0ID0gJChlLmN1cnJlbnRUYXJnZXQpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZCA9IGlucHV0LmF0dHIoJ2lkJykucmVwbGFjZSgnc2V0dGluZ3MtJywgJycpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gaW5wdXQuYXR0cignbmFtZScpLnJlcGxhY2UoJ3NldHRpbmdzLScsICcnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGlucHV0LmF0dHIoJ3R5cGUnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBpbnB1dC5pcygnOmNoZWNrZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmFwcGx5U2V0dGluZ3MoaWQsIG5hbWUsIHR5cGUsIHZhbHVlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoaWQgPT09ICdsZWZ0LXNocmluaycgfHwgaWQgPT09ICdyaWdodC1zaHJpbmsnIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID09PSAnbGVmdC1wdXNoJyB8fCBpZCA9PT0gJ3JpZ2h0LXB1c2gnIHx8XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkID09PSAnbGVmdC1vdmVybGF5JyB8fCBpZCA9PT0gJ3JpZ2h0LW92ZXJsYXknKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuc2V0SHRtbFNjcm9sbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGxheW91dHIuc2hvd1BvcHVwQWxlcnQoJ0ZhaWxlZCB0byBsb2FkIHNldHRpbmdzIGh0bWwnLCAnZGFuZ2VyJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxheW91dHIucmlnaHQub24oJ2NsaWNrJywgJyNzZXR0aW5ncy1jbGVhci1sb2NhbHN0b3JhZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpO1xyXG4gICAgICAgICAgICBsb2NhdGlvbi5yZWxvYWQoKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG59Iiwie1xyXG4gICAgJCgoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5ib2R5Lm9uKFwia2V5ZG93blwiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLnRhcmdldCksXHJcbiAgICAgICAgICAgICAgICBwYXJlbnQgPSB0YXJnZXQucGFyZW50KCk7XHJcbiAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzTG9hZGluZygpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS53aGljaCA9PT0gOSB8fCBlLmN0cmxLZXkgJiYgZS5rZXlDb2RlID09PSA2NSkgeyAvLyB0YWIgfHwgIGN0cmwgKyBhXHJcbiAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUud2hpY2ggPT09IDM3ICYmICFsYXlvdXRyLmlzRm9jdXMoKSAmJiAhbGF5b3V0ci5pc01vZGFsKCkpIHsgLy8gbGVmdFxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzQXNpZGVMZWZ0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci50b2dnbGVBc2lkZSgpOyAvLyBjbG9zZXMgcmlnaHRcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKCFsYXlvdXRyLmlzQXNpZGVSaWdodCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIudG9nZ2xlQXNpZGUoJ3JpZ2h0Jyk7IC8vIG9wZW5zIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLndoaWNoID09PSAzOSAmJiAhbGF5b3V0ci5pc0ZvY3VzKCkgJiYgIWxheW91dHIuaXNNb2RhbCgpKSB7IC8vIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxheW91dHIuaXNBc2lkZVJpZ2h0KCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci50b2dnbGVBc2lkZSgpOyAvLyBjbG9zZXMgbGVmdFxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWxheW91dHIuaXNBc2lkZUxlZnQoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLnRvZ2dsZUFzaWRlKCdsZWZ0Jyk7IC8vIG9wZW5zIGxlZnRcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGUud2hpY2ggPT09IDI3KSB7IC8vIGVzY1xyXG4gICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGxheW91dHIudHRzICE9PSB1bmRlZmluZWQgJiYgbGF5b3V0ci50dHMuSXNTcGVha2luZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuc3RvcFRUUygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobGF5b3V0ci5pc0ZvY3VzKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5oaWRlRm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGxheW91dHIuaXNNb2RhbCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuY2xvc2VNb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzQXNpZGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci50b2dnbGVBc2lkZSgpOyAvLyBjbG9zZXMgYXNpZGVcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgcG9wdXBzID0gbGF5b3V0ci5ib2R5LmNoaWxkcmVuKCcucG9wdXAnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBvcHVwcy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBvcHVwcy5mYWRlT3V0KGxheW91dHIuZmFkZU91dFRpbWUsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3B1cHMucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZHJvcGRvd25zID0gbGF5b3V0ci5jb250ZW50LmZpbmQoJ2Rpdi5kcm9wZG93bi5vcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkcm9wZG93bnMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcm9wZG93bnMucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1hdXRoZW50aWNhdGlvbicsICcnKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZS53aGljaCA9PT0gMTMpIHsgLy8gZW50ZXJcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZHJvcGRvd24gPSB0YXJnZXQucGFyZW50cygnZGl2LmRyb3Bkb3duJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRyb3Bkb3duLmxlbmd0aCB8fCBwYXJlbnQucGFyZW50KCkuaGFzQ2xhc3MoJ2FjY29yZGlvbicpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhcmdldC5jbGljaygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkcm9wZG93bi5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duLmNoaWxkcmVuKCdkaXYnKS5mb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChwYXJlbnQuaGFzQ2xhc3MoJ2NoZWNrYm94JykgfHwgcGFyZW50Lmhhc0NsYXNzKCdyYWRpbycpIHx8IHBhcmVudC5oYXNDbGFzcygnc3dpdGNoJykgfHwgdGFyZ2V0Lmhhc0NsYXNzKCd0b2dnbGUnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc2libGluZ3MoJ2lucHV0JykuY2xpY2soKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsYXlvdXRyLmJvZHkub24oJ2tleXVwJywgKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKCFsYXlvdXRyLmlzTG9hZGluZygpICYmICFsYXlvdXRyLmlzRm9jdXMoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGUud2hpY2ggPT09IDkpIHsgLy8gdGFiXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS50YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0LnBhcmVudHMoJ2Rpdi5kcm9wZG93bi5vcGVuJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICQoJ2Rpdi5kcm9wZG93bi5vcGVuJykucmVtb3ZlQ2xhc3MoJ29wZW4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQucGFyZW50cygnI2F1dGhlbnRpY2F0ZWQub3BlbicpLmxlbmd0aCB8fCB0YXJnZXQuY2xvc2VzdCgnI2F1dGhlbnRpY2F0ZWQgPiBidXR0b24nKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJCgnI2F1dGhlbnRpY2F0ZWQub3BlbicpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzTW9kYWwoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldC5wYXJlbnRzKCcjbW9kYWwnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuY2xvc2VNb2RhbCgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGFzaWRlID0gdGFyZ2V0LnBhcmVudHMoJ2FzaWRlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhc2lkZS5sZW5ndGggPT09IDAgJiYgdGFyZ2V0LmlzKCdhc2lkZScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhc2lkZSA9IHRhcmdldDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXNpZGUubGVuZ3RoICYmIGFzaWRlLmF0dHIoJ2lkJykgIT09IGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIudG9nZ2xlQXNpZGUoYXNpZGUuYXR0cignaWQnKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWFzaWRlLmxlbmd0aCAmJiBsYXlvdXRyLmlzQXNpZGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci50b2dnbGVBc2lkZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgIGxheW91dHIuc2hvd01vZGFsID0gKHR5cGUpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1tb2RhbCcsIHR5cGUpO1xyXG4gICAgICAgIGxheW91dHIuaHRtbC5hZGRDbGFzcygnbW9kYWwnKTtcclxuICAgICAgICBsYXlvdXRyLmhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgbGF5b3V0ci5jaGVja01vZGFsKCk7XHJcbiAgICAgICAgbGF5b3V0ci5tb2RhbC5mb2N1cygpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmNsb3NlTW9kYWwgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxheW91dHIuZnVsbHNjcmVlbikge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmV4aXRGdWxsU2NyZWVuKCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLnJlbW92ZUNsYXNzKCdtb2RhbCcpLmF0dHIoJ2RhdGEtbW9kYWwnLCAnJyk7XHJcbiAgICAgICAgICAgIGxheW91dHIubW9kYWwucmVtb3ZlQ2xhc3MoJ2luZm8tc2hvd24nKS5lbXB0eSgpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLmNoZWNrTW9kYWwoKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5zZXRIdG1sU2Nyb2xsKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmNoZWNrTW9kYWwgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGxheW91dHIuaXNNb2RhbCgpKSB7XHJcbiAgICAgICAgICAgIGxheW91dHIuYm9keS5jc3MoJ3BhZGRpbmctcmlnaHQnLCBsYXlvdXRyLnNjcm9sbGJhcldpZHRoKTtcclxuICAgICAgICAgICAgaWYgKGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJykgPT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIucmlnaHQuY3NzKCdtYXJnaW4tcmlnaHQnLCBsYXlvdXRyLnNjcm9sbGJhcldpZHRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsYXlvdXRyLmJvZHkuY2hpbGRyZW4oJy5wb3B1cCcpLmNzcygnbWFyZ2luLXJpZ2h0JywgbGF5b3V0ci5zY3JvbGxiYXJXaWR0aCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5ib2R5LmNzcygncGFkZGluZy1yaWdodCcsIDApO1xyXG4gICAgICAgICAgICBsYXlvdXRyLnJpZ2h0LmNzcygnbWFyZ2luLXJpZ2h0JywgMCk7XHJcbiAgICAgICAgICAgIGxheW91dHIuYm9keS5jaGlsZHJlbignLnBvcHVwJykuY3NzKCdtYXJnaW4tcmlnaHQnLCAwKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGF5b3V0ci5odG1sLnRyaWdnZXIoJ21vZGVsLWNoZWNrJyk7XHJcbiAgICB9O1xyXG5cclxuICAgICQoKCkgPT4ge1xyXG4gICAgICAgIGxheW91dHIuYm9keS5vbignY2xpY2snLCAnLm1vZGFsJywgKGUpID0+IHtcclxuICAgICAgICAgICAgbGV0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpLFxyXG4gICAgICAgICAgICAgICAgdHlwZSA9ICR0aGlzLmF0dHIoJ2RhdGEtbW9kYWwnKTtcclxuICAgICAgICAgICAgaWYgKHR5cGUgIT09IHVuZGVmaW5lZCAmJiB0eXBlLmxlbmd0aCAmJiAodHlwZSA9PT0gJ2ltYWdlJyB8fCB0eXBlID09PSAnZm9ybScpKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBsZXQgaWQgPSAkdGhpcy5hdHRyKCdkYXRhLW1vZGFsLWlkJyksXHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbCA9IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFUaXRsZSA9ICR0aGlzLmF0dHIoJ2RhdGEtbW9kYWwtdGl0bGUnKSxcclxuICAgICAgICAgICAgICAgICAgICBkYXRhQ29udGVudCA9ICR0aGlzLmF0dHIoJ2RhdGEtbW9kYWwtY29udGVudCcpLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFGdWxsc2NyZWVuID0gJHRoaXMuYXR0cignZGF0YS1tb2RhbC1mdWxsc2NyZWVuJykgPT09ICd0cnVlJztcclxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdj48ZGl2PjxkaXYgaWQ9XCJtb2RhbC1jb250YWluZXJcIj4nKTtcclxuICAgICAgICAgICAgICAgIGlmICh0eXBlID09PSAnaW1hZ2UnICYmICR0aGlzLmF0dHIoJ2RhdGEtbW9kYWwtaW1nJykubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGFUaXRsZSAhPT0gdW5kZWZpbmVkIHx8IGRhdGFDb250ZW50ICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5tb2RhbC5hZGRDbGFzcygnaGFzLWluZm8nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8YnV0dG9uIGlkPVwibW9kYWwtdG9nZ2xlXCIgY2xhc3M9XCJidG5cIiBhcmlhLWxhYmVsPVwiVG9nZ2xlIGluZm9cIj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8c3ZnIGZvY3VzYWJsZT1cImZhbHNlXCI+PHVzZSB4bGluazpocmVmPVwiI3N2Zy1pbmZvXCI+PC91c2U+PC9zdmc+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPC9idXR0b24+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhVGl0bGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goJzxkaXYgaWQ9XCJtb2RhbC10aXRsZVwiPicgKyBkYXRhVGl0bGUgKyAnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhQ29udGVudCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBpZD1cIm1vZGFsLWNvbnRlbnRcIj4nICsgZGF0YUNvbnRlbnQgKyAnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGltZyBpZD1cIm1vZGFsLWltZ1wiIC8+Jyk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdmb3JtJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPGRpdiBjbGFzcz1cImhlYWRlclwiPicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhVGl0bGUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBodG1sLnB1c2goJzxzcGFuIGNsYXNzPVwidGl0bGVcIj4nICsgZGF0YVRpdGxlICsgJzwvc3Bhbj4nKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8YnV0dG9uIGlkPVwibW9kYWwtY2xvc2VcIiBjbGFzcz1cImNsb3NlIGV4cGFuZFwiIGFyaWEtbGFiZWw9XCJDbG9zZSAnICsgKGRhdGFUaXRsZSAhPT0gdW5kZWZpbmVkID8gZGF0YVRpdGxlIDogJycpICsgJ1wiPjxzdmcgZm9jdXNhYmxlPVwiZmFsc2VcIj48dXNlIHhsaW5rOmhyZWY9XCIjc3ZnLWNsb3NlXCI+PC91c2U+PC9zdmc+PC9idXR0b24gPicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPC9kaXY+PGRpdiBjbGFzcz1cImNvbnRlbnRcIj4nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGh0bWwucHVzaCgnPC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+Jyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgZGl2ID0gaHRtbC5qb2luKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5tb2RhbC5odG1sKGRpdik7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZSA9PT0gJ2ltYWdlJykge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBpbWFnZSA9IGxheW91dHIubW9kYWwuZmluZCgnI21vZGFsLWltZycpO1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlLm9uKCdsb2FkJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm93c2VyLmFuZHJvaWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlLmNzcygnbWF4LWhlaWdodCcsIHdpbmRvdy5pbm5lckhlaWdodCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93TW9kYWwodHlwZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2UuYXR0cignc3JjJywgJHRoaXMuYXR0cignZGF0YS1tb2RhbC1pbWcnKSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBkYXRhU2l6ZSA9ICR0aGlzLmF0dHIoJ2RhdGEtbW9kYWwtc2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkYXRhU2l6ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIubW9kYWwuY2hpbGRyZW4oJ2RpdicpLmF0dHIoJ2RhdGEtbW9kYWwtc2l6ZScsIGRhdGFTaXplKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSBsYXlvdXRyLm1vZGFsLmZpbmQoJyNtb2RhbC1jb250YWluZXIgPiAuY29udGVudCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kKGRhdGFDb250ZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmNvbnRlbnRMb2FkZWQoY29udGVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93TW9kYWwodHlwZSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YUZ1bGxzY3JlZW4pIHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLnJlcXVlc3RGdWxsU2NyZWVuKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGF5b3V0ci5ib2R5Lm9uKCdjbGljaycsICcjbW9kYWwtdG9nZ2xlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsYXlvdXRyLm1vZGFsLnRvZ2dsZUNsYXNzKCdpbmZvLXNob3duJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgIGxheW91dHIucmVzcG9uc2l2ZUhlYWRlciA9ICgpID0+IHtcclxuICAgICAgICBsZXQgaDEgPSBsYXlvdXRyLmhlYWRlci5maW5kKCdoMScpLFxyXG4gICAgICAgICAgICBsaW5rID0gaDEuY2hpbGRyZW4oJ2EnKTtcclxuXHJcbiAgICAgICAgbGV0IGNoZWNrID0gKCkgPT4ge1xyXG4gICAgICAgICAgICBoMS5hZGRDbGFzcygnc2hvdy10aXRsZScpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLnVuYXV0aGVudGljYXRlZC5hZGRDbGFzcygnc2hvdy10ZXh0Jyk7XHJcbiAgICAgICAgICAgIGlmIChoMS5vdXRlcldpZHRoKCkgPCBsaW5rLm91dGVyV2lkdGgoKSkge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci51bmF1dGhlbnRpY2F0ZWQucmVtb3ZlQ2xhc3MoJ3Nob3ctdGV4dCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGgxLm91dGVyV2lkdGgoKSA8IGxpbmsub3V0ZXJXaWR0aCgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaDEucmVtb3ZlQ2xhc3MoJ3Nob3ctdGl0bGUnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNoZWNrKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNoZWNrKCk7XHJcblxyXG4gICAgICAgIGxheW91dHIuaHRtbC5vbignaGVhZGVyLWNoYW5nZWQucmVzcG9uc2l2ZUhlYWRlcicsICgpID0+IHtcclxuICAgICAgICAgICAgY2hlY2soKTtcclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmVuYWJsZUZvY3VzID0gKCkgPT4ge1xyXG4gICAgICAgIGxldCBjb21wb25lbnQgPSBsYXlvdXRyLmZvY3VzLmZpbmQoJz4gLmNvbXBvbmVudCA+IGRpdicpO1xyXG5cclxuICAgICAgICBpZiAoIWxheW91dHIuaHRtbC5oYXNDbGFzcygnZm9jdXMtbG9hZGVkJykpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5zaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLnByb21pc2VGb2N1cyA9IGxheW91dHIubG9hZC5qcygnZGlzdC9qcy9mb2N1cy5qcycpLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCdmb2N1cy1sb2FkZWQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxheW91dHIucHJvbWlzZUZvY3VzLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICBjb21wb25lbnRcclxuICAgICAgICAgICAgICAgIC5kcmFnZ2FibGUoe1xyXG4gICAgICAgICAgICAgICAgICAgIGF4aXM6IFwieVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50OiBcInBhcmVudFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZTogXCIubW92ZVwiXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnJlc2l6YWJsZSh7XHJcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuOiAnLnVpLXJlc2l6YWJsZS1uJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgczogJy51aS1yZXNpemFibGUtcydcclxuICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5tZW50OiBcInBhcmVudFwiXHJcbiAgICAgICAgICAgICAgICB9KS5vbigncmVzaXplJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBsYXlvdXRyLmZvY3VzLm9uKCdjbGljaycsICcuY2xvc2UnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmhpZGVGb2N1cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxheW91dHIubWFpbi5maW5kKCcuZm9jdXMnKS5jbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dGb2N1cygpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGxldCBoZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCk7XHJcbiAgICAgICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gZG8gbm90aGluZyBpZiB0aGUgaGVpZ2h0IGlzIHRoZSBzYW1lXHJcbiAgICAgICAgICAgICAgICBpZiAoJCh3aW5kb3cpLmhlaWdodCgpID09PSBoZWlnaHQpIHJldHVybjtcclxuICAgICAgICAgICAgICAgIGhlaWdodCA9ICQod2luZG93KS5oZWlnaHQoKTtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5yZW1vdmVBdHRyKCdzdHlsZScpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgIGxheW91dHIuc2hvd1BvcHVwQWxlcnQoJ0ZhaWxlZCB0byBsb2FkIGZvY3VzJywgJ2RhbmdlcicpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLnNob3dGb2N1cyA9ICgpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1hdXRoZW50aWNhdGlvbicsICcnKTtcclxuICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1mb2N1cycsIHRydWUpO1xyXG4gICAgICAgIGxheW91dHIuZm9jdXMuZm9jdXMoKTtcclxuICAgIH07XHJcbiAgICBsYXlvdXRyLmhpZGVGb2N1cyA9ICgpID0+IHtcclxuICAgICAgICBsZXQgc2Nyb2xsVG9wID0gbGF5b3V0ci5zY3JvbGxUb3AoKTtcclxuICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS1mb2N1cycsIGZhbHNlKTtcclxuICAgICAgICBsYXlvdXRyLm1haW4uZm9jdXMoKTtcclxuICAgICAgICBsYXlvdXRyLmJvZHkuc2Nyb2xsVG9wKHNjcm9sbFRvcCk7IC8vIGVkZ2UsIHNhZmFyaVxyXG4gICAgICAgIGxheW91dHIuaHRtbC5zY3JvbGxUb3Aoc2Nyb2xsVG9wKTsgLy8gY2hyb21lLCBmaXJlZm94LCBpZVxyXG4gICAgfTtcclxufSIsIntcclxuICAgIGxheW91dHIuZW5hYmxlU3dpcGUgPSAoKSA9PiB7XHJcbiAgICAgICAgaWYgKGJvd3Nlci5hbmRyb2lkKSB7XHJcbiAgICAgICAgICAgIGxldCB4RG93biA9IG51bGwsXHJcbiAgICAgICAgICAgICAgICB5RG93biA9IG51bGwsXHJcbiAgICAgICAgICAgICAgICBvZmZzZXRCZWZvcmU7XHJcblxyXG4gICAgICAgICAgICBsZXQgaGFuZGxlVG91Y2hTdGFydCA9IChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ci5pc1N3aXBlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICB4RG93biA9IGUudG91Y2hlc1swXS5jbGllbnRYO1xyXG4gICAgICAgICAgICAgICAgICAgIHlEb3duID0gZS50b3VjaGVzWzBdLmNsaWVudFk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIG9mZnNldEJlZm9yZSA9ICQoZS50YXJnZXQpLm9mZnNldCgpLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBsZXQgaGFuZGxlVG91Y2hNb3ZlID0gKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChsYXlvdXRyLmlzU3dpcGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvZmZzZXRBZnRlciA9ICQoZS50YXJnZXQpLm9mZnNldCgpLmxlZnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCF4RG93biB8fCAheURvd24gfHwgb2Zmc2V0QmVmb3JlICE9PSBvZmZzZXRBZnRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGxldCB4VXAgPSBlLmNoYW5nZWRUb3VjaGVzWzBdLmNsaWVudFgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHlVcCA9IGUuY2hhbmdlZFRvdWNoZXNbMF0uY2xpZW50WSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeERpZmYgPSB4RG93biAtIHhVcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgeURpZmYgPSB5RG93biAtIHlVcDtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoTWF0aC5hYnMoeERpZmYpID4gTWF0aC5hYnMoeURpZmYpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBkaXN0YW5jZSA9IHBhcnNlSW50KCQod2luZG93KS53aWR0aCgpIC8gMik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh5RGlmZiA+IC0xMDAgfHwgeURpZmYgPCAxMDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjdXJyZW50QXNpZGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoeERpZmYgPiBkaXN0YW5jZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8qIGxlZnQgc3dpcGUgKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxheW91dHIuaXNNb2RhbCgpICYmICFsYXlvdXRyLmlzTG9hZGluZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBc2lkZSA9IGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50QXNpZGUgPT09ICdsZWZ0JyAmJiBjdXJyZW50QXNpZGUgIT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIudG9nZ2xlQXNpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50QXNpZGUgIT09ICdyaWdodCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIudG9nZ2xlQXNpZGUoJ3JpZ2h0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHhEaWZmIDwgLWRpc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLyogcmlnaHQgc3dpcGUgKi9cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxheW91dHIuaXNNb2RhbCgpICYmICFsYXlvdXRyLmlzTG9hZGluZygpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRBc2lkZSA9IGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLWFzaWRlJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjdXJyZW50QXNpZGUgPT09ICdyaWdodCcgJiYgY3VycmVudEFzaWRlICE9PSAnbGVmdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIudG9nZ2xlQXNpZGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjdXJyZW50QXNpZGUgIT09ICdsZWZ0Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci50b2dnbGVBc2lkZSgnbGVmdCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAvKiByZXNldCB2YWx1ZXMgKi9cclxuICAgICAgICAgICAgICAgICAgICB4RG93biA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgeURvd24gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgaGFuZGxlVG91Y2hTdGFydCwgZmFsc2UpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIGhhbmRsZVRvdWNoTW92ZSwgZmFsc2UpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmNsZWFyU2VsZWN0aW9uID0gKCkgPT4ge1xyXG4gICAgICAgIGxldCBzZWxlY3Rpb24gPSB3aW5kb3cuZ2V0U2VsZWN0aW9uKCk7XHJcbiAgICAgICAgc2VsZWN0aW9uLnJlbW92ZUFsbFJhbmdlcygpO1xyXG4gICAgICAgIHNlbGVjdGlvbi5hZGRSYW5nZShkb2N1bWVudC5jcmVhdGVSYW5nZSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBsYXlvdXRyLnN0b3BUVFMgPSAoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgIGlmIChsYXlvdXRyLnR0cyAmJiBsYXlvdXRyLnR0cy5Jc1NwZWFraW5nKCkpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci50dHMuU2h1dFVwKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmVuYWJsZVRUUyA9ICgpID0+IHtcclxuICAgICAgICBpZiAoYm93c2VyLmRlc2t0b3AgJiYgIWJvd3Nlci5tc2llKSB7XHJcbiAgICAgICAgICAgIGxldCBzbmFwU2VsZWN0aW9uVG9Xb3JkID0gKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHNlbGVjdGlvbiA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIGlmICghc2VsZWN0aW9uLmlzQ29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJhbmdlID0gc2VsZWN0aW9uLmdldFJhbmdlQXQoMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHJhbmdlLmNvbGxhcHNlZCB8fCByYW5nZS50b1N0cmluZygpLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3QgZnVsbCBzdGFydCB3b3JkXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHdoaWxlIChyYW5nZS5zdGFydE9mZnNldCA+IDAgJiYgcmFuZ2UudG9TdHJpbmcoKVswXS5tYXRjaCgvW15cXHNdLykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJhbmdlLnNldFN0YXJ0KHJhbmdlLnN0YXJ0Q29udGFpbmVyLCByYW5nZS5zdGFydE9mZnNldCAtIDEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBzcGFjZSBhcyBmaXJzdCBzZWxlY3RlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgc3RhcnQgPSByYW5nZS5zdGFydENvbnRhaW5lci5kYXRhLnN1YnN0cmluZyhyYW5nZS5zdGFydE9mZnNldCkuY2hhckF0KDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQgPT09ICcgJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0U3RhcnQocmFuZ2Uuc3RhcnRDb250YWluZXIsIHJhbmdlLnN0YXJ0T2Zmc2V0ICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VsZWN0IGZ1bGwgZW5kIHdvcmRcclxuICAgICAgICAgICAgICAgICAgICAgICAgd2hpbGUgKHJhbmdlLmVuZE9mZnNldCA8IHJhbmdlLmVuZENvbnRhaW5lci5sZW5ndGggJiYgcmFuZ2UudG9TdHJpbmcoKVtyYW5nZS50b1N0cmluZygpLmxlbmd0aCAtIDFdLm1hdGNoKC9bXlxcc10vKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmFuZ2Uuc2V0RW5kKHJhbmdlLmVuZENvbnRhaW5lciwgcmFuZ2UuZW5kT2Zmc2V0ICsgMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHNwYWNlIGFzIGxhc3Qgc2VsZWN0ZWRcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVuZCA9IHJhbmdlLmVuZENvbnRhaW5lci5kYXRhLnN1YnN0cmluZygwLCByYW5nZS5lbmRPZmZzZXQpLnNsaWNlKC0xKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVuZCA9PT0gJyAnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByYW5nZS5zZXRFbmQocmFuZ2UuZW5kQ29udGFpbmVyLCByYW5nZS5lbmRPZmZzZXQgLSAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24ucmVtb3ZlQWxsUmFuZ2VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0aW9uLmFkZFJhbmdlKHJhbmdlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBzZWxlY3Rpb247XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGxldCBnZXRUZXh0ID0gKG5vZGUsIHNlbGVjdGlvbikgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRleHQgPSBbXSxcclxuICAgICAgICAgICAgICAgICAgICBub25XaGl0ZXNwYWNlTWF0Y2hlciA9IC9cXFMvLFxyXG4gICAgICAgICAgICAgICAgICAgIGdldFRleHROb2RlcyA9IChub2RlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSAkKG5vZGUucGFyZW50Tm9kZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjaWFsID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0aW9uLmNvbnRhaW5zTm9kZShub2RlLCBmYWxzZSkgJiYgKG5vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2lucHV0JyB8fFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpID09PSAndGV4dGFyZWEnKSAmJiBub25XaGl0ZXNwYWNlTWF0Y2hlci50ZXN0KG5vZGUudmFsdWUpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzcGVjaWFsID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzcGVjaWFsICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3Rpb24uY29udGFpbnNOb2RlKG5vZGUsIHRydWUpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlLm5vZGVUeXBlID09PSAzICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub25XaGl0ZXNwYWNlTWF0Y2hlci50ZXN0KG5vZGUubm9kZVZhbHVlKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFyZW50LmlzKCc6dmlzaWJsZScpICYmXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJlbnQuY3NzKCd1c2VyLXNlbGVjdCcpICE9PSAnbm9uZScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhcmVudC5wYXJlbnRzKCkuY3NzKCd1c2VyLXNlbGVjdCcpICE9PSAnbm9uZScgJiZcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS50YWdOYW1lICE9PSAnU0NSSVBUJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghKHNlbGVjdGlvbi5leHRlbnROb2RlLm5vZGVUeXBlICE9PSAzICYmICQoc2VsZWN0aW9uLmV4dGVudE5vZGUpLmlzKHBhcmVudCkpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFub2RlLm5vZGVWYWx1ZS5tYXRjaCgvXFwuXFxzKiQvKSAmJiBub2RlLm5leHRFbGVtZW50U2libGluZyA9PT0gbnVsbCAmJiBwYXJlbnQuaXMoJ2gxIHNwYW4sIGgxLCBoMiwgaDMsIGg0LCBoNSwgaDYsIHAsIHRoLCB0ZCwgLmRhdGFUYWJsZSB0aCBzcGFuJykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5wdXNoKG5vZGUubm9kZVZhbHVlICsgJy4gJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dC5wdXNoKG5vZGUubm9kZVZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGV4dC5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJChzZWxlY3Rpb24uYW5jaG9yTm9kZSkuaXMoc2VsZWN0aW9uLmZvY3VzTm9kZSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFswXSA9IHRleHRbMF0uc3Vic3RyaW5nKDAsIHNlbGVjdGlvbi5mb2N1c09mZnNldCkuc3Vic3RyaW5nKHNlbGVjdGlvbi5iYXNlT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0WzBdID0gdGV4dFswXS5zdWJzdHJpbmcoc2VsZWN0aW9uLmJhc2VPZmZzZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGV4dFswXSA9PT0gJy4gJyB8fCB0ZXh0WzBdID09PSAnICcpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dFswXSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbm9kZS5jaGlsZE5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0VGV4dE5vZGVzKG5vZGUuY2hpbGROb2Rlc1tpXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgZ2V0VGV4dE5vZGVzKG5vZGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoICYmIHRleHQubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHRbdGV4dC5sZW5ndGggLSAxXSA9IHRleHRbdGV4dC5sZW5ndGggLSAxXS5zdWJzdHJpbmcoMCwgc2VsZWN0aW9uLmZvY3VzT2Zmc2V0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHRleHQgPSB0ZXh0LmpvaW4oJyAnKS5yZXBsYWNlKC8oPzpcXHJcXG58XFxyfFxcbikvZywgJyAnKS5yZXBsYWNlKC8gK1xcLi9nLCAnLiAnKS5yZXBsYWNlKC9cXHNcXHMrL2csICcgJykucmVwbGFjZSgnLC4nLCAnLicpLnRyaW0oKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiB0ZXh0O1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIWxheW91dHIuaHRtbC5oYXNDbGFzcygndHRzLWxvYWRlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLlByb21pc2VUVFMgPSBsYXlvdXRyLmxvYWQuanMoJ2Rpc3QvanMvdHRzLmpzJykuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ3R0cy1sb2FkZWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsYXlvdXRyLlByb21pc2VUVFMudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgYXdzQ3JlZGVudGlhbHMgPSBuZXcgQVdTLkNyZWRlbnRpYWxzKCdBS0lBSTVKTUNWQlo0Q1dTU09PUScsICdGTTdqOUZiUUxrVVU4dTN0SFNjdjBJT0c0SW9heVVrcC9STk5OTm5pJyksXHJcbiAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3MgPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3c0NyZWRlbnRpYWxzOiBhd3NDcmVkZW50aWFscyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdzUmVnaW9uOiAnZXUtY2VudHJhbC0xJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcG9sbHlWb2ljZUlkOiAnUnVzc2VsbCdcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgIGxheW91dHIudHRzID0gQ2hhdHR5S2F0aHkoc2V0dGluZ3MpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLXR0cycsIHRydWUpO1xyXG5cclxuICAgICAgICAgICAgICAgICQod2luZG93KS5vbignbW91c2Vkb3duIHRvdWNoc3RhcnQnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghbGF5b3V0ci5pc0xvYWRpbmcoKSAmJiAhbGF5b3V0ci5pc0ZvY3VzKCkgJiYgbGF5b3V0ci5pc1RUUygpICYmIGxheW91dHIuaXNUVFNFbmFibGVkKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICQod2luZG93KS5vbignbW91c2V1cCB0b3VjaGVuZCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCEkKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLmlzKCdpbnB1dCwgdGV4dGFyZWEsIGJ1dHRvbiwgc2VsZWN0LCAuZHJvcGRvd24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxheW91dHIuaXNMb2FkaW5nKCkgJiYgIWxheW91dHIuaXNGb2N1cygpICYmIGxheW91dHIuaXNUVFMoKSAmJiBsYXlvdXRyLmlzVFRTRW5hYmxlZCgpICYmIGUub3JpZ2luYWxFdmVudC5kZXRhaWwgPCAzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0aW9uID0gc25hcFNlbGVjdGlvblRvV29yZCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gZ2V0VGV4dChzZWxlY3Rpb24uZ2V0UmFuZ2VBdCgwKS5jb21tb25BbmNlc3RvckNvbnRhaW5lciwgc2VsZWN0aW9uKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIudHRzLlNwZWFrV2l0aFByb21pc2UodGV4dCkudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmNsZWFyU2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuc3RvcFRUUygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5oZWFkZXIuZmluZCgnLnR0cycpLmNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobGF5b3V0ci5odG1sLmF0dHIoJ2RhdGEtdHRzJykgPT09ICd0cnVlJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYXR0cignZGF0YS10dHMnLCBmYWxzZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuc3RvcFRUUygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hdHRyKCdkYXRhLXR0cycsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dQb3B1cEFsZXJ0KCdGYWlsZWQgdG8gbG9hZCB0dHMnLCAnZGFuZ2VyJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0iLCJ7XHJcbiAgICAkKCgpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmh0bWwub24oJ21vZGVsLWNoZWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY29udGVudEhlYWRlciA9IGxheW91dHIuY29udGVudC5jaGlsZHJlbignLmNvbnRlbnQtaGVhZGVyOm5vdCguZnVsbCknKTtcclxuICAgICAgICAgICAgaWYgKGNvbnRlbnRIZWFkZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAobGF5b3V0ci5pc01vZGFsKCkgJiYgY29udGVudEhlYWRlci5jc3MoJ3Bvc2l0aW9uJykgPT09ICdmaXhlZCcpIHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgaGFsZk92ZXJmbG93WSA9IGxheW91dHIuc2Nyb2xsYmFyV2lkdGggLyAyO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnRIZWFkZXIuY2hpbGRyZW4oKS5jc3MoJ3dpZHRoJywgJ2NhbGMoMTAwJSAtICcgKyBoYWxmT3ZlcmZsb3dZICsgJ3B4KScpO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50SGVhZGVyLmNoaWxkcmVuKCkuY3NzKCd3aWR0aCcsICcnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmxvYWRUaGVtZSA9IChpZCkgPT4ge1xyXG4gICAgICAgIGxldCBzdHlsZXNoZWV0ID0gbGF5b3V0ci5oZWFkLmNoaWxkcmVuKCdsaW5rW3JlbD1cInN0eWxlc2hlZXRcIl1baHJlZl49XCInICsgbGF5b3V0ci5ob3N0ICsgJ2Rpc3QvY3NzL3RoZW1lL1wiXScpLFxyXG4gICAgICAgICAgICBocmVmMSA9IHN0eWxlc2hlZXQuYXR0cignaHJlZicpLFxyXG4gICAgICAgICAgICBzcGxpdDEgPSBocmVmMS5zcGxpdCgnLycpLFxyXG4gICAgICAgICAgICBzcGxpdDIgPSBzcGxpdDFbc3BsaXQxLmxlbmd0aCAtIDFdLnNwbGl0KCcuJyk7XHJcbiAgICAgICAgbGV0IGhyZWYyID0gW107XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzcGxpdDEubGVuZ3RoIC0gMTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGhyZWYyLnB1c2goc3BsaXQxW2ldICsgJy8nKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHRoZW1lID0gaWQuc3Vic3RyaW5nKGlkLmluZGV4T2YoXCItXCIpICsgMSk7XHJcbiAgICAgICAgaHJlZjIucHVzaCh0aGVtZSk7XHJcblxyXG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc3BsaXQyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGhyZWYyLnB1c2goJy4nICsgc3BsaXQyW2ldKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaHJlZjIgPSBocmVmMi5qb2luKFwiXCIpO1xyXG4gICAgICAgIGlmIChocmVmMSAhPT0gaHJlZjIpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5zaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLmxvYWQuY3NzKGhyZWYyKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIHN0eWxlc2hlZXQucmVtb3ZlKClcclxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgdGhlbWUnLCAnZGFuZ2VyJyk7XHJcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLnNldE9ubGluZSA9ICgpID0+IHtcclxuICAgICAgICBsZXQgb25saW5lID0gbmF2aWdhdG9yLm9uTGluZTtcclxuXHJcbiAgICAgICAgbGF5b3V0ci5ib2R5LmZpbmQoJy5hbGVydFtkYXRhLXR5cGU9XCJjb25uZWN0ZWRcIl0nKS5yZW1vdmUoKTtcclxuICAgICAgICBpZiAob25saW5lKSB7XHJcbiAgICAgICAgICAgIGxheW91dHIuc2hvd1BvcHVwQWxlcnQoJ1lvdSBhcmUgb25saW5lJywgJ3N1Y2Nlc3MnLCAnYm90dG9tIHJpZ2h0JywgJ2Nvbm5lY3RlZCcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGxheW91dHIuc2hvd1BvcHVwQWxlcnQoJ1lvdSBhcmUgb2ZmbGluZScsICdkYW5nZXInLCAnYm90dG9tIHJpZ2h0JywgJ2Nvbm5lY3RlZCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAkKCgpID0+IHtcclxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignb25saW5lJywgbGF5b3V0ci5zZXRPbmxpbmUpO1xyXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdvZmZsaW5lJywgbGF5b3V0ci5zZXRPbmxpbmUpO1xyXG5cclxuICAgICAgICBpZiAoIW5hdmlnYXRvci5vbkxpbmUpIHtcclxuICAgICAgICAgICAgbGF5b3V0ci5zZXRPbmxpbmUoKTtcclxuICAgICAgICB9XHJcbiAgICB9KTtcclxufSIsIntcclxuICAgIGxheW91dHIuY2hlY2tEcm9wZG93biA9IChkcm9wZG93bnMpID0+IHtcclxuICAgICAgICBkcm9wZG93bnMuZWFjaCgoaSwgZSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgJHRoaXMgPSAkKGUpLFxyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSAkdGhpcy5jaGlsZHJlbignb3B0aW9uOnNlbGVjdGVkJyksXHJcbiAgICAgICAgICAgICAgICBodG1sID0gW10sXHJcbiAgICAgICAgICAgICAgICBhdHRyID0gJHRoaXMuYXR0cignY2xhc3MnKSxcclxuICAgICAgICAgICAgICAgIHRoZW1lID0gJycsXHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9ICR0aGlzLmF0dHIoJ2RhdGEtd2lkdGgnKTtcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkLmxlbmd0aCAhPT0gMSkge1xyXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSAkdGhpcy5jaGlsZHJlbigpLmZpcnN0KCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGNsYXNzPVwiZHJvcGRvd24nICtcclxuICAgICAgICAgICAgICAgICgkdGhpcy5oYXNDbGFzcygnbm90LWZpcnN0JykgPyAnIG5vdC1maXJzdCcgOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgKCR0aGlzLmhhc0NsYXNzKCdub3dyYXAnKSA/ICcgbm93cmFwJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAoJHRoaXMuaGFzQ2xhc3MoJ2NoZWNrJykgPyAnIGNoZWNrJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAoJHRoaXMuaGFzQ2xhc3MoJ2VsbGlwc2lzJykgPyAnIGVsbGlwc2lzJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAoJHRoaXMuaGFzQ2xhc3MoJ2FsaWduLWxlZnQnKSA/ICcgYWxpZ24tbGVmdCcgOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgKCR0aGlzLmhhc0NsYXNzKCdhbGlnbi1yaWdodCcpID8gJyBhbGlnbi1yaWdodCcgOiAnJykgK1xyXG4gICAgICAgICAgICAgICAgKCR0aGlzLmhhc0NsYXNzKCdkaXJlY3Rpb24tdXAnKSA/ICcgZGlyZWN0aW9uLXVwJyA6ICcnKSArXHJcbiAgICAgICAgICAgICAgICAnXCInICtcclxuICAgICAgICAgICAgICAgICh3aWR0aCAhPT0gdW5kZWZpbmVkID8gJyBzdHlsZT1cIndpZHRoOicgKyB3aWR0aCArICdweFwiJyA6ICcnKVxyXG4gICAgICAgICAgICAgICAgKyAnPiAnKTtcclxuXHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgYXR0ciAhPT0gdHlwZW9mIHVuZGVmaW5lZCAmJiBhdHRyICE9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgbGV0IHRlbXAgPSBhdHRyLnNwbGl0KCcgJyk7XHJcbiAgICAgICAgICAgICAgICB0ZW1wID0gJC5ncmVwKHRlbXAsIChpdGVtLCBpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLnRyaW0oKS5tYXRjaCgvXnRoZW1lLS8pO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBpZiAodGVtcC5sZW5ndGggPT09IDEpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGVtZSA9IHRlbXBbMF07XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IHRhYmluZGV4PVwiMFwiIGNsYXNzPVwiJyArIHRoZW1lICsgJ1wiPjxsYWJlbD4nICsgc2VsZWN0ZWQudGV4dCgpICsgJzwvbGFiZWw+PHN2ZyBmb2N1c2FibGU9XCJmYWxzZVwiPjx1c2UgeGxpbms6aHJlZj1cIiNzdmctYXJyb3dcIj48L3VzZT48L3N2Zz48L2Rpdj4nKTtcclxuICAgICAgICAgICAgaHRtbC5wdXNoKCc8dWwgY2xhc3M9XCInICsgdGhlbWUgKyAnXCI+Jyk7XHJcbiAgICAgICAgICAgICR0aGlzLmNoaWxkcmVuKCkuZWFjaCgoaSwgZSkgPT4geyAvKiAnOm5vdChbdmFsdWU9XCJcIl0pJyAqL1xyXG4gICAgICAgICAgICAgICAgbGV0ICR0aGF0ID0gJChlKSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0ID0gJHRoYXQudGV4dCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0ZXh0Lmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSAnJm5ic3A7JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICh0ZXh0LmluZGV4T2YoJyQkJykgPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAkdGhhdC5hdHRyKCdkYXRhLW1hdGgnLCB0ZXh0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goJzxsaSBkYXRhLWlkPVwiJyArICR0aGF0LnZhbCgpICsgJ1wiJyArICgkdGhhdC5pcygnOnNlbGVjdGVkJykgPyAnIGNsYXNzPVwic2VsZWN0ZWRcIicgOiAnJykgKyAnPjxkaXYgdGFiaW5kZXg9XCIwXCIgY2xhc3M9XCJ0aGVtZS1saWdodFwiPjxsYWJlbD4nICsgdGV4dCArICc8L2xhYmVsPjxzdmcgZm9jdXNhYmxlPVwiZmFsc2VcIj48dXNlIHhsaW5rOmhyZWY9XCIjc3ZnLWNoZWNrbWFya1wiPjwvdXNlPjwvc3ZnPjwvZGl2PjwvbGk+Jyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBodG1sLnB1c2goJzwvdWw+Jyk7XHJcbiAgICAgICAgICAgIGh0bWwucHVzaCgnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIGxldCBkcm9wZG93biA9IGh0bWwuam9pbihcIlwiKTtcclxuICAgICAgICAgICAgJHRoaXMuYWZ0ZXIoZHJvcGRvd24pO1xyXG4gICAgICAgICAgICBkcm9wZG93biA9ICR0aGlzLm5leHQoKTtcclxuXHJcblxyXG4gICAgICAgICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ25vd3JhcCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgdG9wID0gZHJvcGRvd24uY2hpbGRyZW4oKS5lcSgwKSxcclxuICAgICAgICAgICAgICAgICAgICBib3R0b20gPSBkcm9wZG93bi5jaGlsZHJlbigpLmVxKDEpLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvcFdpZHRoID0gdG9wLndpZHRoKCksXHJcbiAgICAgICAgICAgICAgICAgICAgYm90dG9tV2lkdGggPSBib3R0b20ud2lkdGgoKTtcclxuICAgICAgICAgICAgICAgIGlmIChib3R0b21XaWR0aCA+IHRvcFdpZHRoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wLmNzcygnbWluLXdpZHRoJywgYm90dG9tV2lkdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBkcm9wZG93bi5vbignY2xpY2snLCAnPiBkaXYnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0ICR0aGF0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgJHRoYXQucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ29wZW4nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGRyb3Bkb3duLm9uKCdjbGljaycsICdsaScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsZXQgJHRoYXQgPSAkKGUuY3VycmVudFRhcmdldCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoISR0aGF0Lmhhc0NsYXNzKCdzZWxlY3RlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHRoYXQuc2libGluZ3MoJy5zZWxlY3RlZCcpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGF0LmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBvcHRpb24gPSAkdGhpcy5jaGlsZHJlbignW3ZhbHVlPVwiJyArICR0aGF0LmF0dHIoJ2RhdGEtaWQnKSArICdcIl0nKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGV4dCA9ICR0aGF0LnRleHQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0aCA9IG9wdGlvbi5hdHRyKCdkYXRhLW1hdGgnKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWF0aCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSBtYXRoO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBsZXQgbGFiZWwgPSBkcm9wZG93bi5jaGlsZHJlbignZGl2JykuY2hpbGRyZW4oJ2xhYmVsJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGFiZWwudGV4dCh0ZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAobWF0aCAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbmRlck1hdGhJbkVsZW1lbnQobGFiZWxbMF0pO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5jaGlsZHJlbignOnNlbGVjdGVkJykucmVtb3ZlQXR0cignc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb24uYXR0cignc2VsZWN0ZWQnLCAnc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5jaGFuZ2UoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duLnJlbW92ZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfTtcclxuXHJcbiAgICAkKHdpbmRvdykuY2xpY2soKGUpID0+IHtcclxuICAgICAgICBsZXQgdGFyZ2V0ID0gJChlLnRhcmdldCk7XHJcbiAgICAgICAgaWYgKHRhcmdldC5jbG9zZXN0KFwiZGl2LmRyb3Bkb3duXCIpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAkKCdkaXYuZHJvcGRvd24nKS5ub3QodGFyZ2V0LmNsb3Nlc3QoXCJkaXYuZHJvcGRvd25cIikpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXRhcmdldC5jbG9zZXN0KFwiLmRyb3Bkb3duXCIpLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAkKCdkaXYuZHJvcGRvd24nKS5yZW1vdmVDbGFzcygnb3BlbicpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59Iiwie1xyXG4gICAgbGF5b3V0ci5jaGVja0FjY29yZGlvbiA9IChlbGVtZW50cykgPT4ge1xyXG4gICAgICAgIGVsZW1lbnRzLm9uKFwiY2xpY2tcIiwgXCIuaGVhZGxpbmVcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgbGV0IGNvbnRlbnQgPSAkKGUuY3VycmVudFRhcmdldCkubmV4dCgpO1xyXG4gICAgICAgICAgICBpZiAoY29udGVudC5oYXNDbGFzcygnb3BlbicpKSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50XHJcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKCdvcGVuJylcclxuICAgICAgICAgICAgICAgICAgICAuc2xpZGVVcChcIjgwMFwiKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGNvbnRlbnRcclxuICAgICAgICAgICAgICAgICAgICAuYWRkQ2xhc3MoXCJvcGVuXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNsaWRlVG9nZ2xlKFwiODAwXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLnBhcmVudHMoJy5hY2NvcmRpb24nKS5maW5kKFwiLmNvbnRlbnQub3BlblwiKS5ub3QoY29udGVudCkucmVtb3ZlQ2xhc3MoJ29wZW4nKS5zbGlkZVVwKFwiODAwXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgdmFyIGNsb3NlQWxlcnQgPSAodGFyZ2V0KSA9PiB7XHJcbiAgICAgICAgdGFyZ2V0LmZhZGVPdXQobGF5b3V0ci5mYWRlT3V0VGltZSwgKCkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgcGFyZW50ID0gdGFyZ2V0LnBhcmVudCgpO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50Lmhhc0NsYXNzKCdwb3B1cCcpICYmIHBhcmVudC5jaGlsZHJlbigpLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcGFyZW50LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGFyZ2V0LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgJCgoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5ib2R5Lm9uKCdjbGljaycsICcuYWxlcnQgLmNsb3NlJywgKGUpID0+IHtcclxuICAgICAgICAgICAgbGV0IHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KS5wYXJlbnQoKTtcclxuICAgICAgICAgICAgY2xvc2VBbGVydCh0YXJnZXQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmNoZWNrTWFwID0gKG1hcHMpID0+IHtcclxuICAgICAgICBsYXlvdXRyLmhlYWQuZmluZCgnc2NyaXB0W3NyY149XCJodHRwczovL21hcHMuZ29vZ2xlYXBpcy5jb20vbWFwcy1hcGktXCJdJykucmVtb3ZlKCk7XHJcbiAgICAgICAgaWYgKG1hcHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmICghbGF5b3V0ci5odG1sLmhhc0NsYXNzKCdtYXAtbG9hZGVkJykpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIucHJvbWlzZU1hcCA9IGxheW91dHIubG9hZC5qcygnaHR0cHM6Ly9tYXBzLmdvb2dsZWFwaXMuY29tL21hcHMvYXBpL2pzP2tleT1BSXphU3lCRWNvbURqUlM0TnUzUlFDa2tTSVEwbnJCaHVRTTBnbmcnKS5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hZGRDbGFzcygnbWFwLWxvYWRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsYXlvdXRyLnByb21pc2VNYXAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBtYXBzLmVhY2goKGksIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgJHRoaXMgPSAkKGUpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsYXQgPSBsYXlvdXRyLnRyeVBhcnNlRmxvYXQoJHRoaXMuYXR0cignZGF0YS1sYXQnKSwgMzcuNDAyOTkzNyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxuZyA9IGxheW91dHIudHJ5UGFyc2VGbG9hdCgkdGhpcy5hdHRyKCdkYXRhLWxuZycpLCAtMTIyLjE4MTE3OTMpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB6b29tID0gbGF5b3V0ci50cnlQYXJzZUludCgkdGhpcy5hdHRyKCdkYXRhLXpvb20nKSwgNCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvcmRzID0geyBsYXQ6IGxhdCwgbG5nOiBsbmcgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoJHRoaXNbMF0sIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogem9vbSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2VudGVyOiBjb3Jkc1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBjb3JkcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWFwOiBtYXBcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLmJpbmQoJ3Jlc2l6ZS5tYXAnLCAkLnRocm90dGxlKGxheW91dHIudGhyb3R0bGVJbnRlcnZhbCwgZmFsc2UsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkdGhpc1swXSwgJ3Jlc2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLm9uKCdhc2lkZS1jaGFuZ2VkLm1hcCcsICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQudHJpZ2dlcigkdGhpc1swXSwgJ3Jlc2l6ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgbWFwcycsICdkYW5nZXInKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgJCh3aW5kb3cpLnVuYmluZCgncmVzaXplLm1hcCcpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwub2ZmKCdhc2lkZS1jaGFuZ2VkLm1hcCcpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmNoZWNrTWF0aCA9IChtYXRoKSA9PiB7XHJcbiAgICAgICAgaWYgKG1hdGgubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGlmICghbGF5b3V0ci5odG1sLmhhc0NsYXNzKCdtYXRoLWxvYWRlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnByb21pc2VNYXRoID0gUHJvbWlzZS5hbGwoW1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIubG9hZC5jc3MoJ2Rpc3QvY3NzL2thdGV4LmNzcycpLFxyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIubG9hZC5qcygnZGlzdC9qcy9rYXRleC5qcycpXHJcbiAgICAgICAgICAgICAgICBdKS5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmhpZGVMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5hZGRDbGFzcygnbWF0aC1sb2FkZWQnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGF5b3V0ci5wcm9taXNlTWF0aC50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIG1hdGguZWFjaCgoaSwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCAkdGhpcyA9ICQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyTWF0aEluRWxlbWVudCgkdGhpc1swXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKCdtYXRoJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgbWF0aCcsICdkYW5nZXInKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSIsIntcclxuICAgIGxheW91dHIuY2hlY2tNZWRpYSA9IChtZWRpYSkgPT4ge1xyXG4gICAgICAgIGlmIChtZWRpYS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKCFsYXlvdXRyLmh0bWwuaGFzQ2xhc3MoJ21lZGlhLWxvYWRlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnByb21pc2VNZWRpYSA9IFByb21pc2UuYWxsKFtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmxvYWQuY3NzKCdkaXN0L2Nzcy9wbHlyLmNzcycpLFxyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIubG9hZC5qcygnZGlzdC9qcy9wbHlyLmpzJylcclxuICAgICAgICAgICAgICAgIF0pLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCdtZWRpYS1sb2FkZWQnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGF5b3V0ci5wcm9taXNlTWVkaWEudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBtZWRpYS5lYWNoKChpLCBpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmV3IFBseXIoaXRlbSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgbWVkaWEnLCAnZGFuZ2VyJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0iLCJ7XHJcbiAgICBsYXlvdXRyLmNoZWNrTGF6eSA9IChlbGVtZW50cykgPT4ge1xyXG4gICAgICAgIGVsZW1lbnRzLmxhenkoe1xyXG4gICAgICAgICAgICBhZnRlckxvYWQ6IChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdsYXp5Jyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH07XHJcbn07Iiwie1xyXG4gICAgJCgoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5ib2R5Lm9uKCdjbGljaycsICcuc2hvdy1wb3B1cC1hbGVydCcsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KSxcclxuICAgICAgICAgICAgICAgIHRpdGxlID0gJHRoaXMuYXR0cignZGF0YS1wb3B1cC10aXRsZScpLFxyXG4gICAgICAgICAgICAgICAgdGhlbWUgPSAkdGhpcy5hdHRyKCdkYXRhLXBvcHVwLXRoZW1lJyksXHJcbiAgICAgICAgICAgICAgICBwb3NpdGlvbiA9ICR0aGlzLmF0dHIoJ2RhdGEtcG9wdXAtcG9zaXRpb24nKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCh0aXRsZSwgdGhlbWUsIHBvc2l0aW9uKTtcclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGxheW91dHIuc2hvd1BvcHVwQWxlcnQgPSAodGl0bGUsIHRoZW1lID0gJ2xpZ2h0JywgcG9zaXRpb24gPSAndG9wIGxlZnQnLCB0eXBlID0gJ2RlZmF1bHQnKSA9PiB7XHJcbiAgICAgICAgaWYgKHRpdGxlICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgbGV0IGFsZXJ0ID0gW10sXHJcbiAgICAgICAgICAgICAgICBwb3B1cCA9IGxheW91dHIuYm9keS5jaGlsZHJlbignLnBvcHVwW2RhdGEtcG9zaXRpb249XCInICsgcG9zaXRpb24gKyAnXCJdJyk7XHJcbiAgICAgICAgICAgIGFsZXJ0LnB1c2goJzxkaXYgY2xhc3M9XCJhbGVydCB0aGVtZS0nICsgdGhlbWUgKyAnXCIgZGF0YS10eXBlPVwiJyArIHR5cGUgKyAnXCI+Jyk7XHJcbiAgICAgICAgICAgIGFsZXJ0LnB1c2goJzxkaXY+PHA+JyArIHRpdGxlICsgJzwvcD48L2Rpdj4nKTtcclxuICAgICAgICAgICAgYWxlcnQucHVzaCgnPGJ1dHRvbiBjbGFzcz1cImNsb3NlXCIgYXJpYS1sYWJlbD1cIkNsb3NlIHBvcHVwXCI+PHN2ZyBmb2N1c2FibGU9XCJmYWxzZVwiPjx1c2UgeGxpbms6aHJlZj1cIiNzdmctY2xvc2VcIj48L3VzZT48L3N2Zz48L2J1dHRvbj4nKTtcclxuICAgICAgICAgICAgYWxlcnQucHVzaCgnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgIGFsZXJ0ID0gYWxlcnQuam9pbignJyk7XHJcbiAgICAgICAgICAgIGlmIChwb3B1cC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIHBvcHVwLmFwcGVuZChhbGVydCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgaHRtbCA9IFtdO1xyXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8ZGl2IGNsYXNzPVwicG9wdXAgcG9zaXRpb24gJyArIHBvc2l0aW9uICsgJ1wiIGRhdGEtcG9zaXRpb249XCInICsgcG9zaXRpb24gKyAnXCI+Jyk7XHJcbiAgICAgICAgICAgICAgICBodG1sLnB1c2goYWxlcnQpO1xyXG4gICAgICAgICAgICAgICAgaHRtbC5wdXNoKCc8L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgIGh0bWwgPSBodG1sLmpvaW4oXCJcIik7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmJvZHkucHJlcGVuZChodG1sKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxufSIsIntcclxuICAgIGxheW91dHIuY2hlY2tSZXNwb25zaXZlQmFja2dyb3VuZCA9IChlbGVtZW50cykgPT4ge1xyXG4gICAgICAgIGxldCBzZXRSYiA9IChlbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBpbWFnZSA9IGVsZW1lbnQuYXR0cignZGF0YS1yYi1pbWFnZScpLFxyXG4gICAgICAgICAgICAgICAgZmlsZXR5cGUgPSBlbGVtZW50LmF0dHIoJ2RhdGEtcmItaW1hZ2UtZmlsZXR5cGUnKSxcclxuICAgICAgICAgICAgICAgIHNpemVzV2lkdGggPSBlbGVtZW50LmF0dHIoJ2RhdGEtcmItc2l6ZXMnKSxcclxuICAgICAgICAgICAgICAgIGN1cnJlbnQgPSBlbGVtZW50LmF0dHIoJ2RhdGEtcmItY3VycmVudCcpLFxyXG4gICAgICAgICAgICAgICAgYXNwZWN0UmF0aW8gPSBlbGVtZW50LmF0dHIoJ2RhdGEtcmItYXNwZWN0LXJhdGlvJyk7XHJcbiAgICAgICAgICAgIGlmIChpbWFnZSAhPT0gdW5kZWZpbmVkICYmIGltYWdlLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAgICAgZmlsZXR5cGUgIT09IHVuZGVmaW5lZCAmJiBmaWxldHlwZS5sZW5ndGggJiZcclxuICAgICAgICAgICAgICAgIHNpemVzV2lkdGggIT09IHVuZGVmaW5lZCAmJiBzaXplc1dpZHRoLmxlbmd0aCAmJlxyXG4gICAgICAgICAgICAgICAgYXNwZWN0UmF0aW8gIT09IHVuZGVmaW5lZCAmJiBhc3BlY3RSYXRpby5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgIGlmICgoZmlsZXR5cGUgPT09ICdqcGcnIHx8IGZpbGV0eXBlID09PSAnanBlZycgfHwgZmlsZXR5cGUgPT09ICdwbmcnKSAmJlxyXG4gICAgICAgICAgICAgICAgICAgIChhc3BlY3RSYXRpbyA9PT0gJzIxYnk5JyB8fCBhc3BlY3RSYXRpbyA9PT0gJzE2Ynk5JyB8fCBhc3BlY3RSYXRpbyA9PT0gJzRieTMnIHx8IGFzcGVjdFJhdGlvID09PSAnMWJ5MScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2l6ZXNXaWR0aCA9IHNpemVzV2lkdGgucmVwbGFjZSgvXFxzL2csICcnKS5zcGxpdCgnLCcpLnNvcnQoKGEsIGIpID0+IHsgcmV0dXJuIGEgLSBiOyB9KTtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgZ29hbFdpZHRoID0gZWxlbWVudC53aWR0aCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBnb2FsSGVpZ2h0ID0gZWxlbWVudC5oZWlnaHQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2xvc2VzdFdpZHRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0SGVpZ2h0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHRQZXJjZW50YWdlO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiBnZXRIZWlnaHRJblBlcmNlbnRhZ2UobnVtLCBhbW91bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bSAqIDEwMCAvIGFtb3VudDtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoYXNwZWN0UmF0aW8gPT09ICcyMWJ5OScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0UGVyY2VudGFnZSA9IGdldEhlaWdodEluUGVyY2VudGFnZSg5LCAyMSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhc3BlY3RSYXRpbyA9PT0gJzE2Ynk5Jykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHRQZXJjZW50YWdlID0gZ2V0SGVpZ2h0SW5QZXJjZW50YWdlKDksIDE2KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChhc3BlY3RSYXRpbyA9PT0gJzRieTMnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlaWdodFBlcmNlbnRhZ2UgPSBnZXRIZWlnaHRJblBlcmNlbnRhZ2UoMywgNCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoYXNwZWN0UmF0aW8gPT09ICcxYnkxJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHRQZXJjZW50YWdlID0gMTAwO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gZ2V0SGVpZ2h0SW5QaXhlbHMobnVtLCBhbW91bnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bSAqIGFtb3VudCAvIDEwMDtcclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAkLmVhY2goc2l6ZXNXaWR0aCwgKGksIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHdpZHRoID0gcGFyc2VJbnQoZSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQgPSBnZXRIZWlnaHRJblBpeGVscyhoZWlnaHRQZXJjZW50YWdlLCB3aWR0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjbG9zZXN0V2lkdGggPT09IHVuZGVmaW5lZCB8fCB3aWR0aCA8IGdvYWxXaWR0aCB8fCBjbG9zZXN0V2lkdGggPCBnb2FsV2lkdGggfHxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RIZWlnaHQgPT09IHVuZGVmaW5lZCB8fCBoZWlnaHQgPCBnb2FsSGVpZ2h0IHx8IGNsb3Nlc3RIZWlnaHQgPCBnb2FsSGVpZ2h0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZXN0V2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3Nlc3RIZWlnaHQgPSBoZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnQgIT09IHVuZGVmaW5lZCAmJiBjdXJyZW50Lmxlbmd0aCAmJiBwYXJzZUludChjdXJyZW50KSA8IGNsb3Nlc3RXaWR0aCB8fCBjdXJyZW50ID09PSB1bmRlZmluZWQgfHwgY3VycmVudC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNyYyA9IGltYWdlICsgJy0nICsgY2xvc2VzdFdpZHRoICsgJy4nICsgZmlsZXR5cGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIubG9hZC5pbWcoc3JjKS50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJywgJ3VybCgnICsgc3JjICsgJyknKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYXR0cignZGF0YS1yYi1jdXJyZW50JywgY2xvc2VzdFdpZHRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgcmVzcG9uc2l2ZSBiYWNrZ3JvdW5kIGltYWdlJywgJ2RhbmdlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgZWxlbWVudHMuZWFjaCgoaSwgZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGV0IGVsZW1lbnQgPSAkKGUpO1xyXG5cclxuICAgICAgICAgICAgICAgIHNldFJiKGVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgICQod2luZG93KS5vbigncmVzaXplLnJiJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHNldFJiKGVsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLm9uKCdjb2x1bW5zLWNoYW5nZWQucmInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0UmIoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwub24oJ2FzaWRlLWNoYW5nZWQucmInLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0UmIoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICQod2luZG93KS5vZmYoJ3Jlc2l6ZS5yYicpO1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwub2ZmKCdjb2x1bW5zLWNoYW5nZWQucmInKTtcclxuICAgICAgICAgICAgbGF5b3V0ci5odG1sLm9mZignYXNpZGUtY2hhbmdlZC5yYicpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgbGF5b3V0ci5jaGVja1Rvb2x0aXAgPSAodG9vbHRpcHMpID0+IHtcclxuICAgICAgICB0b29sdGlwcy5lYWNoKChpLCBlKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCAkdGhpcyA9ICQoZSksXHJcbiAgICAgICAgICAgICAgICBpbnRlcmFjdGl2ZSA9ICR0aGlzLmhhc0NsYXNzKCdpbnRlcmFjdGl2ZScpO1xyXG4gICAgICAgICAgICAkdGhpcy50b29sdGlwc3Rlcih7XHJcbiAgICAgICAgICAgICAgICBhbmltYXRpb25EdXJhdGlvbjogMCxcclxuICAgICAgICAgICAgICAgIGludGVyYWN0aXZlOiBpbnRlcmFjdGl2ZSxcclxuICAgICAgICAgICAgICAgIHRyaWdnZXI6ICdjdXN0b20nLFxyXG4gICAgICAgICAgICAgICAgdHJpZ2dlck9wZW46IHtcclxuICAgICAgICAgICAgICAgICAgICBtb3VzZWVudGVyOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRvdWNoc3RhcnQ6IHRydWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB0cmlnZ2VyQ2xvc2U6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb3VzZWxlYXZlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHRhcDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBzY3JvbGw6IHRydWVcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgbGF5b3V0ci5jaGVja0RhdGF0YWJsZSA9ICh0YWJsZXMpID0+IHtcclxuICAgICAgICBpZiAodGFibGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAoIWxheW91dHIuaHRtbC5oYXNDbGFzcygnZGF0YXRhYmxlcy1sb2FkZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93TG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5wcm9taXNlRGF0YXRhYmxlcyA9IGxheW91dHIubG9hZC5qcygnZGlzdC9qcy9kYXRhdGFibGVzLmpzJykuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ2RhdGF0YWJsZXMtbG9hZGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgbGF5b3V0ci5wcm9taXNlRGF0YXRhYmxlcy50aGVuKCgpID0+IHtcclxuICAgICAgICAgICAgICAgIGxldCBjb3VudCA9IDA7XHJcbiAgICAgICAgICAgICAgICBsZXQgc3BhY2luZyA9ICdzcGFjZS0zJztcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgdGFibGVfaGVhZGVyX2lucHV0ID0gZnVuY3Rpb24gKGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbnMgPSBpbnN0YW5jZS5jb2x1bW5zKCkuaGVhZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGVsZW1lbnRzID0galF1ZXJ5LmdyZXAoY29sdW1ucywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbiA9ICQoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW4uaGFzQ2xhc3MoJ2Ryb3Bkb3duJykgfHwgY29sdW1uLmhhc0NsYXNzKCd0ZXh0Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuY29sdW1ucygpLmV2ZXJ5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRoID0gdGhpcy5oZWFkZXIoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQgPSB0aC5pbm5lclRleHQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2x1bW4gPSAkKHRoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0eWxlID0gJyc7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1pbldpZHRoID0gY29sdW1uLmF0dHIoJ2RhdGEtbWluLXdpZHRoJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtaW5XaWR0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3R5bGUgKz0gJ21pbi13aWR0aDogJyArIG1pbldpZHRoICsgJ3B4Oyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbi5lbXB0eSgpLmFwcGVuZCgnPGRpdiBzdHlsZT1cIicgKyBzdHlsZSArICdcIj48ZGl2PjxzcGFuPicgKyB0ZXh0ICsgJzwvc3Bhbj48L2Rpdj4nICsgKGVsZW1lbnRzLmxlbmd0aCA/ICc8ZGl2PjwvZGl2PicgOiAnJykgKyAnPC9kaXY+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmRleCA9IGNvbHVtbi5pbmRleCgpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbHVtbi5oYXNDbGFzcygnZHJvcGRvd24nKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdCA9ICQoJzxzZWxlY3QgY2xhc3M9XCJkcm9wZG93biBhbGlnbi1sZWZ0IG5vd3JhcFwiPjxvcHRpb24gdmFsdWU9XCJcIj48L29wdGlvbj48L3NlbGVjdD4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb2x1bW4uZmluZCgnPiBkaXYgPiBkaXY6bGFzdC1jaGlsZCcpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbignY2hhbmdlJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuY29sdW1uKGluZGV4KS5zZWFyY2goZS5jdXJyZW50VGFyZ2V0LnZhbHVlKS5kcmF3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhKCkudW5pcXVlKCkuc29ydCgpLmVhY2goKGQsIGopID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3QuYXBwZW5kKCc8b3B0aW9uIHZhbHVlPVwiJyArIGQgKyAnXCI+JyArIGQgKyAnPC9vcHRpb24+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChjb2x1bW4uaGFzQ2xhc3MoJ3RleHQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGlucHV0ID0gJCgnPGlucHV0IHR5cGU9XCJ0ZXh0XCIgLz4nKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmRUbyhjb2x1bW4uZmluZCgnPiBkaXYgPiBkaXY6bGFzdC1jaGlsZCcpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5vbigna2V5dXAgY2hhbmdlJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuY29sdW1uKGluZGV4KS5zZWFyY2goZS5jdXJyZW50VGFyZ2V0LnZhbHVlKS5kcmF3KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbnB1dC5wYXJlbnQoKS5hZGRDbGFzcygnZm9ybS1ncm91cCcpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgdGFibGVfaGVhZGVyX3NvcnQgPSAoaW5zdGFuY2UsIHdyYXBwZXIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgdGggPSB3cmFwcGVyLmZpbmQoJ3RoZWFkIHRoJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgdGgudW5iaW5kKCdjbGljaycpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoLmZpbmQoJz4gZGl2ID4gZGl2OmZpcnN0LWNoaWxkJykuYXBwZW5kKCc8c3BhbiBjbGFzcz1cInNvcnQtYnRuXCI+PC9zcGFuPicpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoLmNsaWNrKChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCAkdGhpcyA9ICQoZS50YXJnZXQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoISR0aGlzLmNsb3Nlc3QoJ2Rpdi5kcm9wZG93bicpLmxlbmd0aCAmJiAhJHRoaXMuY2xvc2VzdCgnaW5wdXQnKS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBwYXJlbnQgPSAkdGhpcy5wYXJlbnRzKCd0aCcpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGV4ID0gcGFyZW50LmluZGV4KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Lmhhc0NsYXNzKCdzb3J0aW5nX2FzYycpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuY29sdW1uKGluZGV4KS5vcmRlcignZGVzYycpLmRyYXcoKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLmNvbHVtbihpbmRleCkub3JkZXIoJ2FzYycpLmRyYXcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHRhYmxlX2hlYWRlcl9sZW5ndGggPSAod3JhcHBlciwgaGVhZGVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGxlbmd0aCA9IHdyYXBwZXIuZmluZCgnLmRhdGFUYWJsZXNfbGVuZ3RoJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRyb3Bkb3duID0gbGVuZ3RoLmZpbmQoJ3NlbGVjdCcpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZW5ndGguYXBwZW5kKGRyb3Bkb3duKTtcclxuICAgICAgICAgICAgICAgICAgICBsZW5ndGguY2hpbGRyZW4oJ2xhYmVsJykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgZHJvcGRvd24uYWRkQ2xhc3MoJ2Ryb3Bkb3duJykuYXR0cignZGF0YS13aWR0aCcsIDEwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaGVhZGVyLmFwcGVuZChsZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHRhYmxlX2hlYWRlcl9idXR0b25zID0gKHdyYXBwZXIsIGhlYWRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSB3cmFwcGVyLmZpbmQoJy5kdC1idXR0b25zJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJmbGV4IGNvbHVtbiB3cmFwICcgKyBzcGFjaW5nICsgJ1wiPjwvZGl2PicpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBsZXQgZGl2ID0gY29udGFpbmVyLmNoaWxkcmVuKCdkaXYnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9ucyA9IGNvbnRhaW5lci5jaGlsZHJlbignYnV0dG9uJyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQoZGl2KTtcclxuICAgICAgICAgICAgICAgICAgICBidXR0b25zLmFkZENsYXNzKCdidG4nKTtcclxuICAgICAgICAgICAgICAgICAgICBkaXYuYXBwZW5kKGJ1dHRvbnMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlci5hcHBlbmQoY29udGFpbmVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxldCB0YWJsZV9oZWFkZXJfZmlsdGVyID0gKHdyYXBwZXIsIGhlYWRlcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBmaWx0ZXIgPSB3cmFwcGVyLmZpbmQoJy5kYXRhVGFibGVzX2ZpbHRlcicpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIuYWRkQ2xhc3MoJ2lucHV0LWdyb3VwJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsdGVyLmZpbmQoJ2lucHV0JykuYXBwZW5kVG8oZmlsdGVyKTtcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIuYXBwZW5kKCc8ZGl2IGNsYXNzPVwiaW5wdXQtZ3JvdXAtYWRkb25cIj48c3ZnIGZvY3VzYWJsZT1cImZhbHNlXCI+PHVzZSB4bGluazpocmVmPVwiI3N2Zy1zZWFyY2hcIj48L3VzZT48L3N2Zz48L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgICAgICBmaWx0ZXIuZmluZCgnbGFiZWwnKS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICBoZWFkZXIuYXBwZW5kKGZpbHRlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgdGFibGVfY29udGVudCA9ICh3cmFwcGVyLCBjb250ZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHRhYmxlID0gd3JhcHBlci5maW5kKCd0YWJsZScpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuYXBwZW5kKHRhYmxlKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGFibGU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgdGFibGVfZm9vdGVyX2luZm8gPSAod3JhcHBlciwgZm9vdGVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGluZm8gPSB3cmFwcGVyLmZpbmQoJy5kYXRhVGFibGVzX2luZm8nKTtcclxuICAgICAgICAgICAgICAgICAgICBmb290ZXIuYXBwZW5kKGluZm8pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHBhZ2luYXRlRml4ID0gKHBhZ2luYXRlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHNwYW4gPSBwYWdpbmF0ZS5jaGlsZHJlbignc3BhbicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwcmV2ID0gcGFnaW5hdGUuZmluZCgnLnBhZ2luYXRlX2J1dHRvbi5wcmV2aW91cycpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXh0ID0gcGFnaW5hdGUuZmluZCgnLnBhZ2luYXRlX2J1dHRvbi5uZXh0Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHByZXYuaHRtbCgnPHN2ZyBmb2N1c2FibGU9XCJmYWxzZVwiPjx1c2UgeGxpbms6aHJlZj1cIiNzdmctYXJyb3dcIj48L3VzZT48L3N2Zz4nKTtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0Lmh0bWwoJzxzdmcgZm9jdXNhYmxlPVwiZmFsc2VcIj48dXNlIHhsaW5rOmhyZWY9XCIjc3ZnLWFycm93XCI+PC91c2U+PC9zdmc+Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHByZXYucHJlcGVuZFRvKHNwYW4pO1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHQuYXBwZW5kVG8oc3Bhbik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsZXQgdGFibGVfZm9vdGVyX3BhZ2luYXRlID0gKHdyYXBwZXIsIGZvb3RlciwgcGFnaW5hdGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBwYWdpbmF0ZS5hZGRDbGFzcygnZmxleCBjb2x1bW4gd3JhcCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvb3Rlci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJkYXRhVGFibGVzX3BhZ2luYXRlX2NvbnRhaW5lclwiPjwvZGl2PicpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBmb290ZXIuZmluZCgnLmRhdGFUYWJsZXNfcGFnaW5hdGVfY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGVGaXgocGFnaW5hdGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hcHBlbmQocGFnaW5hdGUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgbGV0IHRhYmxlX2Ryb3Bkb3ducyA9ICh3cmFwcGVyKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IGRyb3Bkb3ducyA9IHdyYXBwZXIuZmluZCgnc2VsZWN0LmRyb3Bkb3duJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5jaGVja0Ryb3Bkb3duKGRyb3Bkb3ducyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdGFibGVzLmVhY2goKGksIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgJHRoaXMgPSAkKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICR0aGlzLmFkZENsYXNzKCdub3dyYXAnKTtcclxuICAgICAgICAgICAgICAgICAgICAkdGhpcy5EYXRhVGFibGUoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcImRvbVwiOiAnbEJmcnRpcCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiYlNvcnRDZWxsc1RvcFwiOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBidXR0b25zOiBbXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLydjb3B5JywgJ2V4Y2VsJywgJ2NzdidcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlbmQ6ICdjb3B5SHRtbDUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogZmFsc2VcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuZDogJ2V4Y2VsSHRtbDUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0T3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZvcm1hdFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICh0ZXh0LCBpbmRleCwgdGgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJCh0aCkuZmluZCgnc3BhbjpmaXJzdCcpLmh0bWwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5kOiAnY3N2SHRtbDUnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvb3RlcjogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhwb3J0T3B0aW9uczoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcImZvcm1hdFwiOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6ICh0ZXh0LCBpbmRleCwgdGgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJCh0aCkuZmluZCgnc3BhbjpmaXJzdCcpLmh0bWwoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgXSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzcG9uc2l2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaW5pdENvbXBsZXRlOiBmdW5jdGlvbiAoc2V0dGluZ3MsIGpzb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXMuYXBpKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlciA9ICQoc2V0dGluZ3MublRhYmxlV3JhcHBlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJkYXRhVGFibGVzX2hlYWRlciBmbGV4IGdyb3dcIj48ZGl2IGNsYXNzPVwiZmxleCBjb2x1bW4gd3JhcCAnICsgc3BhY2luZyArICdcIj48L2Rpdj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBoZWFkZXIgPSB3cmFwcGVyLmZpbmQoJz4gLmRhdGFUYWJsZXNfaGVhZGVyID4gZGl2Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoJzxkaXYgY2xhc3M9XCJkYXRhVGFibGVzX2NvbnRlbnQgdGFibGVcIj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250ZW50ID0gd3JhcHBlci5maW5kKCc+IC5kYXRhVGFibGVzX2NvbnRlbnQnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLmFwcGVuZCgnPGRpdiBjbGFzcz1cImRhdGFUYWJsZXNfZm9vdGVyXCI+PGRpdiBjbGFzcz1cImZsZXggY29sdW1uIHdyYXAgdmVydGljYWwtY2VudGVyICcgKyBzcGFjaW5nICsgJ1wiPjwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGZvb3RlciA9IHdyYXBwZXIuZmluZCgnPiAuZGF0YVRhYmxlc19mb290ZXIgPiBkaXYnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZV9oZWFkZXJfaW5wdXQoaW5zdGFuY2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVfaGVhZGVyX3NvcnQoaW5zdGFuY2UsIHdyYXBwZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVfaGVhZGVyX2xlbmd0aCh3cmFwcGVyLCBoZWFkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVfaGVhZGVyX2J1dHRvbnMod3JhcHBlciwgaGVhZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlX2hlYWRlcl9maWx0ZXIod3JhcHBlciwgaGVhZGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgdGFibGUgPSB0YWJsZV9jb250ZW50KHdyYXBwZXIsIGNvbnRlbnQpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlX2Zvb3Rlcl9pbmZvKHdyYXBwZXIsIGZvb3Rlcik7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHBhZ2luYXRlID0gd3JhcHBlci5maW5kKCcuZGF0YVRhYmxlc19wYWdpbmF0ZScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVfZm9vdGVyX3BhZ2luYXRlKHdyYXBwZXIsIGZvb3RlciwgcGFnaW5hdGUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlX2Ryb3Bkb3ducyh3cmFwcGVyKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50ID0gdGFibGVzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5vbignZHJhdy5kdCcsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdpbmF0ZUZpeChwYWdpbmF0ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbHVtbnMgPSBpbnN0YW5jZS5jb2x1bW5zKCkucmVzcG9uc2l2ZUhpZGRlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLnRyaWdnZXIoJ3Jlc3BvbnNpdmUtcmVzaXplLmR0JywgW3RoaXMsIGNvbHVtbnNdKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheW91dHIuaHRtbC5vbignYXNpZGUtY2hhbmdlZC5kYXRhdGFibGVzJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluc3RhbmNlLnJlc3BvbnNpdmUucmVjYWxjKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5vbigncmVzcG9uc2l2ZS1yZXNpemUuZHQnLCAoZSwgZGF0YXRhYmxlLCBjb2x1bW5zKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvdW50ID0gY29sdW1ucy5yZWR1Y2UoKGEsIGIpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGIgPT09IGZhbHNlID8gYSArIDEgOiBhO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZWxlbWVudHMgPSB0YWJsZS5maW5kKCd0Ym9keSB0cjpub3QoLmNoaWxkKSA+ICo6Zmlyc3QtY2hpbGQ6bm90KC5kYXRhVGFibGVzX2VtcHR5KScpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLnJlbW92ZUF0dHIoJ3RhYmluZGV4Jyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLmNoaWxkcmVuKCdpJykucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnRzLnByZXBlbmQoJzxpIHRhYmluZGV4PVwiMFwiPjxzdmcgZm9jdXNhYmxlPVwiZmFsc2VcIj48dXNlIHhsaW5rOmhyZWY9XCIjc3ZnLXBsdXNcIj48L3VzZT48L3N2Zz48c3ZnIGZvY3VzYWJsZT1cImZhbHNlXCI+PHVzZSB4bGluazpocmVmPVwiI3N2Zy1taW51c1wiPjwvdXNlPjwvc3ZnPjwvaT4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dQb3B1cEFsZXJ0KCdGYWlsZWQgdG8gbG9hZCBkYXRhdGFibGVzJywgJ2RhbmdlcicpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBsYXlvdXRyLmh0bWwub2ZmKCdhc2lkZS1jaGFuZ2VkLmRhdGF0YWJsZXMnKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgbGF5b3V0ci5jaGVja1N3aXBlciA9IChzd2lwZXIpID0+IHtcclxuICAgICAgICBpZiAoc3dpcGVyLmxlbmd0aCkge1xyXG4gICAgICAgICAgICBpZiAoIWxheW91dHIuaHRtbC5oYXNDbGFzcygnc3dpcGVyLWxvYWRlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnNob3dMb2FkaW5nKCk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLnByb21pc2VTd2lwZXIgPSBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5sb2FkLmNzcygnZGlzdC9jc3Mvc3dpcGVyLmNzcycpLFxyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIubG9hZC5qcygnZGlzdC9qcy9zd2lwZXIuanMnKVxyXG4gICAgICAgICAgICAgICAgXSkuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbGF5b3V0ci5oaWRlTG9hZGluZygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICBsYXlvdXRyLmh0bWwuYWRkQ2xhc3MoJ3N3aXBlci1sb2FkZWQnKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgbGF5b3V0ci5wcm9taXNlU3dpcGVyLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgc3dpcGVyLmVhY2goKGksIGUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBsZXQgJHRoaXMgPSAkKGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghJHRoaXMuaGFzQ2xhc3MoJ2xvYWRlZCcpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aGlzLmFwcGVuZCgnPGRpdiBjbGFzcz1cInN3aXBlci1mb290ZXJcIj48L2Rpdj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgJHRoaXMuY2hpbGRyZW4oJy5zd2lwZXItZm9vdGVyJykuYXBwZW5kKCc8ZGl2PjwvZGl2PicpXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZm9vdGVyID0gJHRoaXMuZmluZCgnPiAuc3dpcGVyLWZvb3RlciA+IGRpdicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbiA9ICR0aGlzLmhhc0NsYXNzKCdwYWdpbmF0aW9uJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkeW5hbWljQnVsbGV0cyA9ICR0aGlzLmhhc0NsYXNzKCdkeW5hbWljLWJ1bGxldHMnKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRpb24gPSAkdGhpcy5oYXNDbGFzcygnbmF2aWdhdGlvbicpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9vcCA9IGxheW91dHIuaXNUcnVlKCR0aGlzLmF0dHIoJ2RhdGEtbG9vcCcpKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYWNlQmV0d2VlbiA9ICR0aGlzLmhhc0NsYXNzKCdzcGFjZS1iZXR3ZWVuJyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZXNQZXJWaWV3ID0gbGF5b3V0ci50cnlQYXJzZUludCgkdGhpcy5hdHRyKCdkYXRhLXNsaWRlcy1wZXItdmlldycpLCAxKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRzID0gbGF5b3V0ci50cnlQYXJzZUpTT04oJHRoaXMuYXR0cignZGF0YS1icmVha3BvaW50cycpLCB7fSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmb290ZXIuYWRkQ2xhc3MoJ2ZsZXggY29sdW1uIHdyYXAgc3BhY2UtMyBjZW50ZXInKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYWdpbmF0aW9uIHx8IGR5bmFtaWNCdWxsZXRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb290ZXIuYXBwZW5kKCc8ZGl2IGNsYXNzPVwic3dpcGVyLXBhZ2luYXRpb25cIj48ZGl2IGNsYXNzPVwiZmxleCBjb2x1bW4gd3JhcCBzcGFjZS0xIGNlbnRlclwiPjwvZGl2PjwvZGl2PicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobmF2aWdhdGlvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9vdGVyLmFwcGVuZCgnPGJ1dHRvbiBjbGFzcz1cImJ0biBzcXVhcmUgY2lyY2xlIHByZXYgdGhlbWUtZGFya1wiPjxzdmcgZm9jdXNhYmxlPVwiZmFsc2VcIj48dXNlIHhsaW5rOmhyZWY9XCIjc3ZnLWFycm93XCI+PC91c2U+PC9zdmc+PC9idXR0b24+Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb290ZXIuYXBwZW5kKCc8YnV0dG9uIGNsYXNzPVwiYnRuIHNxdWFyZSBjaXJjbGUgbmV4dCB0aGVtZS1kYXJrXCI+PHN2ZyBmb2N1c2FibGU9XCJmYWxzZVwiPjx1c2UgeGxpbms6aHJlZj1cIiNzdmctYXJyb3dcIj48L3VzZT48L3N2Zz48L2J1dHRvbj4nKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNwYWNlQmV0d2Vlbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3BhY2VCZXR3ZWVuID0gMTY7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzd2lwZXIgPSBuZXcgU3dpcGVyKCR0aGlzWzBdLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb29wOiBsb29wLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzUGVyVmlldzogc2xpZGVzUGVyVmlldyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNwYWNlQmV0d2Vlbjogc3BhY2VCZXR3ZWVuLFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIElmIHdlIG5lZWQgcGFnaW5hdGlvblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFnaW5hdGlvbjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsOiAnLnN3aXBlci1wYWdpbmF0aW9uID4gZGl2JyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkeW5hbWljQnVsbGV0czogZHluYW1pY0J1bGxldHNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gTmF2aWdhdGlvbiBhcnJvd3NcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hdmlnYXRpb246IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXh0RWw6ICcuc3dpcGVyLWZvb3RlciAubmV4dCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJldkVsOiAnLnN3aXBlci1mb290ZXIgLnByZXYnLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBBbmQgaWYgd2UgbmVlZCBzY3JvbGxiYXJcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjcm9sbGJhcjoge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsOiAnLnN3aXBlci1zY3JvbGxiYXInLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrcG9pbnRzOiBicmVha3BvaW50cyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5pdDogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkdGhpcy5hZGRDbGFzcygnbG9hZGVkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZUNoYW5nZTogKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmNoZWNrTGF6eSgkdGhpcy5maW5kKCcubGF6eScpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2luYXRpb25SZW5kZXI6IChlbCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2lmIChuYXZpZ2F0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICQoZWwpLmFwcGVuZChmb290ZXIuY2hpbGRyZW4oJy5idG4nKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy99XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgc3dpcGVyJywgJ2RhbmdlcicpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59Iiwie1xyXG4gICAgbGF5b3V0ci5nZXRBc3NpZ25tZW50SXRlbSA9IChpdGVtcywgaWQpID0+IHtcclxuICAgICAgICByZXR1cm4gJCgkLm1hcChpdGVtcywgKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgaWYgKGl0ZW0uZ2V0QXR0cmlidXRlKFwiZGF0YS1pZFwiKSA9PT0gaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpdGVtO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfTtcclxuXHJcbiAgICBsYXlvdXRyLmNoZWNrQXNzaWdubWVudCA9IChhc3NpZ25tZW50cykgPT4ge1xyXG4gICAgICAgIGlmIChhc3NpZ25tZW50cy5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaWYgKCFsYXlvdXRyLmh0bWwuaGFzQ2xhc3MoJ2Fzc2lnbm1lbnQtbG9hZGVkJykpIHtcclxuICAgICAgICAgICAgICAgIGxheW91dHIuc2hvd0xvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIGxheW91dHIucHJvbWlzZUFzc2lnbm1lbnQgPSBsYXlvdXRyLmxvYWQuanMoJ2Rpc3QvanMvYXNzaWdubWVudC5qcycpLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuaGlkZUxvYWRpbmcoKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5odG1sLmFkZENsYXNzKCdhc3NpZ25tZW50LWxvYWRlZCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBsYXlvdXRyLnByb21pc2VBc3NpZ25tZW50LnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgJChhc3NpZ25tZW50cykuZWFjaCgoaSwgYXNzaWdubWVudCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGFzc2lnbm1lbnQgPSAkKGFzc2lnbm1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuY2hlY2tBc3NpZ25tZW50U29ydChhc3NpZ25tZW50KTtcclxuICAgICAgICAgICAgICAgICAgICBsYXlvdXRyLmNoZWNrQXNzaWdubWVudERyYWdBbmREcm9wKGFzc2lnbm1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGxheW91dHIuY2hlY2tBc3NpZ25tZW50Q29sb3IoYXNzaWdubWVudCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgbGF5b3V0ci5zaG93UG9wdXBBbGVydCgnRmFpbGVkIHRvIGxvYWQgYXNzaWdubWVudCcsICdkYW5nZXInKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSIsIntcclxuICAgIGxheW91dHIucGFnZUZvcm0gPSAoKSA9PiB7XHJcbiAgICAgICAgbGF5b3V0ci5hZGRWYWxpZGF0aW9uKFxyXG4gICAgICAgICAgICBsYXlvdXRyLmNvbnRlbnQuZmluZCgnI2Zvcm0nKSxcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgbWlubGVuZ3RoOiAyXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgbGFzdE5hbWU6IHtcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBtaW5sZW5ndGg6IDJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1pbmxlbmd0aDogMlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmRfcmVnZXg6IHRydWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBjb25maXJtX3Bhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZXF1YWxUbzogXCIjcGFzc3dvcmRcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVtYWlsOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW1haWw6IHRydWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bl8xOiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bl8yOiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bl8zOiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bl80OiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bl81OiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bl82OiBcInJlcXVpcmVkXCIsXHJcbiAgICAgICAgICAgICAgICBnZW5kZXI6IFwicmVxdWlyZWRcIixcclxuICAgICAgICAgICAgICAgIGludGVyZXN0czogXCJyZXF1aXJlZFwiLFxyXG4gICAgICAgICAgICAgICAgYWdyZWU6IFwicmVxdWlyZWRcIixcclxuICAgICAgICAgICAgICAgIGZvbnRfc2l6ZTogXCJyZXF1aXJlZFwiXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIGZpcnN0TmFtZToge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBcIlBsZWFzZSBlbnRlciB5b3VyIGZpcnN0IG5hbWVcIixcclxuICAgICAgICAgICAgICAgICAgICBtaW5sZW5ndGg6IFwiWW91ciBmaXJzdCBuYW1lIG11c3QgY29uc2lzdCBvZiBhdCBsZWFzdCAyIGNoYXJhY3RlcnNcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIHlvdXIgbGFzdCBuYW1lXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgbWlubGVuZ3RoOiBcIllvdXIgbGFzdCBuYW1lIG11c3QgY29uc2lzdCBvZiBhdCBsZWFzdCAyIGNoYXJhY3RlcnNcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHVzZXJuYW1lOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFwiUGxlYXNlIGVudGVyIGEgdXNlcm5hbWVcIixcclxuICAgICAgICAgICAgICAgICAgICBtaW5sZW5ndGg6IFwiWW91ciB1c2VybmFtZSBtdXN0IGNvbnNpc3Qgb2YgYXQgbGVhc3QgMiBjaGFyYWN0ZXJzXCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDoge1xyXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBcIlBsZWFzZSBwcm92aWRlIGEgcGFzc3dvcmRcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGNvbmZpcm1fcGFzc3dvcmQ6IHtcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogXCJQbGVhc2UgcHJvdmlkZSBhIHBhc3N3b3JkXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgZXF1YWxUbzogXCJQbGVhc2UgZW50ZXIgdGhlIHNhbWUgcGFzc3dvcmQgYXMgYWJvdmVcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVtYWlsOiBcIlBsZWFzZSBlbnRlciBhIHZhbGlkIGVtYWlsIGFkZHJlc3NcIixcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXzE6IFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb25cIixcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXzI6IFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb25cIixcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXzM6IFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb25cIixcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXzQ6IFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb25cIixcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXzU6IFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb25cIixcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXzY6IFwiUGxlYXNlIHNlbGVjdCBhbiBvcHRpb25cIixcclxuICAgICAgICAgICAgICAgIGdlbmRlcjogXCJQbGVhc2Ugc2VsZWN0IHlvdXIgZ2VuZGVyXCIsXHJcbiAgICAgICAgICAgICAgICBpbnRlcmVzdHM6IFwiUGxlYXNlIHNlbGVjdCBhdCBsZWFzdCBvbmUgaW50ZXJlc3RcIixcclxuICAgICAgICAgICAgICAgIGFncmVlOiBcIlBsZWFzZSBhY2NlcHQgb3VyIHBvbGljeVwiXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgfTtcclxufSJdfQ==
