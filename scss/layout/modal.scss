/// <reference path="../references" />

html {
    &:not(.modal) #modal {
        display: none;
    }

    &.modal {
        @media screen {
            overflow: hidden;

            body:before {
                content: '';
                @include overlay;
                height: 100vh;
                background-color: $overlay-background-color-dark;
                z-index: $modal-z-index;
            }

            header,
            &.footer-fixed footer {
                overflow-y: scroll !important;
            }

            #modal {
                @include flex-center;
                @include overlay;
                height: 100%;
                overflow-y: scroll;
                z-index: $modal-z-index;

                > div {
                    @include flex-display;
                    position: relative;
                    max-height: 100%;

                    > div {
                        @include align-self(flex-start);
                        overflow: hidden;
                    }
                }
            }

            &[data-modal="form"] #modal > div {
                margin: 0 $spacer;
                max-width: $container-medium;
            }
        }

        &[data-modal=""] #modal > div {
            display: none !important;
        }

        &[data-modal="form"] #modal > div {
            width: 100%;

            > div {
                @include flex-display;
                @include flex-direction(column);
                width: 100%;
                @include align-items(center);

                > #modal-content {
                    width: 100%;
                    margin: $spacer 0;
                    border: $component-border;
                    border-radius: $component-border-radius;
                    background-color: $modal-background-color;

                    > p {
                        padding: $spacer;
                    }
                }
            }
        }

        &[data-modal="image"] #modal {
            &.has-info:not(.info-shown) {
                #modal-title,
                #modal-description {
                    display: none;
                }
            }

            > div {
                > div {
                    max-height: 100vh;

                    > #modal-content {
                        #modal-img {
                            max-width: 100%;
                            max-height: 100vh;
                            width: auto !important;
                            height: auto !important;
                            background-color: transparent;
                            flex-shrink: 0;
                            display: block;
                        }

                        #modal-title:not(:empty),
                        #modal-description:not(:empty) {
                            position: absolute;
                            left: 0;
                            right: 0;
                            background-color: $component-overlay-dark-background-color;
                            @include color-yiq($component-overlay-dark-background-color);
                        }


                        #modal-title:not(:empty) {
                            top: 0;
                            padding: $spacer (rem(56px) + $spacer) $spacer $spacer;
                            text-align: center;
                            font-weight: $font-weight-bold;
                            transition: top $transition-time $transition-timing;
                            height: $component-line-height + ($spacer * 2);
                            @include ellipsis;
                        }

                        #modal-description:not(:empty) {
                            bottom: 0;
                            padding: $spacer;
                            transition: bottom $transition-time $transition-timing;
                            max-height: calc(100% - #{$component-line-height + ($spacer * 2)});
                            overflow: auto;
                        }

                        #modal-toggle {
                            position: absolute;
                            top: rem(7px);
                            right: rem(7px);
                        }
                    }
                }
            }
        }
    }

    .modal {
        cursor: pointer;
        @include noselect;
    }
}

html.desktop {
    .modal.overlay-light:after,
    .modal.overlay-dark:after {
        transition: background-color $transition-time $transition-timing;
    }

    .modal.overlay-light:hover:after,
    .modal.overlay-dark:hover:after {
        background-color: transparent;
    }
}
